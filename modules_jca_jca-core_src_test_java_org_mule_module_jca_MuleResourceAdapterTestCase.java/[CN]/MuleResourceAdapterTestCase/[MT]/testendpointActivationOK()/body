{
  MuleActivationSpec activationSpec=new MuleActivationSpec();
  activationSpec.setResourceAdapter(resourceAdapter);
  activationSpec.setModelName("jcaModel");
  activationSpec.setEndpoint("test://testEndpoint");
  MessageEndpointFactory endpointFactory=new MockEndpointFactory();
  assertEquals(0,resourceAdapter.endpoints.size());
  resourceAdapter.endpointActivation(endpointFactory,activationSpec);
  assertEquals(1,resourceAdapter.endpoints.size());
  MuleEndpointKey key=new MuleEndpointKey(endpointFactory,activationSpec);
  Service service=(Service)resourceAdapter.endpoints.get(key);
  assertEquals("JcaService#" + endpointFactory.hashCode(),service.getName());
  testJcaService(service);
  testEndpoint(service);
  assertTrue(service.getComponent() instanceof JcaComponent);
  assertEquals(endpointFactory,((JcaComponent)service.getComponent()).messageEndpointFactory);
  resourceAdapter.endpointActivation(endpointFactory,activationSpec);
  assertEquals(1,resourceAdapter.endpoints.size());
  resourceAdapter.endpointActivation(new MockEndpointFactory(),activationSpec);
  assertEquals(2,resourceAdapter.endpoints.size());
}
