{
  DatabaseMetaData metaData=mock(DatabaseMetaData.class);
  when(metaData.getTypeInfo()).thenReturn(createResultSetWithDuplicatedTypes());
  DbConnection connection=mock(DbConnection.class);
  when(connection.getMetaData()).thenReturn(metaData);
  MetadataDbTypeManager typeManager=new MetadataDbTypeManager();
  assertThat(typeManager.lookup(connection,UDT_OK.getId(),UDT_OK.getName()),instanceOf(DbType.class));
}
