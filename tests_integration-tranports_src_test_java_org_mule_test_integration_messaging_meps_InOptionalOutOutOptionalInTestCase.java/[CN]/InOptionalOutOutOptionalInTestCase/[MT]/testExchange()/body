{
  MuleClient client=muleContext.getClient();
  InternalMessage result=client.send("inboundEndpoint","some data",null).getRight();
  assertNotNull(result);
  assertThat(result.getPayload().getValue(),is(nullValue()));
  assertEquals("Received",result.getInboundProperty("externalApp"));
  Map<String,Serializable> props=new HashMap<>();
  props.put("foo","bar");
  result=client.send("inboundEndpoint","some data",props).getRight();
  assertNotNull(result);
  assertEquals("bar header received",result.getPayload().getValue());
  assertEquals("Received",result.getInboundProperty("externalApp"));
}
