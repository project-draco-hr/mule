{
  if (createDOMXPath(object)) {
    return new DOMXPath(expression);
  }
 else   if (createDom4jXPath(object)) {
    return new Dom4jXPath(expression);
  }
 else {
    throw new IllegalArgumentException(XmlMessages.domTypeNotSupported(object.getClass()).getMessage());
  }
}
