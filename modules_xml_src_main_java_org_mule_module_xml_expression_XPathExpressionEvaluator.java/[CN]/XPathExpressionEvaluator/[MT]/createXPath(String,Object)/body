{
  if (object instanceof Document || object instanceof Element) {
    return new DOMXPath(expression);
  }
 else   if (object instanceof org.dom4j.Document || object instanceof org.dom4j.Element) {
    return new Dom4jXPath(expression);
  }
 else {
    throw new IllegalArgumentException(XmlMessages.domTypeNotSupported(object.getClass()).getMessage());
  }
}
