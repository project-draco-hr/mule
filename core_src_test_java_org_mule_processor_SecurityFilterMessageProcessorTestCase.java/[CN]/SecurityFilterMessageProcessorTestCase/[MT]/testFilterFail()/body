{
  TestSecurityFilter securityFilter=new TestSecurityFilter(false);
  InboundEndpoint endpoint=createTestInboundEndpoint(null,securityFilter,MessageExchangePattern.REQUEST_RESPONSE,null);
  InterceptingMessageProcessor mp=new SecurityFilterMessageProcessor(securityFilter);
  TestListener listner=new TestListener();
  mp.setListener(listner);
  MuleEvent inEvent=createTestInboundEvent(endpoint);
  RequestContext.setEvent(inEvent);
  try {
    mp.process(inEvent);
    fail("Exception expected");
  }
 catch (  TestSecurityFilter.StaticMessageUnauthorisedException e) {
  }
  assertNull(listner.sensedEvent);
}
