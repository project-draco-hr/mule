{
  try {
    if (jmsSupport == null) {
      if (JmsConstants.JMS_SPECIFICATION_102B.equals(specification)) {
        jmsSupport=new Jms102bSupport(this);
      }
 else {
        jmsSupport=new Jms11Support(this);
      }
    }
  }
 catch (  Exception e) {
    throw new ConnectException(CoreMessages.failedToCreate("Jms Connector"),e,this);
  }
  try {
    _connection=createConnection();
    if (started.get()) {
      _connection.start();
    }
  }
 catch (  Exception e) {
    throw new ConnectException(e,this);
  }
}
