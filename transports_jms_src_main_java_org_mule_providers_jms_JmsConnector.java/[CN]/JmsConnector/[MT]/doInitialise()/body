{
  if (connectionFactory == null) {
    if (jndiInitialFactory != null) {
      connectionFactory=new JndiObjectFactory(connectionFactoryJndiName,jndiInitialFactory,jndiProviderUrl,jndiProviderProperties);
      ((Initialisable)connectionFactory).initialise();
      jndiContext=((JndiObjectFactory)connectionFactory).getContext();
    }
 else     if (getDefaultConnectionFactory() != null) {
      connectionFactory=getDefaultConnectionFactory();
      ((Initialisable)connectionFactory).initialise();
    }
 else {
      throw new InitialisationException(JmsMessages.noConnectionFactorySet(),this);
    }
  }
  if (topicResolver == null) {
    topicResolver=new DefaultJmsTopicResolver(this);
  }
  if (redeliveryHandler == null) {
    redeliveryHandler=new SimpleObjectFactory(DefaultRedeliveryHandler.class);
    ((Initialisable)redeliveryHandler).initialise();
  }
  try {
    managementContext.registerListener(this,getName());
  }
 catch (  NotificationException nex) {
    throw new InitialisationException(nex,this);
  }
}
