{
  if (obj instanceof String) {
    return (String)obj;
  }
 else   if (obj instanceof Document) {
    return ((Document)obj).asXML();
  }
  Source src=getXmlSource(obj);
  if (src == null)   return null;
  StringWriter writer=new StringWriter();
  StreamResult result=new StreamResult(writer);
  TransformerFactory.newInstance().newTransformer().transform(src,result);
  return writer.getBuffer().toString();
}
