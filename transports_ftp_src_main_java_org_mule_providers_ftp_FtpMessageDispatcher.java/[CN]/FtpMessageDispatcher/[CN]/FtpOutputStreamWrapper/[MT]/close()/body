{
  try {
    if (!client.completePendingCommand()) {
      client.logout();
      client.disconnect();
      client=null;
      throw new IOException("FTP Stream failed to complete pending request");
    }
    super.close();
  }
  finally {
    out.close();
  }
}
