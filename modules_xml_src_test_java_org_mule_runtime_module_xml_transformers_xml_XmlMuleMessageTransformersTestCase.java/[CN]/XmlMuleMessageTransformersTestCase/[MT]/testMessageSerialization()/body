{
  ObjectToXml t1=createObject(ObjectToXml.class);
  t1.setAcceptMuleMessage(true);
  MutableMuleMessage msg=new DefaultMuleMessage("test",(DataType)DataType.builder().charset(UTF_8).build(),muleContext);
  msg.setCorrelationId("1234");
  msg.setOutboundProperty("object",new Apple());
  msg.setOutboundProperty("string","hello");
  String xml=(String)t1.transform(msg);
  assertNotNull(xml);
  XmlToObject t2=createObject(XmlToObject.class);
  Object result=t2.transform(xml);
  assertNotNull(result);
  assertThat(result,instanceOf(MutableMuleMessage.class));
  msg=(MutableMuleMessage)result;
  assertEquals("test",getPayloadAsString(msg));
  assertEquals(new Apple(),msg.getOutboundProperty("object"));
  assertEquals(new Apple(),msg.getOutboundProperty("oBjeCt"));
  assertNull(msg.getInboundProperty("oBjeCt"));
  assertEquals("hello",msg.getOutboundProperty("string"));
  assertEquals("hello",msg.getOutboundProperty("String"));
  assertNull(msg.getInboundProperty("string"));
  assertNull(msg.getInboundProperty("number"));
  assertNull(msg.getOutboundProperty("number"));
  assertThat(msg.getCorrelationId(),is("1234"));
  assertThat(msg.getDataType().getMediaType().getCharset().get(),is(UTF_8));
  Set<String> outboundProps=msg.getOutboundPropertyNames();
  assertEquals(3,outboundProps.size());
  outboundProps.remove(MuleProperties.MULE_CORRELATION_ID_PROPERTY);
  outboundProps.remove(MuleProperties.MULE_ENCODING_PROPERTY);
  for (  String key : outboundProps) {
    assertTrue(key.equals("number") || key.equals("string") || key.equals("object"));
    assertFalse(key.equals("NUMBER") || key.equals("STRING") || key.equals("OBJECT"));
  }
}
