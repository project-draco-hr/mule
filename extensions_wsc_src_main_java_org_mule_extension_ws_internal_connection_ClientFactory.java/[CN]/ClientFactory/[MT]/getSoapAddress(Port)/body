{
  if (port != null) {
    for (    Object address : port.getExtensibilityElements()) {
      if (address instanceof SOAPAddress) {
        return ((SOAPAddress)address).getLocationURI();
      }
 else       if (address instanceof SOAP12Address) {
        return ((SOAP12Address)address).getLocationURI();
      }
 else       if (address instanceof HTTPAddress) {
        return ((HTTPAddress)address).getLocationURI();
      }
    }
  }
  throw new ConnectionException("Cannot create connection without an address, please specify one");
}
