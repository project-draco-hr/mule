{
  muleContext.getRegistry().registerObject("processor1",new StringAppendTransformer("b"));
  muleContext.getRegistry().registerObject("processor2",new StringAppendTransformer("c"));
  MuleMessage msg=new DefaultMuleMessage("test",muleContext);
  msg.setOutboundProperty("user","vasya");
  msg.setOutboundProperty("password","pupkin");
  msg.setOutboundProperty("host","example.com");
  msg.setOutboundProperty("port","12345");
  RequestContext.setEvent(getTestEvent(""));
  String result=muleContext.getExpressionManager().parse("http://#[header:user]:#[header:password]@#[header:host]:#[header:port]/foo/bar",msg);
  assertNotNull(result);
  assertEquals("http://vasya:pupkin@example.com:12345/foo/bar",result);
}
