{
  final ServerNotificationManager notificationManager=muleContext.getNotificationManager();
  final boolean fireNotification=event.isNotificationsEnabled();
  if (fireNotification) {
    fireNotification(notificationManager,flowConstruct,event,messageProcessor,null,MESSAGE_PROCESSOR_PRE_INVOKE);
  }
  Event eventToProcess=event;
  Event result=null;
  MessagingException exceptionThrown=null;
  setCurrentEvent(eventToProcess);
  try {
    if (next == null) {
      result=messageProcessor.process(eventToProcess);
    }
 else {
      result=next.execute(messageProcessor,eventToProcess);
    }
  }
 catch (  MessagingException e) {
    exceptionThrown=e;
    throw e;
  }
catch (  MuleException e) {
    exceptionThrown=new MessagingException(event,e,messageProcessor);
    throw exceptionThrown;
  }
 finally {
    if (fireNotification) {
      fireNotification(notificationManager,flowConstruct,result != null ? result : event,messageProcessor,exceptionThrown,MESSAGE_PROCESSOR_POST_INVOKE);
    }
  }
  return result;
}
