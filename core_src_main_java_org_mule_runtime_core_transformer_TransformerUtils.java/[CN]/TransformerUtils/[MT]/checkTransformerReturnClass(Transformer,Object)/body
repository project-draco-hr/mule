{
  if (value == null && (transformer instanceof AbstractTransformer && ((AbstractTransformer)transformer).isAllowNullReturn())) {
    return;
  }
  if (transformer.getReturnDataType() != null) {
    DataType dt=DataType.fromObject(value);
    if (!transformer.getReturnDataType().isCompatibleWith(dt)) {
      throw new TransformerException(CoreMessages.transformUnexpectedType(dt,transformer.getReturnDataType()),transformer);
    }
  }
  if (LOGGER.isDebugEnabled()) {
    LOGGER.debug("The transformed value is of expected type. Type is: " + ClassUtils.getSimpleName(value.getClass()));
  }
}
