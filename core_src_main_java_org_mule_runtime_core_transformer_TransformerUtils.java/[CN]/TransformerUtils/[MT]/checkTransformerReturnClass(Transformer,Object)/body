{
  if (value == null || value instanceof NullPayload && (transformer instanceof AbstractTransformer && ((AbstractTransformer)transformer).isAllowNullReturn())) {
    return;
  }
  if (transformer.getReturnDataType() != null) {
    DataType<?> dt=DataType.fromType(value.getClass());
    if (!transformer.getReturnDataType().isCompatibleWith(dt)) {
      throw new TransformerException(CoreMessages.transformUnexpectedType(dt,transformer.getReturnDataType()),transformer);
    }
  }
  if (LOGGER.isDebugEnabled()) {
    LOGGER.debug("The transformed value is of expected type. Type is: " + ClassUtils.getSimpleName(value.getClass()));
  }
}
