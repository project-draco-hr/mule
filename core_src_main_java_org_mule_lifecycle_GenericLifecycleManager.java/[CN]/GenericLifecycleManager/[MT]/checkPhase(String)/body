{
  if (executingPhase != null) {
    if (name.equalsIgnoreCase(executingPhase)) {
      throw new IllegalStateException("Phase '" + name + "' is already currently being executed");
    }
 else {
      throw new IllegalStateException("Currently executing lifecycle phase: " + executingPhase);
    }
  }
  Integer phaseIndex=index.get(name);
  if (phaseIndex == null) {
    throw new IllegalStateException("Phase does not exist: " + name);
  }
 else {
    LifecyclePhase phase=(LifecyclePhase)lifecycles.get(phaseIndex);
    if (!phase.isPhaseSupported(currentPhase)) {
      throw new IllegalStateException("Lifecycle phase: " + currentPhase + " does not support current phase: "+ name+ ". Phases supported are: "+ StringMessageUtils.toString(phase.getSupportedPhases()));
    }
  }
}
