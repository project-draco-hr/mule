{
  logger.debug("applying lifecycle to " + object);
  LifecyclePhase lcp;
  String phase;
  Integer phaseIndex;
  for (Iterator iterator=completedPhases.iterator(); iterator.hasNext(); ) {
    phase=(String)iterator.next();
    phaseIndex=(Integer)index.get(phase);
    lcp=(LifecyclePhase)lifecycles.get(phaseIndex.intValue());
    logger.debug("phase: " + lcp);
    LifecycleTransitionResult result=lcp.applyLifecycle(object);
    if (!LifecycleTransitionResult.isOk(result)) {
      throw result.nestedRetryLifecycleException();
    }
  }
  if (getExecutingPhase() != null) {
    phaseIndex=(Integer)index.get(getExecutingPhase());
    lcp=(LifecyclePhase)lifecycles.get(phaseIndex.intValue());
    logger.debug("and executing: " + lcp);
    LifecycleTransitionResult result=lcp.applyLifecycle(object);
    if (!LifecycleTransitionResult.isOk(result)) {
      throw result.nestedRetryLifecycleException();
    }
  }
}
