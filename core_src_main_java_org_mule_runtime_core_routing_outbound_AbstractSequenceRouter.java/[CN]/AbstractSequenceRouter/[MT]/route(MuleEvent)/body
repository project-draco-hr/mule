{
  MuleMessage message=event.getMessage();
  if (routes == null || routes.size() == 0) {
    throw new RoutePathNotFoundException(CoreMessages.noEndpointsForRouter(),event,null);
  }
  if (enableCorrelation.doCorrelation(message.getCorrelation())) {
    event.setMessage(MuleMessage.builder(message).correlationGroupSize(routes.size()).build());
  }
 else {
    logger.debug("Correlation is " + message.getCorrelation().toString());
  }
  List<MuleEvent> results=new ArrayList<>(routes.size());
  try {
    for (int i=0; i < routes.size(); i++) {
      MessageProcessor mp=getRoute(i,event);
      if (!(mp instanceof LegacyOutboundEndpoint) || ((LegacyOutboundEndpoint)mp).filterAccepts(message)) {
        AbstractRoutingStrategy.validateMessageIsNotConsumable(event,message);
        MuleMessage clonedMessage=cloneMessage(event,message);
        MuleEvent result=sendRequest(event,createEventToRoute(event,clonedMessage),mp,true);
        if (result != null && !VoidMuleEvent.getInstance().equals(result)) {
          results.add(result);
        }
        if (!continueRoutingMessageAfter(result)) {
          break;
        }
      }
    }
  }
 catch (  MuleException e) {
    throw new CouldNotRouteOutboundMessageException(event,routes.get(0),e);
  }
  return resultsHandler.aggregateResults(results,event);
}
