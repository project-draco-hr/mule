{
  MuleMessage message=getTestMuleMessage();
  MuleClient client=muleContext.getClient();
  client.dispatch("vm://distributor.queue",message);
  MuleMessage result=client.request("vm://results",10000);
  assertNotNull(result);
  assertTrue(result.getPayload() instanceof List);
  List<MuleMessage> results=(List<MuleMessage>)result.getPayload();
  assertEquals(3,results.size());
  for (int i=0; i < results.size(); i++) {
    MuleMessage msg=results.get(i);
    assertEquals("test Received",msg.getPayload());
    assertEquals(message.getMessageRootId(),msg.getMessageRootId());
  }
  assertEquals(message.getMessageRootId(),result.getMessageRootId());
}
