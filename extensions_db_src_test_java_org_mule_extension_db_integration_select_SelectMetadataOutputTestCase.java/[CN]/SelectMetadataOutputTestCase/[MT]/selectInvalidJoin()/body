{
  MetadataResult<ComponentMetadataDescriptor> metadata=getMetadata("selectMetadata","select NAME, NAME from PLANET");
  assertThat(metadata.isSuccess(),is(false));
  assertThat(metadata.get().getOutputMetadata().isSuccess(),is(false));
  Optional<MetadataFailure> failure=metadata.get().getOutputMetadata().getFailure();
  assertThat(failure.isPresent(),is(true));
  assertThat(failure.get().getFailureCode(),is(FailureCode.INVALID_METADATA_KEY));
  assertThat(failure.get().getMessage(),is(DUPLICATE_COLUMN_LABEL_ERROR));
}
