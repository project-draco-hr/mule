{
  final TestContainerClassLoaderFactory testContainerClassLoaderFactory=new TestContainerClassLoaderFactory(extraBootPackages,artifactUrlClassification.getContainerUrls().toArray(new URL[0]));
  ArtifactClassLoader containerClassLoader=createContainerArtifactClassLoader(testContainerClassLoaderFactory,artifactUrlClassification);
  ClassLoader classLoader=containerClassLoader.getClassLoader();
  ClassLoaderLookupPolicy childClassLoaderLookupPolicy=testContainerClassLoaderFactory.getContainerClassLoaderLookupPolicy();
  List<ArtifactClassLoader> pluginsArtifactClassLoaders=new ArrayList<>();
  if (!artifactUrlClassification.getPluginClassificationUrls().isEmpty()) {
    classLoader=createPluginClassLoaders(classLoader,childClassLoaderLookupPolicy,artifactUrlClassification,pluginsArtifactClassLoaders);
  }
  ArtifactClassLoader appClassLoader=createApplicationArtifactClassLoader(classLoader,childClassLoaderLookupPolicy,artifactUrlClassification);
  return new ClassLoaderTestRunner(containerClassLoader,pluginsArtifactClassLoaders,appClassLoader);
}
