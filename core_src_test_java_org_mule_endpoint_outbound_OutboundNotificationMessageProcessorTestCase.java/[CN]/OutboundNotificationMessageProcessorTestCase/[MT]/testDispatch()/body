{
  TestEndpointMessageNotificationListener listener=new TestEndpointMessageNotificationListener();
  muleContext.registerListener(listener);
  OutboundEndpoint endpoint=createTestOutboundEndpoint(null,null,null,null,MessageExchangePattern.ONE_WAY,null);
  MessageProcessor mp=new OutboundNotificationMessageProcessor(endpoint);
  MuleEvent event=createTestOutboundEvent(endpoint);
  mp.process(event);
  assertTrue(listener.latch.await(RECEIVE_TIMEOUT,TimeUnit.MILLISECONDS));
  assertEquals(EndpointMessageNotification.MESSAGE_DISPATCHED,listener.messageNotification.getAction());
  assertEquals(endpoint.getEndpointURI().getUri().toString(),listener.messageNotification.getEndpoint());
  assertTrue(listener.messageNotification.getSource() instanceof MuleMessage);
  assertEquals(event.getMessage().getPayload(),((MuleMessage)listener.messageNotification.getSource()).getPayload());
}
