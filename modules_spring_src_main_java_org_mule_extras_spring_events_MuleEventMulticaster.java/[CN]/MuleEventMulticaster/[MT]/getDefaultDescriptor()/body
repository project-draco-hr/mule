{
  UMOModel model=MuleManager.getInstance().lookupModel(ModelHelper.SYSTEM_MODEL);
  if (model == null) {
    model=new SedaModel();
    model.setName(ModelHelper.SYSTEM_MODEL);
    MuleManager.getInstance().registerModel(model);
  }
  UMODescriptor descriptor=model.getDescriptor(EVENT_MULTICASTER_DESCRIPTOR_NAME);
  if (descriptor != null) {
    model.unregisterComponent(descriptor);
  }
  descriptor=new MuleDescriptor(EVENT_MULTICASTER_DESCRIPTOR_NAME);
  if (subscriptions == null) {
    logger.info("No receive endpoints have been set, using default '*'");
    descriptor.getInboundRouter().addEndpoint(new MuleEndpoint("vm://*",true));
  }
 else {
    UMOInboundRouterCollection messageRouter=descriptor.getInboundRouter();
    for (int i=0; i < subscriptions.length; i++) {
      String subscription=subscriptions[i];
      UMOEndpointURI endpointUri=new MuleEndpointURI(subscription);
      UMOEndpoint endpoint=MuleEndpoint.getOrCreateEndpointForUri(endpointUri,UMOEndpoint.ENDPOINT_TYPE_RECEIVER);
      if (!asynchronous) {
        endpoint.setSynchronous(true);
      }
      messageRouter.addEndpoint(endpoint);
    }
  }
  descriptor.setImplementation(AbstractApplicationContext.APPLICATION_EVENT_MULTICASTER_BEAN_NAME);
  return descriptor;
}
