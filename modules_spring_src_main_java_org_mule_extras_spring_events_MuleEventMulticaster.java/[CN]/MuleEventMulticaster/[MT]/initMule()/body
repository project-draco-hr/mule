{
  try {
    if (applicationContext.containsBean(EVENT_MULTICASTER_DESCRIPTOR_NAME)) {
      descriptor=(UMODescriptor)applicationContext.getBean(EVENT_MULTICASTER_DESCRIPTOR_NAME);
    }
    if (applicationContext.containsBean("muleManager")) {
      registerMulticasterDescriptor();
      return;
    }
    if (!managementContext.isStarted()) {
      RegistryContext.getConfiguration().setDefaultSynchronousEndpoints(!asynchronous);
      registerEndpointMappings();
    }
    SpringContainerContext containerContext=new SpringContainerContext();
    containerContext.setBeanFactory(applicationContext);
    managementContext.getRegistry().registerContainerContext(null);
    managementContext.getRegistry().registerContainerContext(containerContext);
    registerConnectors();
    registerTransformers();
    registerGlobalEndpoints();
    registerMulticasterDescriptor();
    if (!managementContext.isStarted()) {
      managementContext.start();
    }
  }
 catch (  UMOException e) {
    throw new MuleRuntimeException(new Message("spring",1),e);
  }
}
