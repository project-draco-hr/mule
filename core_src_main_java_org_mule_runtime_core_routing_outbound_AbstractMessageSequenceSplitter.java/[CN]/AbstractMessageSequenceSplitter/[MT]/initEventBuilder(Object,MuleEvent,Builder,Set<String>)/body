{
  if (payload instanceof EventBuilderConfigurer) {
    ((EventBuilderConfigurer)payload).configure(builder);
  }
 else   if (payload instanceof MuleEvent) {
    final MuleEvent payloadAsEvent=(MuleEvent)payload;
    builder.message(payloadAsEvent.getMessage());
    for (    String flowVarName : payloadAsEvent.getFlowVariableNames()) {
      if (!flowVarsFromLastResult.contains(flowVarName)) {
        builder.addFlowVariable(flowVarName,payloadAsEvent.getFlowVariable(flowVarName),payloadAsEvent.getFlowVariableDataType(flowVarName));
      }
    }
  }
 else   if (payload instanceof MuleMessage) {
    builder.message((MuleMessage)payload);
  }
 else {
    builder.message(MuleMessage.builder(originalEvent.getMessage()).payload(payload).build());
  }
}
