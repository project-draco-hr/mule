{
  try {
    HttpResponse httpResponse=getHttpResponse(msg);
    propagateMessageProperties(httpResponse,msg);
    checkVersion(msg);
    setStatus(httpResponse,msg);
    setContentType(httpResponse,msg);
    setHeaders(httpResponse,msg);
    setCookies(httpResponse,msg);
    setCacheControl(httpResponse,msg);
    String date=new SimpleDateFormat(HttpConstants.DATE_FORMAT,Locale.US).format(new Date());
    httpResponse.setHeader(new Header(HttpConstants.HEADER_DATE,date));
    setBody(httpResponse,msg);
    return httpResponse;
  }
 catch (  Exception e) {
    throw new TransformerException(this,e);
  }
}
