{
  FileUtils.deleteDirectory(new File("archive"));
  muleContext=mock(MuleContext.class,RETURNS_DEEP_STUBS);
  sftpConnector=mock(SftpConnector.class,RETURNS_DEEP_STUBS);
  InboundEndpoint endpoint=mock(InboundEndpoint.class);
  EndpointURI endpointURI=mock(EndpointURI.class);
  when(sftpConnector.getName()).thenReturn(CONNECTOR_NAME);
  when(sftpConnector.createSftpClient(endpoint).listFiles()).thenReturn(FILE_NAMES);
  when(sftpConnector.getArchiveDir()).thenReturn("archive");
  when(sftpConnector.getArchiveTempReceivingDir()).thenReturn("receiving");
  when(sftpConnector.getArchiveTempSendingDir()).thenReturn("sending");
  when(endpoint.getMuleContext()).thenReturn(muleContext);
  when(endpoint.getEndpointURI()).thenReturn(endpointURI);
  when(endpoint.getConnector()).thenReturn(sftpConnector);
  when(endpointURI.getPath()).thenReturn(ENDPOINT_URI_PATH);
  requester=new SftpMessageRequester(endpoint);
  requester.initialise();
}
