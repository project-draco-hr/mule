{
  Class eClass=null;
  ExceptionHandler eh=null;
  try {
    eClass=msg.getException().toException().getClass();
    eh=getHandler(eClass);
    eh.onException(msg);
  }
 catch (  Exception e) {
    logger.error("Failed to handle Exception using handler: " + (eh != null ? (eh.getClass().getName() + " : " + e) : "null"));
    if (eh instanceof DefaultHandler) {
      logger.error("As the failure happened in the Default Exception handler, now using Fatal Behaviour " + FatalHandler.class.getName() + " which will cause the Exception Manager to shutdown");
      handleFatal(e);
    }
 else     if (eh instanceof FatalHandler) {
      logger.fatal("Exception caught handling Fatal exception: " + e);
    }
 else {
      logger.error("Exception Handler resorting to Default Behaviour : " + DefaultHandler.class.getName() + ", due to exception in configured behavour : "+ (eh != null ? (eh.getClass().getName() + " : " + e) : "null"));
      handleDefault(msg,e);
    }
  }
}
