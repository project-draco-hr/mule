{
  Flow flow=(Flow)getFlowConstruct(flowName);
  MuleEvent event=getTestEvent("<test/>");
  getFunctionalTestComponent("server").setEventCallback(new EventCallback(){
    @Override public void eventReceived(    MuleEventContext context,    Object component) throws Exception {
      String soapAction=context.getMessage().getInboundProperty("SOAPAction");
      if (expectedSoapAction == null) {
        errorCollector.checkThat(soapAction,nullValue());
      }
 else {
        errorCollector.checkThat(soapAction,equalTo(String.format("\"%s\"",expectedSoapAction)));
      }
    }
  }
);
  flow.process(event);
}
