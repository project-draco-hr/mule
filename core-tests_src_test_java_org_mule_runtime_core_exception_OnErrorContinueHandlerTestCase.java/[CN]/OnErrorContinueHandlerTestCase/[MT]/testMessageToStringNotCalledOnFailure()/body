{
  muleEvent.setMessage(spy(muleMessage));
  muleEvent=spy(muleEvent);
  when(mockException.getStackTrace()).thenReturn(new StackTraceElement[0]);
  MuleEvent lastEventCreated=MuleEvent.builder(context).message(muleMessage).flow(flow).build();
  onErrorContinueHandler.setMessageProcessors(asList(createFailingEventMessageProcessor(MuleEvent.builder(context).message(muleMessage).flow(flow).build()),createFailingEventMessageProcessor(lastEventCreated)));
  onErrorContinueHandler.initialise();
  when(muleEvent.getMessage().toString()).thenThrow(new RuntimeException("MuleMessage.toString() should not be called"));
  expectedException.expect(Exception.class);
  MuleEvent exceptionHandlingResult=exceptionHandlingResult=onErrorContinueHandler.handleException(mockException,muleEvent);
}
