{
  final String contentType="text/plain";
  String payload="I'm a payload";
  final MuleMessage messageOne=MuleMessage.builder(setupRequestContext("http://localhost:8080/services",METHOD_POST)).payload(payload).build();
  final MuleMessage message=MuleMessage.builder(setupRequestContextForCollection("http://localhost:8080/services",METHOD_POST,singletonList(messageOne))).addOutboundProperty(HEADER_CONTENT_TYPE,contentType).addOutboundProperty(HTTP_VERSION_PROPERTY,HTTP10).build();
  final ObjectToHttpClientMethodRequest transformer=createTransformer();
  final Object response=transformer.transform(message);
  assertTrue(response instanceof PostMethod);
  final HttpMethod httpMethod=(HttpMethod)response;
  assertEquals(null,httpMethod.getQueryString());
  final byte[] byteArrayContent=((ByteArrayRequestEntity)((PostMethod)httpMethod).getRequestEntity()).getContent();
  final byte[] expectedByteArrayContent=SerializationUtils.serialize((Serializable)message.getPayload());
  assertArrayEquals(expectedByteArrayContent,byteArrayContent);
}
