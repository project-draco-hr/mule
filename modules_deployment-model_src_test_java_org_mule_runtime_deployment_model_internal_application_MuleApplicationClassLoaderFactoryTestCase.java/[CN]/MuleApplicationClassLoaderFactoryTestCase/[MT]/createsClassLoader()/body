{
  final NativeLibraryFinderFactory nativeLibraryFinderFactory=mock(NativeLibraryFinderFactory.class);
  MuleApplicationClassLoaderFactory classLoaderFactory=new MuleApplicationClassLoaderFactory(nativeLibraryFinderFactory);
  final ApplicationDescriptor descriptor=new ApplicationDescriptor(APP_NAME);
  descriptor.setDomain(DOMAIN_NAME);
  descriptor.setClassesFolder(toFile(classesFolderUrl));
  final MuleApplicationClassLoader artifactClassLoader=(MuleApplicationClassLoader)classLoaderFactory.create(APP_ID,parentArtifactClassLoader,descriptor,emptyList());
  verify(nativeLibraryFinderFactory).create(APP_NAME);
  assertThat(artifactClassLoader.getParent(),is(parentArtifactClassLoader.getClassLoader()));
  assertThat(artifactClassLoader.getArtifactId(),is(APP_ID));
}
