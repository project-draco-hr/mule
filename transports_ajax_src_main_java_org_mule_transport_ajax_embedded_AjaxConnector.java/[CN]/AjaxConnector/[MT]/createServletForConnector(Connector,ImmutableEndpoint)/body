{
  ContinuationCometdServlet servlet=new MuleAjaxServlet();
  Context context=new Context(this.getHttpServer(),"/",Context.NO_SECURITY);
  context.setConnectorNames(new String[]{connector.getName()});
  context.addEventListener(new AjaxServletContextListener(muleContext,getName()));
  ServletHolder holder=new ServletHolder();
  holder.setServlet(servlet);
  String resourceBase=(String)endpoint.getProperty(RESOURCE_BASE_PROPERTY);
  if (resourceBase != null) {
    context.setResourceBase(resourceBase);
  }
  context.addServlet(MuleJarResourcesServlet.class,MuleJarResourcesServlet.DEFAULT_PATH_SPEC);
  context.addServlet(holder,SERVLET_PATH_SPEC);
  context.addServlet(DefaultServlet.class,"/");
  if (getInterval() != INT_VALUE_NOT_SET)   holder.setInitParameter("interval",Integer.toString(getInterval()));
  holder.setInitParameter("JSONCommented",Boolean.toString(isJsonCommented()));
  if (getLogLevel() != INT_VALUE_NOT_SET)   holder.setInitParameter("logLevel",Integer.toString(getLogLevel()));
  if (getMaxInterval() != INT_VALUE_NOT_SET)   holder.setInitParameter("maxInterval",Integer.toString(getMaxInterval()));
  if (getMultiFrameInterval() != INT_VALUE_NOT_SET)   holder.setInitParameter("multiFrameInterval",(Integer.toString(getMultiFrameInterval())));
  if (getTimeout() != INT_VALUE_NOT_SET)   holder.setInitParameter("timeout",Integer.toString(getTimeout()));
  if (getRefsThreshold() != INT_VALUE_NOT_SET)   holder.setInitParameter("refsThreshold",Integer.toString(getRefsThreshold()));
  holder.setInitParameter("requestAvailable",Boolean.toString(isRequestAvailable()));
  return servlet;
}
