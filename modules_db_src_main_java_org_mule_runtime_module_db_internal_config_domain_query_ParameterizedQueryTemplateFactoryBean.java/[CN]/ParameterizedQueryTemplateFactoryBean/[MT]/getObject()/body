{
  QueryTemplate queryTemplate=queryParser.parse(sqlText);
  List<QueryParam> resolvedParams=new LinkedList<QueryParam>();
  List<QueryParam> unresolvedQueryParams=new LinkedList<>(queryParams);
  for (  QueryParam templateParam : queryTemplate.getParams()) {
    QueryParam param=findOverriddenParam(templateParam.getName(),queryParams);
    if (param == null) {
      resolvedParams.add(templateParam);
    }
 else {
      unresolvedQueryParams.remove(param);
      resolvedParams.add(overrideParam(templateParam,param));
    }
  }
  if (!unresolvedQueryParams.isEmpty()) {
    throw new IllegalStateException(buildUnresolvedParamErrorMsg(unresolvedQueryParams));
  }
  return new QueryTemplate(queryTemplate.getSqlText(),queryTemplate.getType(),resolvedParams);
}
