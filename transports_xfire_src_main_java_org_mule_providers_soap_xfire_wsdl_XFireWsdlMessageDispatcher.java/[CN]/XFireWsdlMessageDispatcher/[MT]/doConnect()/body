{
  try {
    XFire xfire=connector.getXfire();
    String wsdlUrl=endpoint.getEndpointURI().getAddress();
    String serviceName=endpoint.getEndpointURI().getAddress();
    if (endpoint.getProperty("wsdlUrl") != null && StringUtils.isNotBlank(endpoint.getProperty("wsdlUrl").toString())) {
      wsdlUrl=(String)endpoint.getProperty("wsdlUrl");
    }
    if (serviceName.indexOf("?") > -1) {
      serviceName=serviceName.substring(0,serviceName.lastIndexOf('?'));
    }
    Service service=xfire.getServiceRegistry().getService(new QName(serviceName));
    if (service == null) {
      service=new Client(new URL(wsdlUrl)).getService();
      service.setName(new QName(serviceName));
      xfire.getServiceRegistry().register(service);
    }
    try {
      this.client=createXFireWsdlClient(endpoint,service,xfire,wsdlUrl);
    }
 catch (    Exception ex) {
      disconnect();
      throw ex;
    }
  }
 catch (  Exception ex) {
    disconnect();
    throw ex;
  }
}
