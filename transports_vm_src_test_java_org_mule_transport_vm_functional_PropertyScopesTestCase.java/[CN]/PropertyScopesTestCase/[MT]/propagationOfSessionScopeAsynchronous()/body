{
  MuleClient client=muleContext.getClient();
  MuleMessage message=new DefaultMuleMessage(TEST_MESSAGE,muleContext);
  message.setProperty("foo","bar",PropertyScope.SESSION);
  client.dispatch("vm://in-asynch",message);
  MuleMessage response=client.request("vm://out-asynch",RECEIVE_TIMEOUT);
  assertNotNull(response);
  assertEquals("bar",response.getProperty("foo",PropertyScope.SESSION));
}
