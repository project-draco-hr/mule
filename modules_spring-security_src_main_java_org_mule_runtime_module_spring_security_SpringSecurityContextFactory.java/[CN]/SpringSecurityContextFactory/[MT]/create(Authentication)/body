{
  org.springframework.security.core.context.SecurityContext context=new SecurityContextImpl();
  context.setAuthentication(((SpringAuthenticationAdapter)authentication).getDelegate());
  if (authentication.getProperties() != null) {
    if (authentication.getProperties().containsKey("securityMode")) {
      String securityMode=(String)authentication.getProperties().get("securityMode");
      SecurityContextHolder.setStrategyName(securityMode);
    }
  }
  SecurityContextHolder.setContext(context);
  return new SpringSecurityContext(context);
}
