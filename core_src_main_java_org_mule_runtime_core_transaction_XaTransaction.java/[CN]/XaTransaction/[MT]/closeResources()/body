{
  Iterator i=resources.entrySet().iterator();
  while (i.hasNext()) {
    Map.Entry entry=(Map.Entry)i.next();
    final Object value=entry.getValue();
    if (value instanceof MuleXaObject) {
      MuleXaObject xaObject=(MuleXaObject)value;
      if (!xaObject.isReuseObject()) {
        try {
          xaObject.close();
          i.remove();
        }
 catch (        Exception e) {
          logger.error("Failed to close resource " + xaObject,e);
        }
      }
    }
  }
}
