{
  managementContext.getRegistry().registerConnector(getTestConnector(),managementContext);
  UMOComponent c=MuleTestUtils.getTestComponent("orangeComponent",Orange.class,managementContext);
  c.setInitialState(ImmutableMuleDescriptor.INITIAL_STATE_STOPPED);
  managementContext.getRegistry().registerComponent(c,managementContext);
  c=managementContext.getRegistry().lookupComponent("orangeComponent");
  assertFalse(c.isStarted());
  AbstractConnector connector=(AbstractConnector)managementContext.getRegistry().lookupConnector("testConnector");
  assertTrue(connector.isStarted());
  assertTrue(connector.getReceivers().isEmpty());
  c.start();
  assertTrue(connector.isStarted());
  assertFalse(connector.getReceivers().isEmpty());
  assertTrue(c.isStarted());
  Iterator it=connector.getReceivers().values().iterator();
  while (it.hasNext()) {
    assertTrue(((UMOMessageReceiver)it.next()).isConnected());
  }
}
