{
  managementContext.getRegistry().registerConnector(getTestConnector(),managementContext);
  managementContext.getRegistry().registerService(MuleTestUtils.createDescriptor(Orange.class.getName(),"orangeComponent","test://in","test://out",null,managementContext),managementContext);
  final UMOComponent c=managementContext.getRegistry().lookupSystemModel().getComponent("orangeComponent");
  assertTrue(c.isStarted());
  AbstractConnector connector=(AbstractConnector)managementContext.getRegistry().lookupConnector("testConnector");
  assertTrue(connector.isStarted());
  assertFalse(connector.getReceivers().isEmpty());
  Iterator it=connector.getReceivers().values().iterator();
  while (it.hasNext()) {
    assertTrue(((UMOMessageReceiver)it.next()).isConnected());
  }
  c.stop();
  assertFalse(c.isStarted());
  assertTrue(connector.isStarted());
  assertTrue(connector.getReceivers().isEmpty());
}
