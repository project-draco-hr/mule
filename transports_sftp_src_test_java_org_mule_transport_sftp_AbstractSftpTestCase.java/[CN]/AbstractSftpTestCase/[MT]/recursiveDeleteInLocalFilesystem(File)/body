{
  if (parent.isDirectory()) {
    for (    File child : parent.listFiles()) {
      recursiveDeleteInLocalFilesystem(child);
    }
  }
  File parentParent=parent.getParentFile();
  if (!parentParent.canWrite()) {
    if (SystemUtils.IS_OS_WINDOWS) {
      Runtime.getRuntime().exec("attrib -r /D" + parentParent.getAbsolutePath());
    }
 else     if (SystemUtils.IS_OS_UNIX || SystemUtils.IS_OS_LINUX) {
      Runtime.getRuntime().exec("chmod +w " + parentParent.getAbsolutePath());
    }
 else {
      throw new IOException("This test is not supported on your detected platform : " + SystemUtils.OS_NAME);
    }
  }
  if (parent.exists()) {
    String os=System.getProperty("os.name").toLowerCase();
    if (SystemUtils.IS_OS_WINDOWS) {
      Runtime.getRuntime().exec("attrib -r /D" + parent.getAbsolutePath());
    }
 else     if (SystemUtils.IS_OS_UNIX || SystemUtils.IS_OS_LINUX) {
      Runtime.getRuntime().exec("chmod +w " + parent.getAbsolutePath());
    }
 else {
      throw new IOException("This test is not supported on your detected platform : " + SystemUtils.OS_NAME);
    }
    if (!parent.delete())     throw new IOException("Failed to delete folder: " + parent);
  }
}
