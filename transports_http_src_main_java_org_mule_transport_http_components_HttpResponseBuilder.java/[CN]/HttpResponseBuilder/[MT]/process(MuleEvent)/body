{
  MuleMessage msg=event.getMessage();
  HttpResponse httpResponse=getHttpResponse(msg);
  propagateMessageProperties(httpResponse,msg);
  checkVersion(msg);
  setStatus(httpResponse,msg);
  setContentType(httpResponse,msg);
  setHeaders(httpResponse,msg);
  setCookies(httpResponse,msg);
  setCacheControl(httpResponse,msg);
  setDateHeader(httpResponse,new Date());
  setBody(httpResponse,msg,event);
  msg.setPayload(httpResponse);
  return event;
}
