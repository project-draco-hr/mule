{
  if (!event.isSynchronous()) {
    throw new ConfigurationException(CoreMessages.watermarkRequiresSynchronousProcessing());
  }
  String variableName=this.watermark.resolveVariable(event);
  event.setFlowVariable(variableName,sourceEvent.getFlowVariable(variableName));
  return event;
}
