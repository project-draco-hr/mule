{
  MuleEvent event;
  MuleSession session=connector.getSessionHandler().retrieveSessionInfoFromMessage(message,flowConstruct.getMuleContext());
  if (session == null) {
    session=new DefaultMuleSession();
  }
  final Object replyToFromMessage=getReplyToDestination(message);
  DefaultMuleEvent newEvent=null;
  final MessageContext executionContext=create(flowConstruct,getEndpoint().getAddress(),message.getCorrelationId());
  if (replyToFromMessage != null) {
    newEvent=new DefaultMuleEvent(executionContext,message,flowConstruct,session,replyToHandler,replyToFromMessage);
  }
 else {
    newEvent=new DefaultMuleEvent(executionContext,message,flowConstruct,session,null,null);
  }
  if (message.getCorrelationId() != null) {
    newEvent.setLegacyCorrelationId(message.getCorrelationId());
  }
  newEvent.setCorrelation(message.getCorrelation());
  DefaultMuleEventEndpointUtils.populateFieldsFromInboundEndpoint(newEvent,getEndpoint());
  event=newEvent;
  setCurrentEvent(event);
  if (session.getSecurityContext() != null && session.getSecurityContext().getAuthentication() != null) {
    session.getSecurityContext().getAuthentication().setEvent(event);
  }
  return event;
}
