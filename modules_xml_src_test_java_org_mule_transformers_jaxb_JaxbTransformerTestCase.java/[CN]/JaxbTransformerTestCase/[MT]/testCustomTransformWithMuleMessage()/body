{
  ByteArrayInputStream in=new ByteArrayInputStream(PERSON_XML.getBytes());
  DefaultMuleMessage msg=new DefaultMuleMessage(in,muleContext);
  msg.setInboundProperty("foo","fooValue");
  List<EmailAddress> emailAddresses=msg.getPayload(new ListDataType<List<EmailAddress>>(EmailAddress.class));
  assertNotNull(emailAddresses);
  assertEquals(2,emailAddresses.size());
  assertEquals("home",emailAddresses.get(0).getType());
  assertEquals("john.doe@gmail.com",emailAddresses.get(0).getAddress());
  assertEquals("work",emailAddresses.get(1).getType());
  assertEquals("jdoe@bigco.com",emailAddresses.get(1).getAddress());
}
