{
  if (initialised.get()) {
    logger.debug("Already initialised: " + toString());
    return;
  }
  if (connector == null) {
    if (endpointUri.getConnectorName() != null) {
      connector=MuleManager.getInstance().lookupConnector(endpointUri.getConnectorName());
      if (connector == null) {
        throw new IllegalArgumentException("Connector not found: " + endpointUri.getConnectorName());
      }
    }
 else {
      try {
        connector=ConnectorFactory.getOrCreateConnectorByProtocol(this);
        if (connector == null) {
          throw new InitialisationException(new Message(Messages.CONNECTOR_WITH_PROTOCOL_X_NOT_REGISTERED,endpointUri.getScheme()),this);
        }
      }
 catch (      ConnectorFactoryException e) {
        throw new InitialisationException(new Message(Messages.FAILED_TO_CREATE_CONNECTOR_FROM_URI_X,endpointUri),e,this);
      }
    }
    if (endpointUri.getEndpointName() != null && name == null) {
      name=endpointUri.getEndpointName();
    }
  }
  if (name == null) {
    name="_" + endpointUri.getScheme() + "Endpoint#"+ hashCode();
    endpointUri.setEndpointName(name);
  }
  String sync=endpointUri.getParams().getProperty("synchronous",null);
  if (sync != null) {
    synchronous=Boolean.valueOf(sync);
  }
  if (properties != null && endpointUri.getParams() != null) {
    properties.putAll(endpointUri.getParams());
  }
  if (endpointUri.getTransformers() != null) {
    try {
      transformer=MuleObjectHelper.getTransformer(endpointUri.getTransformers(),",");
    }
 catch (    MuleException e) {
      throw new InitialisationException(e,this);
    }
  }
  if (transformer == null) {
    if (connector instanceof AbstractConnector) {
      if (UMOEndpoint.ENDPOINT_TYPE_RECEIVER.equals(type)) {
        transformer=((AbstractConnector)connector).getDefaultInboundTransformer();
      }
 else {
        transformer=((AbstractConnector)connector).getDefaultOutboundTransformer();
      }
    }
  }
  if (transformer != null) {
    transformer.setEndpoint(this);
  }
  if (securityFilter != null) {
    securityFilter.setEndpoint(this);
    securityFilter.initialise();
  }
  initialised.set(true);
}
