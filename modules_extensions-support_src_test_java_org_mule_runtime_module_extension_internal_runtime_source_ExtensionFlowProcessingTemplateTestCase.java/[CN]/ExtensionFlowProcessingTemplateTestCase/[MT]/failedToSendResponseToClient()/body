{
  doThrow(runtimeException).when(completionHandler).onCompletion(same(event),any(ExtensionSourceExceptionCallback.class));
  template.sendResponseToClient(event,responseCompletionCallback);
  verify(completionHandler,never()).onFailure(any(Exception.class));
  verify(responseCompletionCallback).responseSentWithFailure(argThat(new ArgumentMatcher<MessagingException>(){
    @Override public boolean matches(    Object o){
      return o instanceof MessagingException && ((MessagingException)o).getCauseException().equals(runtimeException);
    }
  }
),eq(event));
}
