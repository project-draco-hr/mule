{
  final String domainOriginal="TEST_DOMAIN_1";
  final SedaService component=new SedaService();
  component.setName("TEST_SERVICE");
  component.setComponent(new DefaultJavaComponent(new SingletonObjectFactory(Object.class)));
  component.setThreadingProfile(ThreadingProfile.DEFAULT_THREADING_PROFILE);
  SedaModel model=new SedaModel();
  component.setModel(model);
  muleContext.getRegistry().registerModel(model);
  muleContext.getRegistry().registerService(component);
  muleContext.start();
  final ServiceService service=new ServiceService("TEST_SERVICE");
  final ObjectName name=ObjectName.getInstance(domainOriginal + ":type=TEST_SERVICE");
  mBeanServer.registerMBean(service,name);
  Set mbeans=mBeanServer.queryMBeans(ObjectName.getInstance(domainOriginal + ":*"),null);
  assertEquals("Unexpected number of components registered in the domain.",4,mbeans.size());
  mBeanServer.unregisterMBean(name);
  mbeans=mBeanServer.queryMBeans(ObjectName.getInstance(domainOriginal + ":*"),null);
  assertEquals("There should be no MBeans left in the domain",0,mbeans.size());
}
