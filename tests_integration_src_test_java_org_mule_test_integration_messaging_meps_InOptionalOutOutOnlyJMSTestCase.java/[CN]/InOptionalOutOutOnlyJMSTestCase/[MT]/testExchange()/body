{
  MuleClient client=muleContext.getClient();
  MuleMessage result=client.send("inboundEndpoint","some data",null);
  assertNotNull(result);
  assertEquals(NullPayload.getInstance(),result.getPayload());
  Map<String,Object> props=new HashMap<String,Object>();
  props.put("foo","bar");
  result=client.send("inboundEndpoint","some data",props,20000);
  Thread.sleep(200);
  assertEquals(0,broker.getAdminView().getTemporaryQueues().length);
  assertNotNull(result);
  assertEquals("foo header received",result.getPayload());
}
