{
  Map credentials=getValidCredentials();
  authenticator.setCredentials(credentials);
  Subject subject=authenticator.authenticate(VALID_AUTH_TOKEN);
  assertNotNull(subject);
  assertTrue(subject.isReadOnly());
  final Set publicCredentials=subject.getPublicCredentials();
  assertNotNull(publicCredentials);
  assertEquals(0,publicCredentials.size());
  final Set privateCredentials=subject.getPrivateCredentials();
  assertNotNull(privateCredentials);
  assertEquals(0,privateCredentials.size());
  final Set principals=subject.getPrincipals();
  assertNotNull(principals);
  assertEquals(1,principals.size());
  final Object ref=principals.iterator().next();
  assertTrue(ref instanceof JMXPrincipal);
  final JMXPrincipal jmxPrincipal=(JMXPrincipal)ref;
  final String name=jmxPrincipal.getName();
  assertNotNull(name);
  assertEquals(VALID_AUTH_TOKEN[0],name);
}
