{
  if (environment == null) {
    try {
      if (SystemUtils.IS_JAVA_1_4) {
        environment=Collections.unmodifiableMap(getenvJDK14());
      }
 else {
        Class target=System.class;
        Method envMethod=target.getMethod("getenv",ArrayUtils.EMPTY_CLASS_ARRAY);
        environment=Collections.unmodifiableMap((Map)envMethod.invoke(target,(Class[])null));
      }
    }
 catch (    Exception ex) {
      logger.error("Could not access OS environment: ",ex);
      environment=Collections.EMPTY_MAP;
    }
  }
  return environment;
}
