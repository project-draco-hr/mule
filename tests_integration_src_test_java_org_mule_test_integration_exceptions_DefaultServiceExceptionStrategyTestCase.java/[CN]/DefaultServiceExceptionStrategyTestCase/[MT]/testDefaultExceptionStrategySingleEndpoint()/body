{
  FlowConstruct service;
  if (variant.equals(ConfigVariant.FLOW))   service=muleContext.getRegistry().lookupFlowConstruct("testService1");
 else   service=muleContext.getRegistry().lookupService("testService1");
  assertNotNull(service);
  assertNotNull(service.getExceptionListener());
  assertTrue(service.getExceptionListener() instanceof DefaultMessagingExceptionStrategy);
  assertEquals(1,((DefaultMessagingExceptionStrategy)service.getExceptionListener()).getMessageProcessors().size());
  MuleClient mc=new MuleClient(muleContext);
  mc.dispatch("vm://in1","test",null);
  assertExceptionMessage(mc.request("vm://out1",RECEIVE_TIMEOUT));
  assertNull(mc.request("vm://out1",RECEIVE_TIMEOUT));
}
