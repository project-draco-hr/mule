{
  FlowConstruct service;
  if (variant.equals(ConfigVariant.FLOW))   service=muleContext.getRegistry().lookupFlowConstruct("testService1");
 else   service=muleContext.getRegistry().lookupService("testService1");
  assertNotNull(service);
  assertNotNull(service.getExceptionListener());
  assertTrue(service.getExceptionListener() instanceof DefaultMessagingExceptionStrategy);
  assertEquals(1,((DefaultMessagingExceptionStrategy)service.getExceptionListener()).getMessageProcessors().size());
  MuleClient client=muleContext.getClient();
  client.dispatch("vm://in1","test",null);
  assertExceptionMessage(client.request("vm://out1",RECEIVE_TIMEOUT));
  assertNull(client.request("vm://out1",RECEIVE_TIMEOUT));
}
