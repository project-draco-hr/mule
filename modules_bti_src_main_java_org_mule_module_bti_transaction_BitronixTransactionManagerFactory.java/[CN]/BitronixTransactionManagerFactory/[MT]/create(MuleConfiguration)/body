{
synchronized (BitronixTransactionManagerFactory.class) {
    if (transactionManager == null) {
      configureTransactionLogsDirectory();
      configureUniqueServerId();
      configureTransactionRecoveryExecutionInterval();
      configureTransactionTimeout();
      transactionManager=TransactionManagerServices.getTransactionManager();
      registerMuleQueuesXaResource();
      transactionManager=new TransactionManagerWrapper(transactionManager,defaultXaSessionResourceProducer);
    }
    if (!transactionManagerUsedByThisApp) {
      transactionManagerUsedByThisApp=true;
      numberOfAppsUsingTm++;
    }
    return transactionManager;
  }
}
