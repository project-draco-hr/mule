{
  setPayloadMessageProcessor.setValue(EXPRESSION);
  when(expressionLanguage.isExpression(EXPRESSION)).thenReturn(true);
  setPayloadMessageProcessor.initialise();
  DefaultTypedValue typedValue=new DefaultTypedValue(PLAIN_TEXT,DataType.STRING);
  when(expressionLanguage.evaluateTyped(EXPRESSION,testEvent,null)).thenReturn(typedValue);
  when(expressionLanguage.evaluateTyped(eq(EXPRESSION),eq(testEvent),any(Event.Builder.class),eq(null))).thenReturn(typedValue);
  Event response=setPayloadMessageProcessor.process(testEvent);
  assertThat(response.getMessage().getPayload().getValue(),is(PLAIN_TEXT));
}
