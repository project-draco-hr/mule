{
  if (resources == null) {
    resources=new HashMap();
  }
  if (resources.containsKey(key)) {
    throw new IllegalTransactionStateException("A resource has already been enlisted for key: " + key);
  }
  resources.put(key,resource);
}
