{
  super.doSetUp();
  this.adapter=mock(OAuth2Adapter.class);
  this.objectStore=new InMemoryObjectStore<Serializable>();
  this.event=getTestEvent("");
  event.getMessage().setProperty("state","<<MULE_EVENT_ID=whatever>>",PropertyScope.INBOUND);
  this.latch=new CountDownLatch(1);
  this.exception=null;
  this.manager=new TestOAuth2Manager(mock(KeyedPoolableObjectFactory.class),adapter);
  this.manager.setAccessTokenObjectStore(this.objectStore);
  this.processor=new OAuth2FetchAccessTokenMessageProcessor(manager,accessToken);
  this.processor.setMuleContext(muleContext);
  this.processor.setAccessTokenId(accessToken);
}
