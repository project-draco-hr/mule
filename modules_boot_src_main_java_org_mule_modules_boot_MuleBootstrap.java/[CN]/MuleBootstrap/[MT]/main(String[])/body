{
  CommandLine commandLine=parseCommandLine(args);
  String[] remainingArgs=commandLine.getArgs();
  String mainClassName=commandLine.getOptionValue("main");
  if (commandLine.hasOption("version")) {
    prepareBootstrapPhase();
    WrapperManager.start(new VersionWrapper(),remainingArgs);
  }
 else   if (commandLine.hasOption("osgi")) {
    boolean startGui=!commandLine.hasOption("nogui");
    System.out.println("Starting the OSGi Framework...");
    WrapperManager.start(new OsgiFrameworkWrapper(startGui),remainingArgs);
  }
 else   if (mainClassName == null || mainClassName.equals(MAIN_CLASS_MULE_SERVER)) {
    prepareBootstrapPhase();
    System.out.println("Starting the Mule Server...");
    WrapperManager.start((WrapperListener)Class.forName(MAIN_CLASS_MULE_SERVER).newInstance(),remainingArgs);
  }
 else {
    String[] appArgs=new String[remainingArgs.length + 1];
    appArgs[0]=mainClassName;
    System.arraycopy(remainingArgs,0,appArgs,1,remainingArgs.length);
    prepareBootstrapPhase();
    System.out.println("Starting class " + mainClassName + "...");
    WrapperSimpleApp.main(appArgs);
  }
}
