{
  MuleEvent resultEvent=null;
  boolean authorised=false;
  if (filter != null) {
    AbstractConnector connector=(AbstractConnector)endpoint.getConnector();
    MessageReceiver receiver=connector.getReceiver(event.getFlowConstruct(),endpoint);
    try {
      filter.authenticate(event);
      authorised=true;
    }
 catch (    SecurityException e) {
      logger.warn("Request was made but was not authenticated: " + e.getMessage(),e);
      ((AbstractConnector)endpoint.getConnector()).fireNotification(new SecurityNotification(e,SecurityNotification.SECURITY_AUTHENTICATION_FAILED));
      connector.handleException(e,receiver);
      resultEvent=RequestContext.getEvent();
      resultEvent.getMessage().setPayload(e.getLocalizedMessage());
      resultEvent.getMessage().setExceptionPayload(new DefaultExceptionPayload(e));
    }
  }
 else {
    authorised=true;
  }
  if (authorised) {
    resultEvent=processNext(event);
  }
  return resultEvent;
}
