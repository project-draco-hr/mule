{
  Flow flowConstruct=(Flow)muleContext.getRegistry().lookupFlowConstruct("joinInvalidMetadata");
  List<MessageProcessor> messageProcessors=flowConstruct.getMessageProcessors();
  AbstractSingleQueryDbMessageProcessor queryMessageProcessor=(AbstractSingleQueryDbMessageProcessor)messageProcessors.get(0);
  Result<MetaData> outputMetaData=queryMessageProcessor.getOutputMetaData(null);
  assertThat(outputMetaData.getStatus(),equalTo(Result.Status.FAILURE));
  assertThat(outputMetaData.get(),nullValue());
  assertThat(outputMetaData.getMessage(),equalTo(DUPLICATE_COLUMN_LABEL_ERROR));
}
