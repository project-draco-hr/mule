{
  Transaction tx=TransactionCoordination.getInstance().getTransaction();
  if (tx == null) {
    return;
  }
  t=ExceptionHelper.getRootException(t);
  boolean transactionRollback=false;
  if (rollbackTxFilter == null && commitTxFilter == null) {
    rollbackTransaction();
    transactionRollback=true;
  }
 else   if (rollbackTxFilter != null && rollbackTxFilter.accept(t.getClass().getName())) {
    rollbackTransaction();
    transactionRollback=true;
  }
 else   if (commitTxFilter != null && !commitTxFilter.accept(t.getClass().getName())) {
    rollbackTransaction();
    transactionRollback=true;
  }
  if (transactionRollback && t instanceof MessagingException) {
    ((MessagingException)t).setCauseRollback(true);
  }
}
