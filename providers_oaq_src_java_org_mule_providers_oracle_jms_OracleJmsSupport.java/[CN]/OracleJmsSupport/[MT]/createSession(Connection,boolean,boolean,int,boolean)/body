{
  java.sql.Connection jdbcConnection=null;
  try {
    log.debug("Creating queue/topic connection, URL = " + ((OracleJmsConnector)connector).getJdbcConnectionPool().getURL() + ", user = "+ ((OracleJmsConnector)connector).getJdbcConnectionPool().getUser());
    jdbcConnection=((OracleJmsConnector)connector).getJdbcConnectionPool().getConnection();
  }
 catch (  SQLException e) {
    throw new JMSException("Unable to open JDBC connection",e.getMessage());
  }
  if (topic) {
    TopicConnection topicConnection=AQjmsTopicConnectionFactory.createTopicConnection(jdbcConnection);
    ((OracleJmsConnector)connector).getConnections().add(topicConnection);
    topicConnection.start();
    return topicConnection.createTopicSession(transacted,ackMode);
  }
 else {
    QueueConnection queueConnection=AQjmsQueueConnectionFactory.createQueueConnection(jdbcConnection);
    ((OracleJmsConnector)connector).getConnections().add(queueConnection);
    queueConnection.start();
    return queueConnection.createQueueSession(transacted,ackMode);
  }
}
