{
  final OutboundEndpoint failingOutboundEndpoint=MuleTestUtils.getTestOutboundEndpoint(MessageExchangePattern.REQUEST_RESPONSE,muleContext,"test://AlwaysFail",testConnector);
  validator=new Validator("test-validator",muleContext,directInboundMessageSource,failingOutboundEndpoint,new PayloadTypeFilter(Integer.class),"#[string:GOOD:#[message:payload]]","#[string:BAD:#[message:payload]]","#[string:ERROR:#[message:payload]]");
  validator.initialise();
  validator.start();
  final MuleEvent response=directInboundMessageSource.process(MuleTestUtils.getTestInboundEvent(123,muleContext));
  assertEquals("ERROR:123",response.getMessageAsString());
}
