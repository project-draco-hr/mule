{
  TestClassLoader classLoader=new TestClassLoader();
  Class expectedClass=this.getClass();
  classLoader.addClass(CLASS_NAME,expectedClass);
  ClassLoaderFilter filter=mock(ClassLoaderFilter.class);
  when(filter.exportsClass(CLASS_NAME)).thenReturn(true);
  ArtifactClassLoader artifactClassLoader=mock(ArtifactClassLoader.class);
  when(artifactClassLoader.getClassLoader()).thenReturn(classLoader);
  filteringArtifactClassLoader=new FilteringArtifactClassLoader(PLUGIN_NAME,artifactClassLoader,filter);
  Class<?> aClass=filteringArtifactClassLoader.loadClass(CLASS_NAME);
  assertThat(aClass,equalTo(expectedClass));
}
