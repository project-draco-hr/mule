{
  if (isReceiveMessagesInTransaction()) {
    MuleMessage message=getFirstMessage();
    if (message == null) {
      return null;
    }
    List<MuleMessage> messages=new ArrayList<MuleMessage>(1);
    if (message instanceof DefaultMuleMessage) {
      ((DefaultMuleMessage)message).setMuleContext(endpoint.getMuleContext());
    }
    messages.add(message);
    return messages;
  }
 else {
    return getFirstMessages();
  }
}
