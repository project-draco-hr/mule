{
  MuleMessage message=event.getMessage();
  MuleEvent result=null;
  if (targets == null || targets.size() == 0) {
    throw new RoutePathNotFoundException(CoreMessages.noEndpointsForRouter(),message,null);
  }
  try {
    MessageProcessor ep=targets.get(0);
    EndpointURI newUri;
    if (ep instanceof OutboundEndpoint) {
      for (      String propertyKey : message.getPropertyNames()) {
        Object propertyValue=message.getProperty(propertyKey);
        if (propertyKey.equalsIgnoreCase("packet.port")) {
          int port=((Integer)propertyValue).intValue();
          newUri=new MuleEndpointURI("udp://localhost:" + port,muleContext);
          if (logger.isDebugEnabled()) {
            logger.info("Uri after parsing is: " + newUri.getAddress());
          }
          ep=new DynamicURIOutboundEndpoint((OutboundEndpoint)ep,newUri);
          break;
        }
      }
    }
    result=sendRequest(event,message,ep,true);
  }
 catch (  MuleException e) {
    throw new CouldNotRouteOutboundMessageException(message,targets.get(0),e);
  }
  return result;
}
