{
  MuleMessage message=event.getMessage();
  MuleEvent result;
  if (routes == null || routes.size() == 0) {
    throw new RoutePathNotFoundException(CoreMessages.noEndpointsForRouter(),event,null);
  }
  try {
    MessageProcessor ep=routes.get(0);
    EndpointURI newUri;
    if (ep instanceof OutboundEndpoint) {
      for (      String propertyKey : message.getOutboundPropertyNames()) {
        Object propertyValue=message.getOutboundProperty(propertyKey);
        if (propertyKey.equalsIgnoreCase("packet.port")) {
          int port=(Integer)propertyValue;
          newUri=new MuleEndpointURI("udp://localhost:" + port,muleContext);
          if (logger.isDebugEnabled()) {
            logger.info("Uri after parsing is: " + newUri.getAddress());
          }
          ep=new DynamicURIOutboundEndpoint((OutboundEndpoint)ep,newUri);
          break;
        }
      }
    }
    result=sendRequest(event,message,ep,true);
  }
 catch (  MuleException e) {
    throw new CouldNotRouteOutboundMessageException(event,routes.get(0),e);
  }
  return result;
}
