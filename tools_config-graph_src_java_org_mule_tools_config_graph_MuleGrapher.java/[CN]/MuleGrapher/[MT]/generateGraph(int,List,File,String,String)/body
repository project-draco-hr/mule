{
  SAXBuilder builder=new SAXBuilder();
  builder.setValidation(true);
  builder.setEntityResolver(new MuleDtdResolver());
  Graph graph=GraphFactory.newGraph();
  builder.setIgnoringElementContentWhitespace(true);
  MuleParser muleParser=new MuleParser(config,builder);
  for (Iterator iterator=files.iterator(); iterator.hasNext(); ) {
    String s=(String)iterator.next();
    File myFile=new File(s);
    System.out.println("**************** processing " + i + " of "+ files.size()+ 1+ " : "+ myFile.getCanonicalPath());
    muleParser.parseMuleConfig(myFile,graph);
    if (files.size() > 1) {
      if (caption == null)       caption="(no caption set)";
      graph.getInfo().setCaption(caption);
    }
    if (!config.isCombineFiles()) {
      muleParser.finalise(graph);
      graphRenderer.saveGraph(graph,fileName,outputDir);
    }
  }
  if (config.isCombineFiles()) {
    muleParser.finalise(graph);
    graphRenderer.saveGraph(graph,fileName,outputDir);
  }
}
