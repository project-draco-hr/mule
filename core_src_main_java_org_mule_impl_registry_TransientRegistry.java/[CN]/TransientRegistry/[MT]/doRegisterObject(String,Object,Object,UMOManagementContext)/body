{
  if (isInitialised() || isInitialising()) {
    value=applyProcessors(value);
  }
  Map objectMap=getObjectTypeMap((Class)metadata);
  if (objectMap != null) {
    objectMap.put(key,value);
    applyLifecycle(value,managementContext);
  }
 else {
    throw new RegistrationException("No object map exists for type " + metadata);
  }
}
