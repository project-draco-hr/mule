{
  this.sslServerSocketFactory=sslContext.getServerSocketFactory();
  if (cipherSuites == null) {
    cipherSuites=sslServerSocketFactory.getDefaultCipherSuites();
  }
  this.enabledCipherSuites=ArrayUtils.intersection(cipherSuites,sslServerSocketFactory.getSupportedCipherSuites());
  this.defaultCipherSuites=ArrayUtils.intersection(cipherSuites,sslServerSocketFactory.getDefaultCipherSuites());
  if (protocols == null) {
    protocols=sslContext.getDefaultSSLParameters().getProtocols();
  }
  this.enabledProtocols=ArrayUtils.intersection(protocols,sslContext.getSupportedSSLParameters().getProtocols());
  if (this.enabledProtocols.length != protocols.length) {
    logger.warn("Current context supports less SSL protocols than configured. Only the following are enabled: [{}]",Joiner.on(", ").join(this.enabledProtocols));
  }
}
