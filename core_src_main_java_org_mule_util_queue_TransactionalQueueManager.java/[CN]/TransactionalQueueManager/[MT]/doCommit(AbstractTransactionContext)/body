{
  QueueTransactionContext ctx=(QueueTransactionContext)context;
  try {
    if (ctx.added != null) {
      for (      Map.Entry<QueueInfo,List<Object>> entry : ctx.added.entrySet()) {
        QueueInfo queue=entry.getKey();
        List<Object> queueAdded=entry.getValue();
        if (queueAdded != null && queueAdded.size() > 0) {
          for (          Object object : queueAdded) {
            Object id=doStore(queue,object);
            queue.putNow(id);
          }
        }
      }
    }
    if (ctx.removed != null) {
      for (      Map.Entry<QueueInfo,List<Object>> entry : ctx.removed.entrySet()) {
        QueueInfo queue=entry.getKey();
        List<Object> queueRemoved=entry.getValue();
        if (queueRemoved != null && queueRemoved.size() > 0) {
          for (          Object id : queueRemoved) {
            doRemove(queue,id);
          }
        }
      }
    }
  }
 catch (  Exception e) {
    throw new ResourceManagerException(e);
  }
 finally {
    ctx.added=null;
    ctx.removed=null;
  }
}
