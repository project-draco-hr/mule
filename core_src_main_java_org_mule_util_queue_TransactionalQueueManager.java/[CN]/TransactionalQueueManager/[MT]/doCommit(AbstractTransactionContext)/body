{
  QueueTransactionContext ctx=(QueueTransactionContext)context;
  try {
    if (ctx.added != null) {
      for (      Object o : ctx.added.entrySet()) {
        Map.Entry entry=(Map.Entry)o;
        QueueInfo queue=(QueueInfo)entry.getKey();
        List queueAdded=(List)entry.getValue();
        if (queueAdded != null && queueAdded.size() > 0) {
          for (          Object object : queueAdded) {
            Object id=doStore(queue,object);
            queue.putNow(id);
          }
        }
      }
    }
    if (ctx.removed != null) {
      for (      Object o : ctx.removed.entrySet()) {
        Map.Entry entry=(Map.Entry)o;
        QueueInfo queue=(QueueInfo)entry.getKey();
        List queueRemoved=(List)entry.getValue();
        if (queueRemoved != null && queueRemoved.size() > 0) {
          for (          Object id : queueRemoved) {
            doRemove(queue,id);
          }
        }
      }
    }
  }
 catch (  Exception e) {
    throw new ResourceManagerException(e);
  }
 finally {
    ctx.added=null;
    ctx.removed=null;
  }
}
