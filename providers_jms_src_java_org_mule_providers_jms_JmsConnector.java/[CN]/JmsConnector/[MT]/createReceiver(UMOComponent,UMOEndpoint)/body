{
  Session session=getSession(endpoint.getTransactionConfig().isTransacted());
  boolean topic=false;
  String resourceInfo=endpoint.getEndpointURI().getResourceInfo();
  topic=(resourceInfo != null && "topic".equalsIgnoreCase(resourceInfo));
  Destination dest=jmsSupport.createDestination(session,endpoint.getEndpointURI().getAddress(),topic);
  MessageConsumer consumer=null;
  String selector=null;
  if (endpoint.getFilter() != null && endpoint.getFilter() instanceof JmsSelectorFilter) {
    selector=((JmsSelectorFilter)endpoint.getFilter()).getExpression();
  }
 else   if (endpoint.getProperties() != null) {
    selector=(String)endpoint.getProperties().get(JMS_SELECTOR_PROPERTY);
  }
  if (durable) {
    consumer=jmsSupport.createConsumer(session,dest,selector,noLocal,durableName);
  }
 else {
    consumer=jmsSupport.createConsumer(session,dest,selector,noLocal,null);
  }
  UMOMessageReceiver receiver=serviceDescriptor.createMessageReceiver(this,component,endpoint,new Object[]{consumer,session});
  return receiver;
}
