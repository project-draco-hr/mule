{
  super.doInitialise();
  MuleManager.getInstance().registerListener(this,getName());
  try {
    if (connectionFactory == null || (connectionFactory != null && jndiInitialFactory != null)) {
      initJndiContext();
    }
 else {
      jndiDestinations=false;
      forceJndiDestinations=false;
    }
    if (JMS_SPECIFICATION_102B.equals(specification)) {
      jmsSupport=new Jms102bSupport(this,jndiContext,jndiDestinations,forceJndiDestinations);
    }
 else {
      jmsSupport=new Jms11Support(this,jndiContext,jndiDestinations,forceJndiDestinations);
    }
    if (connectionFactory == null) {
      connectionFactory=createConnectionFactory();
    }
    if (connectionFactoryProperties != null && !connectionFactoryProperties.isEmpty()) {
      BeanUtils.populateWithoutFail(connectionFactory,connectionFactoryProperties,true);
    }
  }
 catch (  Exception e) {
    throw new InitialisationException(new Message(Messages.FAILED_TO_CREATE_X,"Jms Connector"),e,this);
  }
}
