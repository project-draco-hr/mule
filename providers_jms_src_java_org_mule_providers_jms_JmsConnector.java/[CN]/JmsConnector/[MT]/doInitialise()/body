{
  super.doInitialise();
  try {
    setDisposeDispatcherOnCompletion(true);
    if (connectionFactory == null || (connectionFactory != null && jndiInitialFactory != null)) {
      initJndiContext();
    }
 else {
      jndiDestinations=false;
      forceJndiDestinations=false;
    }
    if (JMS_SPECIFICATION_102B.equals(specification)) {
      jmsSupport=new Jms102bSupport(jndiContext,jndiDestinations,forceJndiDestinations);
    }
 else {
      jmsSupport=new Jms11Support(jndiContext,jndiDestinations,forceJndiDestinations);
    }
    connection=createConnection();
  }
 catch (  Exception e) {
    throw new InitialisationException("Failed to create Jms Connector: " + e.getMessage(),e);
  }
}
