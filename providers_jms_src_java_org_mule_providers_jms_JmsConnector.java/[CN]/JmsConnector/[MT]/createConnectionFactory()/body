{
  Object temp=jndiContext.lookup(connectionFactoryJndiName);
  if (temp != null && temp instanceof XAConnectionFactory) {
    if (MuleManager.getInstance().getTransactionManager() != null) {
      connectionFactory=new ConnectionFactoryWrapper(connectionFactory,MuleManager.getInstance().getTransactionManager());
    }
  }
 else   if (temp != null && temp instanceof ConnectionFactory) {
    connectionFactory=(ConnectionFactory)temp;
  }
 else {
    throw new InitialisationException(new Message(Messages.JNDI_RESOURCE_X_NOT_FOUND,connectionFactoryJndiName),this);
  }
  return connectionFactory;
}
