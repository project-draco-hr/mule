{
  if (jndiContext == null) {
    Hashtable props=new Hashtable();
    if (jndiInitialFactory != null) {
      props.put(Context.INITIAL_CONTEXT_FACTORY,jndiInitialFactory);
    }
 else     if (jndiProviderProperties == null || !jndiProviderProperties.containsKey(Context.INITIAL_CONTEXT_FACTORY)) {
      throw new InitialisationException(new Message(Messages.X_IS_NULL,"jndiInitialFactory"),this);
    }
    if (jndiProviderUrl != null)     props.put(Context.PROVIDER_URL,jndiProviderUrl);
    if (jndiProviderProperties != null) {
      props.putAll(jndiProviderProperties);
    }
    jndiContext=new InitialContext(props);
  }
}
