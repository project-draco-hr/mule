{
  if (connected.get()) {
    return;
  }
  if (logger.isDebugEnabled()) {
    logger.debug("Attempting to connect");
  }
  try {
    doConnect();
    fireEvent(new ConnectionEvent(this,ConnectionEvent.CONNECTION_CONNECTED));
  }
 catch (  Exception e) {
    fireEvent(new ConnectionEvent(this,ConnectionEvent.CONNECTION_FAILED));
    if (e instanceof ConnectException) {
      throw (ConnectException)e;
    }
 else {
      throw new ConnectException(e,this);
    }
  }
  connected.set(true);
}
