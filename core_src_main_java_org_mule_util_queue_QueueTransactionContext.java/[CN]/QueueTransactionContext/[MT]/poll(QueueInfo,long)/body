{
  readOnly=false;
  if (added != null) {
    List<Serializable> queueAdded=added.get(queue);
    if (queueAdded != null) {
      return queueAdded.remove(queueAdded.size() - 1);
    }
  }
  Serializable object;
  try {
    object=queue.poll(pollTimeout);
  }
 catch (  InterruptedException e) {
    if (transactionalQueueManager.getMuleContext().isStopping()) {
      throw e;
    }
    return null;
  }
  if (object != null) {
    if (removed == null) {
      removed=new HashMap<QueueInfo,List<Serializable>>();
    }
    List<Serializable> queueRemoved=removed.get(queue);
    if (queueRemoved == null) {
      queueRemoved=new ArrayList<Serializable>();
      removed.put(queue,queueRemoved);
    }
    queueRemoved.add(object);
    object=transactionalQueueManager.doLoad(queue,object);
  }
  return object;
}
