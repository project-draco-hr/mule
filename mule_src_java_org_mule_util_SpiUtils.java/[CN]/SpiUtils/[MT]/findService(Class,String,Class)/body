{
  ClassLoaders loaders=(ClassLoaders)AccessController.doPrivileged(new PrivilegedAction(){
    public Object run(){
      return ClassLoaders.getAppLoaders(spi,currentClass,false);
    }
  }
);
  DiscoverClass discover=new DiscoverClass(loaders);
  try {
    return discover.find(spi,System.getProperties(),defaultImpl);
  }
 catch (  DiscoveryException e) {
    logger.warn("Failed to find service for spi: " + spi.getName());
    return null;
  }
}
