{
  Class eClass=null;
  ExceptionHandler eb=null;
  currentEvent=RequestContext.getEvent();
  try {
    eClass=msg.getException().toException().getClass();
    eb=getHandler(eClass);
    eb.onException(msg);
  }
 catch (  Exception e) {
    logger.error("Failed to handle Exception using handler: " + eb.getClass().getName() + " : "+ e);
    if (eb instanceof DefaultHandler) {
      logger.error("As the failure happened in the Default Exception handler, now using Fatal Behaviour " + FatalHandler.class.getName() + " which will cause the Exception Manager to shutdown");
      handleFatal(e);
    }
 else     if (eb instanceof FatalHandler) {
      logger.fatal("Exception caught handling Fatal exception: " + e);
      ((MuleManager)MuleManager.getInstance()).shutdown(e,false);
    }
 else {
      logger.error("Exception Handler resorting to Default Behaviour : " + DefaultHandler.class.getName() + ", due to exception in configured behavour : "+ eb.getClass().getName()+ " : "+ e);
      handleDefault(msg,e);
    }
  }
}
