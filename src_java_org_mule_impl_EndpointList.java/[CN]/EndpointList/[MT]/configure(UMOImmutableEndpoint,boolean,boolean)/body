{
  MuleEndpoint configuredProvider;
  if (endpoint instanceof UMOImmutableEndpoint) {
    configuredProvider=new MuleEndpoint(endpoint);
  }
 else {
    configuredProvider=(MuleEndpoint)endpoint;
  }
  if (isSender) {
    configuredProvider.setType(UMOImmutableEndpoint.ENDPOINT_TYPE_SENDER);
  }
 else {
    configuredProvider.setType(UMOImmutableEndpoint.ENDPOINT_TYPE_RECEIVER);
  }
  if (readOnly) {
    return configuredProvider.getImmutableProvider();
  }
 else {
    return configuredProvider;
  }
}
