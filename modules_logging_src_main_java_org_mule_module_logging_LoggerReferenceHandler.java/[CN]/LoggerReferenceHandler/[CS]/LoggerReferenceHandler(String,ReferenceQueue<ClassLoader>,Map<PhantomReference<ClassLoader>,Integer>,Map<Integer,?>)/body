{
  Executors.newSingleThreadExecutor(new ThreadFactory(){
    public Thread newThread(    Runnable r){
      final Thread thread=Executors.defaultThreadFactory().newThread(r);
      thread.setName(threadName);
      return thread;
    }
  }
).submit(new Runnable(){
    public void run(){
      while (!Thread.currentThread().isInterrupted()) {
        try {
          final Reference<? extends ClassLoader> reference=referenceQueue.remove();
          logger.debug("Cleaning up the logging hierarchy");
          final Integer classLoaderHash=references.get(reference);
          loggerRepository.remove(classLoaderHash);
          reference.clear();
        }
 catch (        InterruptedException e) {
          Thread.currentThread().interrupt();
        }
catch (        RuntimeException rex) {
          logger.error("Zombies detected, run for your life",rex);
        }
      }
    }
  }
);
}
