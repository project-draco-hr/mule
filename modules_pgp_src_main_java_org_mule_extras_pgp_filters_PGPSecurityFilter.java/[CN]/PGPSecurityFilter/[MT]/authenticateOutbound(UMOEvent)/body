{
  logger.debug("authenticateOutbound:" + event.getId());
  if (!isAuthenticate()) {
    return;
  }
  UMOMessage message=event.getMessage();
  KeyBundle userKeyBundle=keyManager.getKeyBundle((String)getCredentialsAccessor().getCredentials(event));
  final PGPCryptInfo cryptInfo=new PGPCryptInfo(userKeyBundle,signRequired);
  try {
    updatePayload(event.getMessage(),strategy.encrypt(message.getPayloadAsBytes(),cryptInfo));
  }
 catch (  Exception e1) {
    throw new UnauthorisedException(CoreMessages.failedToReadPayload(),event.getMessage(),e1);
  }
}
