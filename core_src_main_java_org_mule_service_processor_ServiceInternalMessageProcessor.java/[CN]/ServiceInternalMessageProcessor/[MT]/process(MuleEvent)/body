{
  MuleEvent resultEvent;
  try {
    Object replyTo=event.getReplyToDestination();
    ReplyToHandler replyToHandler=event.getReplyToHandler();
    resultEvent=service.getComponent().process(event);
    resultEvent=processNext(resultEvent);
    if (resultEvent != null && replyTo != null) {
      String replyToStop=resultEvent.getMessage().getInvocationProperty(MuleProperties.MULE_REPLY_TO_STOP_PROPERTY);
      if (!event.getExchangePattern().hasResponse() || !BooleanUtils.toBoolean(replyToStop)) {
        processReplyTo(event,resultEvent,replyToHandler,replyTo);
      }
    }
    return resultEvent;
  }
 catch (  Exception e) {
    event.getSession().setValid(false);
    if (e instanceof MuleException) {
      throw (MuleException)e;
    }
 else {
      throw new MessagingException(event,e);
    }
  }
}
