{
  LocalMuleClient client=muleContext.getClient();
  MuleMessage response=null;
  for (int i=1; i <= EXPECTED_SHORT_DELIVERED_TIMES; i++) {
    response=client.send(String.format("http://localhost:%s",dynamicPort2.getNumber()),MESSAGE,null,TIMEOUT);
    assertThat(response.<String>getInboundProperty(HttpConnector.HTTP_STATUS_PROPERTY),is("500"));
  }
  response=client.send(String.format("http://localhost:%s",dynamicPort2.getNumber()),MESSAGE,null,TIMEOUT);
  assertThat(response.<String>getInboundProperty(HttpConnector.HTTP_STATUS_PROPERTY),is("200"));
  assertThat(response.getExceptionPayload(),IsNull.<Object>nullValue());
  assertThat(response.getPayloadAsString(),is(MESSAGE_EXPECTED));
}
