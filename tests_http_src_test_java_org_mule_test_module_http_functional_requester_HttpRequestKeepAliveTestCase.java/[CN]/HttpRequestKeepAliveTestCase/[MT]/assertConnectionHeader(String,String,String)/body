{
  FlowRunner runner=flowRunner(flow).withPayload(TEST_MESSAGE);
  if (connectionOutboundProperty != null) {
    runner=runner.withOutboundProperty(CONNECTION,connectionOutboundProperty);
  }
  runner.run();
  String responseConnectionHeaderValue=StringUtils.join(headers.get(CONNECTION)," ");
  assertThat(responseConnectionHeaderValue,equalTo(expectedConnectionHeader));
}
