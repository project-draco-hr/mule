{
  MuleClient client=new MuleClient();
  Customer c=new Customer("Ross Mason",1234);
  LoanRequest[] requests=new LoanRequest[2];
  requests[0]=new LoanRequest(c,100000,48);
  requests[1]=new LoanRequest(c,1000,12);
  UMOMessage result;
  int i=0;
  long start=System.currentTimeMillis();
  try {
    for (; i < REQUESTS; i++) {
      result=client.send("vm://LoanBrokerRequests",requests[i % 2],null);
      assertNotNull(result);
      assertFalse(result.getPayload() instanceof NullPayload);
      assertTrue(result.getPayload() instanceof LoanQuote);
      LoanQuote quote=(LoanQuote)result.getPayload();
      assertTrue(quote.getInterestRate() > 0);
    }
  }
  finally {
    System.out.println("Requests processed was: " + i);
    long el=System.currentTimeMillis() - start;
    System.out.println("Total running time was: " + el);
    float mps=1000 / (el / REQUESTS);
    System.out.println("MPS: " + mps + " (no warm up)");
  }
}
