{
  UMOTransaction tx=TransactionCoordination.getInstance().getTransaction();
  if (tx != null && tx instanceof JmsTransaction) {
    return ((JmsTransaction)tx).getResource();
  }
  try {
    if (session == null) {
      session=connector.getSession(false);
    }
    return session;
  }
 catch (  Exception e) {
    throw new MuleException("Failed to get Jms session: " + e.getMessage(),e);
  }
}
