{
  Object result=null;
  ClassLoader originalContextClassLoader=Thread.currentThread().getContextClassLoader();
  try {
    Thread.currentThread().setContextClassLoader(expressionEvaluationClassLoader);
    result=muleContext.getExpressionManager().evaluate(getExpression(),message,!isOptional());
  }
  finally {
    Thread.currentThread().setContextClassLoader(originalContextClassLoader);
  }
  if (getReturnClass() != null && result != null) {
    if (!getReturnClass().isInstance(result)) {
      try {
        Transformer t=muleContext.getRegistry().lookupTransformer(DataTypeFactory.createFromObject(result),DataTypeFactory.create(getReturnClass()));
        result=t.transform(result);
      }
 catch (      TransformerException e) {
        throw new ExpressionRuntimeException(CoreMessages.transformUnexpectedType(result.getClass(),getReturnClass()),e);
      }
    }
  }
  return result;
}
