{
  Transformer xmlToJson=createMockConverter(1,JSON_DATA_TYPE,"xmlToJson",XML_DATA_TYPE);
  Transformer betterXmlToJson=createMockConverter(2,JSON_DATA_TYPE,"betterXmlToJson",XML_DATA_TYPE);
  Transformer inputStreamToXml=createMockConverter(1,XML_DATA_TYPE,"inputStreamToXml",INPUT_STREAM_DATA_TYPE);
  Transformer mockBetterTransformerInputStreamToXml=createMockConverter(2,XML_DATA_TYPE,"mockBetterTransformerInputStreamToXml",INPUT_STREAM_DATA_TYPE);
  GraphTransformerResolver graphResolver=new GraphTransformerResolver();
  graphResolver.transformerChange(mockBetterTransformerInputStreamToXml,TransformerResolver.RegistryAction.ADDED);
  graphResolver.transformerChange(inputStreamToXml,TransformerResolver.RegistryAction.ADDED);
  graphResolver.transformerChange(xmlToJson,TransformerResolver.RegistryAction.ADDED);
  graphResolver.transformerChange(betterXmlToJson,TransformerResolver.RegistryAction.ADDED);
  Transformer transformer=graphResolver.resolve(INPUT_STREAM_DATA_TYPE,JSON_DATA_TYPE);
  assertTrue(transformer instanceof CompositeConverter);
  CompositeConverter chain=(CompositeConverter)transformer;
  assertEquals(2,chain.chain.size());
  assertEquals(mockBetterTransformerInputStreamToXml,chain.chain.get(0));
  assertEquals(betterXmlToJson,chain.chain.get(1));
}
