{
  MessagePropertiesTransformer t=new MessagePropertiesTransformer();
  t.setDeleteProperties(Collections.singletonList("badProperty"));
  MuleMessage msg=new MuleMessage("message");
  msg.setProperty("badProperty","badValue");
  UMOEventContext ctx=getTestEventContext(msg);
  MuleMessage transformed=(MuleMessage)t.transform(msg,null);
  assertSame(msg,transformed);
  assertEquals(msg.getUniqueId(),transformed.getUniqueId());
  assertEquals(msg.getPayload(),transformed.getPayload());
  assertEquals(msg.getPropertyNames(),transformed.getPropertyNames());
  assertFalse(transformed.getPropertyNames().contains("badValue"));
}
