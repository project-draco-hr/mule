{
  MessagePropertiesTransformer t=new MessagePropertiesTransformer();
  Map add=new HashMap();
  add.put("Foo","#[header:public-house]");
  t.setAddProperties(add);
  DefaultMuleMessage msg=new DefaultMuleMessage("message",(Map)null);
  msg.setProperty("public-house","Bar");
  DefaultMuleMessage transformed=(DefaultMuleMessage)t.transform(msg,null);
  assertSame(msg,transformed);
  assertEquals(msg.getUniqueId(),transformed.getUniqueId());
  assertEquals(msg.getPayload(),transformed.getPayload());
  assertEquals(msg.getPropertyNames(),transformed.getPropertyNames());
  assertEquals("Bar",transformed.getProperty("Foo"));
}
