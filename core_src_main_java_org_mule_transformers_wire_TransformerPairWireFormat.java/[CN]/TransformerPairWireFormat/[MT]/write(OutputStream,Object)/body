{
  if (outboundTransformer == null) {
    throw new NullPointerException(new Message(Messages.X_IS_NULL,"outboundTransformer").getMessage());
  }
  try {
    Class returnClass=outboundTransformer.getReturnClass();
    if (returnClass == null) {
      logger.warn("No return class was set on transformer: " + outboundTransformer + ". Attempting to work out"+ "how to treat the result transformation");
      Object result=outboundTransformer.transform(o);
      byte[] bytes;
      if (result instanceof byte[]) {
        bytes=(byte[])result;
      }
 else {
        bytes=result.toString().getBytes(MuleManager.getConfiguration().getEncoding());
      }
      out.write(bytes);
    }
 else     if (returnClass.equals(byte[].class)) {
      byte[] b=(byte[])outboundTransformer.transform(o);
      out.write(b);
    }
 else {
      if (returnClass != null && returnClass.equals(String.class)) {
        String s=(String)outboundTransformer.transform(o);
        out.write(s.getBytes(MuleManager.getConfiguration().getEncoding()));
      }
 else {
        throw new TransformerException(new Message(Messages.TRANSFORM_FAILED_FROM_X,o.getClass()));
      }
    }
  }
 catch (  IOException e) {
    throw new TransformerException(new Message(Messages.TRANSFORM_FAILED_FROM_X,o.getClass(),e));
  }
}
