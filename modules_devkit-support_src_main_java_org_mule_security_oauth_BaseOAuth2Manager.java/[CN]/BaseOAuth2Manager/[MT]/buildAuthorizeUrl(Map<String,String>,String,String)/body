{
  StringBuilder urlBuilder=new StringBuilder();
  if (authorizationUrl != null) {
    urlBuilder.append(authorizationUrl);
  }
 else {
    urlBuilder.append(this.getDefaultUnauthorizedConnector().getAuthorizationUrl());
  }
  urlBuilder.append("?").append("response_type=code&").append("client_id=").append(this.getDefaultUnauthorizedConnector().getConsumerKey());
  try {
    if (!StringUtils.isBlank(this.getScope())) {
      urlBuilder.append("&scope=").append(URLEncoder.encode(this.getScope(),"UTF-8"));
    }
    for (    Map.Entry<String,String> entry : extraParameters.entrySet()) {
      urlBuilder.append("&").append(entry.getKey()).append("=").append(URLEncoder.encode(entry.getValue(),"UTF-8"));
    }
    urlBuilder.append("&redirect_uri=").append(URLEncoder.encode(redirectUri,"UTF-8"));
  }
 catch (  UnsupportedEncodingException e) {
    throw new RuntimeException(e);
  }
  if (getLogger().isDebugEnabled()) {
    getLogger().debug(("Authorization URL has been generated as follows: " + urlBuilder));
  }
  return urlBuilder.toString();
}
