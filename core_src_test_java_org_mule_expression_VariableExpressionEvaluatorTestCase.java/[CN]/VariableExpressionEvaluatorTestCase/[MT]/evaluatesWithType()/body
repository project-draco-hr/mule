{
  DataType dataType=DataTypeFactory.create(String.class,JSON);
  dataType.setEncoding(CUSTOM_ENCODING);
  MuleMessage message=mock(MuleMessage.class);
  when(message.getProperty(PROP_NAME,INVOCATION)).thenReturn(PROP_VALUE);
  when(message.getPropertyDataType(PROP_NAME,INVOCATION)).thenReturn(dataType);
  final TypedValue typedValue=evaluator.evaluateTyped(PROP_NAME,message);
  assertThat((String)typedValue.getValue(),equalTo(PROP_VALUE));
  assertThat(typedValue.getDataType(),like(String.class,JSON,CUSTOM_ENCODING));
}
