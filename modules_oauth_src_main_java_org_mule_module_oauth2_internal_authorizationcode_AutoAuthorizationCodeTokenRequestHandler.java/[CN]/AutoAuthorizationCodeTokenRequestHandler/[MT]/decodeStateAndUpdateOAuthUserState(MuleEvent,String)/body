{
  String decodedState=StateEncoder.decodeOriginalState(originalState);
  String encodedResourceOwnerId=StateEncoder.decodeResourceOwnerId(originalState);
  String resourceOwnerId=encodedResourceOwnerId == null ? ResourceOwnerOAuthContext.DEFAULT_RESOURCE_OWNER_ID : encodedResourceOwnerId;
  final ResourceOwnerOAuthContext stateForUser=getOauthConfig().getUserOAuthContext().getContextForResourceOwner(resourceOwnerId);
  processTokenUrlResponse(tokenUrlResponse,decodedState,stateForUser);
  getOauthConfig().getUserOAuthContext().updateResourceOwnerOAuthContext(stateForUser);
}
