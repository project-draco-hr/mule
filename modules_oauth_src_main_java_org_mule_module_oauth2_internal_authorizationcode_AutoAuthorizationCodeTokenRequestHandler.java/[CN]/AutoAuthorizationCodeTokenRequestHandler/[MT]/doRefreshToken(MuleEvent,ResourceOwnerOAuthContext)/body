{
  try {
    final MuleEvent muleEvent=DefaultMuleEvent.copy(currentEvent);
    muleEvent.getMessage().clearProperties(PropertyScope.OUTBOUND);
    final String userRefreshToken=resourceOwnerOAuthContext.getRefreshToken();
    if (userRefreshToken == null) {
      throw new DefaultMuleException(CoreMessages.createStaticMessage("The user with user id %s has no refresh token in his OAuth state so we can't execute the refresh token call",resourceOwnerOAuthContext.getResourceOwnerId()));
    }
    setMapPayloadWithRefreshTokenRequestParameters(muleEvent,userRefreshToken);
    final MuleEvent refreshTokenResponse=invokeTokenUrl(muleEvent);
    processTokenUrlResponse(refreshTokenResponse,null,resourceOwnerOAuthContext);
  }
 catch (  Exception e) {
    throw new MuleRuntimeException(e);
  }
}
