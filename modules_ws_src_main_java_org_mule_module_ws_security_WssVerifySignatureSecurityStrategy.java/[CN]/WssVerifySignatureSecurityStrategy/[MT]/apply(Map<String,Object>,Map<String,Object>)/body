{
  appendAction(inConfigProperties,SIGNATURE);
  Properties signatureProperties=new Properties();
  signatureProperties.setProperty(WS_CRYPTO_PROVIDER_KEY,Merlin.class.getCanonicalName());
  if (tlsContextFactory == null) {
    signatureProperties.setProperty(LOAD_CA_CERTS,String.valueOf(true));
  }
 else {
    TlsContextTrustStoreConfiguration trustStoreConfig=tlsContextFactory.getTrustStoreConfiguration();
    signatureProperties.setProperty(TRUSTSTORE_TYPE,trustStoreConfig.getType());
    signatureProperties.setProperty(TRUSTSTORE_PASSWORD,trustStoreConfig.getPassword());
    signatureProperties.setProperty(TRUSTSTORE_FILE,trustStoreConfig.getPath());
  }
  inConfigProperties.put(SIG_PROP_REF_ID,WS_SIGNATURE_PROPERTIES_KEY);
  inConfigProperties.put(WS_SIGNATURE_PROPERTIES_KEY,signatureProperties);
}
