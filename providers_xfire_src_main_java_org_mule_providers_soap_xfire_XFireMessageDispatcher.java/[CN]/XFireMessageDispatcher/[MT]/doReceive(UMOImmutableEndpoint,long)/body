{
  String serviceName=getService(endpoint);
  XFire xfire=connector.getXfire();
  Service service=xfire.getServiceRegistry().getService(serviceName);
  Client client=new Client(new MuleUniversalTransport(),service,endpoint.getEndpointURI().toString());
  client.setXFire(xfire);
  client.setTimeout((int)timeout);
  client.setEndpointUri(endpoint.getEndpointURI().toString());
  String method=(String)endpoint.getProperty(SoapConstants.SOAP_METHOD_PROPERTY);
  OperationInfo op=service.getServiceInfo().getOperation(method);
  Properties params=endpoint.getEndpointURI().getUserParams();
  String args[]=new String[params.size()];
  int i=0;
  for (Iterator iterator=params.values().iterator(); iterator.hasNext(); i++) {
    args[i]=iterator.next().toString();
  }
  Object[] response=client.invoke(op,args);
  if (response != null && response.length == 1) {
    return new MuleMessage(response[0]);
  }
 else {
    return new MuleMessage(response);
  }
}
