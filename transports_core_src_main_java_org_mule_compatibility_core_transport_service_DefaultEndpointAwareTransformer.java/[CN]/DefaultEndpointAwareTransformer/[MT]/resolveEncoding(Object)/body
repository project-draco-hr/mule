{
  if (src instanceof InternalMessage) {
    return ((InternalMessage)src).getPayload().getDataType().getMediaType().getCharset().orElse(getDefaultEncoding());
  }
 else {
    return getDefaultEncoding();
  }
}
