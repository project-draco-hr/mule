{
  sendAndCommit(DEFAULT_INPUT_MESSAGE);
  receiveAndAssertNone();
  Message output=receive(getJmsConfig().getDeadLetterDestinationName(),getTimeout(),null);
  assertTrue("Message should be ObjectMessage but is " + output.getClass(),output instanceof ObjectMessage);
  Object payload=((ObjectMessage)output).getObject();
  assertTrue(payload instanceof ExceptionMessage);
  assertEquals(DEFAULT_INPUT_MESSAGE,((ExceptionMessage)payload).getPayload());
  String dest=output.getStringProperty(MuleProperties.MULE_ENDPOINT_PROPERTY);
  assertNotNull(dest);
  assertEquals(getJmsConfig().getDeadLetterEndpoint(),dest);
}
