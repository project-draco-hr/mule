{
  HttpMuleMessageFactory messageFactory=new HttpMuleMessageFactory();
  messageFactory.setEnableCookies(true);
  Header[] headers=new Header[4];
  headers[0]=new Header("SET-COOKIE",COOKIES[0]);
  headers[1]=new Header("Set-Cookie",COOKIES[1]);
  headers[2]=new Header("COOKIE",COOKIES[2]);
  headers[3]=new Header("Cookie",COOKIES[3]);
  Map<String,Object> parsedHeaders=messageFactory.convertHeadersToMap(headers,"http://localhost/");
  assertThat(parsedHeaders.keySet(),hasSize(2));
  assertThat(parsedHeaders.keySet(),containsInAnyOrder(HttpConstants.HEADER_COOKIE_SET,HttpConnector.HTTP_COOKIES_PROPERTY));
  Cookie[] setCookies=(Cookie[])parsedHeaders.get(HttpConstants.HEADER_COOKIE_SET);
  assertThat(setCookies[0].toString(),is(COOKIES[0]));
  assertThat(setCookies[1].toString(),is(COOKIES[1]));
  Cookie[] cookies=(Cookie[])parsedHeaders.get(HttpConnector.HTTP_COOKIES_PROPERTY);
  assertThat(cookies[0].toString(),is(COOKIES[2]));
  assertThat(cookies[1].toString(),is(COOKIES[3]));
}
