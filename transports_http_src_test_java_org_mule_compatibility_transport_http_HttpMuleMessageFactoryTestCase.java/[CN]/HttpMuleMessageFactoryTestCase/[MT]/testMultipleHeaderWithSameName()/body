{
  HttpMuleMessageFactory messageFactory=new HttpMuleMessageFactory();
  Header[] headers=new Header[4];
  headers[0]=new Header("k2","priority");
  headers[1]=new Header("k1","top");
  headers[2]=new Header("k2","always");
  headers[3]=new Header("k2","true");
  Map<String,Serializable> parsedHeaders=messageFactory.convertHeadersToMap(headers,"http://localhost/");
  assertEquals(2,parsedHeaders.size());
  assertEquals("top",parsedHeaders.get("k1"));
  assertEquals("priority,always,true",parsedHeaders.get("k2"));
}
