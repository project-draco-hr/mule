{
  LoanConsumer loanConsumer=null;
  boolean synchronous=false;
  try {
    if (args.length > 0) {
      loanConsumer=new LoanConsumer(args[0]);
      int i=100;
      if (args.length > 1) {
        i=Integer.parseInt(args[1]);
      }
      boolean sync=false;
      if (args.length > 2) {
        sync=Boolean.valueOf(args[2]).booleanValue();
      }
      if (sync) {
        long start=System.currentTimeMillis();
        List results=loanConsumer.requestSend(i,"vm://LoanBrokerRequests");
        System.out.println("Number or quotes received: " + results.size());
        List output=new ArrayList(results.size());
        int x=1;
        for (Iterator iterator=results.iterator(); iterator.hasNext(); x++) {
          LoanQuote quote=(LoanQuote)iterator.next();
          output.add(x + ". " + quote.toString());
        }
        System.out.println(StringMessageHelper.getBoilerPlate(output,'*',80));
        long cur=System.currentTimeMillis();
        System.out.println(Utility.getFormattedDuration(cur - start));
        System.out.println("Avg request: " + ((cur - start) / x));
      }
 else {
        loanConsumer.requestDispatch(i,"vm://LoanBrokerRequests");
      }
    }
 else {
      String config=getConfig();
      loanConsumer=new LoanConsumer(config);
      loanConsumer.run(synchronous);
    }
  }
 catch (  Exception e) {
    System.err.println(e.getMessage());
    e.printStackTrace(System.err);
    System.exit(1);
  }
}
