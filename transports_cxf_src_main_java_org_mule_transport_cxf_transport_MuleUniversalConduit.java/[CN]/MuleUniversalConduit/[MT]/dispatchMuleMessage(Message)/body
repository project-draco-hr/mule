{
  String uri=setupURL(m);
  LOGGER.info("Sending message to " + uri);
  try {
    OutboundEndpoint protocolEndpoint=getProtocolEndpoint(uri);
    MessageAdapter req=(MessageAdapter)m.getExchange().get(CxfConstants.MULE_MESSAGE);
    req.setProperty(MuleProperties.MULE_ENDPOINT_PROPERTY,uri,PropertyScope.INVOCATION);
    req.setProperty(HttpConnector.HTTP_DISABLE_STATUS_CODE_EXCEPTION_CHECK,Boolean.TRUE.toString());
    MuleMessage result=sendStream(req,protocolEndpoint,m.getExchange());
    if (result == null) {
      m.getExchange().put(ClientImpl.FINISHED,Boolean.TRUE);
      return;
    }
    InputStream is=getResponseBody(m,result);
    if (is != null) {
      Message inMessage=new MessageImpl();
      String contentType=result.getStringProperty(HttpConstants.HEADER_CONTENT_TYPE,"text/xml");
      inMessage.put(Message.CONTENT_TYPE,contentType);
      inMessage.put(Message.ENCODING,result.getEncoding());
      inMessage.put(CxfConstants.MULE_MESSAGE,result);
      inMessage.setContent(InputStream.class,is);
      inMessage.setExchange(m.getExchange());
      getMessageObserver().onMessage(inMessage);
    }
  }
 catch (  Exception e) {
    if (e instanceof IOException) {
      throw (IOException)e;
    }
    IOException ex=new IOException("Could not send message to Mule.");
    ex.initCause(e);
    throw ex;
  }
}
