{
  Object serviceFlow=muleContext.getRegistry().lookupObject("TestComponent4");
  if (serviceFlow instanceof Service) {
    assertNotNull(serviceFlow);
    assertNotNull(((ServiceCompositeMessageSource)((Service)serviceFlow).getMessageSource()).getEndpoints());
    assertEquals(1,((ServiceCompositeMessageSource)((Service)serviceFlow).getMessageSource()).getEndpoints().size());
    ImmutableEndpoint endpoint=((ServiceCompositeMessageSource)((Service)serviceFlow).getMessageSource()).getEndpoints().get(0);
    assertNotNull(endpoint);
    assertEquals(VMConnector.VM,endpoint.getConnector().getProtocol().toLowerCase());
    assertEquals("queue4",endpoint.getEndpointURI().getAddress());
    assertFalse(endpoint.getTransformers().isEmpty());
    assertTrue(endpoint.getTransformers().get(0) instanceof ObjectToXml);
    assertTrue(endpoint instanceof InboundEndpoint);
  }
 else   if (serviceFlow instanceof Flow) {
    assertNotNull(serviceFlow);
    assertNotNull(((DefaultInboundEndpoint)((Flow)serviceFlow).getMessageSource()));
    assertEquals(1,((DefaultInboundEndpoint)((Flow)serviceFlow).getMessageSource()).getMessageProcessors().size());
    ImmutableEndpoint endpoint=((DefaultInboundEndpoint)((Flow)serviceFlow).getMessageSource());
    assertNotNull(endpoint);
    assertEquals(VMConnector.VM,endpoint.getConnector().getProtocol().toLowerCase());
    assertEquals("queue4",endpoint.getEndpointURI().getAddress());
    assertFalse(endpoint.getTransformers().isEmpty());
    assertTrue(endpoint.getTransformers().get(0) instanceof ObjectToXml);
    assertTrue(endpoint instanceof InboundEndpoint);
  }
 else {
    fail("Unexpected Object");
  }
}
