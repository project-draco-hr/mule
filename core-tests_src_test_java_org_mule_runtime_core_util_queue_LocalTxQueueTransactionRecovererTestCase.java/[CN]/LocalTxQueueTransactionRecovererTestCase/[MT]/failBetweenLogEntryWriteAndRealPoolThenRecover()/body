{
  MuleEvent testEvent=getTestEvent(MESSAGE_CONTENT);
  inQueue.offer(testEvent,0,TIMEOUT);
  persistentTransactionContext.poll(inQueue,TIMEOUT);
  txLog.close();
  txLog=new LocalTxQueueTransactionJournal(temporaryFolder.getRoot().getAbsolutePath(),muleContext);
  queueTransactionRecoverer.recover();
  MuleEvent muleEvent=(MuleEvent)inQueue.poll(TIMEOUT);
  assertThat(muleEvent,notNullValue());
  assertThat(testEvent.getContext().getId(),equalTo(muleEvent.getContext().getId()));
  muleEvent=(MuleEvent)inQueue.poll(TIMEOUT);
  assertThat(muleEvent,nullValue());
}
