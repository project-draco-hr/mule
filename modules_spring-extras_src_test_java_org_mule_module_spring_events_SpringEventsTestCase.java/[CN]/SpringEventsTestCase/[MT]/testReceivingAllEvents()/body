{
  TestAllEventBean bean=(TestAllEventBean)context.getBean("testAllEventBean");
  assertNotNull(bean);
  Latch whenFinished=new Latch();
  bean.setEventCallback(new CountingEventCallback(eventCounter1,2,whenFinished));
  MuleClient client=new MuleClient();
  client.send("vm://event.multicaster","Test Spring MuleEvent",null);
  context.publishEvent(new TestApplicationEvent(context));
  whenFinished.await(3000,TimeUnit.MILLISECONDS);
  assertEquals(2,eventCounter1.get());
}
