{
  MuleMessage msg=context.getMessage();
  if (logger.isDebugEnabled()) {
    logger.debug("MessageContext:" + msgContext);
    logger.debug("HEADER_CONTENT_TYPE:" + msg.getInboundProperty(HttpConstants.HEADER_CONTENT_TYPE));
    logger.debug("HEADER_CONTENT_LOCATION:" + msg.getInboundProperty(HttpConstants.HEADER_CONTENT_LOCATION));
    logger.debug("Constants.MC_HOME_DIR:" + String.valueOf(getHomeDir()));
    logger.debug("Constants.MC_RELATIVE_PATH:" + endpointUri.getPath());
    logger.debug("HTTPConstants.HEADER_AUTHORIZATION:" + msg.getInboundProperty("Authorization"));
    logger.debug("Constants.MC_REMOTE_ADDR:" + endpointUri.getHost());
  }
  msgContext.setTransportName(transportName);
  msgContext.setProperty("home.dir",getHomeDir());
  msgContext.setProperty("path",endpointUri.getPath());
  msgContext.setProperty(HTTPConstants.MC_HTTP_SERVLET,this);
  msgContext.setProperty(HTTPConstants.MC_HTTP_SERVLETLOCATION,endpointUri.getPath());
  String serviceName=getServiceName(context,endpointUri);
  SOAPService service=msgContext.getAxisEngine().getConfig().getService(new QName(serviceName.substring(1)));
  String scheme=endpointUri.getScheme();
  if (!("vm".equalsIgnoreCase(scheme) || "jms".equalsIgnoreCase(scheme) || "servlet".equalsIgnoreCase(scheme))) {
    if (service.getOption(AxisConnector.SERVICE_PROPERTY_COMPONENT_NAME) != null) {
      String servicePath=(String)service.getOption("servicePath");
      if (StringUtils.isEmpty(endpointUri.getPath())) {
        if (!("/" + endpointUri.getAddress()).startsWith(servicePath + serviceName)) {
          throw new AxisFault("Failed to find service: " + "/" + endpointUri.getAddress());
        }
      }
 else       if (!endpointUri.getPath().endsWith(servicePath + serviceName)) {
        throw new AxisFault("Failed to find service: " + endpointUri.getPath());
      }
    }
  }
  msgContext.setProperty(HTTPConstants.MC_HTTP_SERVLETPATHINFO,serviceName);
  msgContext.setProperty("serviceName",serviceName);
  msgContext.setProperty("Authorization",msg.getInboundProperty("Authorization"));
  msgContext.setProperty("remoteaddr",endpointUri.getHost());
  ServletEndpointContextImpl sec=new ServletEndpointContextImpl();
  msgContext.setProperty("servletEndpointContext",sec);
}
