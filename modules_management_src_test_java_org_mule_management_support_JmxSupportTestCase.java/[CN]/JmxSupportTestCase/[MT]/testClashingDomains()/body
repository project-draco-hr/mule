{
  final String managerId="Test_Instance";
  final String testDomain=JmxModernSupport.DEFAULT_JMX_DOMAIN_PREFIX + "." + managerId;
  ObjectName name=ObjectName.getInstance(testDomain + ":name=TestDuplicates");
  mBeanServer.registerMBean(new StatisticsService(),name);
  managementContext.setId(managerId);
  JmxAgent agent=new JmxAgent();
  agent.setManagementContext(managementContext);
  agent.initialise();
  managementContext.getRegistry().registerAgent(agent);
  managementContext.start();
  List domains=Arrays.asList(mBeanServer.getDomains());
  assertTrue("Should have contained an original domain.",domains.contains(testDomain));
  assertTrue("Should have contained a new domain.",domains.contains(testDomain + ".1"));
}
