{
  Object connectionLock=connectionLocks.get(connection);
  if (connectionLock == null) {
    connectionLock=new Object();
    Object oldConnectionLock=connectionLocks.putIfAbsent(connection,connectionLock);
    if (oldConnectionLock != null) {
      connectionLock=oldConnectionLock;
    }
  }
  return connectionLock;
}
