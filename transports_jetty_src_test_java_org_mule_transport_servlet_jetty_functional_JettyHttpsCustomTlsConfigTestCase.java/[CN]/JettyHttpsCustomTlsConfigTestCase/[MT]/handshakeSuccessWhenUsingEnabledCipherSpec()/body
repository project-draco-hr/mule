{
  final CountDownLatch latch=new CountDownLatch(1);
  SSLSocket socket=createSocket(new String[]{SERVER_CIPHER_SUITE_ENABLED,SERVER_CIPHER_SUITE_DISABLED},new String[]{SERVER_PROTOCOL_ENABLED,SERVER_PROTOCOL_DISABLED});
  socket.addHandshakeCompletedListener(new HandshakeCompletedListener(){
    @Override public void handshakeCompleted(    HandshakeCompletedEvent handshakeCompletedEvent){
      latch.countDown();
    }
  }
);
  socket.startHandshake();
  assertTrue(latch.await(LOCK_TIMEOUT,TimeUnit.MILLISECONDS));
  assertEquals(SERVER_CIPHER_SUITE_ENABLED,socket.getSession().getCipherSuite());
  assertEquals(SERVER_PROTOCOL_ENABLED,socket.getSession().getProtocol());
  socket.close();
}
