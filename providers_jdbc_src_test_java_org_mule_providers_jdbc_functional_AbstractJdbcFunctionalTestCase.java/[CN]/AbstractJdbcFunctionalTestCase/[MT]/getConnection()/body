{
  Object dataSource=getDataSource();
  if (dataSource instanceof DataSource) {
    return ((DataSource)dataSource).getConnection();
  }
 else {
    return ((XADataSource)dataSource).getXAConnection().getConnection();
  }
}
