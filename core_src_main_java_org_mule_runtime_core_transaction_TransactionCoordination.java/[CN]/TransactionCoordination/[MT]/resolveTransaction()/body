{
  Transaction tx=TransactionCoordination.getInstance().getTransaction();
  if (tx.isRollbackOnly()) {
    if (logger.isDebugEnabled()) {
      logger.debug("Transaction has been marked rollbackOnly, rolling it back: " + tx);
    }
    tx.rollback();
  }
 else {
    if (logger.isDebugEnabled()) {
      logger.debug("Committing transaction " + tx);
    }
    tx.commit();
  }
}
