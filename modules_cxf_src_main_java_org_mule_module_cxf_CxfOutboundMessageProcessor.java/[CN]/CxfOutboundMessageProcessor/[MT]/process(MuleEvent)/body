{
  try {
    MuleEvent res;
    if (!isClientProxyAvailable()) {
      res=doSendWithClient(event);
    }
 else {
      res=doSendWithProxy(event);
    }
    return res;
  }
 catch (  MessagingException e) {
    throw e;
  }
catch (  Fault f) {
    if (f.getCause() instanceof MuleException) {
      throw (MuleException)f.getCause();
    }
    throw new DispatchException(MessageFactory.createStaticMessage(f.getMessage()),event,this,f);
  }
catch (  Exception e) {
    throw new DispatchException(MessageFactory.createStaticMessage(ExceptionHelper.getRootException(e).getMessage()),event,this,e);
  }
 finally {
    cleanup();
  }
}
