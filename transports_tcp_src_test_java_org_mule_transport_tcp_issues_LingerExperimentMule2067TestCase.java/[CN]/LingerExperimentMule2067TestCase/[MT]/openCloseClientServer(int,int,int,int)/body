{
  Server server=new Server(port,serverLinger);
  try {
    new Thread(server).start();
    for (int i=0; i < numberOfConnections; i++) {
      logger.debug("opening socket " + i);
      Socket client=new Socket("localhost",port);
      if (NO_LINGER != clientLinger) {
        client.setSoLinger(true,clientLinger);
      }
      client.close();
    }
  }
  finally {
    server.close();
  }
}
