{
  Collection<String> group1=new ArrayList<String>();
  group1.add("one");
  group1.add("two");
  group1.add("three");
  group1.add("four");
  Collection<String> group2=new ArrayList<String>();
  group2.add("five");
  group2.add("six");
  group2.add("seven");
  Collection<String> base=new ArrayList<String>();
  base.addAll(group1);
  base.addAll(group2);
  CollectionMessageSequence<String> cms=new CollectionMessageSequence<String>(base);
  int groupSize=group1.size();
  PartitionedMessageSequence<String> pms=new PartitionedMessageSequence<String>(cms,groupSize);
  assertEquals(2,pms.size());
  Collection<String> batchItem=pms.next();
  assertEquals(groupSize,batchItem.size());
  assertTrue(batchItem.containsAll(group1));
  batchItem=pms.next();
  assertEquals(group2.size(),batchItem.size());
  assertTrue(batchItem.containsAll(group2));
  assertFalse(pms.hasNext());
}
