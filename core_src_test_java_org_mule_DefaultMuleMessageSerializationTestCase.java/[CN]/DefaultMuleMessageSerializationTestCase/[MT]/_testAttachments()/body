{
  String attachmentName="the-attachment";
  MuleMessage message=new DefaultMuleMessage(TEST_MESSAGE,muleContext);
  DataHandler dataHandler=new DataHandler(new StringDataSource("attachment content"));
  message.addAttachment(attachmentName,dataHandler);
  MuleMessage deserializedMessage=serializationRoundtrip(message);
  assertEquals(1,deserializedMessage.getAttachmentNames().size());
  assertTrue(deserializedMessage.getAttachmentNames().contains(attachmentName));
}
