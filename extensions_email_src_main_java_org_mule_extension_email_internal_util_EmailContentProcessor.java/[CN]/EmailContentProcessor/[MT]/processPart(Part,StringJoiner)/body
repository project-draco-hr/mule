{
  try {
    Object content=part.getContent();
    if (isMultipart(content)) {
      Multipart mp=(Multipart)part.getContent();
      for (int i=0; i < mp.getCount(); i++) {
        processPart(mp.getBodyPart(i),bodyCollector);
      }
    }
    if (isAttachment(part)) {
      processAttachment(part);
    }
 else {
      processBodyPart(part,bodyCollector,content);
    }
  }
 catch (  MessagingException|IOException e) {
    throw new EmailException(ERROR_PROCESSING_MESSAGE,e);
  }
}
