{
  DelegateKey key=new DelegateKey(delegateType,configurationInstance);
synchronized (configurationInstance) {
    D delegate=(D)delegates.get(key);
    if (delegate == null) {
      delegate=createDelegate(delegateType,configurationInstance);
      delegates.put(key,delegate);
    }
    return delegate;
  }
}
