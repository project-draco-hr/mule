{
  UMOImmutableEndpoint iprovider;
  Collection endpoints=RegistryContext.getRegistry().getEndpoints();
  for (Iterator iterator=endpoints.iterator(); iterator.hasNext(); ) {
    iprovider=(UMOImmutableEndpoint)iterator.next();
    if (iprovider.getProtocol().equals(protocol)) {
      MuleContext muleContext=MuleServer.getMuleContext();
      UMOEndpointBuilder builder=new EndpointURIEndpointBuilder(iprovider,muleContext);
      return muleContext.getRegistry().lookupEndpointFactory().getInboundEndpoint(builder);
    }
  }
  return null;
}
