{
  if (credential == null || credential.getUsernametoken() == null) {
    throw new WSSecurityException(WSSecurityException.FAILURE,"noCredential");
  }
  DefaultMuleAuthentication auth=new DefaultMuleAuthentication(new MuleCredentials(credential.getUsernametoken().getName(),credential.getUsernametoken().getPassword().toCharArray()));
  try {
    securityManager.authenticate(auth);
  }
 catch (  org.mule.api.security.SecurityException e) {
    throw new WSSecurityException(WSSecurityException.FAILED_AUTHENTICATION,null,null,e);
  }
catch (  SecurityProviderNotFoundException e) {
    throw new WSSecurityException(WSSecurityException.FAILED_AUTHENTICATION,null,null,e);
  }
  return credential;
}
