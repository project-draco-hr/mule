{
  if (configurationResources == null) {
    logger.warn("A configuration file was not set, using default: " + DEFAULT_CONFIGURATION);
    configurationResources=DEFAULT_CONFIGURATION;
  }
  ConfigurationBuilder cfgBuilder=createConfigurationBuilder();
  if (!cfgBuilder.isConfigured()) {
    List<ConfigurationBuilder> configBuilders=new ArrayList<ConfigurationBuilder>(3);
    addAnnotationsConfigBuilder(configBuilders);
    addStartupPropertiesConfigBuilder(configBuilders);
    configBuilders.add(cfgBuilder);
    MuleConfiguration configuration=createMuleConfiguration();
    MuleContextBuilder contextBuilder=new DefaultMuleContextBuilder();
    contextBuilder.setMuleConfiguration(configuration);
    MuleContextFactory contextFactory=new DefaultMuleContextFactory();
    muleContext=contextFactory.createMuleContext(configBuilders,contextBuilder);
  }
}
