{
  try {
    LOGGER.info("Starting JBI");
    if (getRegistry() == null) {
      initialize();
    }
    AdminService admin=new AdminService(context);
    registerMBean(new StandardMBean(admin,AdminServiceMBean.class),createMBeanName(null,"service","admin"));
    InstallationService install=new InstallationService(context);
    registerMBean(new StandardMBean(install,InstallationServiceMBean.class),createMBeanName(null,"service","install"));
    DeploymentService deploy=new DeploymentService(this);
    registerMBean(new StandardMBean(deploy,DeploymentServiceMBean.class),createMBeanName(null,"service","deploy"));
    AutoInstallService autoinstall=new AutoInstallService();
    registerMBean(new StandardMBean(autoinstall,AutoInstallServiceMBean.class),createMBeanName(null,"service","autoinstall"));
    autoinstall.setPollingFrequency(1000);
    autoinstall.start();
    getRegistry().start();
    Directories.deleteMarkedDirectories(getWorkingDir());
    MuleManager.getInstance().start();
  }
 catch (  Exception e) {
    if (e instanceof JBIException) {
      throw (JBIException)e;
    }
 else {
      throw new JBIException(e);
    }
  }
}
