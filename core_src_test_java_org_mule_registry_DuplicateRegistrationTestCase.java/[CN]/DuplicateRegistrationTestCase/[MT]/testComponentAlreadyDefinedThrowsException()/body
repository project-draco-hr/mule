{
  Collection components=muleContext.getRegistry().lookupServices();
  assertEquals(0,components.size());
  final String componentName="TEST_COMPONENT_1";
  getTestService(componentName,Object.class);
  components=muleContext.getRegistry().lookupServices();
  assertEquals(1,components.size());
  try {
    getTestService(componentName,Object.class);
    fail("Trying to register a service with the same name must have thrown an exception.");
  }
 catch (  RegistrationException e) {
    assertTrue("Exception message should contain service name",StringUtils.contains(e.getMessage(),componentName));
  }
  components=muleContext.getRegistry().lookupServices();
  assertEquals(1,components.size());
}
