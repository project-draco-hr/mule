{
  if (message == null) {
    throw new MessageTypeNotSupportedException(message,getClass());
  }
  if (message instanceof Entry) {
    this.message=(Entry)message;
  }
 else {
    this.message=new JiniMessage(null,message);
  }
  if (this.message instanceof JiniMessage) {
    JiniMessage jm=(JiniMessage)this.message;
    id=(jm.getMessageId());
    if (id == null)     id=UUID.getUUID();
    setCorrelationId(jm.getCorrelationId());
    setCorrelationGroupSize(jm.getCorrelationGroupSize().intValue());
    setCorrelationSequence(jm.getCorrelationSequence().intValue());
    setReplyTo(jm.getReplyTo());
    setEncoding(jm.getEncoding());
    setExceptionPayload(jm.getExceptionPayload());
    for (Iterator iterator=jm.getProperties().keySet().iterator(); iterator.hasNext(); ) {
      Object o=iterator.next();
      setProperty(o,jm.getProperties().get(o));
    }
  }
 else {
    id=UUID.getUUID();
  }
}
