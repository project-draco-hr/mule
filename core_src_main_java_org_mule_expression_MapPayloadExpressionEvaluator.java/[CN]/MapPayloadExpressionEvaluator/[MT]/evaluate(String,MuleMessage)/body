{
  Object payload=message.getPayload();
  if (!(payload instanceof Map)) {
    return null;
  }
  if (expression.indexOf(",") > -1) {
    String[] strings=StringUtils.splitAndTrim(expression,",");
    Map<String,Object> result=new HashMap<String,Object>(strings.length);
    for (    String s : strings) {
      Object val=getValue(s,(Map)payload);
      if (val != null) {
        if (s.endsWith("*")) {
          s=s.substring(s.length() - 1);
        }
        result.put(s,val);
      }
    }
    return result;
  }
 else {
    return getValue(expression,(Map)payload);
  }
}
