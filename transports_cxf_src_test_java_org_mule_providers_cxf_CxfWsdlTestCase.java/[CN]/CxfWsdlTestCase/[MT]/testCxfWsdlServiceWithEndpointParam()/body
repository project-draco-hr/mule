{
  Registry registry=muleContext.getRegistry();
  UMOEndpoint endpoint=(UMOEndpoint)registry.lookupEndpointFactory().getOutboundEndpoint(TEST_URL_NOWSDL);
  endpoint.setProperty("wsdlUrl",TEST_URL_WSDL);
  UMOMessage message=new MuleMessage("test1");
  UMOSession session=new MuleSession(message,((AbstractConnector)endpoint.getConnector()).getSessionHandler());
  MuleEvent event=new MuleEvent(message,endpoint,session,true);
  UMOMessage reply=session.sendEvent(event);
  assertNotNull(reply);
  Document response=(Document)reply.getPayload();
  assertNotNull(response);
  XMLAssert.assertXpathEvaluatesTo("test1","//*[namespace-uri()='http://applications.external.tck.mule.org' and local-name()='key']",response);
}
