{
  List<ClassLoader> classLoaders=new LinkedList<>();
  classLoaders.add(parent.getClassLoader());
  for (  ApplicationPluginDescriptor descriptor : plugins) {
    URL[] urls=new URL[descriptor.getRuntimeLibs().length + 1];
    urls[0]=descriptor.getRuntimeClassesDir();
    System.arraycopy(descriptor.getRuntimeLibs(),0,urls,1,descriptor.getRuntimeLibs().length);
    final MuleArtifactClassLoader pluginClassLoader=new MuleArtifactClassLoader(descriptor.getName(),urls,parent.getClassLoader(),parent.getClassLoaderLookupPolicy());
    classLoaders.add(new FilteringArtifactClassLoader(descriptor.getName(),pluginClassLoader,descriptor.getClassLoaderFilter()));
  }
  return new CompositeArtifactClassLoader("appPlugins",parent.getClassLoader(),classLoaders,parent.getClassLoaderLookupPolicy());
}
