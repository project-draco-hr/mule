{
  String domain=DEFAULT_JMX_DOMAIN_PREFIX;
  String instanceId=StringUtils.defaultString(context.getConfiguration().getId());
  if (instanceId.length() > 0) {
    domain+="." + instanceId;
  }
  JmxRegistrationContext ctx=JmxRegistrationContext.getCurrent(context);
  String resolvedDomain=ctx.getResolvedDomain();
  if (resolveClash) {
    if (StringUtils.isBlank(resolvedDomain)) {
      domain=resolveDomainClash(domain);
      ctx.setResolvedDomain(domain);
    }
  }
  return domain;
}
