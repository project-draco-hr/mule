{
  configurationName=null;
  messageProcessor=setUpOperationMessageProcessor();
  Object defaultConfigInstance=new Object();
  when(configurationInstance.getValue()).thenReturn(defaultConfigInstance);
  when(extensionManager.getConfiguration(extensionModel,event)).thenReturn(configurationInstance);
  ArgumentCaptor<ExecutionContext> operationContextCaptor=ArgumentCaptor.forClass(ExecutionContext.class);
  messageProcessor.process(event);
  verify(operationExecutor).execute(operationContextCaptor.capture());
  ExecutionContext<OperationModel> executionContext=operationContextCaptor.getValue();
  assertThat(executionContext,is(instanceOf(ExecutionContextAdapter.class)));
  assertThat(executionContext.getConfiguration().get().getValue(),is(sameInstance(defaultConfigInstance)));
}
