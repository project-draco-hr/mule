{
  Message msg=new Message(Messages.FATAL_ERROR_WHILE_RUNNING);
  UMOException muleException=ExceptionHelper.getRootMuleException(t);
  if (muleException != null) {
    logger.fatal(muleException.getDetailedMessage());
  }
 else {
    logger.fatal(msg.toString() + " " + t.getMessage(),t);
  }
  List msgs=new ArrayList();
  msgs.add(msg.getMessage());
  Throwable root=ExceptionHelper.getRootException(t);
  msgs.add(root.getMessage() + " (" + root.getClass().getName()+ ")");
  msgs.add(" ");
  msgs.add(new Message(Messages.FATAL_ERROR_SHUTDOWN));
  UMOManagementContext context=RegistryContext.getRegistry().getManagementContext();
  if (context != null) {
    msgs.add(new Message(Messages.SERVER_STARTED_AT_X,new Date(context.getStartDate())));
  }
  msgs.add(new Message(Messages.SERVER_SHUTDOWN_AT_X,new Date().toString()));
  String shutdownMessage=StringMessageUtils.getBoilerPlate(msgs,'*',80);
  if (logger.isFatalEnabled()) {
    logger.fatal(shutdownMessage);
  }
 else {
    System.err.println(shutdownMessage);
  }
}
