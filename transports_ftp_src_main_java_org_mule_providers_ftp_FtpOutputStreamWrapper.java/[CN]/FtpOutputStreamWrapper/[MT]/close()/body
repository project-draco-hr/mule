{
  try {
    out.close();
    if (!client.completePendingCommand()) {
      client.logout();
      client.disconnect();
      throw new IOException("FTP Stream failed to complete pending request");
    }
  }
  finally {
    out.close();
    super.close();
  }
}
