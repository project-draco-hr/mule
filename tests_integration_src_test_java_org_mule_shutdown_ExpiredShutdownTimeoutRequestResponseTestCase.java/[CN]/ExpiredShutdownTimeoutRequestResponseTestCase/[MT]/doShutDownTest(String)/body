{
  final MuleClient client=muleContext.getClient();
  final boolean[] results=new boolean[]{false};
  Thread t=new Thread(){
    @Override public void run(){
      try {
        DefaultMuleMessage muleMessage=new DefaultMuleMessage(TEST_MESSAGE);
        MuleMessage result=client.send(url,muleMessage,HttpRequestOptionsBuilder.newOptions().disableStatusCodeValidation().method(POST.name()).build());
        results[0]=result.getExceptionPayload().getException() instanceof DispatchException;
      }
 catch (      Exception e) {
      }
    }
  }
;
  t.start();
  waitLatch.await();
  muleContext.stop();
  t.join();
  assertTrue("Was able to process message ",results[0]);
}
