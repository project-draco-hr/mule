{
  if (previousEvent != null) {
    for (Iterator iterator=previousEvent.getMessage().getPropertyNames(); iterator.hasNext(); ) {
      Object prop=iterator.next();
      if (message.getProperty(prop) == null) {
        message.setProperty(prop,previousEvent.getMessage().getProperty(prop));
      }
    }
  }
  if (endpoint != null && endpoint.getProperties() != null) {
    for (Iterator iterator=endpoint.getProperties().keySet().iterator(); iterator.hasNext(); ) {
      Object prop=iterator.next();
      if (message.getProperty(prop) == null) {
        Object value=endpoint.getProperties().get(prop);
        message.setProperty(prop,value);
      }
    }
  }
  setCredentials();
}
