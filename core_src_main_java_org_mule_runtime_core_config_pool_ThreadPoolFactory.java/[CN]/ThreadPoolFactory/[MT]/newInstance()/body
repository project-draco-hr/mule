{
  final Iterator<ThreadPoolFactory> servicesIterator=ServiceRegistry.lookupProviders(ThreadPoolFactory.class);
  PreferredObjectSelector<ThreadPoolFactory> selector=new PreferredObjectSelector<ThreadPoolFactory>();
  ThreadPoolFactory threadPoolFactory=selector.select(servicesIterator);
  if (threadPoolFactory == null) {
    throw new MuleRuntimeException(MessageFactory.createStaticMessage("Couldn't find config via SPI mechanism. Corrupted Mule core jar?"));
  }
  return threadPoolFactory;
}
