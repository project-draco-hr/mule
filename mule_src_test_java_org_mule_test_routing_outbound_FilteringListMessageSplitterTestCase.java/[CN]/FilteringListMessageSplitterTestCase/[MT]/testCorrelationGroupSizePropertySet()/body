{
  UMOComponent testComponent=getTestComponent(getTestDescriptor("test",Apple.class.getName()));
  UMOSession session=getTestSession(testComponent);
  UMOEndpoint endpoint=getTestEndpoint("Test1Provider",UMOEndpoint.ENDPOINT_TYPE_SENDER);
  FilteringListMessageSplitter router=new FilteringListMessageSplitter();
  router.setFilter(null);
  router.addEndpoint(endpoint);
  List payload=new ArrayList();
  payload.add("one");
  payload.add("two");
  payload.add("three");
  payload.add("four");
  UMOMessage message=new MuleMessage(payload);
  endpoint.getConnector().setDispatcherFactory(new TestDispatcherFactory());
  UMOMessage result=router.route(message,session,true);
  assertNotNull(result);
  assertEquals("Correlation group size has not been set.",4,result.getCorrelationGroupSize());
}
