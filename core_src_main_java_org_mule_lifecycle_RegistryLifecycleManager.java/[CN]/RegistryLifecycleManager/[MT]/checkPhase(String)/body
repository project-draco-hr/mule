{
  if (executingPhase != null) {
    if (name.equalsIgnoreCase(executingPhase)) {
      throw new IllegalStateException("Phase '" + name + "' is already currently being executed");
    }
 else {
      throw new IllegalStateException("Currently executing lifecycle phase: " + executingPhase);
    }
  }
  if (name.equalsIgnoreCase(currentPhase)) {
    throw new IllegalStateException("Already in lifecycle phase '" + name + "', cannot fire the same phase twice");
  }
  Integer phaseIndex=getPhaseIndex(name);
  if (phaseIndex == null) {
    throw new IllegalStateException("Phase does not exist: " + name);
  }
 else {
    LifecyclePhase phase=getPhaseForIndex(phaseIndex);
    if (!phase.isPhaseSupported(currentPhase)) {
      throw new IllegalStateException("Lifecycle phase: " + currentPhase + " does not support current phase: "+ phase.getName()+ ". Phases supported are: "+ StringMessageUtils.toString(phase.getSupportedPhases()));
    }
  }
}
