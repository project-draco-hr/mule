{
  if (headers == null) {
    headers=new HashMap<String,Object>();
    headers.put("foo","fooValue");
    headers.put("bar","barValue");
    headers.put("baz","bazValue");
  }
  if (attachments == null) {
    attachments=new HashMap<String,DataHandler>();
    attachments.put("foo",new DataHandler(new StringDataSource("fooValue")));
    attachments.put("bar",new DataHandler(new StringDataSource("barValue")));
    attachments.put("baz",new DataHandler(new StringDataSource("bazValue")));
  }
  MuleMessage message=new DefaultMuleMessage("test",muleContext);
  for (  Map.Entry<String,DataHandler> attachment : attachments.entrySet()) {
    message.addOutboundAttachment(attachment.getKey(),attachment.getValue());
  }
  for (  String s : headers.keySet()) {
    message.setOutboundProperty(s,headers.get(s));
  }
  return message;
}
