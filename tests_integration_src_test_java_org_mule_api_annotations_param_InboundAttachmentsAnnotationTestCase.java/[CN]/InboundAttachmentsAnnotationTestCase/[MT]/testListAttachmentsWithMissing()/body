{
  Map<String,DataHandler> attachments=new HashMap<String,DataHandler>();
  attachments.put("foo",new DataHandler(new StringDataSource("fooValue")));
  attachments.put("baz",new DataHandler(new StringDataSource("bazValue")));
  muleMessage=createMessage(null,attachments);
  MuleClient client=new MuleClient(muleContext);
  MuleMessage message=client.send("vm://attachmentsListOptional",muleMessage);
  assertNotNull("return message from MuleClient.send() should not be null",message);
  assertNotNull(message.getExceptionPayload());
  assertTrue(message.getExceptionPayload().getRootException() instanceof RequiredValueException);
}
