{
  Map<String,DataHandler> attachments=new HashMap<String,DataHandler>();
  attachments.put("foo",new DataHandler(new StringDataSource("fooValue")));
  attachments.put("baz",new DataHandler(new StringDataSource("bazValue")));
  muleMessage=createMessage(null,attachments);
  try {
    muleContext.getClient().send("vm://attachmentsListOptional",muleMessage);
    fail("Exception expected");
  }
 catch (  Exception e) {
    assertTrue(ExceptionUtils.getRootCause(e) instanceof RequiredValueException);
  }
}
