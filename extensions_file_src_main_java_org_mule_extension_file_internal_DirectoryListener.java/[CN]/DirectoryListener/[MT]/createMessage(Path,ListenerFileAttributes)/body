{
  Object payload=NullPayload.getInstance();
  MediaType mediaType=MediaType.ANY;
  MuleMessage<InputStream,ListenerFileAttributes> message;
  if (attributes.getEventType().equals(DELETE.name())) {
    attributes=new DeletedFileAttributes(path);
  }
 else   if (!attributes.isDirectory()) {
    mediaType=fileSystem.getFileMessageMediaType(mediaType,attributes);
    payload=new FileInputStream(path,new NullPathLock());
  }
  message=(MuleMessage)new DefaultMuleMessage(payload,DataType.builder().fromObject(payload).mediaType(mediaType).build(),attributes);
  return message;
}
