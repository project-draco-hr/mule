{
  Object payload=NullPayload.getInstance();
  MediaType mediaType=MediaType.ANY;
  MuleMessage message;
  if (attributes.getEventType().equals(DELETE.name())) {
    attributes=new DeletedFileAttributes(path);
  }
 else   if (!attributes.isDirectory()) {
    mediaType=fileSystem.getFileMessageMediaType(mediaType,attributes);
    payload=new FileInputStream(path,new NullPathLock());
  }
  return MuleMessage.builder().payload(payload).mediaType(mediaType).attributes(attributes).build();
}
