{
  Object payload=NullPayload.getInstance();
  DataType dataType=DataTypeFactory.create(NullPayload.class);
  MuleMessage<InputStream,ListenerFileAttributes> message;
  if (attributes.getEventType() == FileEventType.DELETE) {
    attributes=new DeletedFileAttributes(path);
  }
 else   if (!attributes.isDirectory()) {
    dataType=fileSystem.getFileMessageDataType(DataTypeFactory.create(InputStream.class),attributes);
    payload=new FileInputStream(path,new NullPathLock());
  }
  message=(MuleMessage)new DefaultMuleMessage(payload,dataType,attributes,muleContext);
  return message;
}
