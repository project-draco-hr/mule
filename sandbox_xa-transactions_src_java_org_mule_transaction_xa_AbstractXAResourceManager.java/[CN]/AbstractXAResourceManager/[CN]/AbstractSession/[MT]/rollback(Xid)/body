{
  if (xid == null) {
    throw new XAException(XAException.XAER_PROTO);
  }
  AbstractTransactionContext context=getActiveTransactionalResource(xid);
  if (context == null) {
    throw new XAException(XAException.XAER_NOTA);
  }
  if (logger.isDebugEnabled()) {
    logger.debug("Rolling back transaction branch " + xid);
  }
  try {
    rollbackTransaction(context);
  }
 catch (  ResourceManagerException e) {
    throw (XAException)new XAException(XAException.XAER_RMERR).initCause(e);
  }
  removeActiveTransactionalResource(xid);
  removeSuspendedTransactionalResource(xid);
}
