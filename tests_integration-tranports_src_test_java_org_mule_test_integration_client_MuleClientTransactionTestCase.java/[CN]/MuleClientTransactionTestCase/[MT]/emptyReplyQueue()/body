{
  final MuleClient client=new MuleClient(muleContext);
  MuleTransactionConfig tc=new MuleTransactionConfig(TransactionConfig.ACTION_ALWAYS_BEGIN);
  tc.setFactory(new JmsTransactionFactory());
  ExecutionTemplate<Void> executionTemplate=TransactionalExecutionTemplate.createTransactionalExecutionTemplate(muleContext,tc);
  executionTemplate.execute(new ExecutionCallback<Void>(){
    @Override public Void process() throws Exception {
      while (client.request("jms://replyTo.queue",2000) != null) {
      }
      return null;
    }
  }
);
}
