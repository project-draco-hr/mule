{
  return new AbstractRequestResponseMessageProcessor(){
    @Override protected MuleEvent processRequest(    MuleEvent event) throws MuleException {
      if (requestBody != null) {
        event.setMessage(MuleMessage.builder(event.getMessage()).payload(requestBody).build());
      }
      copyAttachmentsRequest(event);
      return super.processRequest(event);
    }
    @Override protected MuleEvent processNext(    MuleEvent event) throws MuleException {
      try {
        return super.processNext(event);
      }
 catch (      DispatchException e) {
        if (e.getCause() instanceof SoapFault) {
          SoapFault soapFault=(SoapFault)e.getCause();
          event.setMessage(MuleMessage.builder(event.getMessage()).payload(soapFault.getDetail() != null ? soapFault.getDetail() : NullPayload.getInstance()).build());
          throw new SoapFaultException(event,soapFault.getFaultCode(),soapFault.getSubCode(),soapFault.getMessage(),soapFault.getDetail(),this);
        }
 else {
          throw e;
        }
      }
    }
    @Override protected MuleEvent processResponse(    MuleEvent response,    final MuleEvent request) throws MuleException {
      copyAttachmentsResponse(response);
      return super.processResponse(response,request);
    }
  }
;
}
