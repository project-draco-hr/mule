{
  List endpoints=new ArrayList();
  for (Iterator iterator=getRouters().iterator(); iterator.hasNext(); ) {
    OutboundRouter umoOutboundRouter=(OutboundRouter)iterator.next();
    if (umoOutboundRouter.isMatch(message)) {
      endpoints.addAll(umoOutboundRouter.getEndpoints());
      if (!isMatchAll()) {
        break;
      }
    }
  }
  ImmutableEndpoint[] result=new ImmutableEndpoint[endpoints.size()];
  return (ImmutableEndpoint[])endpoints.toArray(result);
}
