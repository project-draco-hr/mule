{
  InboundEndpoint endpoint=createTestInboundEndpoint(null,null);
  InboundExceptionDetailsMessageProcessor mp=new InboundExceptionDetailsMessageProcessor(endpoint.getConnector());
  mp.setMuleContext(muleContext);
  MuleEvent event=createTestInboundEvent(endpoint);
  event.setMessage(MuleMessage.builder(event.getMessage()).exceptionPayload(new DefaultExceptionPayload(new RuntimeException())).build());
  MuleEvent result=mp.process(event);
  assertNotNull(result);
  final int status=result.getMessage().getOutboundProperty("status",0);
  assertEquals(500,status);
}
