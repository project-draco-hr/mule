{
  Message m=null;
  if (context == null) {
    m=new Message(Messages.AUTH_SET_TO_X_BUT_NO_CONTEXT,filter.getClass().getName());
  }
 else {
    m=new Message(Messages.AUTH_FAILED_FOR_USER_X,context.getAuthentication().getPrincipal());
  }
  m.setNextMessage(new Message(Messages.AUTH_DENIED_ON_ENDPOINT_X,endpoint.getEndpointURI()));
  return m;
}
