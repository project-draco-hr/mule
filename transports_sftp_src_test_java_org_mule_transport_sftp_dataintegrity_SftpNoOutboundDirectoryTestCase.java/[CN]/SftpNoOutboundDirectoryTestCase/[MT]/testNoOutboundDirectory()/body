{
  MuleClient muleClient=new MuleClient(muleContext);
  Exception exception=dispatchAndWaitForException(new DispatchParameters(ENDPOINT_NAME,null),"sftp","service");
  assertNotNull(exception);
  assertTrue("expected DispatchException, but got " + exception.getClass().toString(),exception instanceof DispatchException);
  assertTrue("expected IOException, but got " + exception.getCause().getClass().toString(),exception.getCause() instanceof IOException);
  assertTrue("wrong starting message : " + exception.getCause().getMessage(),exception.getCause().getMessage().startsWith("Error 'No such file' occurred when trying to CDW to '"));
  assertTrue("wrong ending message : " + exception.getCause().getMessage(),exception.getCause().getMessage().endsWith("/DIRECTORY-MISSING'."));
  SftpClient sftpClient=getSftpClient(muleClient,ENDPOINT_NAME);
  try {
    ImmutableEndpoint endpoint=(ImmutableEndpoint)muleClient.getProperty(ENDPOINT_NAME);
    assertTrue("The inbound file should still exist",super.verifyFileExists(sftpClient,endpoint.getEndpointURI(),FILENAME));
  }
  finally {
    sftpClient.disconnect();
  }
}
