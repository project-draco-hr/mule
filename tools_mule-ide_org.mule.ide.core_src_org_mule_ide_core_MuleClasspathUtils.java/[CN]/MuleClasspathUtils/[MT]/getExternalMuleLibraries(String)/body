{
  IPath basePath=new Path(location);
  IPath libPath=basePath.append("lib");
  IPath sourcePath=basePath.append("src").append("java");
  IPath javadocPath=basePath.append("docs").append("apidocs");
  String javadocPathURI=javadocPath.toFile().toURI().toString();
  IClasspathAttribute jdocAttr=JavaCore.newClasspathAttribute(IClasspathAttribute.JAVADOC_LOCATION_ATTRIBUTE_NAME,javadocPathURI);
  IClasspathAttribute[] muleAttrs=new IClasspathAttribute[]{jdocAttr};
  File externalRoot=libPath.toFile();
  if (!externalRoot.exists()) {
    throw new MuleModelException(MuleCorePlugin.getDefault().createErrorStatus("External Mule root is invalid",null));
  }
  List entries=new ArrayList();
  File[] members=externalRoot.listFiles();
  for (int i=0; i < members.length; i++) {
    File file=members[i];
    if (file.getPath().endsWith(".jar")) {
      IPath source=(isMuleJar(file.getName())) ? sourcePath : null;
      IClasspathAttribute[] attrs=(isMuleJar(file.getName())) ? muleAttrs : new IClasspathAttribute[0];
      IClasspathEntry entry=JavaCore.newLibraryEntry(new Path(file.getPath()),source,null,new IAccessRule[0],attrs,false);
      entries.add(entry);
    }
  }
  IClasspathEntry entry=getMuleCoreLibraryEntry();
  if (entry != null) {
    entries.add(entry);
  }
  return (IClasspathEntry[])entries.toArray(new IClasspathEntry[entries.size()]);
}
