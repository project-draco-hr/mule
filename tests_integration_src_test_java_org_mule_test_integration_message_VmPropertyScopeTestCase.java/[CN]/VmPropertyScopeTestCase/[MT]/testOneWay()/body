{
  LocalMuleClient client=muleContext.getClient();
  MuleMessage message=new DefaultMuleMessage("test",muleContext);
  message.setOutboundProperty("foo","fooValue");
  client.dispatch("vm://queueIn",message);
  MuleMessage result=client.request("vm://queueOut",2000);
  assertEquals("test bar",result.getPayload());
  assertEquals("fooValue",result.<Object>getInboundProperty("foo2"));
}
