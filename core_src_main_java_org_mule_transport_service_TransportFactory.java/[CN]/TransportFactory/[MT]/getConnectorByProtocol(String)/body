{
  Connector connector;
  Connector resultConnector=null;
  Collection connectors=RegistryContext.getRegistry().lookupObjects(Connector.class);
  for (Iterator iterator=connectors.iterator(); iterator.hasNext(); ) {
    connector=(Connector)iterator.next();
    if (connector.supportsProtocol(protocol)) {
      if (resultConnector == null) {
        resultConnector=connector;
      }
 else {
        throw new IllegalStateException(CoreMessages.moreThanOneConnectorWithProtocol(protocol).getMessage());
      }
    }
  }
  return resultConnector;
}
