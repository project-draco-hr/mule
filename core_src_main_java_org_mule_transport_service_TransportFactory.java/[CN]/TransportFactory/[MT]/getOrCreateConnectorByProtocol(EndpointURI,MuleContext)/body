{
  String connectorName=uri.getConnectorName();
  if (null != connectorName) {
    Connector connector=RegistryContext.getRegistry().lookupConnector(connectorName);
    if (connector != null) {
      return connector;
    }
  }
  Connector connector=getConnectorByProtocol(uri.getFullScheme());
  if (connector == null) {
    connector=createConnector(uri,muleContext);
    try {
      BeanUtils.populate(connector,uri.getParams());
      connector.setMuleContext(muleContext);
      muleContext.getRegistry().registerConnector(connector);
    }
 catch (    Exception e) {
      throw new TransportFactoryException(e);
    }
  }
  return connector;
}
