{
  if (algorithm == null) {
    throw new InitialisationException(CoreMessages.objectIsNull("Algorithm"),this);
  }
 else {
    logger.debug("Using encryption algorithm: " + algorithm);
  }
  keySpec=createKeySpec();
  try {
    secretKey=getSecretKey();
    createAndInitCiphers();
  }
 catch (  Exception e) {
    throw new InitialisationException(CoreMessages.failedToCreate("encryption ciphers"),e,this);
  }
}
