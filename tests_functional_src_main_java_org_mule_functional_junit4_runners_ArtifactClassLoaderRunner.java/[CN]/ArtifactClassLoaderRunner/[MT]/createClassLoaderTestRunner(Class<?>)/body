{
  ClassPathUrlProvider classPathUrlsProvider=new ClassPathUrlProvider();
  MavenDependenciesResolver mavenDependenciesResolver=new DependencyGraphMavenDependenciesResolver();
  MavenMultiModuleArtifactMapping mavenMultiModuleArtifactMapping=new MuleMavenMultiModuleArtifactMapping();
  MuleClassLoaderRunnerFactory classLoaderRunnerFactory=new MuleClassLoaderRunnerFactory();
  ClassPathClassifier classPathClassifier=new MuleClassPathClassifier();
  ClassPathClassifierContext context=new ClassPathClassifierContext(klass,classPathUrlsProvider.getURLs(),mavenDependenciesResolver.buildDependencies(),mavenMultiModuleArtifactMapping);
  ArtifactUrlClassification artifactUrlClassification=classPathClassifier.classify(context);
  return classLoaderRunnerFactory.createClassLoaderTestRunner(context.getExtraBootPackages(),artifactUrlClassification);
}
