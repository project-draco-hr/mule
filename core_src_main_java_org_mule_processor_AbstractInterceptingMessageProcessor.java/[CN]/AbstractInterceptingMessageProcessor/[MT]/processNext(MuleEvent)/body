{
  if (next == null) {
    return event;
  }
 else {
    if (logger.isTraceEnabled()) {
      logger.trace("Invoking next MessageProcessor: '" + next.getClass().getName() + "' ");
    }
    boolean fireNotification=!(next instanceof MessageProcessorChain);
    if (fireNotification) {
      fireNotification(event.getFlowConstruct(),event,next,MessageProcessorNotification.MESSAGE_PROCESSOR_PRE_INVOKE);
    }
    final MuleEvent result=next.process(event);
    if (fireNotification) {
      fireNotification(event.getFlowConstruct(),result,next,MessageProcessorNotification.MESSAGE_PROCESSOR_POST_INVOKE);
    }
    return result;
  }
}
