{
  ByteArrayOutputStream baos=new ByteArrayOutputStream(EOFProtocol.BUFFER_SIZE);
  byte[] buffer=new byte[EOFProtocol.BUFFER_SIZE];
  int len=0;
  try {
    while ((len=is.read(buffer)) == 0) {
    }
  }
 catch (  SocketException e) {
    EOFProtocol.logger.debug("Socket exception occured: " + e.getMessage());
    return null;
  }
catch (  SocketTimeoutException e) {
    EOFProtocol.logger.debug("Socket timeout, returning null.");
    return null;
  }
  if (len == -1) {
    return null;
  }
 else {
    do {
      baos.write(buffer,0,len);
    }
 while ((len=is.read(buffer)) >= 0);
    baos.flush();
    baos.close();
    return baos.toByteArray();
  }
}
