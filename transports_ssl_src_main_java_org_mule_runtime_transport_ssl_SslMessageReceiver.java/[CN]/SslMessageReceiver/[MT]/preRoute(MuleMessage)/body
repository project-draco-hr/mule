{
  long sslHandshakeTimeout=((SslConnector)getConnector()).getSslHandshakeTimeout();
  boolean rc=handshakeComplete.await(sslHandshakeTimeout,TimeUnit.MILLISECONDS);
  if (rc == false) {
    throw new IllegalStateException("Handshake did not complete");
  }
  if (peerCertificateChain != null) {
    message.setOutboundProperty(SslConnector.PEER_CERTIFICATES,peerCertificateChain);
  }
  if (localCertificateChain != null) {
    message.setOutboundProperty(SslConnector.LOCAL_CERTIFICATES,localCertificateChain);
  }
}
