{
  StreamMessageAdapter adapter=(StreamMessageAdapter)event.getMessage().getAdapter();
  OutputStream temp=getOutputStreamFromRouter();
  if (temp == null) {
    temp=adapter.getOutputStream();
  }
  if (temp == null) {
    throw new IOException("No output stream was found for the current event: " + event);
  }
 else   if (getBuffer() > 0) {
    return new BufferedOutputStream(temp,getBuffer());
  }
 else {
    return temp;
  }
}
