{
  Object src=message.getPayload();
  if (src instanceof byte[]) {
    try {
      Reader xml=new InputStreamReader(new ByteArrayInputStream((byte[])src),outputEncoding);
      return getXStream().fromXML(xml);
    }
 catch (    UnsupportedEncodingException uee) {
      throw new TransformerException(this,uee);
    }
  }
 else   if (src instanceof InputStream) {
    InputStream input=(InputStream)src;
    try {
      Reader xml=new InputStreamReader(input,outputEncoding);
      return getXStream().fromXML(xml);
    }
 catch (    UnsupportedEncodingException uee) {
      throw new TransformerException(this,uee);
    }
 finally {
      try {
        input.close();
      }
 catch (      IOException e) {
        logger.warn("Exception closing stream: ",e);
      }
    }
  }
 else   if (src instanceof String) {
    return getXStream().fromXML(src.toString());
  }
 else {
    return getXStream().fromXML((String)domTransformer.transform(src));
  }
}
