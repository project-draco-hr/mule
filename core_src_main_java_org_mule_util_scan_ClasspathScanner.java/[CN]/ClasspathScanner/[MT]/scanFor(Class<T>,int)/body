{
  Set<Class<T>> classes=new HashSet<Class<T>>();
  for (int i=0; i < basepaths.length; i++) {
    String basepath=basepaths[i];
    Enumeration<URL> urls=classLoader.getResources(basepath.trim());
    while (urls.hasMoreElements()) {
      URL url=urls.nextElement();
      if (url.getProtocol().equalsIgnoreCase("file")) {
        classes.addAll(processFileUrl(url,basepath,clazz,flags));
      }
 else       if (url.getProtocol().equalsIgnoreCase("jar")) {
        classes.addAll(processJarUrl(url,basepath,clazz,flags));
      }
 else       if (url.getProtocol().equalsIgnoreCase("bundleresource")) {
        logger.debug("Classpath contains an OSGi bundle resource which Mule does not know how to access, therefore this resource will be ignored: + " + url.toString());
      }
 else {
        throw new IllegalArgumentException("Do not understand how to handle protocol: " + url.getProtocol());
      }
    }
  }
  return classes;
}
