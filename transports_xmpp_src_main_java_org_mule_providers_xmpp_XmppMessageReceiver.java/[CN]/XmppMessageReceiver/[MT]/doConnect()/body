{
  try {
    XmppConnector cnn=(XmppConnector)connector;
    xmppConnection=cnn.createXmppConnection(endpoint.getEndpointURI());
    if (endpoint.getFilter() instanceof PacketFilter) {
      xmppConnection.addPacketListener(this,(PacketFilter)endpoint.getFilter());
    }
 else {
      PacketFilter filter=new PacketTypeFilter(Message.class);
      xmppConnection.addPacketListener(this,filter);
    }
  }
 catch (  XMPPException e) {
    throw new ConnectException(CoreMessages.failedToCreate("XMPP Connection"),e,this);
  }
}
