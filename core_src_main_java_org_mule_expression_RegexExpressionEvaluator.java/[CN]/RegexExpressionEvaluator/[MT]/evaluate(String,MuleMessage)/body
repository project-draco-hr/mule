{
  Matcher matcher=createMatcher(expression,message);
  Object result=null;
  if (matcher.matches()) {
    if (matcher.groupCount() == NO_CAPTURE_GROUP || matcher.groupCount() == SINGLE_CAPTURE_GROUP) {
      result=matcher.group(matcher.groupCount());
    }
 else {
      String[] matchedValues=new String[matcher.groupCount()];
      for (int i=1; i <= matcher.groupCount(); i++) {
        matchedValues[i - 1]=matcher.group(i);
      }
      result=matchedValues;
    }
  }
  return result;
}
