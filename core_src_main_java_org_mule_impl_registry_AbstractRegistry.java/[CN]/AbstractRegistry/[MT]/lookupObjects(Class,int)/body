{
  logger.debug("lookupObjects: type=" + type + " scope="+ scope);
  Collection collection=doLookupObjects(type);
  if (collection == null) {
    collection=new ArrayList();
  }
  if (getParent() != null && scope > SCOPE_IMMEDIATE) {
    if (getParent().isRemote() && scope == SCOPE_REMOTE) {
      Collection collection2=getParent().lookupObjects(type);
      if (collection2 != null) {
        collection.addAll(collection2);
      }
    }
 else     if (!getParent().isRemote() && scope >= SCOPE_LOCAL) {
      Collection collection2=getParent().lookupObjects(type);
      if (collection2 != null) {
        collection=CollectionUtils.union(collection,collection2);
      }
    }
  }
  return collection;
}
