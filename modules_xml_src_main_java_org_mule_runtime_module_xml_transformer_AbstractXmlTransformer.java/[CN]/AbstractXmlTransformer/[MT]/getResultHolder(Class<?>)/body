{
  if (desiredClass == null) {
    return null;
  }
  if (byte[].class.equals(desiredClass) || InputStream.class.isAssignableFrom(desiredClass)) {
    return new ResultHolder(){
      ByteArrayOutputStream resultStream=new ByteArrayOutputStream();
      StreamResult result=new StreamResult(resultStream);
      @Override public Result getResult(){
        return result;
      }
      @Override public Object getResultObject(){
        return resultStream.toByteArray();
      }
    }
;
  }
 else   if (String.class.equals(desiredClass)) {
    return new ResultHolder(){
      StringWriter writer=new StringWriter();
      StreamResult result=new StreamResult(writer);
      @Override public Result getResult(){
        return result;
      }
      @Override public Object getResultObject(){
        return writer.getBuffer().toString();
      }
    }
;
  }
 else   if (org.w3c.dom.Document.class.isAssignableFrom(desiredClass)) {
    final DOMResult result;
    try {
      result=new DOMResult(DocumentBuilderFactory.newInstance().newDocumentBuilder().newDocument());
    }
 catch (    Exception e) {
      throw new MuleRuntimeException(I18nMessageFactory.createStaticMessage("Could not create result document"),e);
    }
    return new ResultHolder(){
      @Override public Result getResult(){
        return result;
      }
      @Override public Object getResultObject(){
        return result.getNode();
      }
    }
;
  }
 else   if (org.dom4j.io.DocumentResult.class.isAssignableFrom(desiredClass)) {
    return new ResultHolder(){
      DocumentResult result=new DocumentResult();
      @Override public Result getResult(){
        return result;
      }
      @Override public Object getResultObject(){
        return result;
      }
    }
;
  }
 else   if (org.dom4j.Document.class.isAssignableFrom(desiredClass)) {
    return new ResultHolder(){
      DocumentResult result=new DocumentResult();
      @Override public Result getResult(){
        return result;
      }
      @Override public Object getResultObject(){
        return result.getDocument();
      }
    }
;
  }
  return null;
}
