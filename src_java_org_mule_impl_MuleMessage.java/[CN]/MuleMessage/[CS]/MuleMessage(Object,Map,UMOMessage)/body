{
  if (message instanceof UMOMessageAdapter) {
    adapter=(UMOMessageAdapter)message;
  }
 else {
    adapter=new DefaultMessageAdapter(message);
  }
  if (properties != null) {
    addProperties(previous.getProperties());
  }
  if (previous != null) {
    for (Iterator iterator=previous.getAttachmentNames().iterator(); iterator.hasNext(); ) {
      String name=(String)iterator.next();
      try {
        addAttachment(name,previous.getAttachment(name));
      }
 catch (      Exception e) {
        throw new MuleRuntimeException(new Message(Messages.FAILED_TO_READ_PAYLOAD),e);
      }
    }
  }
}
