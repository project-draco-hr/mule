{
  when(mockTransactionConfig.getFactory()).thenReturn(mockTransactionFactory);
  when(mockTransactionFactory.beginTransaction(mockMuleContext)).thenAnswer(new Answer<Transaction>(){
    @Override public Transaction answer(    InvocationOnMock invocationOnMock) throws Throwable {
      TransactionCoordination.getInstance().bindTransaction(mockTransaction);
      return mockTransaction;
    }
  }
);
}
