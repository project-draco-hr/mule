{
  muleContext.getClient().dispatch(getUrl(),new DefaultMuleMessage(new ByteArrayInputStream(TEST_MESSAGE.getBytes()),muleContext),newOptions().method("POST").build());
  final MuleMessage vmMessage=getMessageReceivedByFlow();
  assertThat(vmMessage,notNullValue());
  assertThat(vmMessage.getPayloadAsString(),is(TEST_MESSAGE));
  assertThat(vmMessage.getInboundProperty(HttpHeaders.Names.TRANSFER_ENCODING),Is.<Object>is(HttpHeaders.Values.CHUNKED));
}
