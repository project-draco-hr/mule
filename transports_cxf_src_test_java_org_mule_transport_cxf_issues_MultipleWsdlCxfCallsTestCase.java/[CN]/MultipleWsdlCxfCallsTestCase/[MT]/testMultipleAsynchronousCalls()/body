{
  final MuleClient client=new MuleClient();
  for (int i=0; i < 5; i++) {
    new Thread(new Runnable(){
      public void run(){
        try {
          client.dispatch("vm://receive",new DefaultMuleMessage(new Object[]{"USD","EUR"}));
        }
 catch (        MuleException e) {
          logger.error("Exception in test",e);
        }
      }
    }
).start();
  }
  for (int i=0; i < 5; i++) {
    MuleMessage result=client.request("vm://output",20000L);
    assertNotNull(result.getPayload());
  }
}
