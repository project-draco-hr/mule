{
  if (isBlank(statementDefinition.getSql())) {
    throw new IllegalArgumentException("Statement doesn't contain a SQL query. Please provide one or reference a template which does");
  }
  QueryTemplate queryTemplate=queryTemplateParser.parse(statementDefinition.getSql());
  if (needsParamTypeResolution(queryTemplate)) {
    Map<Integer,DbType> paramTypes=getParameterTypes(connector,connection,queryTemplate);
    queryTemplate=resolveQueryTemplate(queryTemplate,paramTypes);
  }
  return queryTemplate;
}
