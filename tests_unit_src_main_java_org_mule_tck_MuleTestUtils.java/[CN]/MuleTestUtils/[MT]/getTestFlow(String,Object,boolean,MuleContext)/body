{
  final Flow flow=new Flow(name,context);
  flow.setMessageProcessors(new ArrayList<Processor>());
  if (component instanceof Component) {
    flow.getMessageProcessors().add((Processor)component);
  }
 else {
    flow.getMessageProcessors().add(new DefaultJavaComponent(new SingletonObjectFactory(component)));
  }
  if (initialize) {
    context.getRegistry().registerFlowConstruct(flow);
  }
  return flow;
}
