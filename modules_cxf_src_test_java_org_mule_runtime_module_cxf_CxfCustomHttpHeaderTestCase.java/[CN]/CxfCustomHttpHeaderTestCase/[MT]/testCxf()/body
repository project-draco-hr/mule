{
  String endpointAddress="http://localhost:" + dynamicPort.getValue() + "/services/TestComponent";
  String myProperty="myProperty";
  Map<String,Serializable> props=new HashMap<>();
  props.put(MULE_USER_PROPERTY,"alan");
  props.put(MULE_METHOD_PROPERTY,"onReceive");
  props.put(myProperty,myProperty);
  InternalMessage reply=muleContext.getClient().send(String.format(endpointAddress),InternalMessage.builder().payload(REQUEST_PAYLOAD).outboundProperties(props).build(),HTTP_REQUEST_OPTIONS).getRight();
  assertNotNull(reply);
  assertNotNull(reply.getPayload().getValue());
  assertEquals(SOAP_RESPONSE,getPayloadAsString(reply));
  latch.await(3000,SECONDS);
  assertEquals(1,notificationMsgList.size());
  final HttpRequestAttributes attributes=(HttpRequestAttributes)notificationMsgList.get(0).getAttributes();
  assertThat(attributes.getHeaders().get(MULE_USER_PROPERTY.toLowerCase()),is("alan"));
  assertThat(attributes.getHeaders().get(MULE_IGNORE_METHOD_PROPERTY.toLowerCase()),nullValue());
  assertThat(attributes.getHeaders().get(myProperty.toLowerCase()),is(myProperty));
}
