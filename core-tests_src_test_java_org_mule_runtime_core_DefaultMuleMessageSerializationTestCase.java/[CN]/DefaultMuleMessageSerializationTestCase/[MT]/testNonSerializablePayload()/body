{
  muleContext.getRegistry().registerTransformer(new NonSerializableToByteArray());
  MutableMuleMessage message=new DefaultMuleMessage(new NonSerializable());
  message.setOutboundProperty("foo","bar");
  RequestContext.setEvent(new DefaultMuleEvent(message,getTestFlow()));
  MuleMessage deserializedMessage=serializationRoundtrip(message);
  assertTrue(deserializedMessage.getPayload() instanceof byte[]);
  assertEquals(INNER_TEST_MESSAGE,getPayloadAsString(deserializedMessage));
}
