{
  final MuleClient client=new MuleClient();
  MuleTransactionConfig tc=new MuleTransactionConfig();
  tc.setFactory(new JmsTransactionFactory());
  tc.setAction(TransactionConfig.ACTION_ALWAYS_BEGIN);
  TransactionTemplate tt=new TransactionTemplate(tc,null,muleContext);
  tt.execute(new TransactionCallback(){
    public Object doInTransaction() throws Exception {
      while (client.request("jms://replyTo.queue",2000) != null) {
      }
      return null;
    }
  }
);
}
