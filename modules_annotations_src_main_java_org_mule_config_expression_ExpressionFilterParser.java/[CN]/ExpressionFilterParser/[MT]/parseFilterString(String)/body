{
  List<String> strings=split(filterString);
  Filter filter=null;
  for (  String s : strings) {
    s=s.trim();
    if (s.equals("AND")) {
      filter=new AndFilter(filter);
    }
 else     if (s.equals("OR")) {
      filter=new OrFilter(filter);
    }
 else     if (filter instanceof AndFilter) {
      ExpressionFilter expressionFilter=new ExpressionFilter(s);
      expressionFilter.setMuleContext(muleContext);
      ((AndFilter)filter).getFilters().add(expressionFilter);
    }
 else     if (filter instanceof OrFilter) {
      ExpressionFilter expressionFilter=new ExpressionFilter(s);
      expressionFilter.setMuleContext(muleContext);
      ((OrFilter)filter).getFilters().add(expressionFilter);
    }
 else     if (filter == null) {
      ExpressionFilter expressionFilter=new ExpressionFilter(s);
      expressionFilter.setMuleContext(muleContext);
      filter=expressionFilter;
    }
 else {
      throw new DefaultMuleException("Expression Filter is malformed. IF this is a nested filter make sure each expression is separated by either 'AND' or 'OR'");
    }
  }
  return filter;
}
