{
  MessagePropertiesTransformer transformer=(MessagePropertiesTransformer)muleContext.getRegistry().lookupTransformer("addPropertyWithDataType");
  transformer.setMuleContext(muleContext);
  assertNotNull(transformer.getAddProperties());
  assertEquals(1,transformer.getAddProperties().size());
  DefaultMuleMessage msg=new DefaultMuleMessage(TEST_MESSAGE,muleContext);
  DefaultMuleMessage transformed=(DefaultMuleMessage)transformer.transform(msg);
  assertThat(FOO_VALUE,equalTo(transformed.getOutboundProperty(FOO_PROPERTY)));
  assertThat(transformed.getPropertyDataType(FOO_PROPERTY,PropertyScope.OUTBOUND),like(String.class,TEXT_BAZ_MIME_TYPE,StandardCharsets.UTF_16BE.name()));
}
