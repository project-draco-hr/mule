{
  MuleClient client=muleContext.getClient();
  StringBuilder sBuffer=new StringBuilder();
  for (int i=10000; i < 20000; i++) {
    sBuffer.append(i);
  }
  MessageObject message=new MessageObject(1,sBuffer.toString(),true);
  for (int i=0; i < messages; i++) {
    client.dispatch("vm://in",new DefaultMuleMessage(message,muleContext));
  }
  for (int i=0; i < messages; i++) {
    MuleMessage msg=client.request("vm://out",WAIT_MS);
    assertNotNull(msg);
    assertTrue(msg.getPayload() instanceof MessageObject);
    MessageObject received=(MessageObject)msg.getPayload();
    assertEquals(message.s,received.s);
    assertEquals(1,received.i);
    assertEquals(true,received.b);
  }
}
