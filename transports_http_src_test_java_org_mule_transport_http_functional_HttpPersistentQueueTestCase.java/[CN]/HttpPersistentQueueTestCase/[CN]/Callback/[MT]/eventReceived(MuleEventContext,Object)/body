{
  MuleMessage message=context.getMessage();
  assertTrue(message.getAdapter() instanceof DefaultMessageAdapter);
  Object httpMethod=message.getProperty("http.method");
  if (HttpConstants.METHOD_GET.equals(httpMethod)) {
    assertEquals("/services/Echo?foo=bar",message.getPayloadAsString());
  }
 else   if (HttpConstants.METHOD_POST.equals(httpMethod)) {
    assertEquals("foo=bar",message.getPayloadAsString());
  }
 else {
    fail("invalid HTTP method : " + httpMethod);
  }
  assertEquals("true",message.getProperty(HttpConstants.HEADER_CONNECTION));
  assertEquals("true",message.getProperty(HttpConstants.HEADER_KEEP_ALIVE));
  messageDidArrive.countDown();
}
