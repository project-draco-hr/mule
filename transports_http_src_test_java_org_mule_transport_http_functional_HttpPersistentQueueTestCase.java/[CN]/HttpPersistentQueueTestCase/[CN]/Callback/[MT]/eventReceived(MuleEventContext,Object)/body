{
  MuleMessage message=context.getMessage();
  Object httpMethod=message.getProperty("http.method",PropertyScope.INBOUND);
  if (HttpConstants.METHOD_GET.equals(httpMethod)) {
    assertEquals("/services/Echo?foo=bar",message.getPayloadAsString());
  }
 else   if (HttpConstants.METHOD_POST.equals(httpMethod)) {
    assertEquals("foo=bar",message.getPayloadAsString());
  }
 else {
    fail("invalid HTTP method : " + httpMethod);
  }
  assertEquals("true",message.getProperty(HttpConstants.HEADER_CONNECTION,PropertyScope.INBOUND));
  assertEquals("true",message.getProperty(HttpConstants.HEADER_KEEP_ALIVE,PropertyScope.INBOUND));
  messageDidArrive.countDown();
}
