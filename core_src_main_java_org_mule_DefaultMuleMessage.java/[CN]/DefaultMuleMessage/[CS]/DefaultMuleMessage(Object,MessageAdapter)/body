{
  if (message instanceof MessageAdapter) {
    adapter=(MessageAdapter)message;
    ((ThreadSafeAccess)adapter).resetAccessControl();
  }
 else {
    adapter=new DefaultMessageAdapter(message,previous);
  }
  if (previous.getExceptionPayload() != null) {
    setExceptionPayload(previous.getExceptionPayload());
  }
  setEncoding(previous.getEncoding());
  if (previous.getAttachmentNames().size() > 0) {
    Set attNames=adapter.getAttachmentNames();
synchronized (attNames) {
      for (Iterator iterator=attNames.iterator(); iterator.hasNext(); ) {
        String s=(String)iterator.next();
        try {
          addAttachment(s,adapter.getAttachment(s));
        }
 catch (        Exception e) {
          throw new MuleRuntimeException(CoreMessages.failedToReadAttachment(s),e);
        }
      }
    }
  }
  resetAccessControl();
}
