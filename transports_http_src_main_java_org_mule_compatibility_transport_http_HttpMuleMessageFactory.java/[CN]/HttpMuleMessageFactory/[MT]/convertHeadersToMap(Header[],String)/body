{
  Map<String,Serializable> headersMap=new CaseInsensitiveHashMap();
  for (  final Header header : headersArray) {
    if (HttpConnector.HTTP_COOKIES_PROPERTY.equals(header.getName()) || HttpConstants.HEADER_COOKIE.equalsIgnoreCase(header.getName())) {
      putCookieHeaderInMapAsAServer(headersMap,header,uri);
    }
 else     if (HttpConstants.HEADER_COOKIE_SET.equalsIgnoreCase(header.getName())) {
      putCookieHeaderInMapAsAClient(headersMap,header,uri);
    }
 else {
      if (headersMap.containsKey(header.getName())) {
        if (headersMap.get(header.getName()) instanceof String) {
          headersMap.put(header.getName(),headersMap.get(header.getName()) + "," + header.getValue());
        }
 else {
          headersMap.put(header.getName(),header.getValue());
        }
      }
 else {
        headersMap.put(header.getName(),header.getValue());
      }
    }
  }
  return headersMap;
}
