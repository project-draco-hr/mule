{
  UMOImmutableEndpoint endpoint=getOutboundEndpoint(uri);
  if (!endpoint.getConnector().isStarted() && muleContext.isStarted()) {
    endpoint.getConnector().start();
  }
  try {
    MuleSession session=new MuleSession(message,((AbstractConnector)endpoint.getConnector()).getSessionHandler());
    if (user != null) {
      message.setProperty(MuleProperties.MULE_USER_PROPERTY,MuleCredentials.createHeader(user.getUsername(),user.getPassword()));
    }
    MuleEvent event=new MuleEvent(message,endpoint,session,synchronous);
    return event;
  }
 catch (  Exception e) {
    throw new DispatchException(CoreMessages.failedToCreate("Client event"),message,endpoint,e);
  }
}
