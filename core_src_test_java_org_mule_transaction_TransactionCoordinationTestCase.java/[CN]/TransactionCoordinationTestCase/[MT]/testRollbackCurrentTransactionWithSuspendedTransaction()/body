{
  assertThat(tc.getTransaction(),IsNull.<Object>nullValue());
  TestTransaction xaTx=spy(new TestTransaction(mock(MuleContext.class)));
  xaTx.setXA(true);
  Transaction tx=spy(new TestTransaction(mock(MuleContext.class)));
  tc.bindTransaction(xaTx);
  tc.suspendCurrentTransaction();
  tc.bindTransaction(tx);
  tc.rollbackCurrentTransaction();
  tc.resumeSuspendedTransaction();
  assertThat((TestTransaction)tc.getTransaction(),is(xaTx));
  verify(xaTx,times(1)).suspend();
  verify(xaTx,times(1)).resume();
  verify(tx,times(1)).rollback();
}
