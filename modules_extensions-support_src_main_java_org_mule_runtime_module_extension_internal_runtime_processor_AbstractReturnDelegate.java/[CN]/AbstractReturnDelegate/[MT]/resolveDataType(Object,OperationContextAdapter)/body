{
  if (value == null || value instanceof NullPayload) {
    return null;
  }
  DataTypeParamsBuilder dataTypeBuilder=null;
  if (value instanceof MuleMessage) {
    dataTypeBuilder=DataType.builder(((MuleMessage)value).getDataType());
  }
 else {
    dataTypeBuilder=DataType.builder().type(value != null ? value.getClass() : Object.class);
  }
  String mimeType=operationContext.getTypeSafeParameter(MIME_TYPE_PARAMETER_NAME,String.class);
  String encoding=operationContext.getTypeSafeParameter(ENCODING_PARAMETER_NAME,String.class);
  return dataTypeBuilder.mimeType(mimeType).encoding(encoding).build();
}
