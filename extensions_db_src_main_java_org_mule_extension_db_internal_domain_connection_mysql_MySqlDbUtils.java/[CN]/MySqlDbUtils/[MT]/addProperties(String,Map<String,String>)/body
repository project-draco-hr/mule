{
  if (connectionProperties != null && !connectionProperties.isEmpty()) {
    final StringBuilder effectiveUrl=new StringBuilder(url);
    final String queryParams=buildQueryParams(connectionProperties);
    if (getUri(url).getQuery() == null) {
      effectiveUrl.append("?");
    }
 else {
      effectiveUrl.append("&");
    }
    effectiveUrl.append(queryParams);
    return effectiveUrl.toString();
  }
  return url;
}
