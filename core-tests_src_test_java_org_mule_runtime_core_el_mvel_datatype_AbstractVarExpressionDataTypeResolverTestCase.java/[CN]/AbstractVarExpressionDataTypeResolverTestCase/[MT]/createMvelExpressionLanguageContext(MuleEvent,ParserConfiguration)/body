{
  final MVELExpressionLanguageContext context=new MVELExpressionLanguageContext(parserConfiguration,muleContext);
  final StaticVariableResolverFactory staticContext=new StaticVariableResolverFactory(parserConfiguration,muleContext);
  final GlobalVariableResolverFactory globalContext=new GlobalVariableResolverFactory(Collections.EMPTY_MAP,Collections.EMPTY_MAP,parserConfiguration,muleContext);
  context.setNextFactory(new CachedMapVariableResolverFactory(Collections.EMPTY_MAP,new DelegateVariableResolverFactory(staticContext,new MessageVariableResolverFactory(parserConfiguration,muleContext,testEvent,new DelegateVariableResolverFactory(globalContext,new VariableVariableResolverFactory(parserConfiguration,muleContext,testEvent))))));
  return context;
}
