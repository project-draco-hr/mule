{
  if ("component1".equals(context.getFlowConstruct().getName())) {
    Map props=new HashMap();
    props.put("stringParam","param1");
    props.put("objectParam",new Apple());
    props.put("doubleParam",12345.6);
    props.put("integerParam",12345);
    props.put("longParam",(long)123456789);
    props.put("booleanParam",Boolean.TRUE);
    MuleMessage msg=new DefaultMuleMessage(context.getMessageAsString(),props,muleContext);
    msg.addAttachment("test1",new DataHandler(new DataSource(){
      public InputStream getInputStream() throws IOException {
        return null;
      }
      public OutputStream getOutputStream() throws IOException {
        return null;
      }
      public String getContentType(){
        return "text/plain";
      }
      public String getName(){
        return "test1";
      }
    }
));
    return msg;
  }
 else {
    MuleMessage msg=context.getMessage();
    assertEquals("param1",msg.getOutboundProperty("stringParam"));
    final Object o=msg.getOutboundProperty("objectParam");
    assertTrue(o instanceof Apple);
    assertEquals(12345.6,12345.6,msg.<Double>getOutboundProperty("doubleParam",0d));
    assertEquals(12345,msg.getIntProperty("integerParam",0));
    assertEquals(123456789,msg.<Long>getOutboundProperty("longParam",0L).longValue());
    assertEquals(Boolean.TRUE,msg.getOutboundProperty("booleanParam",Boolean.FALSE));
    assertNotNull(msg.getAttachment("test1"));
  }
  return null;
}
