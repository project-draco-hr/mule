{
  try {
    if (message instanceof UMOMessage) {
      message=((UMOMessage)message).getPayload();
    }
    XPath xpath=getXPath(expression,message);
    List result=xpath.selectNodes(message);
    result=extractResultsFromNodes(result);
    if (result.size() == 1) {
      return result.get(0);
    }
 else     if (result.size() == 0) {
      return null;
    }
 else {
      return result;
    }
  }
 catch (  JaxenException e) {
    throw new MuleRuntimeException(XmlMessages.failedToProcessXPath(expression),e);
  }
}
