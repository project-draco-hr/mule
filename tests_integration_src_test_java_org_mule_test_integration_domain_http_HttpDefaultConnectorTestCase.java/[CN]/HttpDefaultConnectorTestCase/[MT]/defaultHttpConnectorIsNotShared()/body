{
  MuleContext domainContext=null;
  MuleContext firstApp=null;
  MuleContext secondApp=null;
  try {
    domainContext=new DomainContextBuilder().setDomainConfig("domain/empty-domain-config.xml").build();
    firstApp=new ApplicationContextBuilder().setDomainContext(domainContext).setApplicationResources(new String[]{"domain/http/http-hello-world-app-no-connector.xml"}).build();
    expectedException.expect(LifecycleException.class);
    secondApp=new ApplicationContextBuilder().setDomainContext(domainContext).setApplicationResources(new String[]{"domain/http/http-hello-mule-app-no-connector.xml"}).build();
  }
  finally {
    closeQuietly(domainContext);
    closeQuietly(firstApp);
    closeQuietly(secondApp);
  }
}
