{
  OutboundEndpoint endpoint=createEndpoint("test://localhost:#[header:port]");
  assertTrue(endpoint instanceof DynamicOutboundEndpoint);
  assertTrue(endpoint.getConnector() instanceof NullConnector);
  MuleEvent event=getTestEvent("test");
  event.getMessage().setOutboundProperty("port",12345);
  endpoint.process(event);
  assertTrue(endpoint.getConnector() instanceof TestConnector);
}
