{
  validate(expression);
  if (expression.startsWith(ExpressionManager.DEFAULT_EXPRESSION_PREFIX)) {
    expression=expression.substring(2,expression.length() - 1);
  }
  for (  Entry<String,String> alias : aliases.entrySet()) {
    variableResolverFactory.addAlias(alias.getKey(),alias.getValue());
  }
  for (  Entry<String,Function> function : globalFunctions.entrySet()) {
    variableResolverFactory.addVariable(function.getKey(),function.getValue());
  }
  variableResolverFactory.addFinalVariable("server",serverContext);
  variableResolverFactory.addFinalVariable("mule",muleInstanceContext);
  variableResolverFactory.addFinalVariable("app",appContext);
  try {
    addExtensions(variableResolverFactory);
    return (T)expressionExecutor.execute(expression,variableResolverFactory);
  }
 catch (  Exception e) {
    throw new ExpressionRuntimeException(CoreMessages.expressionEvaluationFailed(expression),e);
  }
}
