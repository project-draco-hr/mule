{
  QuickConfigurationBuilder builder=new QuickConfigurationBuilder(true);
  MuleManager.getRegistry().registerConnector(getTestConnector());
  builder.registerComponent(Orange.class.getName(),"orangeComponent","test://in","test://out",null);
  UMOManager manager=builder.createStartedManager(true,"");
  UMOModel model=getDefaultModel();
  UMOSession session=new MuleSession(model.getComponent("orangeComponent"));
  final UMOComponent c=session.getComponent();
  assertTrue(c.isStarted());
  AbstractConnector connector=(AbstractConnector)MuleManager.getRegistry().lookupConnector("testConnector");
  assertTrue(connector.isStarted());
  assertFalse(connector.getReceivers().isEmpty());
  Iterator it=connector.getReceivers().values().iterator();
  while (it.hasNext()) {
    assertTrue(((UMOMessageReceiver)it.next()).isConnected());
  }
  c.stop();
  assertFalse(c.isStarted());
  assertTrue(connector.isStarted());
  assertTrue(connector.getReceivers().isEmpty());
}
