{
  String uuid=UUID.getUUID();
  Message payload=(Message)getValidTransportMessage();
  payload.setSubject("the subject");
  payload.setProperty("foo","foo-value");
  payload.setPacketID(uuid);
  MuleMessageFactory factory=createMuleMessageFactory();
  MuleMessage message=factory.create(payload,encoding,muleContext);
  assertNotNull(message);
  assertEquals(Message.class,message.getPayload().getClass());
  assertEquals(TEST_MESSAGE,((Message)message.getPayload()).getBody());
  assertEquals(uuid,message.getUniqueId());
  assertInboundProperty("foo-value",message,"foo");
  assertInboundProperty("the subject",message,XmppConnector.XMPP_SUBJECT);
}
