{
  SecurityManager securityManager=registryBroker.lookupObject(OBJECT_SECURITY_MANAGER);
  if (securityManager == null) {
    Collection temp=registryBroker.lookupObjects(SecurityManager.class);
    if (temp.size() > 0) {
      securityManager=((SecurityManager)temp.iterator().next());
    }
  }
  if (securityManager == null) {
    throw new MuleRuntimeException(CoreMessages.objectIsNull("securityManager"));
  }
  return securityManager;
}
