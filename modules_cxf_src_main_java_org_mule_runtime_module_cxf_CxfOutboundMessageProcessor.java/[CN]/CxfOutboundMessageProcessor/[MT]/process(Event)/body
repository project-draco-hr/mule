{
  try {
    Event res;
    if (!isClientProxyAvailable()) {
      res=doSendWithClient(event);
    }
 else {
      res=doSendWithProxy(event);
    }
    return res;
  }
  finally {
    cleanup();
  }
}
