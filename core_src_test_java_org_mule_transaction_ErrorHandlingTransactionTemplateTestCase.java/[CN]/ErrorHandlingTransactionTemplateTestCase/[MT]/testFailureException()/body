{
  TransactionTemplate transactionTemplate=createExceptionHandlingTransactionTemplate(mockMuleContext);
  when(mockMessagingException.getEvent()).thenReturn(mockEvent);
  MuleEvent mockResultEvent=mock(MuleEvent.class);
  when(mockEvent.getFlowConstruct().getExceptionListener().handleException(mockMessagingException,mockEvent)).thenReturn(mockResultEvent);
  Object result=transactionTemplate.execute(TransactionTemplateTestUtils.getFailureTransactionCallback(mockMessagingException));
  assertThat((MuleEvent)result,is(mockResultEvent));
}
