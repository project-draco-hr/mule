{
  OutboundEndpoint out=getTestOutboundEndpoint("out","test://out",null,null,null,connector);
  try {
    out.process(getTestEvent("data"));
    fail("cannot sent on a connector that is not started");
  }
 catch (  LifecycleException e) {
  }
  assertEquals(0,connector.dispatchers.getNumIdle());
  assertDispatcherStartedConnected(out,false,false);
  connector.start();
  assertDispatcherStartedConnected(out,true,true);
  OutboundEndpoint out2=getTestOutboundEndpoint("out2","test://out2",null,null,null,connector);
  out2.process(getTestEvent("data",out2));
  Thread.sleep(1000);
  assertEquals(2,connector.dispatchers.getNumIdle());
  assertDispatcherStartedConnected(out,true,true);
  assertDispatcherStartedConnected(out2,true,true);
  connector.stop();
  assertEquals(0,connector.dispatchers.getNumActive() + connector.dispatchers.getNumIdle());
  assertDispatcherStartedConnected(out,false,false);
  assertDispatcherStartedConnected(out2,false,false);
  connector.start();
  assertEquals(2,connector.dispatchers.getNumActive() + connector.dispatchers.getNumIdle());
  assertDispatcherStartedConnected(out,true,true);
  assertDispatcherStartedConnected(out2,true,true);
  out.process(getTestEvent("data",out));
  assertEquals(2,connector.dispatchers.getNumIdle());
  assertDispatcherStartedConnected(out,true,true);
  connector.dispose();
  assertEquals(0,connector.dispatchers.getNumActive() + connector.dispatchers.getNumIdle());
}
