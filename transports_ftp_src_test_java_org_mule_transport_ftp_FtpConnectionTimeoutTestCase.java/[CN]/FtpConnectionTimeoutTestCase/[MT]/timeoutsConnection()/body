{
  ServerSocket serverSocket=new ServerSocket(ftpPort.getNumber(),1);
  Socket socket=new Socket();
  socket.connect(serverSocket.getLocalSocketAddress());
  try {
    MuleClient client=muleContext.getClient();
    MuleMessage result=client.send("vm://in","somethingFTPFail",null);
    assertThat(result,is(not(nullValue())));
    assertThat(result.getExceptionPayload().getException().getCause().getCause(),instanceOf(SocketTimeoutException.class));
    assertThat(result.getPayload(),instanceOf(NullPayload.class));
  }
  finally {
    socket.close();
    serverSocket.close();
  }
}
