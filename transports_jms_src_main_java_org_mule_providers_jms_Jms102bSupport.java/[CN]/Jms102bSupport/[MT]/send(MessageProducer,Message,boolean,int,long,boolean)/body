{
  if (topic && producer instanceof TopicPublisher) {
    ((TopicPublisher)producer).publish(message,(persistent ? DeliveryMode.PERSISTENT : DeliveryMode.NON_PERSISTENT),priority,ttl);
  }
 else   if (producer instanceof QueueSender) {
    ((QueueSender)producer).send(message,(persistent ? DeliveryMode.PERSISTENT : DeliveryMode.NON_PERSISTENT),priority,ttl);
  }
 else {
    throw new IllegalArgumentException("Producer and domain type do not match");
  }
}
