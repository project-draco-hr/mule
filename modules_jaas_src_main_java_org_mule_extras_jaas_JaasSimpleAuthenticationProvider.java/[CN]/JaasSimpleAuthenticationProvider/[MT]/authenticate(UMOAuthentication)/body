{
  LoginContext loginContext;
  MuleAuthentication auth=(MuleAuthentication)authentication;
  MuleCallbackHandler cbh=new MuleCallbackHandler(auth);
  try {
    loginContext=new LoginContext(loginContextName,cbh);
  }
 catch (  LoginException e) {
    throw new org.mule.umo.security.UnauthorisedException(CoreMessages.cannotLoadFromClasspath(loginContextName));
  }
  try {
    loginContext.login();
  }
 catch (  LoginException le) {
    throw new UnauthorisedException(CoreMessages.authFailedForUser(auth.getPrincipal()));
  }
  auth.setAuthenticated(true);
  return auth;
}
