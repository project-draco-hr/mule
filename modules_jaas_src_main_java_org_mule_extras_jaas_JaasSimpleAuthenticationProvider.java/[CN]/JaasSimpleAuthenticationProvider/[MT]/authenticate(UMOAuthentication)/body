{
  LoginContext loginContext;
  MuleAuthentication auth=(MuleAuthentication)authentication;
  MuleCallbackHandler cbh=new MuleCallbackHandler(auth);
  try {
    loginContext=new LoginContext(loginContextName,cbh);
  }
 catch (  LoginException e) {
    throw new SecurityException(e);
  }
  try {
    loginContext.login();
  }
 catch (  LoginException le) {
    throw new UnauthorisedException(new org.mule.config.i18n.Message(org.mule.config.i18n.Messages.AUTH_FAILED_FOR_USER_X,auth.getPrincipal()));
  }
  auth.setAuthenticated(true);
  return auth;
}
