{
  final Map<String,Object> options=StartupContext.get().getStartupOptions();
  String appString=(String)options.get("app");
  final File appsDir=MuleContainerBootstrapUtils.getMuleAppsDir();
  String[] appAnchors=appsDir.list(new SuffixFileFilter(APP_ANCHOR_SUFFIX));
  for (  String anchor : appAnchors) {
    new File(appsDir,anchor).delete();
  }
  String[] apps;
  final boolean explicitAppSet=appString != null;
  if (!explicitAppSet) {
    final String[] zips=appsDir.list(new SuffixFileFilter(".zip"));
    for (    String zip : zips) {
      try {
        deployer.installFromAppDir(zip);
      }
 catch (      IOException e) {
        e.printStackTrace();
      }
    }
    apps=appsDir.list(DirectoryFileFilter.DIRECTORY);
  }
 else {
    apps=appString.split(":");
  }
  for (  String app : apps) {
    final Application a;
    try {
      a=appFactory.createApp(app);
      applications.add(a);
    }
 catch (    IOException e) {
      e.printStackTrace();
    }
  }
  for (  Application application : applications) {
    try {
      deployer.deploy(application);
    }
 catch (    Throwable t) {
      t.printStackTrace();
    }
  }
  if (!explicitAppSet) {
    scheduleChangeMonitor(appsDir);
  }
}
