{
  Address[] addresses=null;
  try {
    addresses=message.getRecipients(type);
  }
 catch (  MessagingException e) {
    logger.error("Failed to get recipients from message: " + e.getMessage());
    return null;
  }
  if (addresses == null)   return null;
  StringBuffer result=new StringBuffer();
  for (int i=0; i < addresses.length; i++) {
    result.append(addresses[i] + ", ");
  }
  return result.substring(0,result.length() - 2);
}
