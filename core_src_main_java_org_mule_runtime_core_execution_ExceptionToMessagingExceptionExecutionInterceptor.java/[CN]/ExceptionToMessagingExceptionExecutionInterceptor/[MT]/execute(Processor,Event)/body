{
  try {
    return messageProcessor.process(event);
  }
 catch (  Exception exception) {
    MessagingException messagingException;
    if (!(exception instanceof MessagingException) || !((MessagingException)exception).getEvent().getError().isPresent()) {
      ErrorType errorType;
      errorType=getErrorTypeFromFailingProcessor(messageProcessor,exception);
      if (exception instanceof MessagingException) {
        messagingException=(MessagingException)exception;
      }
 else {
        messagingException=new MessagingException(event,exception,messageProcessor);
      }
      Event exceptionEvent=messagingException.getEvent();
      event=Event.builder(exceptionEvent).error(ErrorBuilder.builder(exception).errorType(errorType).build()).build();
      messagingException.setProcessedEvent(event);
    }
 else {
      messagingException=(MessagingException)exception;
      Event exceptionEvent=messagingException.getEvent();
      if (!exceptionEvent.getError().isPresent() || !(exceptionEvent.getError().get().equals(exception) || messagingException.causedExactlyBy(exceptionEvent.getError().get().getException().getClass()))) {
        ErrorType errorType=getErrorTypeFromFailingProcessor(messageProcessor,exception);
        event=Event.builder(exceptionEvent).error(ErrorBuilder.builder(exception).errorType(errorType).build()).build();
        messagingException.setProcessedEvent(event);
      }
    }
    if (messagingException.getFailingMessageProcessor() == null) {
      throw putContext(messagingException,messageProcessor,event);
    }
 else {
      throw putContext(messagingException,messagingException.getFailingMessageProcessor(),event);
    }
  }
catch (  Throwable ex) {
    throw putContext(new MessagingException(event,ex,messageProcessor),messageProcessor,event);
  }
}
