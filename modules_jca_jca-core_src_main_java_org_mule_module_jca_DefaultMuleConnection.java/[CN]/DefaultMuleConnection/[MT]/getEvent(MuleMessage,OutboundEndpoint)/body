{
  MuleSession session=new DefaultMuleSession(message,((AbstractConnector)endpoint.getConnector()).getSessionHandler(),muleContext);
  if (credentials != null) {
    message.setOutboundProperty(MuleProperties.MULE_USER_PROPERTY,"Plain " + credentials.getToken());
  }
  return new DefaultMuleEvent(message,new NullInboundEndpoint(endpoint.getExchangePattern(),muleContext),session);
}
