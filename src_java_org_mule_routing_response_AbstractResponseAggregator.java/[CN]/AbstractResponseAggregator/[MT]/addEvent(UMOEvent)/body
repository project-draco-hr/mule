{
  Object cId=getAggregateIdentifier(event);
  if (cId == null) {
    throw new RoutingException(new Message(Messages.NO_CORRELATION_ID),event.getMessage(),event.getEndpoint());
  }
  EventGroup eg=(EventGroup)eventGroups.get(cId);
  if (logger.isDebugEnabled()) {
    logger.debug("Adding event to response aggregator group: " + cId);
  }
  if (eg == null) {
    eg=createEventGroup(cId,event);
    eg.addEvent(event);
    eventGroups.put(eg.getGroupId(),eg);
  }
 else {
    eg.addEvent(event);
  }
  return eg;
}
