{
  this.checkDisposed();
  if (connected.get()) {
    return;
  }
  try {
    if (connecting.get()) {
      this.doConnect();
    }
    if (connecting.compareAndSet(false,true)) {
      if (logger.isDebugEnabled()) {
        logger.debug("Connecting: " + this);
      }
      connectionStrategy.connect(this);
      logger.info("Connected: " + getConnectionDescription());
      return;
    }
    connected.set(true);
    connecting.set(false);
    this.fireNotification(new ConnectionNotification(this,getConnectEventId(),ConnectionNotification.CONNECTION_CONNECTED));
  }
 catch (  Exception e) {
    connected.set(false);
    connecting.set(false);
    this.fireNotification(new ConnectionNotification(this,getConnectEventId(),ConnectionNotification.CONNECTION_FAILED));
    if (e instanceof ConnectException || e instanceof FatalConnectException) {
      throw e;
    }
 else {
      throw new ConnectException(e,this);
    }
  }
  if (startOnConnect.get()) {
    this.start();
  }
}
