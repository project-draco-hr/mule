{
  startOnConnect.set(this.isStarted());
  this.fireNotification(new ConnectionNotification(this,getConnectEventId(),ConnectionNotification.CONNECTION_DISCONNECTED));
  connected.set(false);
  connectedSemaphore.drainPermits();
  try {
    this.doDisconnect();
  }
  finally {
    this.stop();
  }
  logger.info("Disconnected: " + this.getConnectionDescription());
}
