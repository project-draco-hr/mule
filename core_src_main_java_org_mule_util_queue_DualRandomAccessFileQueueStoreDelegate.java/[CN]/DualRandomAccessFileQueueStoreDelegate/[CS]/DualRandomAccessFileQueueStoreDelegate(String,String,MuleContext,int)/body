{
  super(capacity);
  this.muleContext=muleContext;
  File queuesDirectory=getQueuesDirectory(workingDirectory);
  if (!queuesDirectory.exists()) {
    Preconditions.checkState(queuesDirectory.mkdirs(),"Could not create queue store directory " + queuesDirectory.getAbsolutePath());
  }
  randomAccessFileQueueStore1=new RandomAccessFileQueueStore(queuesDirectory,queueName + QUEUE_STORE_1_SUFFIX);
  randomAccessFileQueueStore2=new RandomAccessFileQueueStore(queuesDirectory,queueName + QUEUE_STORE_2_SUFFIX);
  writeFile=randomAccessFileQueueStore1;
  readFile=randomAccessFileQueueStore1;
  if (logger.isDebugEnabled()) {
    logger.debug(String.format("Queue %s has %s messages",queueName,getSize()));
  }
  filesLock=new ReentrantReadWriteLock();
}
