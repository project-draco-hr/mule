{
  MuleContext muleContext;
  try {
    muleContext=(MuleContext)jobExecutionContext.getScheduler().getContext().get(MuleProperties.MULE_CONTEXT_PROPERTY);
  }
 catch (  SchedulerException e) {
    throw new JobExecutionException("Failed to retrieve Mulecontext from the Scheduler Context: " + e.getMessage(),e);
  }
  JobDataMap jobDataMap=jobExecutionContext.getJobDetail().getJobDataMap();
  Object tempJob=jobDataMap.get(QuartzConnector.PROPERTY_JOB_OBJECT);
  if (tempJob == null) {
    tempJob=jobDataMap.get(QuartzConnector.PROPERTY_JOB_REF);
    if (tempJob == null) {
      throw new JobExecutionException(QuartzMessages.invalidPayloadType().getMessage());
    }
 else {
      tempJob=muleContext.getRegistry().lookupObject((String)tempJob);
      if (tempJob == null) {
        throw new JobExecutionException("Job not found: " + tempJob);
      }
      if (!(tempJob instanceof Job)) {
        throw new JobExecutionException(QuartzMessages.invalidJobObject().getMessage());
      }
    }
  }
 else   if (!(tempJob instanceof Job)) {
    throw new JobExecutionException(QuartzMessages.invalidJobObject().toString());
  }
  ((Job)tempJob).execute(jobExecutionContext);
}
