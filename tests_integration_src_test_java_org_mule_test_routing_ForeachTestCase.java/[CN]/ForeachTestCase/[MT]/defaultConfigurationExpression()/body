{
  final ArrayList<String> names=new ArrayList<>();
  names.add("residente");
  names.add("visitante");
  Map<String,Serializable> props=new HashMap<>();
  props.put("names",names);
  MuleMessage message=new DefaultMuleMessage("message payload",props);
  MuleMessage result=flowRunner("minimal-config-expression").withPayload("message payload").withInboundProperties(props).run().getMessage();
  assertThat(result.getPayload(),instanceOf(String.class));
  assertThat(((Collection<?>)message.getOutboundProperty("names")),hasSize(names.size()));
  MuleMessage out=client.request("test://out",getTestTimeoutSecs());
  assertThat(out.getPayload(),instanceOf(String.class));
  assertThat(out.getPayload(),is("residente"));
  out=client.request("test://out",getTestTimeoutSecs());
  assertThat(out.getPayload(),instanceOf(String.class));
  assertThat(out.getPayload(),is("visitante"));
}
