{
  final Collection<String> payload=new ArrayList<String>();
  payload.add("gulp");
  payload.add("oktubre");
  payload.add("un baion");
  payload.add("bang bang");
  payload.add("la mosca");
  MuleMessage result=client.send("vm://input-4",payload,null);
  assertTrue(result.getPayload() instanceof Collection);
  Collection<?> resultPayload=(Collection<?>)result.getPayload();
  assertEquals(5,resultPayload.size());
  assertSame(payload,resultPayload);
  MuleMessage out=client.request("vm://out",getTestTimeoutSecs());
  assertTrue(out.getPayload() instanceof Collection);
  Collection<?> outPayload=(Collection<?>)out.getPayload();
  assertEquals(3,outPayload.size());
  out=client.request("vm://out",getTestTimeoutSecs());
  assertTrue(out.getPayload() instanceof Collection);
  outPayload=(Collection<?>)out.getPayload();
  assertEquals(2,outPayload.size());
}
