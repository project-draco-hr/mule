{
  final Collection<String> payload=new ArrayList<>();
  payload.add("gulp");
  payload.add("oktubre");
  payload.add("un baion");
  payload.add("bang bang");
  payload.add("la mosca");
  InternalMessage result=flowRunner("partitioned-config").withPayload(payload).run().getMessage();
  assertThat(result.getPayload().getValue(),instanceOf(Collection.class));
  Collection<?> resultPayload=(Collection<?>)result.getPayload().getValue();
  assertThat(resultPayload,hasSize(5));
  assertSame(payload,resultPayload);
  InternalMessage out=client.request("test://out",getTestTimeoutSecs()).getRight().get();
  assertThat(out.getPayload().getValue(),instanceOf(Collection.class));
  Collection<?> outPayload=(Collection<?>)out.getPayload().getValue();
  assertThat(outPayload,hasSize(3));
  out=client.request("test://out",getTestTimeoutSecs()).getRight().get();
  assertThat(out.getPayload().getValue(),instanceOf(Collection.class));
  outPayload=(Collection<?>)out.getPayload().getValue();
  assertThat(outPayload,hasSize(2));
}
