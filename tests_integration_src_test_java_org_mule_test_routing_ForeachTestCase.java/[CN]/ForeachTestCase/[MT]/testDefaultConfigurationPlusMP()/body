{
  final Collection<String> payload=new ArrayList<String>();
  payload.add("syd");
  payload.add("barrett");
  MuleMessage result=client.send("vm://input-2",payload,null);
  assertTrue(result.getPayload() instanceof Collection);
  Collection<?> resultPayload=(Collection<?>)result.getPayload();
  assertEquals(3,resultPayload.size());
  assertSame(payload,resultPayload);
  MuleMessage out=client.request("vm://out",getTestTimeoutSecs());
  assertTrue(out.getPayload() instanceof String);
  assertEquals("syd",out.getPayload());
  out=client.request("vm://out",getTestTimeoutSecs());
  assertTrue(out.getPayload() instanceof String);
  assertEquals("barrett",out.getPayload());
}
