{
  List<MuleMessage> list=new ArrayList<>();
  for (int i=0; i < 10; i++) {
    list.add(MuleMessage.builder().payload("message-" + i).addOutboundProperty("out","out" + (i + 1)).build());
  }
  MuleMessage msgCollection=MuleMessage.builder().payload(list).build();
  MuleMessage result=flowRunner("message-collection-config").withPayload(list).run().getMessage();
  assertThat(result.getOutboundProperty("totalMessages"),is(10));
  assertThat(result.getPayload(),equalTo(msgCollection.getPayload()));
  FlowAssert.verify("message-collection-config");
}
