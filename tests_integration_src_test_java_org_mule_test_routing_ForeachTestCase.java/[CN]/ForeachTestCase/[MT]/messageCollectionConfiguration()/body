{
  List<MuleMessage> list=new ArrayList<>();
  for (int i=0; i < 10; i++) {
    MuleMessage msg=new DefaultMuleMessage("message-" + i,muleContext);
    msg.setProperty("out","out" + (i + 1),PropertyScope.OUTBOUND);
    list.add(msg);
  }
  MuleMessage msgCollection=new DefaultMuleMessage(list,muleContext);
  MuleMessage result=client.send("vm://input-7",msgCollection);
  assertThat(result.getInboundProperty("totalMessages"),is(10));
  assertEquals(msgCollection.getPayload(),result.getPayload());
  FlowAssert.verify("message-collection-config");
}
