{
  Object data=getData();
  try {
    if (data != null && !ignoreClasses.contains(data.getClass())) {
      if (jsonBindings.contains(data.getClass())) {
        return (String)jsonTransformer.transform(this);
      }
 else       if (AnnotationUtils.hasAnnotationWithPackage("org.codehaus.jackson",data.getClass())) {
        jsonBindings.add(data.getClass());
        return (String)jsonTransformer.transform(this);
      }
 else {
        ignoreClasses.add(data.getClass());
      }
    }
    return super.getJSON();
  }
 catch (  Exception e) {
    throw new RuntimeException("Failed to convert message to JSON",e);
  }
}
