{
  MuleClient client=muleContext.getClient();
  FunctionalTestComponent ftc=getFunctionalTestComponent("matchesCorrectExceptionStrategyUsingExceptionType");
  ftc.setEventCallback(new EventCallback(){
    @Override public void eventReceived(    MuleEventContext context,    Object component) throws Exception {
      throw exceptionToThrow;
    }
  }
);
  MuleMessage response=client.send("vm://in",payload,null);
  assertThat(getPayloadAsString(response),is(expectedMessage));
}
