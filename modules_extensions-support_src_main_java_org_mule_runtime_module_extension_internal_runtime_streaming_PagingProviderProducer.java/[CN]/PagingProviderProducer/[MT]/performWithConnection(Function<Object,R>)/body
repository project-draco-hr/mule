{
  ConnectionHandler connectionHandler=null;
  try {
    connectionHandler=connectionManager.getConnection(config.getValue());
    return function.apply(connectionHandler.getConnection());
  }
 catch (  ConnectionException e) {
    throw new MuleRuntimeException(createStaticMessage("Could not obtain a connection for the configuration"),e);
  }
 finally {
    if (connectionHandler != null) {
      connectionHandler.release();
    }
  }
}
