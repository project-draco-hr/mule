{
  Message message=new MimeMessage(Session.getDefaultInstance(new Properties()));
  message.addHeader(NAME_1,VALUE_1);
  message.addHeader(NAME_1,VALUE_2);
  message.addHeader(NAME_2,VALUE_2);
  SimpleMailMessageAdapter adapter=new SimpleMailMessageAdapter(message);
  assertEquals(adapter.getProperty(NAME_1),VALUE_1);
  assertTrue(adapter.getProperty(SimpleMailMessageAdapter.toListHeader(NAME_1)) instanceof List);
  List list1=(List)adapter.getProperty(SimpleMailMessageAdapter.toListHeader(NAME_1));
  assertTrue(list1.contains(VALUE_1));
  assertTrue(list1.contains(VALUE_2));
  assertEquals(2,list1.size());
  assertEquals(adapter.getProperty(NAME_2),VALUE_2);
  assertTrue(adapter.getProperty(SimpleMailMessageAdapter.toListHeader(NAME_2)) instanceof List);
  List list2=(List)adapter.getProperty(SimpleMailMessageAdapter.toListHeader(NAME_2));
  assertTrue(list2.contains(VALUE_2));
  assertEquals(1,list2.size());
}
