{
  String name=endpoint.getName();
  if (name != null) {
    if (name.equals(endpoint.getEndpointURI().getAddress())) {
      name=endpoint.getEndpointURI().getScheme() + SEPARATOR + name;
    }
    return replaceObjectNameChars(name);
  }
 else {
    String address=endpoint.getEndpointURI().getAddress();
    address=(address.indexOf(":/") > -1 ? address : endpoint.getEndpointURI().getScheme() + SEPARATOR + address);
    name=ENDPOINT_PREFIX + SEPARATOR + replaceObjectNameChars(address);
    int i=0;
    while (MuleManager.getInstance().lookupEndpoint(name) != null) {
      i++;
      name=ENDPOINT_PREFIX + SEPARATOR + replaceObjectNameChars(endpoint.getEndpointURI().getAddress())+ SEPARATOR+ i;
    }
    return name;
  }
}
