{
  try {
    Object payload=message.getPayload();
    XPath xpath=getXPath(expression,payload);
    if (namespaceManager != null) {
      addNamespaces(namespaceManager,xpath);
    }
    List result=xpath.selectNodes(payload);
    result=extractResultsFromNodes(result);
    if (result.size() == 1) {
      return result.get(0);
    }
 else     if (result.size() == 0) {
      return null;
    }
 else {
      return result;
    }
  }
 catch (  JaxenException e) {
    throw new MuleRuntimeException(XmlMessages.failedToProcessXPath(expression),e);
  }
}
