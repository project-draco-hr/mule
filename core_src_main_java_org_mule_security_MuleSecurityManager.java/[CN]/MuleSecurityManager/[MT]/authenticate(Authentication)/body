{
  Iterator iter=providers.values().iterator();
  Class toTest=authentication.getClass();
  while (iter.hasNext()) {
    SecurityProvider provider=(SecurityProvider)iter.next();
    if (provider.supports(toTest)) {
      if (logger.isDebugEnabled()) {
        logger.debug("Authentication attempt using " + provider.getClass().getName());
      }
      Authentication result=provider.authenticate(authentication);
      if (result != null) {
        return result;
      }
    }
  }
  throw new SecurityProviderNotFoundException(toTest.getName());
}
