{
  Iterator iter=providers.values().iterator();
  Class toTest=authentication.getClass();
  while (iter.hasNext()) {
    SecurityProvider provider=(SecurityProvider)iter.next();
    if (provider.supports(toTest)) {
      return provider.createSecurityContext(authentication);
    }
  }
  throw new UnknownAuthenticationTypeException(authentication);
}
