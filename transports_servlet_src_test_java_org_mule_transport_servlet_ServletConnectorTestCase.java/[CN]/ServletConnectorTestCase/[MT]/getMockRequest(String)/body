{
  Object proxy=Proxy.newProxyInstance(ServletConnectorTestCase.class.getClassLoader(),new Class[]{HttpServletRequest.class},new InvocationHandler(){
    private String payload=message;
    private Map<Object,Object> props=new HashMap<Object,Object>();
    public Object invoke(    Object proxy,    Method method,    Object[] args) throws Throwable {
      if ("getInputStream".equals(method.getName())) {
        ServletInputStream s=new ServletInputStream(){
          ByteArrayInputStream is=new ByteArrayInputStream(payload.getBytes());
          @Override public int read() throws IOException {
            return is.read();
          }
        }
;
        return s;
      }
 else       if ("getAttribute".equals(method.getName())) {
        return props.get(args[0]);
      }
 else       if ("setAttribute".equals(method.getName())) {
        props.put(args[0],args[1]);
      }
 else       if ("equals".equals(method.getName())) {
        return Boolean.valueOf(payload.equals(args[0].toString()));
      }
 else       if ("toString".equals(method.getName())) {
        return payload;
      }
 else       if ("getReader".equals(method.getName())) {
        return new BufferedReader(new StringReader(payload.toString()));
      }
 else       if ("getAttributeNames".equals(method.getName())) {
        return new Hashtable<Object,Object>().elements();
      }
 else       if ("getHeaderNames".equals(method.getName())) {
        return new Hashtable<Object,Object>().elements();
      }
      return null;
    }
  }
);
  return (HttpServletRequest)proxy;
}
