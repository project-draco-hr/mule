{
  try {
    File folder=destination.getParentFile();
    if (!folder.exists()) {
      throw new IOException("Destination folder does not exist: " + folder);
    }
    if (!folder.canWrite()) {
      throw new IOException("Destination folder is not writeable: " + folder);
    }
    FileOutputStream output=new FileOutputStream(destination);
    try {
      IOUtils.copy(input,output);
    }
  finally {
      if (output != null)       output.close();
    }
  }
 catch (  IOException ex) {
    setErrorOccurredOnInputStream(input);
    throw ex;
  }
catch (  RuntimeException ex) {
    setErrorOccurredOnInputStream(input);
    throw ex;
  }
 finally {
    if (input != null)     input.close();
  }
}
