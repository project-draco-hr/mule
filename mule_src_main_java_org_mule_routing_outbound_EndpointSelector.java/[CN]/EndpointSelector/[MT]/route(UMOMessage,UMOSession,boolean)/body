{
  String endpointName=message.getStringProperty(getSelectorProperty(),null);
  if (endpointName == null) {
    throw new IllegalArgumentException("selectorProperty '" + getSelectorProperty() + "' must be set on message in order to route it.");
  }
  UMOEndpoint ep=lookupEndpoint(endpointName);
  if (ep == null) {
    throw new CouldNotRouteOutboundMessageException(Message.createStaticMessage("No endpoint found with the name " + endpointName),message,ep);
  }
  try {
    if (synchronous) {
      return send(session,message,ep);
    }
 else {
      dispatch(session,message,ep);
      return null;
    }
  }
 catch (  UMOException e) {
    throw new CouldNotRouteOutboundMessageException(message,ep,e);
  }
}
