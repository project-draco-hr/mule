{
  when(expressionManager.isExpression(Mockito.anyString())).thenReturn(true);
  when(expressionManager.parse(Mockito.eq("dynamicReferencedFlow"),Mockito.any(MuleEvent.class))).thenReturn("parsedDynamicReferencedFlow");
  when(applicationContext.getBean(Mockito.eq("parsedDynamicReferencedFlow"))).thenReturn(target);
  FlowRefFactoryBean flowRefFactoryBean=new FlowRefFactoryBean();
  flowRefFactoryBean.setName("dynamicReferencedFlow");
  flowRefFactoryBean.setApplicationContext(applicationContext);
  flowRefFactoryBean.setMuleContext(muleContext);
  flowRefFactoryBean.initialise();
  Assert.assertNotSame(target,flowRefFactoryBean.getObject());
  Assert.assertSame(result,flowRefFactoryBean.getObject().process(mock(MuleEvent.class)));
}
