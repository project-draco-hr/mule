{
  FlowConstruct flowConstruct=mock(FlowConstruct.class);
  MuleEvent event=mock(MuleEvent.class);
  when(event.getFlowConstruct()).thenReturn(flowConstruct);
  FlowConstructAwareProcessor targetSubFlowConstructAware=mock(FlowConstructAwareProcessor.class);
  when(targetSubFlowConstructAware.process(event)).thenReturn(result);
  FlowRefFactoryBean flowRefFactoryBean=createDynamicFlowRefFactoryBean(targetSubFlowConstructAware);
  assertSame(result,flowRefFactoryBean.getObject().process(event));
  verify(targetSubFlowConstructAware).setFlowConstruct(flowConstruct);
}
