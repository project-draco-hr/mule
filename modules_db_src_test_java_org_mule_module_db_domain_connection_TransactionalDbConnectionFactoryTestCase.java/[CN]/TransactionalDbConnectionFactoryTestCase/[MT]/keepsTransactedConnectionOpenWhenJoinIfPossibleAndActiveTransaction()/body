{
  Transaction transaction=mock(Transaction.class);
  when(dbTransactionManager.getTransaction()).thenReturn(transaction);
  DbConnection connection=mock(DbConnection.class);
  when(connection.getTransactionalAction()).thenReturn(TransactionalAction.JOIN_IF_POSSIBLE);
  factory=new TransactionalDbConnectionFactory(null,dbTransactionManager);
  factory.releaseConnection(connection);
  verify(connection,times(0)).commit();
  verify(connection,times(0)).close();
}
