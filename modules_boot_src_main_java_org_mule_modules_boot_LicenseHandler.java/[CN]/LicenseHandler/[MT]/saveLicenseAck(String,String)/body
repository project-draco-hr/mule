{
  File muleLib=new File(muleHome,"lib/mule");
  File tempJar=createAckJarFile(licenseType,licenseVersion);
  if (!muleLib.canWrite()) {
    if (!muleHome.getCanonicalFile().equals(muleBase.getCanonicalFile())) {
      muleLib=new File(muleBase,"lib/user");
      if (!muleLib.canWrite())       throw new Exception("No write permissions for " + ackJarName + " in either MULE_HOME or MULE_BASE");
    }
 else {
      throw new Exception("No write permission for " + ackJarName);
    }
  }
  File newJarFile=new File(muleLib,ackJarName);
  if (newJarFile.exists())   throw new Exception("Unable to rename temporary jar to " + newJarFile.getAbsolutePath() + " a file with this name already exists!");
  if (!tempJar.renameTo(newJarFile))   throw new Exception("Unable to rename temporary jar to " + newJarFile.getAbsolutePath());
}
