{
  try {
    Object replyTo=event.getMessage().getReplyTo();
    ReplyToHandler replyToHandler=getReplyToHandler(event.getMessage(),(InboundEndpoint)event.getEndpoint());
    event.getMessage().setReplyTo(null);
    MuleMessage result=invokeComponent(event);
    dispatchToOutboundRouter(event,result);
    processReplyTo(event,result,replyToHandler,replyTo);
  }
 catch (  Exception e) {
    event.getSession().setValid(false);
    if (e instanceof MessagingException) {
      handleException(e);
    }
 else {
      handleException(new MessagingException(CoreMessages.eventProcessingFailedFor(getName()),event.getMessage(),e));
    }
  }
}
