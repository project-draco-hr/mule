{
  try {
    app.stop();
    app.dispose();
    final File appDir=new File(MuleContainerBootstrapUtils.getMuleAppsDir(),app.getAppName());
    FileUtils.deleteDirectory(appDir);
    File marker=new File(MuleContainerBootstrapUtils.getMuleAppsDir(),String.format("%s-anchor.txt",app.getAppName()));
    marker.delete();
    Introspector.flushCaches();
  }
 catch (  Throwable t) {
    if (t instanceof DeploymentException) {
      throw ((DeploymentException)t);
    }
    final String msg=String.format("Failed to undeploy application [%s]",app.getAppName());
    throw new DeploymentException(MessageFactory.createStaticMessage(msg),t);
  }
}
