{
  DefaultMuleMessage message=new DefaultMuleMessage(TEST_PAYLOAD,muleContext);
  message.setOutboundProperty("Content-Type","application/json");
  MuleEvent event=new DefaultMuleEvent(message,MessageExchangePattern.REQUEST_RESPONSE,mock(Flow.class));
  MuleMessage response=runFlow("dataType",event).getMessage();
  assertThat(response.getPayload(),is(Matchers.instanceOf(List.class)));
  assertThat(((List<MuleMessage>)response.getPayload()).size(),is(3));
  assertThat(((List<MuleMessage>)response.getPayload()).get(0).getDataType().getMimeType(),is("text/plain"));
  assertThat(((List<MuleMessage>)response.getPayload()).get(1).getDataType().getMimeType(),is("*/*"));
  assertThat(((List<MuleMessage>)response.getPayload()).get(2).getDataType().getMimeType(),is("*/*"));
}
