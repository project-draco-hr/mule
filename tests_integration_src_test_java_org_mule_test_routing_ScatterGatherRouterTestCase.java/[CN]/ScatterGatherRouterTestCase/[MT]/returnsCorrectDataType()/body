{
  DefaultMuleMessage message=new DefaultMuleMessage(TEST_PAYLOAD,muleContext);
  message.setMimeType("application/json");
  MuleEvent event=new DefaultMuleEvent(message,MessageExchangePattern.REQUEST_RESPONSE,mock(Flow.class));
  MuleMessage response=runFlow("dataType",event).getMessage();
  assertThat(response,is(Matchers.instanceOf(DefaultMessageCollection.class)));
  assertThat(((DefaultMessageCollection)response).size(),is(3));
  assertThat(((DefaultMessageCollection)response).getMessage(0).getDataType().getMimeType(),is("text/plain"));
  assertThat(((DefaultMessageCollection)response).getMessage(1).getDataType().getMimeType(),is("*/*"));
  assertThat(((DefaultMessageCollection)response).getMessage(2).getDataType().getMimeType(),is("*/*"));
}
