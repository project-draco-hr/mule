{
  try {
    this.runFlow("routeWithException");
    fail("Was expecting a failure");
  }
 catch (  CompositeRoutingException e) {
    MuleEvent response=e.getEvent();
    ExceptionPayload ep=response.getMessage().getExceptionPayload();
    assertNotNull(ep);
    assertSame(e,ep.getException());
    Map<Integer,Exception> exceptions=e.getExceptions();
    assertEquals(1,exceptions.size());
    assertTrue(exceptions.get(2) instanceof DispatchException);
  }
}
