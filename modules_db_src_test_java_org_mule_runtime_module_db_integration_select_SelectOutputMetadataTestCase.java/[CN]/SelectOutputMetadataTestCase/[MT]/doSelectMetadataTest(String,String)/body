{
  Flow flowConstruct=(Flow)muleContext.getRegistry().lookupFlowConstruct(flowName);
  List<MessageProcessor> messageProcessors=flowConstruct.getMessageProcessors();
  AbstractSingleQueryDbMessageProcessor queryMessageProcessor=(AbstractSingleQueryDbMessageProcessor)messageProcessors.get(0);
  Result<MetaData> outputMetaData=queryMessageProcessor.getOutputMetaData(null);
  DefaultListMetaDataModel listMetaDataModel=(DefaultListMetaDataModel)outputMetaData.get().getPayload();
  assertEquals(implementationClass,listMetaDataModel.getImplementationClass());
  DefinedMapMetaDataModel mapDataModel=(DefinedMapMetaDataModel)listMetaDataModel.getElementModel();
  assertThat(mapDataModel.getKeys().size(),equalTo(3));
  MetaDataModel id=mapDataModel.getValueMetaDataModel("ID");
  assertThat(id.getDataType(),equalTo(testDatabase.getIdFieldOutputMetaDataType()));
  MetaDataModel type=mapDataModel.getValueMetaDataModel("POSITION");
  assertThat(type.getDataType(),equalTo(testDatabase.getPositionFieldOutputMetaDataType()));
  MetaDataModel data=mapDataModel.getValueMetaDataModel("NAME");
  assertThat(data.getDataType(),equalTo(DataType.STRING));
}
