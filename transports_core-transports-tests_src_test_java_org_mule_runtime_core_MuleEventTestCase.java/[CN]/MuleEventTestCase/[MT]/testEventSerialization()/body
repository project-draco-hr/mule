{
  InboundEndpoint endpoint=getTestInboundEndpoint("Test",null,null,new PayloadTypeFilter(Object.class),null,null);
  MuleEvent event=RequestContext.setEvent(getTestEvent("payload",endpoint));
  Transformer transformer=createSerializableToByteArrayTransformer();
  transformer.setMuleContext(muleContext);
  Serializable serialized=(Serializable)createSerializableToByteArrayTransformer().transform(event);
  assertNotNull(serialized);
  ByteArrayToObject trans=new ByteArrayToObject();
  trans.setMuleContext(muleContext);
  MuleEvent deserialized=(MuleEvent)trans.transform(serialized);
  assertNotNull(deserialized);
  assertNotNull(deserialized.getMuleContext());
  assertNotNull(deserialized.getSession());
  assertEquals(event.getSession().getId(),deserialized.getSession().getId());
  assertNotNull(deserialized.getFlowConstruct());
  assertEquals(event.getFlowConstruct(),deserialized.getFlowConstruct());
  assertSame(event.getFlowConstruct(),deserialized.getFlowConstruct());
}
