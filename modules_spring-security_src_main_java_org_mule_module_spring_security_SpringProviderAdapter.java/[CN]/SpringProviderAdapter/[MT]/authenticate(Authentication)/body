{
  org.springframework.security.Authentication auth=null;
  if (authentication instanceof SpringAuthenticationAdapter) {
    auth=((SpringAuthenticationAdapter)authentication).getDelegate();
  }
 else {
    auth=new UsernamePasswordAuthenticationToken(authentication.getPrincipal(),authentication.getCredentials());
  }
  auth=delegate.authenticate(auth);
  return new SpringAuthenticationAdapter(auth,getSecurityProperties());
}
