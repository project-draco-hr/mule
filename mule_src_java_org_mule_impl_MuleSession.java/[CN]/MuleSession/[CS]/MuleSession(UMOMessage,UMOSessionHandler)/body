{
  if (requestSessionHandler == null) {
    throw new IllegalArgumentException(new Message(Messages.PROPERTIES_X_NOT_SET,"requestSessionHandler").toString());
  }
  if (message == null) {
    throw new IllegalArgumentException(new Message(Messages.PROPERTIES_X_NOT_SET,"message").toString());
  }
  properties=new HashMap();
  requestSessionHandler.populateSession(message,this);
  id=(String)getProperty(requestSessionHandler.getSessionIDKey());
  if (id == null) {
    id=new UUID().getUUID();
    if (logger.isDebugEnabled())     logger.debug("There is no session id on the request using key: " + requestSessionHandler.getSessionIDKey() + ". Generating new session id: "+ id);
  }
 else   if (logger.isDebugEnabled()) {
    logger.debug("Got session with id: " + id);
  }
}
