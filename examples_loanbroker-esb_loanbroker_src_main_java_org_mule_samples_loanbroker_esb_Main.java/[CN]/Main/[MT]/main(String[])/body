{
  Main loanConsumer=null;
  int response=0;
  try {
    System.out.println("******************" + "\nWelcome to the Mule Loan Broker ESB example. This example demonstrates using JMS, Web Services,\n Http/Rest and EJBs using an ESB architecture." + "\nFor more information see http://mule.codehaus.org/LoanBroker."+ "\n\nThe example demonstrates integrating EJB applications in 2 ways -"+ "\n  1. Calling out to a remote EJB using a Mule Endpoint."+ "\n  2. Managing an EJB as a Mule component."+ "\n\nBoth have the same behavior but the second method allows a remote EJB to be used as if it were\n a local Mule component, thereby enabling tighter integration."+ "\n\nPlease select [1], [2] or [q]uit"+ "\n******************");
    response=getSelection();
    if (response == '1') {
      System.out.println("Loading 'Ejb via an Endpoint' version");
      loanConsumer=new Main("loan-broker-esb-mule-config.xml");
    }
 else     if (response == 'q') {
      System.out.println("Bye");
      System.exit(0);
    }
 else {
      System.out.println("Loading 'Managed Ejb Component' version");
      loanConsumer=new Main("loan-broker-esb-mule-config-with-ejb-container.xml");
    }
    while (response != 'q') {
      System.out.println("\n[1] make a loan request");
      System.out.println("[q] quit");
      System.out.println("\nPlease make your selection: ");
      response=getSelection();
      if (response == '1') {
        CustomerQuoteRequest request=getRequestFromUser();
        UMOMessage result=loanConsumer.request(request);
        if (result == null) {
          System.out.println("A result was not received, an error must have occurred. Check the logs.");
        }
 else {
          System.out.println("Loan Consumer received a Quote: " + result.getPayload());
        }
      }
 else       if (response == 'q') {
        System.out.println("Exiting now");
        loanConsumer.close();
        System.exit(0);
      }
 else {
        System.out.println("That response is not recognised, try again:");
      }
    }
  }
 catch (  Exception e) {
    System.err.println(e.getMessage());
    e.printStackTrace(System.err);
    System.exit(1);
  }
}
