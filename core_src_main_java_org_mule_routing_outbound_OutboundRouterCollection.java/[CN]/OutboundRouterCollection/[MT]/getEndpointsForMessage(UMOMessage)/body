{
  List endpoints=new ArrayList();
  for (Iterator iterator=getRouters().iterator(); iterator.hasNext(); ) {
    UMOOutboundRouter umoOutboundRouter=(UMOOutboundRouter)iterator.next();
    if (umoOutboundRouter.isMatch(message)) {
      endpoints.addAll(umoOutboundRouter.getEndpoints());
      if (!isMatchAll()) {
        break;
      }
    }
  }
  UMOImmutableEndpoint[] result=new UMOImmutableEndpoint[endpoints.size()];
  return (UMOImmutableEndpoint[])endpoints.toArray(result);
}
