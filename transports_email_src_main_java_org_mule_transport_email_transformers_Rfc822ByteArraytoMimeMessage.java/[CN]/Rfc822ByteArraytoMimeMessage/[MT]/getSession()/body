{
  if (null == endpoint) {
    throw new TransformerException(this,new IllegalStateException("The transformer is no associated with an endpoint."));
  }
  Connector connector=endpoint.getConnector();
  if (!(connector instanceof AbstractMailConnector)) {
    throw new TransformerException(this,new IllegalStateException("The transformer is not associated with an email endpoint."));
  }
  try {
    return ((AbstractMailConnector)connector).getSessionDetails(endpoint).getSession();
  }
 catch (  UnsupportedEncodingException e) {
    throw new TransformerException(this,e);
  }
}
