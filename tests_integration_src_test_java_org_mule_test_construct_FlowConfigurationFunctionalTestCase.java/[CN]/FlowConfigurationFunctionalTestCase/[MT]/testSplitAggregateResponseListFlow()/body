{
  final Apple apple=new Apple();
  final Banana banana=new Banana();
  final Orange orange=new Orange();
  final FruitBowl fruitBowl=new FruitBowl(apple,banana);
  fruitBowl.addFruit(orange);
  final MuleMessage result=muleContext.getClient().send("vm://split-aggregate-response-list-in",new DefaultMuleMessage(fruitBowl.getFruit(),muleContext));
  assertNotNull(result);
  assertTrue(result instanceof MuleMessageCollection);
  final MuleMessageCollection coll=(MuleMessageCollection)result;
  assertEquals(3,coll.size());
  final List<?> results=(List<?>)coll.getPayload();
  assertEquals(3,results.size());
  assertTrue(apple.isBitten());
  assertTrue(banana.isBitten());
  assertTrue(orange.isBitten());
  assertTrue(results.contains(apple));
  assertTrue(results.contains(banana));
  assertTrue(results.contains(orange));
}
