{
  final Flow flow=muleContext.getRegistry().lookupObject("flow2");
  CompositeMessageSource compositeSource=(CompositeMessageSource)flow.getMessageSource();
  assertEquals(StartableCompositeMessageSource.class,compositeSource.getClass());
  assertEquals(2,flow.getMessageProcessors().size());
  final List<MessageSource> sources=compositeSource.getSources();
  TestSimpleMessageSource source1=(TestSimpleMessageSource)sources.get(0);
  TestSimpleMessageSource source2=(TestSimpleMessageSource)sources.get(1);
  assertEquals("01xyz",getPayloadAsString(source1.fireEvent(Event.builder(DefaultEventContext.create(flow,TEST_CONNECTOR)).message(InternalMessage.of("0")).build()).getMessage()));
  assertEquals("01xyz",getPayloadAsString(source2.fireEvent(Event.builder(DefaultEventContext.create(flow,TEST_CONNECTOR)).message(InternalMessage.of("0")).build()).getMessage()));
}
