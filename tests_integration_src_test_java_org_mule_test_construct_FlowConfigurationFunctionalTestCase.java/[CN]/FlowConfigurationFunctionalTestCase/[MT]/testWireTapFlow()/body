{
  muleContext.getClient().send("vm://wiretap-in",new DefaultMuleMessage(TEST_MESSAGE,muleContext));
  MuleMessage result=muleContext.getClient().request("vm://wiretap-out",RECEIVE_TIMEOUT);
  MuleMessage tapResult=muleContext.getClient().request("vm://wiretap-tap",RECEIVE_TIMEOUT);
  assertNotNull(result);
  assertNotNull(tapResult);
  assertNotSame(result,tapResult);
  assertEquals(TEST_MESSAGE + "inout",result.getPayloadAsString());
  assertEquals(TEST_MESSAGE + "intap",tapResult.getPayloadAsString());
}
