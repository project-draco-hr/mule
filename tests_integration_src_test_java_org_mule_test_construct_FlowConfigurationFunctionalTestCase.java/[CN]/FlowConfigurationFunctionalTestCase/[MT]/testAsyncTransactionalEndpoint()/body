{
  Exception e=flowRunner("async-tx").withPayload("0").transactionally(ACTION_NONE,new TestTransactionFactory()).asynchronously().runExpectingException();
  assertThat(e,instanceOf(MessagingException.class));
  assertThat(e.getMessage(),containsString("The <async> element cannot be used with transactions"));
  final MuleClient client=muleContext.getClient();
  assertThat(client.request("test://async-requestresponse-out",RECEIVE_TIMEOUT).getRight().isPresent(),is(false));
  assertThat(client.request("test://async-async-oneway-out",RECEIVE_TIMEOUT).getRight().isPresent(),is(false));
}
