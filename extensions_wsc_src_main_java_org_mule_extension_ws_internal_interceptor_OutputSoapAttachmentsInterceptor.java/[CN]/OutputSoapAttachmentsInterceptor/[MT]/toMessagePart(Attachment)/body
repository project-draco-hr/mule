{
  DataHandler dataHandler=attachment.getDataHandler();
  String name=dataHandler.getName() != null ? dataHandler.getName() : attachment.getId();
  try {
    return org.mule.runtime.api.message.Message.builder().payload(dataHandler.getInputStream()).mediaType(MediaType.parse(dataHandler.getContentType())).attributes(new PartAttributes(name)).build();
  }
 catch (  IOException e) {
    throw new SoapFault("Error copying received attachments",e,FAULT_CODE_SERVER);
  }
}
