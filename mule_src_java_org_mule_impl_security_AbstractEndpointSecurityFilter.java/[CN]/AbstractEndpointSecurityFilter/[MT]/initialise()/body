{
  if (securityManager == null) {
    securityManager=MuleManager.getInstance().getSecurityManager();
  }
  if (securityManager == null) {
    throw new InitialisationException(new Message(Messages.AUTH_SECURITY_MANAGER_NOT_SET),this);
  }
  if (endpoint == null) {
    throw new InitialisationException(new Message(Messages.X_IS_NULL,"Endpoint"),this);
  }
  if (securityProviders != null) {
    UMOSecurityManager localManager=new MuleSecurityManager();
    String[] sp=StringUtils.split(securityProviders,",");
    for (int i=0; i < sp.length; i++) {
      UMOSecurityProvider provider=securityManager.getProvider(sp[i]);
      if (provider != null) {
        localManager.addProvider(provider);
      }
 else {
        throw new InitialisationException(new Message(Messages.X_NOT_REGISTERED_WITH_MANAGER,"Security Provider '" + sp[i] + "'"),this);
      }
    }
    securityManager=localManager;
  }
  if (endpoint.getType().equals(UMOEndpoint.ENDPOINT_TYPE_RECEIVER)) {
    inbound=true;
  }
 else   if (endpoint.getType().equals(UMOEndpoint.ENDPOINT_TYPE_SENDER)) {
    inbound=false;
  }
 else {
    throw new InitialisationException(new Message(Messages.AUTH_ENDPOINT_TYPE_FOR_FILTER_MUST_BE_X_BUT_IS_X,UMOEndpoint.ENDPOINT_TYPE_SENDER + " or " + UMOEndpoint.ENDPOINT_TYPE_RECEIVER,endpoint.getType()),this);
  }
  doInitialise();
}
