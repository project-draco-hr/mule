{
  return parser.parse(new TemplateParser.TemplateCallback(){
    @Override public Object match(    String token){
      Object result=evaluate(token,event,failIfNull);
      if (result instanceof MuleMessage) {
        return ((MuleMessage)result).getPayload();
      }
 else {
        return result;
      }
    }
  }
,expression);
}
