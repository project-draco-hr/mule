{
  HttpResponseBuilder httpResponseBuilder=createHttpResponseBuilder();
  Date now=new Date();
  List<CookieWrapper> cookies=new ArrayList<>();
  cookies.add(createCookie("test","test",null,null,"#[now]",null,null));
  httpResponseBuilder.setCookies(cookies);
  when(mockExpressionManager.isExpression("#[now]")).thenReturn(true);
  when(mockExpressionManager.evaluate("#[now]",mockEvent)).thenReturn(now);
  when(mockExpressionManager.parse("test",mockEvent)).thenReturn("test");
  when(mockExpressionManager.parse("test",mockEvent)).thenReturn("test");
  HttpResponse response=new HttpResponse();
  httpResponseBuilder.setCookies(response,mockEvent);
  SimpleDateFormat httpCookieFormatter=new SimpleDateFormat(CookieHelper.EXPIRE_PATTERN,Locale.US);
  httpCookieFormatter.setTimeZone(TimeZone.getTimeZone("GMT"));
  String expectedCookieValue="test=test; Expires=" + httpCookieFormatter.format(now);
  validateHeader(response.getHeaders(),HttpConstants.HEADER_COOKIE_SET,expectedCookieValue);
}
