{
  DefaultMuleMessage muleMessage=new DefaultMuleMessage(TEST,muleContext);
  muleMessage.setMimeType(ANY);
  muleMessage.setEncoding(CUSTOM_ENCODING);
  Transformer transformer=mock(Transformer.class);
  when(transformer.isSourceDataTypeSupported(org.mockito.Matchers.<DataType<?>>any())).thenReturn(true);
  DataType outputDataType=DataTypeFactory.create(Integer.class,APPLICATION_XML);
  outputDataType.setEncoding(null);
  when(transformer.getReturnDataType()).thenReturn(outputDataType);
  MuleEvent muleEvent=mock(MuleEvent.class);
  transformationService.applyTransformers(muleMessage,muleEvent,Collections.singletonList(transformer));
  assertDataType(muleMessage,Integer.class,APPLICATION_XML,CUSTOM_ENCODING);
}
