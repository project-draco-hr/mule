{
  try {
    if (dataSourceFactory != null) {
      dataSource=(DataSource)dataSourceFactory.create();
    }
 else {
      if (dataSource == null) {
        initJndiContext();
        createDataSource();
      }
    }
    if (queryValueExtractors.isEmpty()) {
      queryValueExtractors=new HashSet();
      queryValueExtractors.add(new SimpleObjectFactory(MessagePropertyExtractor.class));
      queryValueExtractors.add(new SimpleObjectFactory(NowPropertyExtractor.class));
      queryValueExtractors.add(new SimpleObjectFactory(PayloadPropertyExtractor.class));
      queryValueExtractors.add(new SimpleObjectFactory(MapPropertyExtractor.class));
      queryValueExtractors.add(new SimpleObjectFactory(BeanPropertyExtractor.class));
      if (ClassUtils.isClassOnPath("org.mule.util.properties.Dom4jPropertyExtractor",getClass())) {
        queryValueExtractors.add(new SimpleObjectFactory("org.mule.util.properties.Dom4jPropertyExtractor"));
      }
      if (ClassUtils.isClassOnPath("org.mule.util.properties.JDomPropertyExtractor",getClass())) {
        queryValueExtractors.add(new SimpleObjectFactory("org.mule.util.properties.JDomPropertyExtractor"));
      }
    }
  }
 catch (  Exception e) {
    throw new InitialisationException(CoreMessages.failedToCreate("Jdbc Connector"),e,this);
  }
}
