{
  try {
    if (dataSourceFactory != null) {
      dataSource=(DataSource)dataSourceFactory.create();
    }
 else {
      if (dataSource == null) {
        initJndiContext();
        createDataSource();
      }
    }
    if (dataSource != null && dataSource instanceof XADataSource) {
      final TransactionManager tm=managementContext.getTransactionManager();
      if (tm != null) {
        dataSource=new DataSourceWrapper((XADataSource)dataSource,tm);
      }
    }
    if (propertyExtractors.isEmpty()) {
      propertyExtractors=new HashSet();
      propertyExtractors.add(new SimpleObjectFactory(MessagePropertyExtractor.class));
      propertyExtractors.add(new SimpleObjectFactory(NowPropertyExtractor.class));
      propertyExtractors.add(new SimpleObjectFactory(PayloadPropertyExtractor.class));
      propertyExtractors.add(new SimpleObjectFactory(MapPropertyExtractor.class));
      propertyExtractors.add(new SimpleObjectFactory(BeanPropertyExtractor.class));
      if (ClassUtils.isClassOnPath("org.mule.util.properties.Dom4jPropertyExtractor",getClass())) {
        propertyExtractors.add(new SimpleObjectFactory("org.mule.util.properties.Dom4jPropertyExtractor"));
      }
      if (ClassUtils.isClassOnPath("org.mule.util.properties.JDomPropertyExtractor",getClass())) {
        propertyExtractors.add(new SimpleObjectFactory("org.mule.util.properties.JDomPropertyExtractor"));
      }
    }
  }
 catch (  Exception e) {
    throw new InitialisationException(CoreMessages.failedToCreate("Jdbc Connector"),e,this);
  }
}
