{
  Object[] params=new Object[paramNames.size()];
  for (int i=0; i < paramNames.size(); i++) {
    String param=(String)paramNames.get(i);
    String name=param.substring(2,param.length() - 1);
    Object value=null;
    boolean foundValue=false;
    if (message != null) {
      PropertyExtractor pe=(PropertyExtractor)propertyExtractorCache.get(query + param);
      if (pe == null) {
        for (Iterator iterator=propertyExtractors.iterator(); iterator.hasNext(); ) {
          pe=(PropertyExtractor)iterator.next();
          value=pe.getProperty(name,message);
          if (value != null) {
            foundValue=true;
            propertyExtractorCache.putIfAbsent(query + param,pe);
            break;
          }
        }
      }
 else {
        value=pe.getProperty(name,message);
        foundValue=true;
      }
      if (StringUtils.EMPTY.equals(value) && pe instanceof BeanPropertyExtractor) {
        value=null;
      }
    }
    if (!foundValue) {
      value=endpoint.getProperty(name);
    }
    params[i]=value;
  }
  return params;
}
