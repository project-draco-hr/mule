{
  MuleMessage msg=event.getMessage();
  HttpResponse httpResponse=getHttpResponse(msg);
  propagateMessageProperties(httpResponse,msg);
  checkVersion(msg);
  setStatus(httpResponse,event);
  setContentType(httpResponse,event);
  setHeaders(httpResponse,event);
  setCookies(httpResponse,event);
  setCacheControl(httpResponse,event);
  setDateHeader(httpResponse,new Date());
  setBody(httpResponse,msg,event);
  msg.setPayload(httpResponse);
  return event;
}
