{
  MuleMessage message=event.getMessage();
  HttpResponse httpResponse=getHttpResponse(message);
  propagateMessageProperties(httpResponse,message,event.getCorrelationId(),event.getCorrelation());
  checkVersion(message);
  setStatus(httpResponse,event);
  setContentType(httpResponse,event);
  setHeaders(httpResponse,event);
  setCookies(httpResponse,event);
  setCacheControl(httpResponse,event);
  setDateHeader(httpResponse,new Date());
  setBody(httpResponse,message,event);
  event.setMessage(MuleMessage.builder(event.getMessage()).payload(httpResponse).build());
  return event;
}
