{
  Registration registration=registrationFactory.getInstance(RegistrationFactory.REF_MULE_COMPONENT);
  String newId="" + getNewId();
  registration.setId(newId);
  String cn=object.getClass().getName();
  registration.setProperty("sourceObjectClassName",cn);
  int pos=cn.lastIndexOf(".");
  if (pos > -1) {
    registration.setType(cn.substring(pos + 1));
  }
 else {
    registration.setType(cn);
  }
  if (parent != null) {
    if (parent.getRegistryId() == null) {
      logger.warn("Trying to register " + object.getClass().getName() + " but parent "+ parent.getClass().getName()+ " has no Registration record");
    }
 else {
      registration.setParentId(parent.getRegistryId());
    }
  }
  ObjectMetadata om=null;
  try {
    om=MetadataStore.getObjectMetadata(object.getClass().getName());
  }
 catch (  MissingMetadataException mme) {
    logger.warn("Trying to register " + object.getClass().getName() + " but no ObjectMetadata found");
  }
  try {
    loadProperties(om,registration,object);
  }
 catch (  Exception e) {
    logger.warn("Unable to load properties for object " + object.getClass().getName());
  }
  registryStore.registerComponent(registration);
  return registration;
}
