{
  when(mockRoute.process(any(MuleEvent.class))).thenThrow(new RuntimeException("expected failure"));
  SynchronousUntilSuccessfulProcessingStrategy processingStrategy=createProcessingStrategy();
  try {
    processingStrategy.route(event);
    fail("processing should throw exception");
  }
 catch (  MessagingException e) {
    assertThat(e,instanceOf(RoutingException.class));
    verify(mockRoute,times(DEFAULT_RETRIES + 1)).process(event);
    assertThat(RequestContext.getEvent(),is(e.getEvent()));
  }
}
