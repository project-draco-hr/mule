{
  final MuleMessage attachmentPart=toMuleMessagePart("spi-props",getResourceAsUrl("test-spi.properties",getClass()),MediaType.TEXT);
  MuleMessage message=MuleMessage.builder().payload(new DefaultMultiPartPayload(MuleMessage.builder().payload(TEST_PAYLOAD).attributes(BODY_ATTRIBUTES).build(),attachmentPart)).build();
  assertThat(((MultiPartPayload)message.getPayload()).getParts(),hasSize(2));
  assertThat(((MultiPartPayload)message.getPayload()).getPartNames(),hasItem("spi-props"));
  assertThat(((MultiPartPayload)message.getPayload()).getPart("spi-props"),sameInstance(attachmentPart));
  assertThat(((MultiPartPayload)message.getPayload()).getPart("spi-props").getDataType().getMediaType(),is(MediaType.TEXT));
}
