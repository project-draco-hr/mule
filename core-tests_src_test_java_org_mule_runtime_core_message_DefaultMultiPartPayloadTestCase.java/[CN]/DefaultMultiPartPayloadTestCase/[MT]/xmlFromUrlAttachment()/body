{
  final InternalMessage attachmentPart1=toMuleMessagePart("spi-props",getResourceAsUrl("test-spi.properties",getClass()),MediaType.TEXT);
  final InternalMessage attachmentPart2=toMuleMessagePart("dummy",getResourceAsUrl("dummy.xml",getClass()),null);
  InternalMessage message=InternalMessage.builder().payload(new DefaultMultiPartPayload(InternalMessage.builder().payload(TEST_PAYLOAD).attributes(BODY_ATTRIBUTES).build(),attachmentPart1,attachmentPart2)).build();
  assertThat(((MultiPartPayload)message.getPayload().getValue()).getParts(),hasSize(3));
  assertThat(((MultiPartPayload)message.getPayload().getValue()).getPart("dummy").getPayload().getDataType().getMediaType(),is(MediaType.APPLICATION_XML));
}
