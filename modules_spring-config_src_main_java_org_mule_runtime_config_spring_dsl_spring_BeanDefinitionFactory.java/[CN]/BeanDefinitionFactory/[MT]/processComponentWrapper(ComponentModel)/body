{
  ComponentBuildingDefinition parentBuildingDefinition=componentBuildingDefinitionRegistry.getBuildingDefinition(componentModel.getParent().getIdentifier()).get();
  Map<String,WrapperElementType> wrapperIdentifierAndTypeMap=getWrapperIdentifierAndTypeMap(parentBuildingDefinition);
  WrapperElementType wrapperElementType=wrapperIdentifierAndTypeMap.get(componentModel.getIdentifier().getName());
  if (wrapperElementType.equals(SINGLE)) {
    componentModel.setType(componentModel.getInnerComponents().get(0).getType());
    componentModel.setBeanDefinition(componentModel.getInnerComponents().get(0).getBeanDefinition());
    componentModel.setBeanReference(componentModel.getInnerComponents().get(0).getBeanReference());
  }
 else {
    throw new IllegalStateException(format("Element %s does not have a building definition and it should since it's of type %s",componentModel.getIdentifier(),wrapperElementType));
  }
}
