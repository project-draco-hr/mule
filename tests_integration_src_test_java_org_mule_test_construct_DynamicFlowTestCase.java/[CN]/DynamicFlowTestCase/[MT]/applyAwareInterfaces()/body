{
  Flow flow=getFlow("dynamicFlow");
  UberAwareMessageProcessor awareMessageProcessor=new UberAwareMessageProcessor();
  flow.dynamicPipeline(null).injectBefore(awareMessageProcessor).resetAndUpdate();
  MuleMessage result=client.send("vm://dynamic","source->",null);
  assertEquals("source->(pre)(static)",getPayloadAsString(result));
  assertNotNull(awareMessageProcessor.getFlowConstruct());
  assertNotNull(awareMessageProcessor.getMuleContext());
}
