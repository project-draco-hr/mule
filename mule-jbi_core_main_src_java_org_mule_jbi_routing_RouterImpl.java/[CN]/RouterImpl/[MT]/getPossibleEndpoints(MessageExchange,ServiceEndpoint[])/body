{
  List result=new ArrayList();
  for (int i=0; i < endpoints.length; i++) {
    AbstractServiceEndpoint se=(AbstractServiceEndpoint)endpoints[i];
    String compName=se.getComponent();
    ComponentInfo compInfo=this.container.getComponentRegistry().getComponent(compName);
    if (me.getRole() == MessageExchange.Role.CONSUMER) {
      if (compInfo.getComponent().isExchangeWithConsumerOkay(se,me)) {
        result.add(se);
      }
    }
 else {
      if (compInfo.getComponent().isExchangeWithProviderOkay(se,me)) {
        result.add(se);
      }
    }
  }
  return (ServiceEndpoint[])result.toArray(new ServiceEndpoint[result.size()]);
}
