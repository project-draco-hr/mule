{
  final Flow flow=new Flow("",muleContext);
  flow.setProcessingStrategy(new NonBlockingProcessingStrategy());
  muleContext.getRegistry().registerFlowConstruct(flow);
  OutboundEndpoint endpoint=createOutboundEndpoint("test://AlwaysFail",null,null,null,null,REQUEST_RESPONSE,null);
  endpoint.setFlowConstruct(flow);
  SensingNullReplyToHandler nullReplyToHandler=new SensingNullReplyToHandler();
  MuleEvent event=getNonBlockingTestEventUsingFlow(TEST_MESSAGE,nullReplyToHandler,flow);
  MuleEvent response=endpoint.process(event);
  assertThat(response,equalTo(NonBlockingVoidMuleEvent.getInstance()));
  try {
    getNonBlockingResponse(nullReplyToHandler,response);
    fail("Exception Expected");
  }
 catch (  Exception e) {
    assertThat(e,instanceOf(MessagingException.class));
    assertThat(e.getCause(),instanceOf(RoutingException.class));
  }
  assertThat(nullReplyToHandler.event,is(nullValue()));
}
