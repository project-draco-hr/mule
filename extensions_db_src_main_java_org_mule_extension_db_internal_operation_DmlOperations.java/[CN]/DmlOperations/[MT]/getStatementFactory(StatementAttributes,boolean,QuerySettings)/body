{
  QueryStatementFactory statementFactory=new QueryStatementFactory();
  if (statementAttributes != null) {
    if (statementAttributes.getMaxRows() != null) {
      statementFactory.setMaxRows(statementAttributes.getMaxRows());
    }
    if (statementAttributes.getFetchSize() != null) {
      statementFactory.setFetchSize(statementAttributes.getFetchSize());
    }
 else     if (streaming) {
      LOGGER.warn("Streaming mode needs to configure fetchSize property. Using default value: " + DEFAULT_FETCH_SIZE);
      statementFactory.setFetchSize(DEFAULT_FETCH_SIZE);
    }
  }
  statementFactory.setQueryTimeout(new Long(settings.getQueryTimeoutUnit().toSeconds(settings.getQueryTimeout())).intValue());
  return statementFactory;
}
