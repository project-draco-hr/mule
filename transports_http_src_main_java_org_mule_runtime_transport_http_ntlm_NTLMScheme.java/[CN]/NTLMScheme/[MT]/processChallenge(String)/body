{
  String s=AuthChallengeParser.extractScheme(challenge);
  if (!s.equalsIgnoreCase(getSchemeName())) {
    throw new MalformedChallengeException("Invalid NTLM challenge: " + challenge);
  }
  int i=challenge.indexOf(' ');
  if (i != -1) {
    s=challenge.substring(i,challenge.length());
    receivedNtlmChallenge=s.trim();
    authenticationState=AUTHENTICATION_STATE.TYPE2_MSG_RECEIVED;
  }
 else {
    receivedNtlmChallenge=null;
    authenticationState=authenticationState == AUTHENTICATION_STATE.UNINITIATED ? AUTHENTICATION_STATE.INITIATED : AUTHENTICATION_STATE.FAILED;
  }
}
