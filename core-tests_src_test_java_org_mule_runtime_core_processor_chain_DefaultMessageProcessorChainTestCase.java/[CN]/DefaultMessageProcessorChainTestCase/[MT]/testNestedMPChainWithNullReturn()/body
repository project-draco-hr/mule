{
  DefaultMessageProcessorChainBuilder builder=new DefaultMessageProcessorChainBuilder(muleContext);
  builder.chain(getAppendingMP("1"),new DefaultMessageProcessorChainBuilder(muleContext).chain(getAppendingMP("a"),new ReturnNullMP(),getAppendingMP("b")).build(),new ReturnNullMP(),getAppendingMP("2"));
  assertNull(process(builder.build(),getTestEventUsingFlow("0")));
  assertEquals(isMultipleThreadsUsed() ? 3 : 1,threads);
}
