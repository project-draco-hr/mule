{
  DefaultMessageProcessorChainBuilder builder=new DefaultMessageProcessorChainBuilder();
  final MessageProcessorChain chain=newChain(singletonList(getAppendingMP("1")));
  final ResponseMessageProcessorAdapter responseMessageProcessorAdapter=new ResponseMessageProcessorAdapter(chain);
  responseMessageProcessorAdapter.setMuleContext(muleContext);
  builder.chain(responseMessageProcessorAdapter);
  process(builder.build(),getTestEventUsingFlow("0"));
  assertThat(process(builder.build(),getTestEventUsingFlow("0")).getMessage().getPayload().getValue(),equalTo("01"));
}
