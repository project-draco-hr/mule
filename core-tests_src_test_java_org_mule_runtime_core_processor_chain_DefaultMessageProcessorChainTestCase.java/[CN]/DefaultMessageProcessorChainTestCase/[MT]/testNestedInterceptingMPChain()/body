{
  DefaultMessageProcessorChainBuilder builder=new DefaultMessageProcessorChainBuilder(muleContext);
  builder.chain(new AppendingInterceptingMP("1"),new DefaultMessageProcessorChainBuilder(muleContext).chain(new AppendingInterceptingMP("a"),new AppendingInterceptingMP("b")).build(),new AppendingInterceptingMP("2"));
  assertEquals("0before1beforeabeforebafterbafterabefore2after2after1",process(builder.build(),getTestEventUsingFlow("0")).getMessage().getPayload());
  assertEquals(1,threads);
}
