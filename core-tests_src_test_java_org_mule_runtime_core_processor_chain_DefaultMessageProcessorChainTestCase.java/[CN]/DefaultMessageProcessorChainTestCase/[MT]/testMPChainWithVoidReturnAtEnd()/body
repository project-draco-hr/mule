{
  DefaultMessageProcessorChainBuilder builder=new DefaultMessageProcessorChainBuilder(muleContext);
  builder.chain(getAppendingMP("1"),getAppendingMP("2"),getAppendingMP("3"),new ReturnVoidMP());
  assertEquals("0123",process(builder.build(),getTestEventUsingFlow("0")).getMessage().getPayload().getValue());
  assertEquals(isMultipleThreadsUsed() ? 4 : 1,threads);
}
