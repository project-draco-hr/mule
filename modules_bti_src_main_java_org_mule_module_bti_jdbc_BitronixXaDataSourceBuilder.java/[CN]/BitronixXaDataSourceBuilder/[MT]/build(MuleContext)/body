{
  Preconditions.checkState(name != null,"name is required");
  Preconditions.checkState(dataSource != null,"dataSource is required");
  Preconditions.checkState(minPoolSize > 0,"minPoolSize must be greater than 0");
  Preconditions.checkState(maxPoolSize > 0,"maxPoolSize must be greater than 0");
  Preconditions.checkState(maxIdleTime > 0,"maxIdleTime must be greater than 0");
  PoolingDataSource poolingDataSource;
synchronized (BitronixJdbcXaDataSourceProvider.class) {
    BitronixJdbcXaDataSourceProvider.xaDatasourceHolder=dataSource;
    poolingDataSource=new PoolingDataSource();
    poolingDataSource.setClassName(BitronixJdbcXaDataSourceProvider.class.getCanonicalName());
    poolingDataSource.setMinPoolSize(minPoolSize);
    poolingDataSource.setMaxPoolSize(maxPoolSize);
    poolingDataSource.setMaxIdleTime(maxIdleTime);
    poolingDataSource.setAcquireIncrement(1);
    poolingDataSource.setAllowLocalTransactions(true);
    poolingDataSource.setAutomaticEnlistingEnabled(false);
    poolingDataSource.setUniqueName(muleContext.getConfiguration().getId() + "-" + name);
    poolingDataSource.init();
  }
  return new BitronixXaDataSourceWrapper(poolingDataSource,muleContext);
}
