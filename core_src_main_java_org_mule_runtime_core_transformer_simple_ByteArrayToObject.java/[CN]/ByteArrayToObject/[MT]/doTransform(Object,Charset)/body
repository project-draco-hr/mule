{
  if (src instanceof byte[]) {
    byte[] bytes=(byte[])src;
    if (this.checkStreamHeader(bytes[0])) {
      return super.doTransform(src,encoding);
    }
 else {
      return new String(bytes,encoding);
    }
  }
 else   if (src instanceof InputStream) {
    try {
      PushbackInputStream pushbackStream=new PushbackInputStream((InputStream)src);
      int firstByte=pushbackStream.read();
      pushbackStream.unread((byte)firstByte);
      if (this.checkStreamHeader((byte)firstByte)) {
        return super.doTransform(pushbackStream,encoding);
      }
 else {
        try {
          return IOUtils.toString(pushbackStream,encoding);
        }
  finally {
          pushbackStream.close();
        }
      }
    }
 catch (    IOException iox) {
      throw new TransformerException(this,iox);
    }
  }
 else {
    throw new TransformerException(CoreMessages.transformOnObjectUnsupportedTypeOfEndpoint(this.getName(),src.getClass()));
  }
}
