{
  SslConnector cnn=null;
  ServerSocketFactory ssf=null;
  cnn=(SslConnector)connector;
  SSLContext sslc=SSLContext.getInstance(cnn.getProtocol().toLowerCase());
  sslc.init(cnn.getKeyManagerFactory().getKeyManagers(),null,null);
  ssf=sslc.getServerSocketFactory();
  String host=uri.getHost();
  InetAddress inetAddress=null;
  int backlog=cnn.getBacklog();
  if (host == null || host.length() == 0) {
    host="localhost";
  }
  SSLServerSocket serverSocket=null;
  inetAddress=InetAddress.getByName(host);
  if (inetAddress.equals(InetAddress.getLocalHost()) || inetAddress.isLoopbackAddress() || host.trim().equals("localhost")) {
    serverSocket=(SSLServerSocket)ssf.createServerSocket(uri.getPort(),backlog);
  }
 else {
    serverSocket=(SSLServerSocket)ssf.createServerSocket(uri.getPort(),backlog,inetAddress);
  }
  serverSocket.setNeedClientAuth(cnn.isRequireClientAuthentication());
  return serverSocket;
}
