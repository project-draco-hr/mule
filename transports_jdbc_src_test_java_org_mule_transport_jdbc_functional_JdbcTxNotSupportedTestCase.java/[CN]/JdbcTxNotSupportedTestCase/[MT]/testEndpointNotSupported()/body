{
  final Latch transactionCommitLatch=new Latch();
  muleContext.registerListener(new TransactionNotificationListener<TransactionNotification>(){
    @Override public void onNotification(    TransactionNotification notification){
      if (notification.getAction() == TransactionNotification.TRANSACTION_COMMITTED) {
        transactionCommitLatch.release();
      }
    }
  }
);
  execSqlUpdate("INSERT INTO TEST(TYPE, DATA, ACK, RESULT) VALUES(1, NULL, NULL, NULL)");
  if (!(transactionCommitLatch.await(5,TimeUnit.SECONDS))) {
    fail("Transaction wasn't commited");
  }
  assertThat(getCountWithType2(),Is.is(1));
  assertThat(getCountWithType3(),Is.is(1));
}
