{
  final CountDownLatch countDown=new CountDownLatch(2);
  EventCallback callback=new EventCallback(){
    public void eventReceived(    UMOEventContext context,    Object component) throws Exception {
      int index=(int)countDown.getCount() - 1;
      assertEquals(context.getMessage().getProperty(FileConnector.PROPERTY_ORIGINAL_FILENAME),FILE_NAMES[index]);
      countDown.countDown();
    }
  }
;
  ((FunctionalTestComponent)managementContext.getRegistry().lookupComponent(COMPONENT_NAME).getServiceFactory().getOrCreate()).setEventCallback(callback);
  managementContext.getRegistry().lookupConnector(FILE_CONNECTOR_NAME).stop();
  File f1=FileUtils.newFile(PATH + FILE_NAMES[0]);
  f1.createNewFile();
  Thread.sleep(1000);
  File f2=FileUtils.newFile(PATH + FILE_NAMES[1]);
  f2.createNewFile();
  Thread.sleep(1000);
  managementContext.getRegistry().lookupConnector(FILE_CONNECTOR_NAME).start();
  assertTrue(countDown.await(TIMEOUT,TimeUnit.MILLISECONDS));
}
