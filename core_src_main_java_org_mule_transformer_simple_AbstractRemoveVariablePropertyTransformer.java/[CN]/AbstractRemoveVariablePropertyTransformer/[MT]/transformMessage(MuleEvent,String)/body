{
  if (wildcardAttributeEvaluator.hasWildcards()) {
    wildcardAttributeEvaluator.processValues(event.getMessage().getPropertyNames(getScope()),new WildcardAttributeEvaluator.MatchCallback(){
      @Override public void processMatch(      String matchedValue){
        event.getMessage().removeProperty(matchedValue,getScope());
        if (logger.isDebugEnabled()) {
          logger.debug(String.format("Removing property: '%s' from scope: '%s'",matchedValue,getScope().getScopeName()));
        }
      }
    }
);
  }
 else {
    Object keyValue=identifierEvaluator.resolveValue(event);
    if (keyValue != null) {
      event.getMessage().removeProperty(keyValue.toString(),getScope());
    }
 else {
      logger.info("Key expression return null, no property will be removed");
    }
  }
  return event.getMessage();
}
