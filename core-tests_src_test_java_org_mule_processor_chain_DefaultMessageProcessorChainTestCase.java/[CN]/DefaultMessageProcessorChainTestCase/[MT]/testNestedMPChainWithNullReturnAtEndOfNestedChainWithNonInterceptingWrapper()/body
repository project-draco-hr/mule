{
  DefaultMessageProcessorChainBuilder builder=new DefaultMessageProcessorChainBuilder();
  final MessageProcessor nested=new DefaultMessageProcessorChainBuilder().chain(getAppendingMP("a"),getAppendingMP("b"),new ReturnNullMP()).build();
  builder.chain(getAppendingMP("1"),new MessageProcessor(){
    public MuleEvent process(    MuleEvent event) throws MuleException {
      return nested.process(event);
    }
  }
,getAppendingMP("2"));
  assertNull("012",process(builder.build(),getTestEventUsingFlow("0")));
  assertEquals(isMultipleThreadsUsed() ? 4 : 1,threads);
}
