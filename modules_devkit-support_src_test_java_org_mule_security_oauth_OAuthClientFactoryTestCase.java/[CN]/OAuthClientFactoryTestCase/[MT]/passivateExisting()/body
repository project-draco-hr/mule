{
  OAuthState state=this.registerState();
  TestOAuth2Adapter adapter=new TestOAuth2Adapter(this.manager);
  adapter.setAccessToken("new access token");
  adapter.setAccessTokenUrl("access token url");
  adapter.setAuthorizationUrl("authorization url");
  adapter.setRefreshToken("refresh token");
  this.factory.passivateObject("key",adapter);
  Assert.assertEquals(adapter.getAccessToken(),state.getAccessToken());
  Assert.assertEquals(adapter.getAccessTokenUrl(),state.getAccessTokenUrl());
  Assert.assertEquals(adapter.getAuthorizationUrl(),state.getAuthorizationUrl());
  Assert.assertEquals(adapter.getRefreshToken(),state.getRefreshToken());
  Mockito.verify(this.objectStore).remove("key");
  Mockito.verify(this.factory).setCustomStateProperties(adapter,state);
  Mockito.verify(this.objectStore).store("key",state);
}
