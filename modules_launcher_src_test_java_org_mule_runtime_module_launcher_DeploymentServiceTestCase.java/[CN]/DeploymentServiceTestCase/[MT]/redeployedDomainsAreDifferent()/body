{
  deploymentService.start();
  addPackedDomainFromBuilder(emptyAppFileBuilder);
  File dummyDomainFile=new File(emptyAppFileBuilder.getZipPath());
  long firstFileTimestamp=dummyDomainFile.lastModified();
  assertDeploymentSuccess(domainDeploymentListener,emptyAppFileBuilder.getId());
  assertEquals("Domain has not been properly registered with Mule",2,deploymentService.getDomains().size());
  Domain firstDomain=findADomain(emptyAppFileBuilder.getId());
  reset(domainDeploymentListener);
  addPackedDomainFromBuilder(emptyAppFileBuilder);
  alterTimestampIfNeeded(dummyDomainFile,firstFileTimestamp);
  assertUndeploymentSuccess(domainDeploymentListener,emptyAppFileBuilder.getId());
  assertDeploymentSuccess(domainDeploymentListener,emptyAppFileBuilder.getId());
  assertEquals("Domain has not been properly registered with Mule",2,deploymentService.getDomains().size());
  Domain secondDomain=findADomain(emptyAppFileBuilder.getId());
  assertNotSame(firstDomain,secondDomain);
}
