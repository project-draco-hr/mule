{
  if (proxyConfig != null) {
    ProxyServer proxyServer;
    if (!StringUtils.isEmpty(proxyConfig.getUsername())) {
      proxyServer=new ProxyServer(proxyConfig.getHost(),Integer.parseInt(proxyConfig.getPort()),proxyConfig.getUsername(),proxyConfig.getPassword());
      if (proxyConfig instanceof NtlmProxyConfig) {
        proxyServer.setNtlmDomain(((NtlmProxyConfig)proxyConfig).getNtlmDomain());
      }
    }
 else {
      proxyServer=new ProxyServer(proxyConfig.getHost(),Integer.parseInt(proxyConfig.getPort()));
    }
    builder.setProxyServer(proxyServer);
  }
}
