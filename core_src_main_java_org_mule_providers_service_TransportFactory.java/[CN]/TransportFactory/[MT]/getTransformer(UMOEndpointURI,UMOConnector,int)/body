{
  try {
    UMOTransformer trans=null;
    String transId=null;
    if (type == 2) {
      transId=url.getResponseTransformers();
    }
 else {
      transId=url.getTransformers();
    }
    if (transId != null) {
      trans=MuleObjectHelper.getTransformer(transId,",");
    }
 else {
      Properties overrides=new Properties();
      if (cnn instanceof AbstractConnector) {
        Map so=((AbstractConnector)cnn).getServiceOverrides();
        if (so != null) {
          overrides.putAll(so);
        }
      }
      String scheme=url.getSchemeMetaInfo();
      TransportServiceDescriptor sd=(TransportServiceDescriptor)RegistryContext.getRegistry().lookupServiceDescriptor(ServiceDescriptorFactory.PROVIDER_SERVICE_TYPE,scheme,overrides);
      if (sd != null) {
        if (type == 0) {
          trans=sd.createInboundTransformer();
        }
 else         if (type == 1) {
          trans=sd.createOutboundTransformer();
        }
 else {
          trans=sd.createResponseTransformer();
        }
      }
 else {
        throw new ServiceException(Message.createStaticMessage("No service descriptor found for transport: " + scheme + ".  This transport does not appear to be installed."));
      }
    }
    return trans;
  }
 catch (  Exception e) {
    throw new TransportFactoryException(e);
  }
}
