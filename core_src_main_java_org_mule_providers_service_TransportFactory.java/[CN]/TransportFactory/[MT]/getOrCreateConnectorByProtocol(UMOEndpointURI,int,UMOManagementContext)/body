{
  String connectorName=uri.getConnectorName();
  if (null != connectorName) {
    UMOConnector connector=RegistryContext.getRegistry().lookupConnector(connectorName);
    if (connector != null) {
      return connector;
    }
  }
  UMOConnector connector=getConnectorByProtocol(uri.getFullScheme());
  if (ALWAYS_CREATE_CONNECTOR == create || (connector == null && create == GET_OR_CREATE_CONNECTOR)) {
    connector=createConnector(uri,managementContext);
    try {
      BeanUtils.populate(connector,uri.getParams());
      connector.setManagementContext(managementContext);
      managementContext.getRegistry().registerConnector(connector);
    }
 catch (    Exception e) {
      throw new TransportFactoryException(e);
    }
  }
 else   if (create == NEVER_CREATE_CONNECTOR && connector == null) {
    logger.warn("There is no connector for protocol: " + uri.getScheme() + " and 'createConnector' is set to NEVER.  Returning null");
  }
  return connector;
}
