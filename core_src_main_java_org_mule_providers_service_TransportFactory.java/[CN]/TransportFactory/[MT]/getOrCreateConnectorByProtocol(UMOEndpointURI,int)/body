{
  UMOConnector connector=getConnectorByProtocol(uri.getFullScheme());
  if (ALWAYS_CREATE_CONNECTOR == create || (connector == null && create == GET_OR_CREATE_CONNECTOR)) {
    connector=createConnector(uri);
    try {
      BeanUtils.populate(connector,uri.getParams());
      RegistryContext.getRegistry().registerConnector(connector);
    }
 catch (    Exception e) {
      throw new TransportFactoryException(new Message(Messages.FAILED_TO_SET_PROPERTIES_ON_X,"Connector"),e);
    }
  }
 else   if (create == NEVER_CREATE_CONNECTOR && connector == null) {
    logger.warn("There is no connector for protocol: " + uri.getScheme() + " and 'createConnector' is set to NEVER.  Returning null");
  }
  return connector;
}
