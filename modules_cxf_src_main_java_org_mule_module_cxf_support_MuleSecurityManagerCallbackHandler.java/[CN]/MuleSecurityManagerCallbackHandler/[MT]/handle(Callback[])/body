{
  WSPasswordCallback pc=(WSPasswordCallback)callbacks[0];
  if (pc.getUsage() == WSPasswordCallback.USERNAME_TOKEN || pc.getUsage() == WSPasswordCallback.USERNAME_TOKEN_UNKNOWN) {
    DefaultMuleAuthentication auth=new DefaultMuleAuthentication(new MuleCredentials(pc.getIdentifer(),pc.getPassword().toCharArray()));
    try {
      securityManager.authenticate(auth);
      pc.setPassword(pc.getPassword());
    }
 catch (    SecurityException e) {
      throw new WSSecurityException(WSSecurityException.FAILED_AUTHENTICATION,null,null,e);
    }
catch (    SecurityProviderNotFoundException e) {
      throw new WSSecurityException(WSSecurityException.FAILED_AUTHENTICATION,null,null,e);
    }
  }
}
