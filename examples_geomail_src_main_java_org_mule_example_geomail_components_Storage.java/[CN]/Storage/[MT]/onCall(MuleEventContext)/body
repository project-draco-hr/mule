{
  MuleMessage message=context.getMessage();
  System.err.println("GroupSize: " + message.getCorrelationGroupSize());
  System.err.println("Correlation ID: " + message.getCorrelationId());
  System.err.println("Sequence Number: " + message.getCorrelationSequence());
  for (  String key : message.getPropertyNames()) {
    System.err.println(key + " = " + message.getProperty(key));
  }
  String ip=message.getOutboundProperty("ip");
  if (ip == null) {
    throw new IllegalStateException("'ip' property should have been set on MuleMessage.");
  }
  String from=message.getOutboundProperty("from.email.address");
  Sender sender=(Sender)message.getPayload();
  sender.setIp(ip);
  sender.setEmail(from);
  if (getSenderDao().getSender(sender.getIp()) != null) {
    log.warn("Sender '" + sender + "' should not be in the Database.");
  }
 else {
    getSenderDao().addSender(sender);
    log.warn("Sender '" + sender + "' successfully added to the Database.");
  }
  MuleMessage resultMessage=new DefaultMuleMessage(sender,context.getMuleContext());
  resultMessage.setCorrelationGroupSize(message.getCorrelationGroupSize());
  resultMessage.setCorrelationId(message.getCorrelationId());
  resultMessage.setCorrelationSequence(message.getCorrelationSequence());
  return resultMessage;
}
