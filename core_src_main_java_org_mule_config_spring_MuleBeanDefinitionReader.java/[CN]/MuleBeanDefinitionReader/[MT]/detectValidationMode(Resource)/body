{
  int i=super.detectValidationMode(resource);
  if (i == VALIDATION_DTD) {
    setEntityResolver(createEntityResolver());
  }
 else {
    setEntityResolver(new ResourceEntityResolver(getResourceLoader()));
  }
  return i;
}
