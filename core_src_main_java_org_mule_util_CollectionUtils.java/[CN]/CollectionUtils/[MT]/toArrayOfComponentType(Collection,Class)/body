{
  if (objects == null) {
    return null;
  }
  if (clazz == null) {
    throw new IllegalArgumentException("Array target class must not be null");
  }
  if (objects.isEmpty()) {
    return (Object[])Array.newInstance(clazz,0);
  }
  int i=0, size=objects.size();
  Object[] result=(Object[])Array.newInstance(clazz,size);
  Iterator iter=objects.iterator();
  while (i < size && iter.hasNext()) {
    result[i++]=iter.next();
  }
  return result;
}
