{
  final RetryCallback callback=new RetryCallback(){
    @Override public String getWorkDescription(){
      return "Until successful processing of event stored under key: " + eventStoreKey;
    }
    @Override public void doWork(    final RetryContext context) throws Exception {
      retrieveAndProcessEvent(eventStoreKey);
    }
  }
;
  final SimpleRetryPolicyTemplate simpleRetryPolicyTemplate=new SimpleRetryPolicyTemplate(TimeUnit.SECONDS.toMillis(secondsBetweenRetries),maxRetries);
  final RetryPolicyTemplate retryPolicyTemplate=new AsynchronousRetryTemplate(simpleRetryPolicyTemplate);
  retryPolicyTemplate.setNotifier(new RetryNotifier(){
    @Override public void onSuccess(    final RetryContext context){
      removeFromStore(eventStoreKey);
    }
    @Override public void onFailure(    final RetryContext context,    final Throwable e){
      incrementProcessAttemptCountOrRemoveFromStore(eventStoreKey);
    }
  }
);
  retryPolicyTemplate.execute(callback,muleContext.getWorkManager());
}
