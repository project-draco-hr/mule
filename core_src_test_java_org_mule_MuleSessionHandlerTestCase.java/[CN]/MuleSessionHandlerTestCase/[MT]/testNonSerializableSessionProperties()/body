{
  DefaultMuleMessage message=new DefaultMuleMessage("Test Message",muleContext);
  MuleSession session=new DefaultMuleSession();
  SessionHandler handler=new SerializeAndEncodeSessionHandler();
  NotSerializableClass clazz=new NotSerializableClass();
  session.setProperty("foo",clazz);
  handler.storeSessionInfoToMessage(session,message);
  Object s=message.removeProperty(MuleProperties.MULE_SESSION_PROPERTY);
  message.setInboundProperty(MuleProperties.MULE_SESSION_PROPERTY,s);
  session=handler.retrieveSessionInfoFromMessage(message);
  assertNull(session.getProperty("foo"));
}
