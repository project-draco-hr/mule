{
  try {
    if (startupProperties != null) {
      Registry registry=managementContext.getRegistry();
      for (Iterator iterator=startupProperties.entrySet().iterator(); iterator.hasNext(); ) {
        Map.Entry e=(Map.Entry)iterator.next();
        Map props=((Map)registry.lookupObject(MuleProperties.OBJECT_MULE_APPLICATION_PROPERTIES));
        if (props == null) {
          props=new HashMap();
          props.put(e.getKey(),e.getValue());
          registry.registerObject(MuleProperties.OBJECT_MULE_APPLICATION_PROPERTIES,props,managementContext);
        }
 else {
          props.put(e.getKey(),e.getValue());
        }
      }
    }
    for (int i=0; i < configResources.length; i++) {
      ReaderResource configResource=configResources[i];
      setScriptFile(configResource.getDescription());
      initialise();
      Bindings ns=getScriptEngine().createBindings();
      populateBindings(ns);
      CompiledScript script=compileScript(configResource.getReader());
      script.eval(ns);
    }
    if (System.getProperty(MuleProperties.MULE_START_AFTER_CONFIG_SYSTEM_PROPERTY,"true").equalsIgnoreCase("true")) {
      if (!managementContext.isStarted()) {
        managementContext.start();
      }
    }
  }
 catch (  Exception e) {
    throw new ConfigurationException(e);
  }
  return managementContext;
}
