{
  Iterator iter=providers.values().iterator();
  Class toTest=authentication.getClass();
  while (iter.hasNext()) {
    UMOSecurityProvider provider=(UMOSecurityProvider)iter.next();
    if (provider.supports(toTest)) {
      logger.debug("Authentication attempt using " + provider.getClass().getName());
      UMOAuthentication result=provider.authenticate(authentication);
      if (result != null) {
        return result;
      }
    }
  }
  throw new SecurityProviderNotFoundException(toTest.getName());
}
