{
  final String accessTokenUrl="accessTokenUrl";
  final String redirectUri="redirectUri";
  final String accessTokenId="accessTokenId";
  this.processor.setRedirectUri(redirectUri);
  this.processor.setAccessTokenId(accessTokenId);
  OAuth2Adapter adapter=Mockito.mock(OAuth2Adapter.class);
  Mockito.when(this.manager.createAdapter(verifier)).thenReturn(adapter);
  Mockito.when(adapter.getAccessTokenUrl()).thenReturn(accessTokenUrl);
  Assert.assertSame(this.restoredEvent,this.processor.process(event));
  Mockito.verify(adapter).fetchAccessToken(redirectUri);
  Mockito.verify(this.manager.getAccessTokenPoolFactory()).passivateObject(accessTokenId,adapter);
  Mockito.verify(this.restoredEvent.getMessage()).setInvocationProperty(OAuthProperties.ACCESS_TOKEN_ID,accessTokenId);
}
