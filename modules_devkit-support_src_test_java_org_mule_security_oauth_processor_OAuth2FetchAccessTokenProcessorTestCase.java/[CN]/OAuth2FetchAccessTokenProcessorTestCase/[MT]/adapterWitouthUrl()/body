{
  final String accessTokenUrl="accessTokenUrl";
  final String redirectUri="redirectUri";
  final String accessTokenId="accessTokenId";
  this.processor.setRedirectUri(redirectUri);
  this.processor.setAccessTokenUrl(accessTokenUrl);
  OAuth2Adapter adapter=Mockito.mock(OAuth2Adapter.class);
  Mockito.when(this.manager.createAdapter(verifier)).thenReturn(adapter);
  Mockito.when(adapter.getAccessTokenId()).thenReturn(accessTokenId);
  MuleEvent event=this.getEvent();
  this.processor.process(event);
  Mockito.verify(adapter).fetchAccessToken(redirectUri);
  Mockito.verify(this.manager.getAccessTokenPoolFactory()).passivateObject(accessTokenId,adapter);
  Mockito.verify(event.getMessage()).setInvocationProperty("OAuthAccessTokenId",accessTokenId);
}
