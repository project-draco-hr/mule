{
  File pluginLibDir=MuleFoldersUtil.getAppSharedPluginLibsFolder(APP_NAME);
  pluginLibDir.mkdirs();
  File sharedLibFile=new File(pluginLibDir,JAR_FILE_NAME);
  copyResourceAs("lib/mule-module-service-echo-default-4.0-SNAPSHOT.jar",sharedLibFile);
  final ApplicationDescriptorFactory applicationDescriptorFactory=new ApplicationDescriptorFactory(new ArtifactPluginDescriptorLoader(new ArtifactPluginDescriptorFactory(new ArtifactClassLoaderFilterFactory())),applicationPluginRepository);
  ApplicationDescriptor desc=applicationDescriptorFactory.create(getAppFolder(APP_NAME));
  assertThat(desc.getSharedRuntimeLibs().length,equalTo(1));
  assertThat(desc.getSharedRuntimeLibs()[0].getFile(),equalTo(sharedLibFile.toString()));
  assertThat(desc.getClassLoaderFilter().getExportedClassPackages(),contains("org.mule.echo"));
  assertThat(desc.getClassLoaderFilter().getExportedResources(),containsInAnyOrder("META-INF/MANIFEST.MF","META-INF/maven/org.mule.modules/mule-module-service-echo-default/pom.properties","META-INF/maven/org.mule.modules/mule-module-service-echo-default/pom.xml"));
}
