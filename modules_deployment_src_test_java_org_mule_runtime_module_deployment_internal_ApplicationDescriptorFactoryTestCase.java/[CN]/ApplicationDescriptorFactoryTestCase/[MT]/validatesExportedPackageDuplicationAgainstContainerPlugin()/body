{
  File pluginDir=getAppPluginsFolder(APP_NAME);
  pluginDir.mkdirs();
  copyFile(createApplicationPluginFile(),new File(pluginDir,"plugin1.zip"));
  final ArtifactPluginRepository applicationPluginRepository=mock(ArtifactPluginRepository.class);
  final ArtifactPluginDescriptor plugin2Descriptor=new ArtifactPluginDescriptor();
  plugin2Descriptor.setName("plugin2");
  final Set<String> exportedPackages=new HashSet<>();
  exportedPackages.add("org.foo");
  exportedPackages.add("org.bar");
  plugin2Descriptor.setClassLoaderFilter(new DefaultArtifactClassLoaderFilter(exportedPackages,Collections.emptySet()));
  when(applicationPluginRepository.getContainerArtifactPluginDescriptors()).thenReturn(Collections.singletonList(plugin2Descriptor));
  doPackageValidationTest(applicationPluginRepository);
}
