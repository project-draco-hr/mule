{
  Session session=null;
  AdtMessage message=null;
  XMLType xmltype=null;
  try {
    session=(Session)getEndpoint().getConnector().getDispatcher("transformerSession").getDelegateSession();
  }
 catch (  UMOException e) {
    throw new TransformerException(this,e);
  }
  if (!(session instanceof AQjmsSession)) {
    throw new TransformerException(Message.createStaticMessage("Endpoint must be an OracleAQ session."),this);
  }
  try {
    if (xml instanceof String) {
      xmltype=XMLType.createXML(((AQjmsSession)session).getDBConnection(),(String)xml);
    }
 else {
      throw new TransformerException(Message.createStaticMessage("Object to transform is not one of the supported types for this transformer."),this);
    }
    message=((AQjmsSession)session).createAdtMessage();
    message.setAdtPayload(xmltype);
  }
 catch (  JMSException e) {
    throw new TransformerException(this,e);
  }
catch (  SQLException e) {
    throw new TransformerException(this,e);
  }
  return message;
}
