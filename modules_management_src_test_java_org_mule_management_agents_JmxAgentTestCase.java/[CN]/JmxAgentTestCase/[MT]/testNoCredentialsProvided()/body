{
  configureProperties();
  jmxAgent.setCredentials(getValidCredentials());
  managementContext.getRegistry().registerAgent(jmxAgent);
  managementContext.start();
  JMXConnector connector=null;
  try {
    JMXServiceURL serviceUrl=new JMXServiceURL(JmxAgent.DEFAULT_REMOTING_URI);
    connector=JMXConnectorFactory.connect(serviceUrl);
    fail("expected SecurityException");
  }
 catch (  SecurityException e) {
  }
 finally {
    if (connector != null) {
      connector.close();
    }
  }
}
