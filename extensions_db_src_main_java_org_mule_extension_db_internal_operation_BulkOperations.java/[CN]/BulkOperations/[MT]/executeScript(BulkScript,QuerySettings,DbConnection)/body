{
  QueryTemplateParser queryParser=new SimpleQueryTemplateParser();
  BulkQueryFactory bulkQueryFactory;
  if (!isEmpty(script.getFile())) {
    bulkQueryFactory=new FileBulkQueryFactory(script.getFile(),queryParser,new DefaultFileReader());
  }
 else {
    bulkQueryFactory=new DefaultBulkQueryFactory(queryParser,script.getSql());
  }
  BulkQuery bulkQuery=bulkQueryFactory.resolve();
  BulkUpdateExecutor bulkUpdateExecutor=new BulkUpdateExecutor(getStatementFactory(null,false,settings));
  return (int[])bulkUpdateExecutor.execute(connection,bulkQuery);
}
