{
  try {
    StringBuffer message=new StringBuffer();
    byte[] buf=new byte[getBufferSize()];
    int len=inputStream.read(buf);
    if (len == -1)     return;
    message.append(new String(buf,0,len));
    String read=message.toString();
    if (read.endsWith("\n"))     read=read.substring(0,message.length() - 1);
    UMOMessage umoMessage=new MuleMessage(connector.getMessageAdapter(read));
    routeMessage(umoMessage,endpoint.isSynchronous());
    ((StreamConnector)endpoint.getConnector()).reinitialise();
  }
 catch (  Exception e) {
    handleException(e);
  }
}
