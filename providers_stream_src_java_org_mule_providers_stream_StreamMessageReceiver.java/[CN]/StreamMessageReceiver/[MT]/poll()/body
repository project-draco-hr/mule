{
  try {
    if (inputStream.available() == 0) {
      return;
    }
    byte[] buf=new byte[getBufferSize()];
    int len=inputStream.read(buf);
    if (len == -1) {
      return;
    }
    String message=new String(buf,0,len);
    if (message.endsWith(Utility.CRLF)) {
      message=message.substring(0,message.length() - Utility.CRLF.length());
    }
    UMOMessage umoMessage=new MuleMessage(connector.getMessageAdapter(message));
    routeMessage(umoMessage,endpoint.isSynchronous());
    ((StreamConnector)endpoint.getConnector()).reinitialise();
  }
 catch (  Exception e) {
    handleException(e);
  }
}
