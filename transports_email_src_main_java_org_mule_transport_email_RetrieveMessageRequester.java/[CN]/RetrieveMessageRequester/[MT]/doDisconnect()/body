{
  try {
    if (folder != null) {
      try {
        folder.expunge();
      }
 catch (      MessagingException e) {
        if (logger.isDebugEnabled()) {
          logger.debug("ignoring exception on expunge: " + e.getMessage());
        }
      }
      if (folder.isOpen()) {
        folder.close(true);
      }
    }
  }
 catch (  Exception e) {
    logger.error("Failed to close inbox: " + e.getMessage(),e);
  }
  try {
    if (moveToFolder != null) {
      if (moveToFolder.isOpen()) {
        moveToFolder.close(false);
      }
    }
  }
 catch (  Exception e) {
    logger.error("Failed to close moveToFolder: " + e.getMessage(),e);
  }
}
