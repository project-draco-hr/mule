{
  Properties props=new Properties();
  props.setProperty(WSHandlerConstants.ACTION,WSHandlerConstants.ENCRYPT);
  props.setProperty(WSHandlerConstants.USER,"mulealias");
  props.setProperty(WSHandlerConstants.PW_CALLBACK_CLASS,"org.mule.extras.wssecurity.callbackhandlers.MuleWsSecurityCallbackHandler");
  props.setProperty(WSHandlerConstants.ENC_PROP_FILE,"out-encrypted-security.properties");
  props.setProperty(WSHandlerConstants.SIG_KEY_ID,"DirectReference");
  props.setProperty(WSHandlerConstants.USE_REQ_SIG_CERT,"false");
  MuleMessage result;
  MuleClient client=new MuleClient();
  result=client.send("vm://secured","Inputgot",props);
  assertNotNull(result.getPayload());
  assertTrue(result.getPayloadAsString().equalsIgnoreCase("inputgot"));
  System.out.println("Message Echoed is: " + result.getPayload().toString());
}
