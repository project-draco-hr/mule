{
  ExpressionManager expressionManager=muleContext.getExpressionManager();
  MuleMessage message=new DefaultMuleMessage("test",muleContext);
  expressionManager.enrich("#[variable:foo]",message,"fooValue");
  Object result=expressionManager.evaluate("#[variable:foo]",message);
  assertNotNull(result);
  assertEquals("fooValue",result);
  assertNull(expressionManager.evaluate("#[variable:foo]",message));
  result=message.getProperty("foo",PropertyScope.INVOCATION);
  assertNotNull(result);
  assertEquals("fooValue",result);
}
