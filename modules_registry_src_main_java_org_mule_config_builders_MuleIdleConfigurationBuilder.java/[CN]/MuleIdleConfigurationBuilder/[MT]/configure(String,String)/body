{
  try {
    Class scannerAgentClass=ClassUtils.loadClass("org.mule.impl.internal.admin.ConfigScannerAgent",MuleIdleConfigurationBuilder.class);
    UMOAgent scannerAgent=(UMOAgent)scannerAgentClass.newInstance();
    managementContext.getRegistry().registerAgent(scannerAgent);
    Class jmxAgentClass=ClassUtils.loadClass("org.mule.management.agents.JmxAgent",MuleIdleConfigurationBuilder.class);
    UMOAgent jmxAgent=(UMOAgent)jmxAgentClass.newInstance();
    jmxAgent.setName("jmxAgent");
    managementContext.getRegistry().registerAgent(jmxAgent);
    Class mx4jAgentClass=ClassUtils.loadClass("org.mule.management.agents.Mx4jAgent",MuleIdleConfigurationBuilder.class);
    UMOAgent mx4jAgent=(UMOAgent)mx4jAgentClass.newInstance();
    mx4jAgent.setName("mx4jAgent");
    managementContext.getRegistry().registerAgent(mx4jAgent);
  }
 catch (  Exception e) {
    throw new ConfigurationException(e);
  }
  try {
    managementContext.start();
  }
 catch (  UMOException umoe) {
    throw new ConfigurationException(umoe);
  }
  configured=true;
  return managementContext;
}
