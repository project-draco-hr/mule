{
  if (folder == null || !folder.isOpen()) {
    Store store=castConnector().getSessionDetails(endpoint).newStore();
    UMOEndpointURI uri=endpoint.getEndpointURI();
    store.connect(uri.getHost(),uri.getPort(),uri.getUsername(),uri.getPassword());
    folder=store.getFolder(castConnector().getMailboxFolder());
    if (!folder.isOpen()) {
      try {
        folder.open(Folder.READ_WRITE);
      }
 catch (      MessagingException e) {
        logger.warn("Failed to open folder: " + folder.getFullName(),e);
      }
    }
  }
}
