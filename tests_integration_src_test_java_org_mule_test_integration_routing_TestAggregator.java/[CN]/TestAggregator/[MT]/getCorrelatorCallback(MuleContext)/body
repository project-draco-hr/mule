{
  return new CollectionCorrelatorCallback(muleContext,storePrefix){
    @Override public Event aggregateEvents(    EventGroup events) throws AggregationException {
      StringBuilder buffer=new StringBuilder(128);
      try {
        for (Iterator<Event> iterator=events.iterator(); iterator.hasNext(); ) {
          Event event=iterator.next();
          try {
            buffer.append(event.transformMessageToString(muleContext));
          }
 catch (          TransformerException e) {
            throw new AggregationException(events,null,e);
          }
        }
      }
 catch (      ObjectStoreException e) {
        throw new AggregationException(events,null,e);
      }
      logger.debug("event payload is: " + buffer.toString());
      return Event.builder(events.getMessageCollectionEvent()).message(InternalMessage.builder().payload(buffer.toString()).build()).build();
    }
  }
;
}
