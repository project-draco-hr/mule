{
  int defaultMaxBufferSize=42;
  int defaultMaxThreadsActive=16;
  int defaultMaxThreadsIdle=3;
  int defaultThreadPoolExhaustedAction=ThreadingProfile.WHEN_EXHAUSTED_WAIT;
  int defaultThreadTTL=60001;
  int connectorMaxBufferSize=2;
  int componentMaxBufferSize=6;
  int componentMaxThreadsActive=12;
  int componentMaxThreadsIdle=6;
  int componentThreadPoolExhaustedAction=ThreadingProfile.WHEN_EXHAUSTED_DISCARD;
  ThreadingProfile tp=muleContext.getDefaultThreadingProfile();
  assertEquals(defaultMaxBufferSize,tp.getMaxBufferSize());
  assertEquals(defaultMaxThreadsActive,tp.getMaxThreadsActive());
  assertEquals(defaultMaxThreadsIdle,tp.getMaxThreadsIdle());
  assertEquals(defaultThreadPoolExhaustedAction,tp.getPoolExhaustedAction());
  assertEquals(defaultThreadTTL,tp.getThreadTTL());
  tp=muleContext.getDefaultServiceThreadingProfile();
  assertEquals(defaultMaxBufferSize,tp.getMaxBufferSize());
  assertEquals(defaultMaxThreadsActive,tp.getMaxThreadsActive());
  assertEquals(defaultMaxThreadsIdle,tp.getMaxThreadsIdle());
  assertEquals(defaultThreadPoolExhaustedAction,tp.getPoolExhaustedAction());
  assertEquals(defaultThreadTTL,tp.getThreadTTL());
  AbstractConnector c=(AbstractConnector)muleContext.getRegistry().lookupConnector("dummyConnector");
  tp=c.getDispatcherThreadingProfile();
  assertEquals(connectorMaxBufferSize,tp.getMaxBufferSize());
  assertEquals(defaultMaxThreadsActive,tp.getMaxThreadsActive());
  assertEquals(defaultMaxThreadsIdle,tp.getMaxThreadsIdle());
  assertEquals(defaultThreadPoolExhaustedAction,tp.getPoolExhaustedAction());
  assertEquals(defaultThreadTTL,tp.getThreadTTL());
  Service service=muleContext.getRegistry().lookupService("appleComponent2");
  assertTrue("service must be SedaService to get threading profile",service instanceof SedaService);
  tp=((SedaService)service).getThreadingProfile();
  assertEquals(componentMaxBufferSize,tp.getMaxBufferSize());
  assertEquals(componentMaxThreadsActive,tp.getMaxThreadsActive());
  assertEquals(componentMaxThreadsIdle,tp.getMaxThreadsIdle());
  assertEquals(componentThreadPoolExhaustedAction,tp.getPoolExhaustedAction());
  assertEquals(defaultThreadTTL,tp.getThreadTTL());
}
