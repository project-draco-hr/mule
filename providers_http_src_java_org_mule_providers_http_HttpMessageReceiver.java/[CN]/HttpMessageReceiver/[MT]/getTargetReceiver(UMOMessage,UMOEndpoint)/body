{
  String path=(String)message.getProperty(HttpConnector.HTTP_REQUEST_PROPERTY);
  int i=path.indexOf("?");
  if (i > -1) {
    path=path.substring(0,i);
  }
  StringBuffer requestUri=new StringBuffer();
  requestUri.append(endpoint.getProtocol()).append("://");
  requestUri.append(endpoint.getEndpointURI().getHost());
  requestUri.append(":").append(endpoint.getEndpointURI().getPort());
  AbstractMessageReceiver receiver=connector.getReceiver(requestUri.toString());
  if (receiver == null && !"/".equals(path)) {
    int x=path.lastIndexOf("/");
    if (x > 1 && path.indexOf(".") > x) {
      requestUri.append(path.substring(0,x));
    }
 else {
      requestUri.append(path);
    }
    receiver=connector.getReceiver(requestUri.toString());
  }
  return receiver;
}
