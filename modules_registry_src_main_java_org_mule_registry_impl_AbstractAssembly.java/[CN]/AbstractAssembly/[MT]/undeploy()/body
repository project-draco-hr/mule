{
  if (!getCurrentState().equals(SHUTDOWN) && !getCurrentState().equals(UNKNOWN)) {
    throw new RegistryException("Illegal status: " + getCurrentState());
  }
  Unit[] units=getUnits();
  for (int i=0; i < units.length; i++) {
    units[i].undeploy();
  }
  FileUtils.deleteTree(FileUtils.newFile(getInstallRoot()));
  getRegistry().removeAssembly(this);
  setCurrentState(UNKNOWN);
  return null;
}
