{
  FunctionalTestComponent ftc=lookupTestComponent();
  CountdownCallback callback=new CountdownCallback(1);
  ftc.setEventCallback(callback);
  send(TEST_MESSAGE,useTopics() ? "topic:in" : "in");
  assertTrue(callback.await(LOCK_TIMEOUT));
  assertEquals(TEST_MESSAGE,ftc.getLastReceivedMessage());
  assertEquals(TEST_MESSAGE_RESPONSE,receiveTextMessage(useTopics() ? "topic:out" : "out"));
}
