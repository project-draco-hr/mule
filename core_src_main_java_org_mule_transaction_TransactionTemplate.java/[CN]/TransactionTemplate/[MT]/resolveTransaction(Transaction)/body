{
  if (tx.isRollbackOnly()) {
    logger.debug("Transaction has been marked rollbackOnly, rolling it back: " + tx);
    tx.rollback();
  }
 else {
    logger.debug("Committing transaction " + tx);
    tx.commit();
  }
}
