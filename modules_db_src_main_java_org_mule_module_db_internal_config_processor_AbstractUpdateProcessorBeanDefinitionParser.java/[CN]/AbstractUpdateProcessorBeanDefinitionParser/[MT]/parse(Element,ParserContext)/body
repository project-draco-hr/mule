{
  BeanDefinitionParser beanDefinitionParser;
  List<QueryType> validQueryTypes=getQueryType();
  if (element.hasAttribute(BULK_MODE_ATTRIBUTE) && element.getAttribute(BULK_MODE_ATTRIBUTE).equals("true")) {
    beanDefinitionParser=new PreparedBulkUpdateProcessorBeanDefinitionParser(validQueryTypes);
  }
 else {
    beanDefinitionParser=new SingleUpdateProcessorDefinitionParser(validQueryTypes);
  }
  return beanDefinitionParser.parse(element,parserContext);
}
