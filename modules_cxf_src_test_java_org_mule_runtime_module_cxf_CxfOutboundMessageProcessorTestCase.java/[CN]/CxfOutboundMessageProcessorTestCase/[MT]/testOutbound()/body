{
  CxfConfiguration config=new CxfConfiguration();
  config.setMuleContext(muleContext);
  config.initialise();
  SimpleClientMessageProcessorBuilder builder=new SimpleClientMessageProcessorBuilder();
  builder.setConfiguration(config);
  builder.setServiceClass(EchoService.class);
  builder.setOperation("echo");
  builder.setMuleContext(muleContext);
  CxfOutboundMessageProcessor processor=builder.build();
  MessageProcessor messageProcessor=new MessageProcessor(){
    public MuleEvent process(    MuleEvent event) throws MuleException {
      payload=event.getMessage().getPayload();
      try {
        System.out.println(getPayloadAsString(event.getMessage()));
      }
 catch (      Exception e) {
        e.printStackTrace();
      }
      event.getMessage().setPayload(msg);
      gotEvent=true;
      return event;
    }
  }
;
  processor.setListener(messageProcessor);
  MuleEvent event=getTestEvent("hello");
  MuleEvent response=processor.process(event);
  assertThat(processor.getClient().getRequestContext().isEmpty(),Is.is(true));
  assertThat(processor.getClient().getResponseContext().isEmpty(),Is.is(true));
  Object payload=response.getMessage().getPayload();
  assertThat(payload,IsInstanceOf.instanceOf(String.class));
  assertThat((String)payload,Is.is("hello"));
  assertThat(gotEvent,Is.is(true));
}
