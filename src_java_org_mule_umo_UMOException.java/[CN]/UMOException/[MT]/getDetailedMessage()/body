{
  UMOException e=ExceptionHelper.getRootMuleException(this);
  if (!e.equals(this)) {
    return getMessage();
  }
  StringBuffer buf=new StringBuffer(1024);
  buf.append(SystemUtils.LINE_SEPARATOR).append(StringMessageHelper.charString('*',80)).append(SystemUtils.LINE_SEPARATOR);
  buf.append("Message               : ").append(message).append(SystemUtils.LINE_SEPARATOR);
  buf.append("Type                  : ").append(getClass().getName()).append(SystemUtils.LINE_SEPARATOR);
  buf.append("Code                  : ").append(getExceptionCode() + getMessageCode()).append(SystemUtils.LINE_SEPARATOR);
  Map info=ExceptionHelper.getExceptionInfo(this);
  for (Iterator iterator=info.keySet().iterator(); iterator.hasNext(); ) {
    String s=(String)iterator.next();
    int pad=22 - s.length();
    buf.append(s);
    if (pad > 0) {
      buf.append(StringMessageHelper.charString(' ',pad));
    }
    buf.append(": ");
    buf.append(info.get(s)).append(SystemUtils.LINE_SEPARATOR);
  }
  buf.append(StringMessageHelper.charString('*',80)).append(SystemUtils.LINE_SEPARATOR);
  buf.append(new Message(Messages.EXCEPTION_STACK_IS)).append(SystemUtils.LINE_SEPARATOR);
  buf.append(ExceptionHelper.getExceptionStack(this));
  buf.append(StringMessageHelper.charString('*',80)).append(SystemUtils.LINE_SEPARATOR);
  buf.append(new Message(Messages.ROOT_STACK_TRACE)).append(SystemUtils.LINE_SEPARATOR);
  Throwable root=ExceptionHelper.getRootException(this);
  StringWriter w=new StringWriter();
  PrintWriter p=new PrintWriter(w);
  root.printStackTrace(p);
  buf.append(w.toString()).append(SystemUtils.LINE_SEPARATOR);
  buf.append(StringMessageHelper.charString('*',80)).append(SystemUtils.LINE_SEPARATOR);
  return buf.toString();
}
