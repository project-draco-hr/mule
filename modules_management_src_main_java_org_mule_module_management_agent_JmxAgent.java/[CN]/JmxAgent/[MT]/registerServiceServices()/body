{
  for (  Service service : muleContext.getRegistry().lookupObjects(Service.class)) {
    final String rawName=service.getName();
    final String escapedName=jmxSupport.escape(rawName);
    final String jmxName=String.format("%s:%s%s",jmxSupport.getDomainName(muleContext,!containerMode),ServiceServiceMBean.DEFAULT_JMX_NAME_PREFIX,escapedName);
    ObjectName on=jmxSupport.getObjectName(jmxName);
    ServiceServiceMBean serviceMBean=new ServiceService(rawName,muleContext);
    ClassloaderSwitchingMBeanWrapper wrapper=new ClassloaderSwitchingMBeanWrapper(serviceMBean,ServiceServiceMBean.class,muleContext.getExecutionClassLoader());
    logger.debug("Registering service with name: " + on);
    mBeanServer.registerMBean(wrapper,on);
  }
}
