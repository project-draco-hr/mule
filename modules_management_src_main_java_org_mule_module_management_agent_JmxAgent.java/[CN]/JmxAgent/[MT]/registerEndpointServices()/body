{
  Iterator iter=muleContext.getRegistry().lookupObjects(Connector.class).iterator();
  Connector connector;
  while (iter.hasNext()) {
    connector=(Connector)iter.next();
    if (connector instanceof AbstractConnector) {
      for (Iterator iterator=((AbstractConnector)connector).getReceivers().values().iterator(); iterator.hasNext(); ) {
        EndpointServiceMBean mBean=new EndpointService((MessageReceiver)iterator.next());
        final String rawName=mBean.getName();
        final String name=jmxSupport.escape(rawName);
        if (logger.isInfoEnabled()) {
          logger.info("Attempting to register service with name: " + jmxSupport.getDomainName(muleContext) + ":type=org.mule.Endpoint,service="+ jmxSupport.escape(mBean.getComponentName())+ ",name="+ name);
        }
        ObjectName on=jmxSupport.getObjectName(jmxSupport.getDomainName(muleContext) + ":type=org.mule.Endpoint,service=" + jmxSupport.escape(mBean.getComponentName())+ ",name="+ name);
        mBeanServer.registerMBean(mBean,on);
        logger.info("Registered Endpoint Service with name: " + on);
      }
    }
 else {
      logger.warn("Connector: " + connector + " is not an istance of AbstractConnector, cannot obtain Endpoint MBeans from it");
    }
  }
}
