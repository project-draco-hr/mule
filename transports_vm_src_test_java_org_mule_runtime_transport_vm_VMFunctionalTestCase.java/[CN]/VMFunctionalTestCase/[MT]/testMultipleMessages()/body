{
  MuleClient client=muleContext.getClient();
  client.dispatch("vm://in","Marco",null);
  client.dispatch("vm://in","Marco",null);
  client.dispatch("vm://in","Marco",null);
  MuleMessage response;
  for (int i=0; i < 3; ++i) {
    response=client.request("vm://out",RECEIVE_TIMEOUT);
    assertNotNull("Response is null",response);
    assertEquals("Polo",response.getPayload());
  }
  MuleMessage secondMessage=client.request("vm://out",RECEIVE_TIMEOUT);
  assertNull(secondMessage);
}
