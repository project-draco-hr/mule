{
  AbstractRedeliveryPolicy redeliveryPolicy=super.getRedeliveryPolicy();
  OnErrorPropagateHandler onErrorPropagateHandler=null;
  if (flowConstruct != null && flowConstruct.getExceptionListener() != null) {
    MessagingExceptionHandler exceptionListener=flowConstruct.getExceptionListener();
    if (exceptionListener instanceof OnErrorPropagateHandler) {
      onErrorPropagateHandler=(OnErrorPropagateHandler)exceptionListener;
    }
 else     if (exceptionListener instanceof ErrorHandler) {
      ErrorHandler errorHandler=(ErrorHandler)exceptionListener;
      for (      MessagingExceptionHandlerAcceptor messagingExceptionHandlerAcceptor : errorHandler.getExceptionListeners()) {
        if (messagingExceptionHandlerAcceptor instanceof OnErrorPropagateHandler && ((OnErrorPropagateHandler)messagingExceptionHandlerAcceptor).hasMaxRedeliveryAttempts()) {
          onErrorPropagateHandler=(OnErrorPropagateHandler)messagingExceptionHandlerAcceptor;
          break;
        }
      }
    }
  }
  if (onErrorPropagateHandler != null && onErrorPropagateHandler.hasMaxRedeliveryAttempts()) {
    if (redeliveryPolicy == null) {
      redeliveryPolicy=createDefaultRedeliveryPolicy(onErrorPropagateHandler.getMaxRedeliveryAttempts());
    }
 else {
      redeliveryPolicy.setMaxRedeliveryCount(onErrorPropagateHandler.getMaxRedeliveryAttempts());
    }
  }
  return redeliveryPolicy;
}
