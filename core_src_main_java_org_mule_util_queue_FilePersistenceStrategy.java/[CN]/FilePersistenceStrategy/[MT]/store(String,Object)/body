{
  String id=getId(obj);
  File file=FileUtils.newFile(store,queue + File.separator + id+ EXTENSION);
  if (!file.getParentFile().exists() && !file.getParentFile().mkdirs()) {
    throw new IOException("Failed to create directory: " + file.getAbsolutePath());
  }
  try {
    serializer.write(new FileOutputStream(file),obj,muleContext.getConfiguration().getDefaultEncoding());
  }
 catch (  MuleException e) {
    throw new IOException(e.getDetailedMessage());
  }
  return id;
}
