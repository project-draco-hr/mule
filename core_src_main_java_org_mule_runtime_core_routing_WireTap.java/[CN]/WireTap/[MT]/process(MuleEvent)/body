{
  if (tap == null) {
    return event;
  }
  try {
    MuleEvent tapEvent=DefaultMuleEvent.copy(event);
    tapEvent=new DefaultMuleEvent(tapEvent,(ReplyToHandler)null);
    OptimizedRequestContext.unsafeSetEvent(tapEvent);
    filteredTap.process(tapEvent);
    OptimizedRequestContext.unsafeSetEvent(event);
  }
 catch (  MuleException e) {
    logger.error("Exception sending to wiretap output " + tap,e);
  }
  return event;
}
