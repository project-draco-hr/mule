{
  List<AnnotationMetaData> annotations=AnnotationUtils.getClassAndMethodAnnotations(componentFactoryClass);
  for (  AnnotationMetaData metaData : annotations) {
    Router routerAnnotation=metaData.getAnnotation().annotationType().getAnnotation(Router.class);
    if (routerAnnotation != null && routerAnnotation.type() == RouterType.ReplyTo) {
      RouterAnnotationParser parser=parserFactory.getRouterParser(metaData.getAnnotation(),metaData.getClazz(),metaData.getMember());
      if (parser != null) {
        MessageProcessor router=parser.parseRouter(metaData.getAnnotation());
        if (router instanceof MuleContextAware) {
          ((MuleContextAware)router).setMuleContext(context);
        }
        break;
      }
 else {
        throw new IllegalStateException("Cannot find parser for router annotation: " + metaData.getAnnotation().toString());
      }
    }
  }
}
