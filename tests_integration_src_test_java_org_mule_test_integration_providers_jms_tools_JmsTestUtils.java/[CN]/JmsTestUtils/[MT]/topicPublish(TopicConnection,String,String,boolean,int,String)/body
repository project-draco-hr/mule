{
  TopicSession session=cnn.createTopicSession(transacted,ack);
  Topic topic=session.createTopic(topicName);
  TopicPublisher publisher=session.createPublisher(topic);
  TextMessage msg=session.createTextMessage();
  msg.setText(payload);
  msg.setJMSDeliveryMode(ack);
  if (replyTo != null) {
    msg.setJMSReplyTo(session.createTopic(replyTo));
  }
  publisher.publish(msg);
  publisher.close();
  session.close();
}
