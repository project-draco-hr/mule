{
  StringBuffer buf=new StringBuffer();
  buf.append(getSessionIDKey()).append("=").append(session.getId());
  for (  String key : session.getPropertyNamesAsSet()) {
    buf.append(";");
    buf.append(key).append("=").append(session.getProperty(key));
    if (logger.isDebugEnabled()) {
      logger.debug(String.format("Adding property to session header: %s=%s",key,session.getProperty(key)));
    }
  }
  String sessionString=buf.toString();
  if (logger.isDebugEnabled()) {
    logger.debug("Adding session header to message: " + sessionString);
  }
  sessionString=(String)encoder.transform(sessionString);
  message.setOutboundProperty(MuleProperties.MULE_SESSION_PROPERTY,sessionString);
}
