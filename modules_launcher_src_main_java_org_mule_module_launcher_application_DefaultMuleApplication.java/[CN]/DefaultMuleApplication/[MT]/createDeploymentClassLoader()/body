{
  final String domain=descriptor.getDomain();
  ClassLoader parent;
  if (StringUtils.isBlank(domain) || DefaultMuleSharedDomainClassLoader.DEFAULT_DOMAIN_NAME.equals(domain)) {
    parent=new DefaultMuleSharedDomainClassLoader(getClass().getClassLoader());
  }
 else {
    parent=new MuleSharedDomainClassLoader(domain,getClass().getClassLoader());
  }
  final Set<PluginDescriptor> plugins=descriptor.getPlugins();
  if (!plugins.isEmpty()) {
    MulePluginsClassLoader cl=new MulePluginsClassLoader(parent,plugins);
    parent=cl;
  }
  final MuleApplicationClassLoader appCl=new MuleApplicationClassLoader(appName,parent,descriptor.getLoaderOverride());
  this.deploymentClassLoader=appCl;
}
