{
  AbstractRedeliveryPolicy redeliveryPolicy=super.getRedeliveryPolicy();
  if (redeliveryPolicy == null) {
    if (flowConstruct != null && flowConstruct.getExceptionListener() != null) {
      MessagingExceptionHandler exceptionListener=flowConstruct.getExceptionListener();
      RollbackMessagingExceptionStrategy rollbackMessagingExceptionStrategy=null;
      if (exceptionListener instanceof RollbackMessagingExceptionStrategy) {
        rollbackMessagingExceptionStrategy=(RollbackMessagingExceptionStrategy)exceptionListener;
      }
 else       if (exceptionListener instanceof ChoiceMessagingExceptionStrategy) {
        ChoiceMessagingExceptionStrategy choiceMessagingExceptionStrategy=(ChoiceMessagingExceptionStrategy)exceptionListener;
        for (        MessagingExceptionHandlerAcceptor messagingExceptionHandlerAcceptor : choiceMessagingExceptionStrategy.getExceptionListeners()) {
          if (messagingExceptionHandlerAcceptor instanceof RollbackMessagingExceptionStrategy && ((RollbackMessagingExceptionStrategy)messagingExceptionHandlerAcceptor).hasMaxRedeliveryAttempts()) {
            rollbackMessagingExceptionStrategy=(RollbackMessagingExceptionStrategy)messagingExceptionHandlerAcceptor;
            break;
          }
        }
      }
      if (rollbackMessagingExceptionStrategy != null) {
        if (rollbackMessagingExceptionStrategy.hasMaxRedeliveryAttempts()) {
          redeliveryPolicy=createDefaultRedeliveryPolicy(rollbackMessagingExceptionStrategy.getMaxRedeliveryAttempts());
        }
      }
    }
  }
  return redeliveryPolicy;
}
