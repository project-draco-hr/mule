{
  setPayloadTransformer=new SetPayloadTransformer();
  mockMuleContext=mock(MuleContext.class);
  setPayloadTransformer.setMuleContext(mockMuleContext);
  mockExpressionManager=mock(ExpressionManager.class);
  mockMuleEvent=mock(MuleEvent.class);
  mockMuleMessage=mock(MuleMessage.class);
  when(mockMuleEvent.getMessage()).thenReturn(mockMuleMessage);
  when(mockMuleContext.getExpressionManager()).thenReturn(mockExpressionManager);
  Mockito.when(mockExpressionManager.parse(anyString(),Mockito.any(MuleEvent.class))).thenAnswer(new Answer<String>(){
    @Override public String answer(    InvocationOnMock invocation) throws Throwable {
      return (String)invocation.getArguments()[0];
    }
  }
);
}
