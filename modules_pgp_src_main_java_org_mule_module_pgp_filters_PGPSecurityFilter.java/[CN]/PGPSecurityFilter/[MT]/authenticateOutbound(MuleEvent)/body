{
  logger.debug("authenticateOutbound:" + event.getId());
  if (!isAuthenticate()) {
    return;
  }
  MuleMessage message=event.getMessage();
  PGPPublicKey userKeyBundle=keyManager.getPublicKey((String)getCredentialsAccessor().getCredentials(event));
  final PGPCryptInfo cryptInfo=new PGPCryptInfo(userKeyBundle,signRequired);
  try {
    updatePayload(event.getMessage(),strategy.encrypt(event.getMessageAsBytes(),cryptInfo),event);
  }
 catch (  Exception e1) {
    throw new UnauthorisedException(CoreMessages.failedToReadPayload(),event,e1);
  }
}
