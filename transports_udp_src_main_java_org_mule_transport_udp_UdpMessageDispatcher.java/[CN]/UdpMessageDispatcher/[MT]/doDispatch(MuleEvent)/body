{
  ImmutableEndpoint ep=event.getEndpoint();
  DatagramSocket socket=connector.getSocket(ep);
  try {
    byte[] payload=event.transformMessageToBytes();
    int port=ep.getEndpointURI().getPort();
    InetAddress inetAddress=null;
    if ("null".equalsIgnoreCase(ep.getEndpointURI().getHost())) {
      inetAddress=InetAddress.getLocalHost();
    }
 else {
      inetAddress=InetAddress.getByName(ep.getEndpointURI().getHost());
    }
    write(socket,payload,port,inetAddress);
  }
  finally {
    connector.releaseSocket(socket,ep);
  }
}
