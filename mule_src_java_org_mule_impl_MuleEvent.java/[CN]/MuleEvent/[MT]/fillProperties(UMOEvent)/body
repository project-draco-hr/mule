{
  if (previousEvent != null && previousEvent.getProperties() != null) {
    properties.putAll(previousEvent.getProperties());
  }
  if (endpoint != null && endpoint.getProperties() != null) {
    properties.putAll(endpoint.getProperties());
    if (endpoint.getEndpointURI().getParams() != null) {
      properties.putAll(endpoint.getEndpointURI().getParams());
    }
  }
  properties.putAll(message.getProperties());
  setCredentials();
}
