{
  Object src=message.getPayload();
  if (src instanceof byte[]) {
    try {
      Reader xml=new InputStreamReader(new ByteArrayInputStream((byte[])src),outputEncoding);
      return getXStream().fromXML(xml);
    }
 catch (    UnsupportedEncodingException uee) {
      throw new TransformerException(this,uee);
    }
  }
 else   if (src instanceof InputStream) {
    try {
      Reader xml=new InputStreamReader((InputStream)src,outputEncoding);
      return getXStream().fromXML(xml);
    }
 catch (    UnsupportedEncodingException uee) {
      throw new TransformerException(this,uee);
    }
 finally {
      try {
        ((InputStream)src).close();
      }
 catch (      IOException e) {
        logger.warn("Exception closing stream: ",e);
      }
    }
  }
 else   if (src instanceof String) {
    return getXStream().fromXML(src.toString());
  }
 else {
    return getXStream().fromXML((String)domTransformer.transform(src));
  }
}
