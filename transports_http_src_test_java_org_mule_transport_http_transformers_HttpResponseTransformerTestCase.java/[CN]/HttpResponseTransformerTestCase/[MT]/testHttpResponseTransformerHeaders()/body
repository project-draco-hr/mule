{
  HttpResponseTransformer httpResponseTransformer=createHttpResponseTransformer();
  DefaultMuleMessage muleMessage=new DefaultMuleMessage(HTTP_BODY,muleContext);
  Map<String,String> headers=new HashMap<String,String>();
  headers.put("Allow",HEADER_ALLOW);
  headers.put("Cache-Control",HEADER_CACHE_CONTROL);
  headers.put("Connection",HEADER_CONNECTION);
  headers.put("Content-Encoding",HEADER_CONTENT_ENCODING);
  headers.put("Expires",HEADER_EXPIRES);
  headers.put("Location",HEADER_LOCATION);
  headers.put("Transfer-Encoding",HEADER_TRANSFER_ENCODING);
  httpResponseTransformer.setHeaders(headers);
  when(mockExpressionManager.isExpression(HEADER_ALLOW)).thenReturn(true);
  when(mockExpressionManager.evaluate(HEADER_ALLOW,muleMessage)).thenReturn("GET, HEAD");
  when(mockExpressionManager.isExpression(HEADER_CACHE_CONTROL)).thenReturn(true);
  when(mockExpressionManager.evaluate(HEADER_CACHE_CONTROL,muleMessage)).thenReturn("max-age=3600");
  when(mockExpressionManager.isExpression(HEADER_CONNECTION)).thenReturn(true);
  when(mockExpressionManager.evaluate(HEADER_CONNECTION,muleMessage)).thenReturn("close");
  when(mockExpressionManager.isExpression(HEADER_CONTENT_ENCODING)).thenReturn(true);
  when(mockExpressionManager.evaluate(HEADER_CONTENT_ENCODING,muleMessage)).thenReturn("gzip");
  when(mockExpressionManager.isExpression(HEADER_EXPIRES)).thenReturn(true);
  when(mockExpressionManager.evaluate(HEADER_EXPIRES,muleMessage)).thenReturn("Thu, 01 Dec 1994 16:00:00 GMT");
  when(mockExpressionManager.isExpression(HEADER_LOCATION)).thenReturn(true);
  when(mockExpressionManager.evaluate(HEADER_LOCATION,muleMessage)).thenReturn("http://localhost:8080");
  when(mockExpressionManager.isExpression(HEADER_TRANSFER_ENCODING)).thenReturn(true);
  when(mockExpressionManager.evaluate(HEADER_TRANSFER_ENCODING,muleMessage)).thenReturn("chunked");
  HttpResponse httpResponse=(HttpResponse)httpResponseTransformer.transformMessage(muleMessage,"UTF-8");
  validateHeaders(httpResponse.getHeaders());
}
