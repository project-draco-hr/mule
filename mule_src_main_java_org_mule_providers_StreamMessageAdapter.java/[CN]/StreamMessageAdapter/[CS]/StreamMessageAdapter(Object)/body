{
  try {
    if (message instanceof OutputStream) {
      out=(OutputStream)message;
    }
 else     if (message instanceof String) {
      out=new ByteArrayOutputStream(message.toString().length());
      out.write(StringMessageUtils.getBytes(message.toString()));
    }
 else     if (message instanceof byte[]) {
      out=new ByteArrayOutputStream(((byte[])message).length);
      out.write((byte[])message);
    }
 else {
      throw new MessageTypeNotSupportedException(message,getClass());
    }
  }
 catch (  IOException e) {
    throw new MessageTypeNotSupportedException(message,getClass(),e);
  }
}
