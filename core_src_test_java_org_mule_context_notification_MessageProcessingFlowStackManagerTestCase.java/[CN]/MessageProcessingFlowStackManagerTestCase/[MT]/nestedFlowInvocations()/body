{
  MuleEvent event=buildEvent("nestedFlowInvocations");
  String flowName=ROOT_FLOW_NAME;
  PipelineMessageNotification pipelineNotification=buildPipelineNotification(event,flowName);
  assertThat(getContextInfo(event),is(""));
  manager.onPipelineNotificationStart(pipelineNotification);
  PipelineMessageNotification pipelineNotificationNested=mock(PipelineMessageNotification.class);
  when(event.getId()).thenReturn("nestedFlowInvocations");
  when(pipelineNotificationNested.getSource()).thenReturn(event);
  when(pipelineNotificationNested.getResourceIdentifier()).thenReturn(NESTED_FLOW_NAME);
  manager.onPipelineNotificationStart(pipelineNotificationNested);
  assertThat(getContextInfo(event),is("at " + NESTED_FLOW_NAME + System.lineSeparator()+ "at "+ flowName));
  manager.onPipelineNotificationComplete(pipelineNotificationNested);
  assertThat(getContextInfo(event),is("at " + flowName));
  manager.onPipelineNotificationComplete(pipelineNotification);
  assertThat(getContextInfo(event),is(""));
}
