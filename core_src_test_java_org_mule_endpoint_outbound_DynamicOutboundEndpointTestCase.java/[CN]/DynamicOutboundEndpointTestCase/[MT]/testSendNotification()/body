{
  TestEndpointMessageNotificationListener listener=new TestEndpointMessageNotificationListener();
  muleContext.registerListener(listener);
  OutboundEndpoint endpoint=createOutboundEndpoint(null,null,null,null,MessageExchangePattern.REQUEST_RESPONSE,null);
  MuleEvent outboundEvent=createTestOutboundEvent();
  endpoint.process(outboundEvent);
  assertEventSent();
  assertTrue(listener.latch.await(RECEIVE_TIMEOUT,TimeUnit.MILLISECONDS));
  assertEquals(EndpointMessageNotification.MESSAGE_SENT,listener.messageNotification.getAction());
  assertTrue(listener.messageNotification.getSource() instanceof MuleMessage);
  assertEquals(outboundEvent.getMessage().getPayload(),listener.messageNotification.getSource().getPayload());
}
