{
  MuleEvent event=(MuleEvent)message.get(MULE_EVENT_PROPERTY);
  MuleMessage muleMsg;
  if (event == null) {
    muleMsg=(MuleMessage)message.get(CxfConstants.MULE_MESSAGE);
  }
 else {
    muleMsg=event.getMessage();
  }
  Collection<Attachment> atts=message.getAttachments();
  if (atts != null) {
    muleMsg.setProperty(CxfConstants.ATTACHMENTS,atts,PropertyScope.OUTBOUND);
    muleMsg.setProperty(HttpConstants.HEADER_CONTENT_TYPE,muleMsg.getProperty(HttpConstants.HEADER_CONTENT_TYPE),PropertyScope.OUTBOUND);
  }
}
