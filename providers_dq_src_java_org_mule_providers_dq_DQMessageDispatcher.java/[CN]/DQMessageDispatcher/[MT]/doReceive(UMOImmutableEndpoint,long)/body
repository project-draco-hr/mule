{
  DataQueue dq=new DataQueue(connector.getSystem(),endpoint.getEndpointURI().getAddress());
  DataQueueEntry entry=dq.read((int)timeout);
  if (entry != null) {
    RecordFormat format=getRecordFormat(endpoint.getEndpointURI());
    DQMessage message=DQMessageUtils.getDQMessage(entry.getData(),format);
    message.setSenderInformation(entry.getSenderInformation());
    return new MuleMessage(connector.getMessageAdapter(message));
  }
  return null;
}
