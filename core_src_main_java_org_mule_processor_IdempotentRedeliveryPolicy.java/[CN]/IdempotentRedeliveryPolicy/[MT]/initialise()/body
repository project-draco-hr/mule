{
  super.initialise();
  if (useSecureHash && idExpression != null) {
    throw new InitialisationException(CoreMessages.initialisationFailure(String.format("The Id expression'%s' was specified when a secure hash will be used",idExpression)),this);
  }
  if (!useSecureHash && messageDigestAlgorithm != null) {
    throw new InitialisationException(CoreMessages.initialisationFailure(String.format("The message digest algorithm '%s' was specified when a secure hash will not be used",messageDigestAlgorithm)),this);
  }
  if (!useSecureHash && idExpression == null) {
    throw new InitialisationException(CoreMessages.initialisationFailure("No method for identifying messages was specified"),this);
  }
  if (useSecureHash) {
    if (messageDigestAlgorithm == null) {
      messageDigestAlgorithm="SHA-256";
    }
    try {
      MessageDigest md=MessageDigest.getInstance(messageDigestAlgorithm);
    }
 catch (    NoSuchAlgorithmException e) {
      throw new InitialisationException(CoreMessages.initialisationFailure(String.format("Exception '%s' initializing message digest algorithm %s",e.getMessage(),messageDigestAlgorithm)),this);
    }
  }
  store=createStore();
}
