{
  super();
  if (requestLine == null) {
    throw new IllegalArgumentException("Request line may not be null");
  }
  this.defaultEncoding=defaultEncoding;
  this.requestLine=requestLine;
  if (headers != null) {
    this.headers.setHeaders(headers);
  }
  if (content != null) {
    String methodname=requestLine.getMethod();
    if (HttpConstants.METHOD_POST.equalsIgnoreCase(methodname) || HttpConstants.METHOD_PUT.equalsIgnoreCase(methodname)) {
      Header contentLength=this.headers.getFirstHeader(HttpConstants.HEADER_CONTENT_LENGTH);
      Header transferEncoding=this.headers.getFirstHeader(HttpConstants.HEADER_TRANSFER_ENCODING);
      InputStream in=content;
      if (sync) {
        in=new ByteArrayInputStream(IOUtils.toByteArray((InputStream)in));
      }
 else {
        if (transferEncoding != null) {
          if (transferEncoding.getValue().indexOf(HttpConstants.TRANSFER_ENCODING_CHUNKED) != -1) {
            in=new ChunkedInputStream(in);
          }
        }
 else         if (contentLength != null) {
          long len=getContentLength();
          if (len >= 0) {
            in=new ContentLengthInputStream(in,len);
          }
        }
      }
      this.entity=in;
    }
  }
}
