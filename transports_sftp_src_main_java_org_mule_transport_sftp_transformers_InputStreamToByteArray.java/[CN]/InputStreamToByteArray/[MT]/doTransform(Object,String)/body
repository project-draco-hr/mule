{
  if (msg instanceof InputStream) {
    InputStream inputStream=null;
    try {
      inputStream=(InputStream)msg;
      ByteArrayOutputStream baos=new ByteArrayOutputStream();
      byte[] buffer=new byte[1024];
      int len;
      while ((len=inputStream.read(buffer)) > 0) {
        baos.write(buffer,0,len);
      }
      return baos.toByteArray();
    }
 catch (    Exception e) {
      throw new TransformerException(this,e);
    }
 finally {
      IOUtils.closeQuietly(inputStream);
    }
  }
 else {
    throw new TransformerException(MessageFactory.createStaticMessage("Message is not an instance of java.io.InputStream"),this);
  }
}
