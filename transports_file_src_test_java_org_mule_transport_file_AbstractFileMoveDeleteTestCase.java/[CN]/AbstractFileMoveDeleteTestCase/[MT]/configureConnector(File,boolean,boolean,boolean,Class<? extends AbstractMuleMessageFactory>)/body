{
  FileConnector fc=new FileConnector(muleContext);
  if (messageFactoryClass != null) {
    Map<String,String> overrides=new HashMap<String,String>();
    overrides.put("message.factory",messageFactoryClass.getName());
    fc.setServiceOverrides(overrides);
  }
  fc.setName("moveDeleteConnector");
  File moveToDir=new File(inFile.getParent() + "/moveto/");
  moveToDir.mkdir();
  muleContext.getRegistry().registerConnector(fc);
  if (move) {
    fc.setMoveToDirectory(moveToDir.getPath());
  }
  fc.setAutoDelete(delete);
  fc.setStreaming(stream);
  return moveToDir;
}
