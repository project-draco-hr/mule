{
  String providerName=System.getProperty(MuleProperties.MULE_SECURITY_PROVIDER_PROPERTY);
  Provider provider=null;
  if (providerName == null) {
    if (!isFipsSecurityModel()) {
      provider=Security.getProvider(PREFERED_PROVIDER_NAME);
    }
    if (provider == null) {
      Provider[] providers=Security.getProviders();
      if (providers.length > 0) {
        provider=providers[0];
      }
    }
  }
 else {
    provider=Security.getProvider(providerName);
  }
  if (provider == null) {
    throw new IllegalStateException("Can't find a suitable security provider. " + (providerName == null ? "" : "Provider name " + providerName + " was not found."));
  }
  return provider;
}
