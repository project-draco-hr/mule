{
  final String descriptorName="TEST_COMPONENT_1";
  MuleDescriptor descriptor=getTestDescriptor(descriptorName,"java.lang.Object");
  MuleDescriptor duplicateDescriptor=getTestDescriptor(descriptorName,"java.lang.Object");
  final UMOModel model=getDefaultModel();
  MuleManager.getRegistry().registerComponent(descriptor,model.getName());
  try {
    MuleManager.getRegistry().registerComponent(duplicateDescriptor,model.getName());
    fail("Trying to register a component descriptor with the same name " + "must have thrown an exception.");
  }
 catch (  RegistryException e) {
    final String message=e.getMessage();
    assertTrue("Exception message should contain our descriptor name.",(message.indexOf("\"" + descriptorName + "\"") > -1));
  }
  int componentCount=0;
  for (Iterator it=model.getComponentNames(); it.hasNext(); ) {
    it.next();
    componentCount++;
  }
  assertEquals("Wrong number of components registered in the model.",1,componentCount);
}
