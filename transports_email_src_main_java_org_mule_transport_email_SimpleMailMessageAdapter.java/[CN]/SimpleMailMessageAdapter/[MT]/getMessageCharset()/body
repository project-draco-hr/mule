{
  try {
    String ct=message.getDataHandler().getContentType();
    MimeType mt=new MimeType(ct);
    return mt.getParameter("charset");
  }
 catch (  Exception e) {
    String charset=System.getProperty("file.encoding");
    if (logger.isWarnEnabled()) {
      logger.warn("Unable to read charset from message. Defaulting to the system default: " + charset,e);
    }
    return charset;
  }
}
