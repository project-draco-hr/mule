{
  if (contentBuffer == null) {
    String contentType=messagePart.getContentType();
    if (contentType.startsWith("text/")) {
      InputStream is=messagePart.getInputStream();
      if (!(is instanceof BufferedInputStream)) {
        is=new BufferedInputStream(is);
      }
      BufferedReader reader=new BufferedReader(new InputStreamReader(is));
      StringBuffer buffer=new StringBuffer(32768);
      String line;
      while ((line=reader.readLine()) != null) {
        buffer.append(line).append(SystemUtils.LINE_SEPARATOR);
      }
      contentBuffer=buffer.toString().getBytes();
    }
 else {
      contentBuffer=getPayloadAsBytes();
    }
  }
  return new String(contentBuffer,encoding);
}
