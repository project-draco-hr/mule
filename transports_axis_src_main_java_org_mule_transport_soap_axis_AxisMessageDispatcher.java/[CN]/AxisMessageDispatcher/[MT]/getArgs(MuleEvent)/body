{
  Object payload=event.getMessage().getPayload();
  Object[] args;
  if (payload instanceof Object[]) {
    args=(Object[])payload;
  }
 else {
    args=new Object[]{payload};
  }
  if (event.getMessage().getOutboundAttachmentNames() != null && event.getMessage().getOutboundAttachmentNames().size() > 0) {
    ArrayList attachments=new ArrayList();
    Iterator i=event.getMessage().getOutboundAttachmentNames().iterator();
    while (i.hasNext()) {
      attachments.add(event.getMessage().getOutboundAttachment((String)i.next()));
    }
    ArrayList temp=new ArrayList(Arrays.asList(args));
    temp.add(attachments.toArray(new DataHandler[attachments.size()]));
    args=temp.toArray();
  }
  return args;
}
