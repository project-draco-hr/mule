{
  MuleMessage response=null;
  response=flowRunner("refServiceOne").withPayload("a request").withInboundProperty("method","retrieveReferenceData").run().getMessage();
  Object payload=response.getPayload();
  assertThat(payload,instanceOf(String.class));
  assertThat(payload,is("ServiceOne"));
  response=flowRunner("refServiceTwo").withPayload("another request").withInboundProperty("method","retrieveReferenceData").run().getMessage();
  payload=response.getPayload();
  if ((payload == null) || (response.getExceptionPayload() != null)) {
    DefaultExceptionPayload exPld=(DefaultExceptionPayload)response.getExceptionPayload();
    if (exPld.getException() != null) {
      fail(exPld.getException().getMessage());
    }
 else {
      fail(exPld.toString());
    }
  }
  assertThat(payload,instanceOf(String.class));
  assertThat(payload,is("ServiceTwo"));
}
