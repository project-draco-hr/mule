{
  MuleClient client=muleContext.getClient();
  MuleMessage response=null;
  HashMap<String,Object> propertyMap=new HashMap<String,Object>();
  propertyMap.put("method","retrieveReferenceData");
  response=client.send("refOneInbound","a request",propertyMap);
  Object payload=response.getPayload();
  assertTrue("should be a string",payload instanceof String);
  assertEquals("ServiceOne",payload);
  response=client.send("refTwoInbound","another request",propertyMap);
  payload=response.getPayload();
  if ((payload == null) || (response.getExceptionPayload() != null)) {
    DefaultExceptionPayload exPld=(DefaultExceptionPayload)response.getExceptionPayload();
    if (exPld.getException() != null) {
      fail(exPld.getException().getMessage());
    }
 else {
      fail(exPld.toString());
    }
  }
  assertTrue("should be a string",payload instanceof String);
  assertEquals("ServiceTwo",payload);
}
