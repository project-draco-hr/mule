{
  Transformer transformer=new MockTransformerBuilder().from(DataType.BYTE_ARRAY).to(DataType.STRING).returning("bar").build();
  Transformer converter=new MockConverterBuilder().from(DataType.STRING).to(DataType.BYTE_ARRAY).returning("bar".getBytes()).build();
  when(conversionResolver.resolve(any(DataType.class),anyList())).thenReturn(converter);
  MuleMessage message=MuleMessage.builder().payload("TEST").build();
  message=transformationService.applyTransformers(message,null,transformer);
  assertEquals("bar",message.getPayload());
  verifyTransformerExecuted(transformer);
  verifyTransformerExecuted(converter);
}
