{
  String remoteEndpoint="vm://remote.queue?connector=vmRemoteQueueConnector";
  MuleClient client=new MuleClient();
  RegistryContext.getConfiguration().setDefaultSynchronousEndpoints(true);
  RemoteDispatcher dispatcher=client.getRemoteDispatcher(getRemoteEndpointUri());
  MuleMessage message=dispatcher.receiveRemote(remoteEndpoint,2000);
  assertNull(message);
  dispatcher.sendRemote(remoteEndpoint,"Test Remote Message 2",null);
  message=dispatcher.receiveRemote(remoteEndpoint,3000);
  assertNotNull(message);
  assertEquals("Test Remote Message 2",message.getPayload());
}
