{
  final ClassLoader ccl=Thread.currentThread().getContextClassLoader();
  ConcurrentMap<String,Logger> loggerMap=repositories.get(ccl);
  if (loggerMap == null) {
    loggerMap=new ConcurrentHashMap<String,Logger>();
    repositories.put(ccl,loggerMap);
  }
  Logger slf4jLogger=loggerMap.get(name);
  if (slf4jLogger == null) {
    org.apache.log4j.Logger log4jLogger;
    if (name.equalsIgnoreCase(Logger.ROOT_LOGGER_NAME)) {
      log4jLogger=LogManager.getRootLogger();
    }
 else {
      log4jLogger=LogManager.getLogger(name);
    }
    slf4jLogger=new AccessibleLog4jLoggerAdapter(log4jLogger);
    final Logger previous=loggerMap.putIfAbsent(name,slf4jLogger);
    if (previous != null) {
      slf4jLogger=previous;
    }
  }
  return slf4jLogger;
}
