{
  if (c == null) {
    c=Locator.class.getClassLoader();
  }
  URL url=null;
  if (c == null) {
    url=ClassLoader.getSystemResource(resource);
  }
 else {
    url=c.getResource(resource);
  }
  if (url != null) {
    String u=url.toString();
    if (u.startsWith("jar:file:")) {
      int pling=u.indexOf("!");
      String jarName=u.substring(4,pling);
      return new File(fromURI(jarName));
    }
 else     if (u.startsWith("file:")) {
      int tail=u.indexOf(resource);
      String dirName=u.substring(0,tail);
      return new File(fromURI(dirName));
    }
  }
  return null;
}
