{
  latch=new CountDownLatch(1);
  muleContext.registerListener(new RoutingNotificationListener<RoutingNotification>(){
    @Override public void onNotification(    RoutingNotification notification){
      if (notification.getAction() == RoutingNotification.MISSED_AGGREGATION_GROUP_EVENT) {
        latch.countDown();
        assertEquals("test Received Late!",((MuleMessage)notification.getSource()).getPayload());
      }
    }
  }
);
  String message="test";
  MuleClient client=muleContext.getClient();
  MuleMessage result=client.send("vm://distributor.queue",message,null);
  assertNotNull(result);
  assertTrue(result.getPayload() instanceof List);
  List<MuleMessage> results=(List<MuleMessage>)result.getPayload();
  assertEquals(2,results.size());
  for (int i=0; i < results.size(); i++) {
    MuleMessage msg=results.get(i);
    assertEquals("test Received",msg.getPayload());
  }
  assertTrue(latch.await(3000,TimeUnit.MILLISECONDS));
}
