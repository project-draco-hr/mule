{
  MuleContext ctx=ctxBuilder.buildMuleContext();
  ctx.initialise();
  new DefaultsConfigurationBuilder().configure(ctx);
  final AtomicBoolean startingNotifFired=new AtomicBoolean(false);
  final AtomicBoolean startedNotifFired=new AtomicBoolean(false);
  ctx.registerListener(new MuleContextNotificationListener<MuleContextNotification>(){
    public void onNotification(    MuleContextNotification notification){
      if (notification.getAction() == MuleContextNotification.CONTEXT_STARTING) {
        startingNotifFired.set(true);
      }
      if (notification.getAction() == MuleContextNotification.CONTEXT_STARTED) {
        startedNotifFired.set(true);
      }
    }
  }
);
  ctx.start();
  assertTrue("CONTEXT_STARTING notification never fired",startingNotifFired.get());
  assertTrue("CONTEXT_STARTED notification never fired",startedNotifFired.get());
  ctx.start();
}
