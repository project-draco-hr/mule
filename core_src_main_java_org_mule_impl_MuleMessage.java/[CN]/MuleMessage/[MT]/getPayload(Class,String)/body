{
  if (outputType == null) {
    return getPayload();
  }
  Class inputCls=getPayload().getClass();
  if (Proxy.isProxyClass(inputCls)) {
    inputCls=inputCls.getInterfaces()[0];
  }
  if (outputType.isAssignableFrom(inputCls)) {
    return getPayload();
  }
  UMOTransformer transformer=null;
  try {
    transformer=RegistryContext.getRegistry().lookupTransformer(inputCls,outputType);
  }
 catch (  RegistrationException e) {
    throw new TransformerException(CoreMessages.failedToLoad("transformers"),e);
  }
  if (transformer == null) {
    throw new TransformerException(CoreMessages.noTransformerFoundForMessage(inputCls,outputType));
  }
  Object result=transformer.transform(this);
  if (!outputType.isAssignableFrom(result.getClass())) {
    throw new TransformerException(CoreMessages.transformOnObjectNotOfSpecifiedType(outputType.getName(),result.getClass()));
  }
  if (isPayloadConsumed(inputCls)) {
    setPayload(result);
  }
  return result;
}
