{
  if (closed.compareAndSet(false,true)) {
    if (logger.isDebugEnabled()) {
      logger.debug("Closing the stream for the file " + fileName);
    }
    try {
      super.close();
    }
 catch (    IOException e) {
      logger.error("Error occurred while closing file " + fileName,e);
      throw e;
    }
    if (postProcessOnClose) {
      try {
        postProcess();
      }
 catch (      Exception e) {
        throw new MuleRuntimeException(e);
      }
    }
  }
}
