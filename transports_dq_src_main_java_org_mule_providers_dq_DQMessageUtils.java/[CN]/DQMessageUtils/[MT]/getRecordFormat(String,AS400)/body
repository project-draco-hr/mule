{
  log.debug("Record descriptor :" + recordDescriptor);
  if (recordDescriptor == null) {
    throw new Exception("Failed to read record descriptor : recordDescriptor property is not set ");
  }
  InputStream input=null;
  RecordFormat recordFormat=null;
  try {
    input=IOUtils.getResourceAsStream(recordDescriptor,DQMessageUtils.class);
    if (input == null) {
      throw new Exception("Failed to read record descriptor  (" + recordDescriptor + ") cannot be found ");
    }
    recordFormat=parse(input,as400);
  }
  finally {
    if (input != null) {
      input.close();
    }
  }
  return recordFormat;
}
