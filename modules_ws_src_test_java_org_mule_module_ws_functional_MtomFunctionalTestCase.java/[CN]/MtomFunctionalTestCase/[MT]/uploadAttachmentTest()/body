{
  String request=String.format("<ns:uploadAttachment xmlns:ns=\"http://consumer.ws.module.mule.org/\">" + "<fileName>%s</fileName><attachment>" + "<xop:Include xmlns:xop=\"http://www.w3.org/2004/08/xop/include\" href=\"cid:testAttachmentId\"/>"+ "</attachment></ns:uploadAttachment>",TEST_FILE_ATTACHMENT);
  Flow flow=(Flow)getFlowConstruct("clientUploadAttachment");
  MuleEvent event=getTestEvent(request);
  addAttachment(event.getMessage(),TEST_FILE_ATTACHMENT,"testAttachmentId");
  event=flow.process(event);
  String expected="<ns2:uploadAttachmentResponse xmlns:ns2=\"http://consumer.ws.module.mule.org/\">" + "<result>OK</result></ns2:uploadAttachmentResponse>";
  assertXMLEqual(expected,getPayloadAsString(event.getMessage()));
}
