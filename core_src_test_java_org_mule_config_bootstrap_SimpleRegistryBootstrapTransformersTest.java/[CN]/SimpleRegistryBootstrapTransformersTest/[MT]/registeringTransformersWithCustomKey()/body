{
  Properties properties=new Properties();
  properties.setProperty("core.transformer.1",ExpectedKeyTransformer.class.getName());
  properties.setProperty("custom1",CustomKeyTransformer.class.getName());
  TestTransformerResolver transformerResolver=new TestTransformerResolver();
  muleContext.getRegistry().registerObject("testTransformerResolver",transformerResolver);
  final BootstrapServiceDiscoverer bootstrapServiceDiscoverer=new TestBootstrapServiceDiscoverer(properties);
  ((DefaultMuleContext)muleContext).setBootstrapServiceDiscoverer(bootstrapServiceDiscoverer);
  SimpleRegistryBootstrap registryBootstrap=new SimpleRegistryBootstrap();
  registryBootstrap.setMuleContext(muleContext);
  registryBootstrap.initialise();
  assertEquals(2,transformerResolver.getTransformersCount());
  assertTrue(transformerResolver.contains(ExpectedKeyTransformer.class));
  assertTrue(transformerResolver.contains(CustomKeyTransformer.class));
}
