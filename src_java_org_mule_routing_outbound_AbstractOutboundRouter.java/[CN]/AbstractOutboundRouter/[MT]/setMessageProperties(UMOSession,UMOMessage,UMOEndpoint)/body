{
  if (replyTo != null) {
    message.setReplyTo(replyTo);
    message.setProperty(MuleProperties.MULE_REPLY_TO_REQUESTOR_PROPERTY,session.getComponent().getDescriptor().getName());
    if (logger.isDebugEnabled()) {
      logger.debug("Setting replyTo=" + replyTo + " for outbound endpoint: "+ endpoint.getEndpointURI());
    }
  }
  if (enableCorrelation != ENABLE_CORRELATION_NEVER) {
    boolean correlationSet=message.getCorrelationId() != null;
    if (correlationSet && (enableCorrelation == ENABLE_CORRELATION_IF_NOT_SET)) {
      logger.debug("CorrelationId is already set, not setting it again");
      return;
    }
 else     if (correlationSet) {
      logger.debug("CorrelationId is already set, but router is configured to overwrite it");
    }
    String correlation=null;
    Object o=propertyExtractor.getProperty(MuleProperties.MULE_CORRELATION_ID_PROPERTY,message);
    if (logger.isDebugEnabled()) {
      logger.debug("Extracted correlation Id as: " + o);
    }
    correlation=o.toString();
    int seq=1;
    int group=1;
    if (logger.isDebugEnabled()) {
      StringBuffer buf=new StringBuffer();
      buf.append("Setting Correlation info on Outbound router for endpoint: ").append(endpoint.getEndpointURI());
      buf.append("\n").append("Id=").append(correlation);
      logger.debug(buf.toString());
    }
    message.setCorrelationId(correlation);
  }
}
