{
  String payloadFactoryClass=((OracleJmsConnector)connector).getPayloadFactory();
  if ((endpointProperties != null) && (endpointProperties.get(OracleJmsConnector.PAYLOADFACTORY_PROPERTY) != null)) {
    payloadFactoryClass=(String)endpointProperties.get(OracleJmsConnector.PAYLOADFACTORY_PROPERTY);
  }
  Object payloadFactory=null;
  if (payloadFactoryClass != null) {
    Throwable ex=null;
    try {
      payloadFactory=ClassUtils.loadClass(payloadFactoryClass,this.getClass()).newInstance();
    }
 catch (    ClassNotFoundException e) {
      ex=e;
    }
catch (    IllegalAccessException e) {
      ex=e;
    }
catch (    InstantiationException e) {
      ex=e;
    }
    if (ex != null) {
      throw new JMSException("Unable to instantiate payload factory class " + payloadFactoryClass + ": "+ ex.getMessage());
    }
  }
  return payloadFactory;
}
