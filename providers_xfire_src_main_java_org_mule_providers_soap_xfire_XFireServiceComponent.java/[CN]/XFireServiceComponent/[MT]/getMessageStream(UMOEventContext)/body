{
  InputStream is=null;
  if (context.getMessage().getPayload() instanceof InputStream) {
    is=(InputStream)context.getMessage().getPayload();
  }
 else   if (context.getMessage().getAdapter() instanceof StreamMessageAdapter) {
    StreamMessageAdapter sma=(StreamMessageAdapter)context.getMessage().getAdapter();
    if (sma.getInput() != null) {
      is=sma.getInput();
    }
 else {
      is=sma.getResponse();
    }
  }
 else {
    String method=context.getStringProperty(HttpConnector.HTTP_METHOD_PROPERTY);
    if (method != null && method.equalsIgnoreCase(HttpConstants.METHOD_GET)) {
      String data=(String)new GetRequestToSoapRequest().transform(context.getTransformedMessageAsString());
      is=new ByteArrayInputStream(data.getBytes());
    }
 else {
      is=new ByteArrayInputStream(context.getTransformedMessageAsBytes());
    }
  }
  return is;
}
