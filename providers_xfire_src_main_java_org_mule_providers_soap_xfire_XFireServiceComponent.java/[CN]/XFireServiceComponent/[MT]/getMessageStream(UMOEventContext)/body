{
  InputStream is;
  UMOMessage eventMsg=context.getMessage();
  Object eventMsgPayload=eventMsg.getPayload();
  if (eventMsgPayload instanceof InputStream) {
    is=(InputStream)eventMsgPayload;
  }
 else   if (eventMsg.getAdapter() instanceof StreamMessageAdapter) {
    StreamMessageAdapter sma=(StreamMessageAdapter)eventMsg.getAdapter();
    if (sma.getInput() != null) {
      is=sma.getInput();
    }
 else {
      is=sma.getResponse();
    }
  }
 else {
    String method=context.getStringProperty(HttpConnector.HTTP_METHOD_PROPERTY,null);
    if (method != null && method.equalsIgnoreCase(HttpConstants.METHOD_GET)) {
      String data=(String)new GetRequestToSoapRequest().transform(context.getTransformedMessageAsString());
      is=new ByteArrayInputStream(data.getBytes());
    }
 else {
      is=new ByteArrayInputStream(context.getTransformedMessageAsBytes());
    }
  }
  return is;
}
