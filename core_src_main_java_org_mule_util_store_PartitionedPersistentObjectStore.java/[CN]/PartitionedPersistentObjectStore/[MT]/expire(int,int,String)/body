{
  File partitionFolder=FileUtils.newFile(storeDirectory,partitionName);
  File[] files=partitionFolder.listFiles();
  if (files == null) {
    return;
  }
  Arrays.sort(files,new Comparator<File>(){
    public int compare(    File f1,    File f2){
      int result=Long.valueOf(f1.lastModified()).compareTo(f2.lastModified());
      if (result == 0) {
        result=f1.getName().compareTo(f2.getName());
      }
      return result;
    }
  }
);
  int startIndex=trimToMaxSize(files,maxEntries);
  final long now=System.currentTimeMillis();
  for (int i=startIndex; i < files.length; i++) {
    if (files[i].getName().endsWith(FILE_EXTENSION)) {
      Long lastModified=files[i].lastModified();
      if ((now - lastModified) >= entryTTL) {
        deleteStoreFile(files[i]);
      }
 else {
        break;
      }
    }
  }
}
