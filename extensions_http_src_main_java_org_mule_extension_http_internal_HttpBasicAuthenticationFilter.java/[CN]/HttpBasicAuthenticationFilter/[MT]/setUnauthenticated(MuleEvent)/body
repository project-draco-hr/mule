{
  String realmHeader="Basic realm=";
  if (realm != null) {
    realmHeader+="\"" + realm + "\"";
  }
  Map<String,String> headers=getFlowVariableOrNull(headersFlowVar,event);
  Builder builder=MuleEvent.builder(event);
  if (headers == null) {
    headers=new HashMap<>();
    builder.addFlowVariable(headersFlowVar,headers);
  }
  headers.put(WWW_AUTHENTICATE,realmHeader);
  builder.addFlowVariable(statusCodeFlowVar,UNAUTHORIZED.getStatusCode());
  return builder.build();
}
