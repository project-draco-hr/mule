{
  String realmHeader="Basic realm=";
  if (realm != null) {
    realmHeader+="\"" + realm + "\"";
  }
  Map<String,String> headers=getFlowVariableOrNull(headersFlowVar,event);
  if (headers == null) {
    headers=new HashMap<>();
    event.setFlowVariable(headersFlowVar,headers);
  }
  headers.put(WWW_AUTHENTICATE,realmHeader);
  event.setFlowVariable(statusCodeFlowVar,UNAUTHORIZED.getStatusCode());
}
