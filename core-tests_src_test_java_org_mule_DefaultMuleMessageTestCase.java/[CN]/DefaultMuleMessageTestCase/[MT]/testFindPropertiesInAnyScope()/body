{
  MuleMessage message=createMuleMessage();
  message.removeProperty("MuleMessage",OUTBOUND);
  RequestContext.setEvent(new DefaultMuleEvent(message,getTestFlow()));
  message.setOutboundProperty(FOO_PROPERTY,"fooOutbound");
  message.setInvocationProperty("bar","barInvocation");
  message.setInvocationProperty(FOO_PROPERTY,"fooInvocation");
  message.setProperty(FOO_PROPERTY,"fooInbound",PropertyScope.INBOUND);
  message.setProperty(FOO_PROPERTY,"fooSession",SESSION);
  assertEquals(2,message.getInvocationPropertyNames().size());
  assertEquals(1,message.getOutboundPropertyNames().size());
  assertEquals(1,message.getInboundPropertyNames().size());
  assertEquals(1,message.getPropertyNames(SESSION).size());
  String value=message.findPropertyInAnyScope(FOO_PROPERTY,null);
  assertEquals("fooOutbound",value);
  message.removeProperty(FOO_PROPERTY,OUTBOUND);
  value=message.findPropertyInAnyScope(FOO_PROPERTY,null);
  assertEquals("fooInvocation",value);
  message.removeProperty(FOO_PROPERTY,PropertyScope.INVOCATION);
  value=message.findPropertyInAnyScope(FOO_PROPERTY,null);
  assertEquals("fooSession",value);
  message.removeProperty(FOO_PROPERTY,SESSION);
  value=message.findPropertyInAnyScope(FOO_PROPERTY,null);
  assertEquals("fooInbound",value);
  value=message.findPropertyInAnyScope("bar",null);
  assertEquals("barInvocation",value);
}
