{
  AppBloodhound bh=new DefaultAppBloodhound();
  final ApplicationDescriptor descriptor=bh.fetch(appName);
  if (descriptor.isPrivileged()) {
    final PriviledgedMuleApplication delegate=new PriviledgedMuleApplication(descriptor);
    delegate.setDeploymentListener(deploymentListener);
    delegate.setDeploymentService(deploymentService);
    delegate.setCoreExtensions(coreExtensions);
    return new ApplicationWrapper(delegate);
  }
 else {
    final DefaultMuleApplication delegate=new DefaultMuleApplication(descriptor);
    delegate.setDeploymentListener(deploymentListener);
    return new ApplicationWrapper(delegate);
  }
}
