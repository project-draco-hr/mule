{
  super(connector,component,endpoint,new Long(0));
  this.connector=(JmsConnector)connector;
  this.frequency=endpoint.getTransactionConfig().getTimeout();
  if (this.connectionStrategy instanceof SingleAttemptConnectionStrategy) {
    this.reuseConsumer=true;
    this.reuseSession=true;
  }
  this.reuseConsumer=MapUtils.getBooleanValue(endpoint.getProperties(),"reuseConsumer",this.reuseConsumer);
  this.reuseSession=MapUtils.getBooleanValue(endpoint.getProperties(),"reuseSession",this.reuseSession);
  String resourceInfo=endpoint.getEndpointURI().getResourceInfo();
  boolean topic=(resourceInfo != null && "topic".equalsIgnoreCase(resourceInfo));
  useMultipleReceivers=!topic;
  try {
    redeliveryHandler=this.connector.createRedeliveryHandler();
    redeliveryHandler.setConnector(this.connector);
  }
 catch (  Exception e) {
    throw new InitialisationException(e,this);
  }
}
