{
  Object comparatorClassName=getEndpoint().getProperty(COMPARATOR_CLASS_NAME_PROPERTY);
  if (comparatorClassName != null) {
    Object reverseProperty=this.getEndpoint().getProperty(COMPARATOR_REVERSE_ORDER_PROPERTY);
    boolean reverse=false;
    if (reverseProperty != null) {
      reverse=Boolean.valueOf((String)reverseProperty);
    }
    Class<?> clazz=Class.forName(comparatorClassName.toString());
    Comparator<?> comparator=(Comparator<?>)clazz.newInstance();
    return reverse ? new ReverseComparator(comparator) : comparator;
  }
  return null;
}
