{
  client.getHttpConnectionManager().getParams().setSoTimeout(endpoint.getResponseTimeout());
  event=setPropertyFromEndpoint(event,HttpConnector.HTTP_CUSTOM_HEADERS_MAP_PROPERTY);
  InternalMessage msg=event.getMessage();
  HttpMethod httpMethod;
  Object body=event.getMessage().getPayload().getValue();
  if (body instanceof HttpMethod) {
    httpMethod=(HttpMethod)body;
  }
 else {
    httpMethod=(HttpMethod)sendTransformer.transform(msg);
  }
  httpMethod.setFollowRedirects("true".equalsIgnoreCase((String)endpoint.getProperty("followRedirects")));
  if ("false".equalsIgnoreCase((String)endpoint.getProperty("keepAlive"))) {
    httpMethod.setRequestHeader("Connection","close");
  }
  return httpMethod;
}
