{
  MuleEvent event=getTestEvent("");
  event.setFlowVariable("customMessage",customMessage);
  try {
    runFlow(flowName,event);
    fail("was expecting a failure");
  }
 catch (  Exception e) {
    Throwable cause=ExceptionUtils.getRootCause(e);
    assertThat(cause.getMessage(),is(expectedMessage));
  }
}
