{
  final FunctionalTestComponent ftc=getFunctionalTestComponent("test-service");
  final Latch latch=new Latch();
  ftc.setEventCallback(new EventCallback(){
    public void eventReceived(    MuleEventContext context,    Object component) throws Exception {
      latch.countDown();
    }
  }
);
  final Object validPayload=doTestValidMessageAck(serviceName);
  latch.await(getTestTimeoutSecs(),TimeUnit.SECONDS);
  assertEquals(1,ftc.getReceivedMessagesCount());
  assertEquals(validPayload,ftc.getLastReceivedMessage());
  ftc.initialise();
}
