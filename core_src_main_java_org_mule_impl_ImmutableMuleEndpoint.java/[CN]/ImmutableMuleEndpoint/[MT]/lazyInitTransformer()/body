{
  if (UninitialisedTransformer.getInstance() == transformer.get()) {
    UMOTransformer newTransformer=null;
    if (connector instanceof AbstractConnector) {
      if (UMOEndpoint.ENDPOINT_TYPE_SENDER.equals(type)) {
        newTransformer=((AbstractConnector)connector).getDefaultOutboundTransformer();
      }
 else       if (UMOEndpoint.ENDPOINT_TYPE_SENDER_AND_RECEIVER.equals(type)) {
        newTransformer=((AbstractConnector)connector).getDefaultInboundTransformer();
      }
 else {
        newTransformer=((AbstractConnector)connector).getDefaultInboundTransformer();
      }
      if (logger.isDebugEnabled()) {
        logger.debug("Creating new transformer " + newTransformer + " for endpoint "+ this+ " of type "+ type);
      }
    }
 else {
      logger.warn("Connector " + connector.getName() + " does not inherit AbstractConnector");
    }
    transformer.compareAndSet(UninitialisedTransformer.getInstance(),newTransformer);
    updateTransformerEndpoint();
  }
}
