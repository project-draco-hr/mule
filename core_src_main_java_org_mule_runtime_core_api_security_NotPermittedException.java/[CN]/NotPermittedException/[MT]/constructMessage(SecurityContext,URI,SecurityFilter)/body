{
  Message m;
  if (context == null) {
    m=CoreMessages.authSetButNoContext(filter.getClass().getName());
  }
 else {
    m=CoreMessages.authFailedForUser(context.getAuthentication().getPrincipal());
  }
  m.setNextMessage(CoreMessages.authorizationDeniedOnEndpoint(endpointURI));
  return m;
}
