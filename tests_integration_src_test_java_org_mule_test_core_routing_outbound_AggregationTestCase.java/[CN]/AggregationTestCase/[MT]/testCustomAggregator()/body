{
  MuleClient client=muleContext.getClient();
  flowRunner("SplitterFlow2").withPayload(PAYLOAD).asynchronously().run();
  MuleMessage msg=client.request("test://collectionCreated2",RECEIVE_TIMEOUT).getRight().get();
  assertNotNull(msg);
  assertNotNull(msg.getPayload());
  assertTrue(msg.getPayload() instanceof List);
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  for (  Object obj : (List<?>)msg.getPayload()) {
    assertTrue(obj instanceof MuleEvent);
    MuleEvent event=(MuleEvent)obj;
    assertTrue(event.getMessage().getPayload() instanceof byte[]);
    baos.write((byte[])event.getMessage().getPayload());
  }
  String aggregated=baos.toString();
  assertEquals(PAYLOAD,aggregated);
}
