{
  ImmutableEndpoint endpoint;
  EndpointBuilder endpointBuilder=getEndpointBuilder(epData);
  if (epData.getProperties() != null) {
    endpointBuilder.setProperties(epData.getProperties());
  }
  if (epData.getTransformers() != null) {
    List<Transformer> transformers=(List)convertProperty(List.class,epData.getTransformers());
    endpointBuilder.setTransformers(transformers);
  }
  if (epData.getFilter() != null) {
    Filter filter=(Filter)convertProperty(Filter.class,epData.getFilter());
    endpointBuilder.setFilter(filter);
  }
  if (epData.getEncoding() != null) {
    endpointBuilder.setEncoding(getPropertyValue(epData.getEncoding()));
  }
  if (epData.getConnectorName() != null) {
    endpointBuilder.setConnector(muleContext.getRegistry().lookupConnector(getPropertyValue(epData.getConnectorName())));
  }
 else   if (epData.getConnector() != null) {
    endpointBuilder.setConnector(epData.getConnector());
  }
 else {
    MuleEndpointURI uri=new MuleEndpointURI(getPropertyValue(epData.getAddress()),muleContext);
    Connector connector=transportFactory.createConnector(uri);
    if (muleContext.getRegistry().lookupConnector(connector.getName()) == null) {
      muleContext.getRegistry().registerConnector(connector);
    }
    endpointBuilder.setConnector(connector);
  }
  if (epData.getName() != null) {
    endpointBuilder.setName(getPropertyValue(epData.getName()));
  }
  endpointBuilder.setSynchronous(epData.isSynchronous());
  if (epData.getType() == ChannelType.Inbound) {
    endpoint=endpointBuilder.buildInboundEndpoint();
  }
 else   if (epData.getType() == ChannelType.Outbound) {
    endpoint=endpointBuilder.buildOutboundEndpoint();
  }
 else {
    throw new IllegalArgumentException("Channel type not recognised: " + epData.getType());
  }
  if (epData.getName() != null) {
    muleContext.getRegistry().registerEndpointBuilder(epData.getName(),endpointBuilder);
  }
  return endpoint;
}
