{
  ExpressionManager expressionManager=event.getMuleContext().getExpressionManager();
  MuleEvent enricherEvent=DefaultMuleEvent.copy(event);
  OptimizedRequestContext.unsafeSetEvent(enricherEvent);
  MuleEvent enrichmentEvent=enrichmentProcessor.process(enricherEvent);
  OptimizedRequestContext.unsafeSetEvent(event);
  if (enrichmentEvent != null && !VoidMuleEvent.getInstance().equals(enrichmentEvent)) {
    for (    EnrichExpressionPair pair : enrichExpressionPairs) {
      enrich(event.getMessage(),enrichmentEvent.getMessage(),pair.getSource(),pair.getTarget(),expressionManager);
    }
    event=new DefaultMuleEvent(event.getMessage(),event,enrichmentEvent.getSession());
  }
  return event;
}
