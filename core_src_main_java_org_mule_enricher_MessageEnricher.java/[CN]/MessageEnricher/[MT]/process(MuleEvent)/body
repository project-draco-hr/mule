{
  MuleContext muleContext=event.getMuleContext();
  ExpressionManager expressionManager=muleContext.getExpressionManager();
  Object enrichmentObject=null;
  MuleMessage enrichmentMessage=enrichmentProcessor.process(event).getMessage();
  if (enrichmentMessage != null) {
    if (evaluatorExpression != null) {
      enrichmentObject=expressionManager.evaluate(evaluatorExpression,enrichmentMessage);
      if (enrichmentObject instanceof MuleMessage) {
        enrichmentObject=((MuleMessage)enrichmentObject).getPayload();
      }
    }
 else {
      enrichmentObject=enrichmentMessage.getPayload();
    }
    expressionManager.enrich(enricherExpression,event.getMessage(),enrichmentObject);
  }
  return event;
}
