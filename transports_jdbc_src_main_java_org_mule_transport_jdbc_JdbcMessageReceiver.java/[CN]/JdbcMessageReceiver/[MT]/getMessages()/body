{
  if (!flowConstruct.getMuleContext().isPrimaryPollingInstance()) {
    return null;
  }
  Connection con=null;
  try {
    con=this.connector.getConnection();
    List resultList=executeReadStatement(con);
    if (resultList != null && resultList.size() > 1 && isReceiveMessagesInTransaction() && !receiveMessagesInXaTransaction) {
      aggregateResult=true;
      logger.warn(JdbcMessages.moreThanOneMessageInTransaction(RECEIVE_MESSAGE_IN_TRANSCTION,RECEIVE_MESSAGES_IN_XA_TRANSCTION));
      List singleResultList=new ArrayList(1);
      singleResultList.add(resultList);
      return singleResultList;
    }
    return resultList;
  }
  finally {
    if (TransactionCoordination.getInstance().getTransaction() == null) {
      JdbcUtils.close(con);
    }
  }
}
