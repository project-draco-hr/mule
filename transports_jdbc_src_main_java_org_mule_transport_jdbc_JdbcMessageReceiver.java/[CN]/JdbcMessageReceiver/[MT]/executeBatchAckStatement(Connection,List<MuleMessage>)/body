{
  Object[][] paramValuesArray=new Object[messages.size()][];
  for (int i=0; i < messages.size(); i++) {
    MuleMessage message=messages.get(i);
    paramValuesArray[i]=connector.getParams(endpoint,this.ackParams,message,this.endpoint.getEndpointURI().getAddress());
  }
  if (logger.isDebugEnabled()) {
    logger.debug("SQL UPDATE: " + ackStmt + ", params = "+ ArrayUtils.toString(ackParams));
  }
  int[] nbRows=connector.getQueryRunnerFor(endpoint).batch(con,this.ackStmt,paramValuesArray);
  return nbRows;
}
