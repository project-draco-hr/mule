{
  if (cryptInfo == null) {
    MuleEvent event=getCurrentEvent();
    PGPPublicKey publicKey=keyManager.getPublicKey((String)this.getCredentialsAccessor().getCredentials(event));
    this.checkKeyExpirity(publicKey);
    return new PGPCryptInfo(publicKey,false);
  }
 else {
    PGPCryptInfo info=(PGPCryptInfo)cryptInfo;
    this.checkKeyExpirity(info.getPublicKey());
    return info;
  }
}
