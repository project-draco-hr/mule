{
  String connectUri=(connectorServerUrl != null ? connectorServerUrl : StringUtils.EMPTY);
  if (connectUri.contains("jmx:rmi")) {
    int i=connectUri.lastIndexOf("rmi://");
    URI uri=new URI(connectUri.substring(i));
    if (rmiRegistry == null) {
      try {
        if (isCreateRmiRegistry()) {
          try {
            rmiRegistry=LocateRegistry.createRegistry(uri.getPort());
          }
 catch (          ExportException e) {
            logger.info("Registry on " + uri + " already bound. Attempting to use that instead");
            rmiRegistry=LocateRegistry.getRegistry(uri.getHost(),uri.getPort());
          }
        }
 else {
          rmiRegistry=LocateRegistry.getRegistry(uri.getHost(),uri.getPort());
        }
      }
 catch (      RemoteException e) {
        throw new InitialisationException(e,this);
      }
    }
  }
}
