{
  Connection connection=dataSource.getConnection();
  try {
    connection.setAutoCommit(false);
    createPlanetTestTable(connection);
    if (supportsXmlType()) {
      createAlienTestTable(connection);
    }
    if (supportsSimpleUdt()) {
      createContactDetailsType(connection);
      createRegionManagersTestTable(connection);
      if (supportsArraysUdt()) {
        createContactsTestTable(connection);
        createRegionsTestTable(connection);
      }
    }
    connection.commit();
  }
 catch (  SQLException e) {
    logger.info("Error creating test database",e);
    connection.rollback();
    throw e;
  }
 finally {
    if (connection != null) {
      connection.close();
    }
  }
}
