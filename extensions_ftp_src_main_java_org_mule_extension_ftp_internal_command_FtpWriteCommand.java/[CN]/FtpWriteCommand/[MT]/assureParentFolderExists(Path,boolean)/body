{
  Path parentFolderPath=filePath.getParent();
  if (parentFolderPath == null) {
    return;
  }
  FilePayload parentFolder=getFile(parentFolderPath.toString());
  if (parentFolder == null) {
    if (createParentFolder) {
      mkdirs(parentFolderPath);
    }
 else {
      throw new IllegalArgumentException(format("Cannot write to file '%s' because path to it doesn't exist. Consider setting the 'createParentFolder' attribute to 'true'",filePath));
    }
  }
}
