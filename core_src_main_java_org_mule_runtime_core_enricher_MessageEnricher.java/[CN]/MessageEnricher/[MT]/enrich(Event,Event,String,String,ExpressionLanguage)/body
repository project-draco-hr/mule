{
  if (StringUtils.isEmpty(sourceExpressionArg)) {
    sourceExpressionArg="#[payload:]";
  }
  DefaultTypedValue typedValue=expressionLanguage.evaluateTyped(sourceExpressionArg,enrichmentEvent,flowConstruct);
  if (typedValue.getValue() instanceof InternalMessage) {
    InternalMessage muleMessage=(InternalMessage)typedValue.getValue();
    typedValue=new DefaultTypedValue(muleMessage.getPayload().getValue(),muleMessage.getPayload().getDataType());
  }
  if (!StringUtils.isEmpty(targetExpressionArg)) {
    Event.Builder eventBuilder=Event.builder(currentEvent);
    expressionLanguage.enrich(targetExpressionArg,currentEvent,eventBuilder,flowConstruct,typedValue);
    return eventBuilder.build();
  }
 else {
    return Event.builder(currentEvent).message(InternalMessage.builder(currentEvent.getMessage()).payload(typedValue.getValue()).mediaType(typedValue.getDataType().getMediaType()).build()).build();
  }
}
