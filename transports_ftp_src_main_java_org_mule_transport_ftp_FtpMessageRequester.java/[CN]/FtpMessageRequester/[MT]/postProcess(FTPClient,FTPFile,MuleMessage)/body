{
  if (!connector.isStreaming()) {
    if (!client.deleteFile(file.getName())) {
      throw new IOException(MessageFormat.format("Failed to delete file {0}. Ftp error: {1}",file.getName(),client.getReplyCode()));
    }
    if (logger.isDebugEnabled()) {
      logger.debug("Deleted file " + file.getName());
    }
  }
}
