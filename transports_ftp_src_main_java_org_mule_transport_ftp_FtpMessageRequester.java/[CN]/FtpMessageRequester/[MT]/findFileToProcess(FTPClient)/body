{
  boolean isFile=connector.isFile(endpoint,client);
  FTPListParseEngine engine=client.initiateListParsing();
  FTPFile[] files=null;
  while (engine.hasNext()) {
    files=engine.getNext(FTP_LIST_PAGE_SIZE);
    if (files == null) {
      break;
    }
    FilenameFilter filenameFilter=getFilenameFilter();
    for (int i=0; i < files.length; i++) {
      FTPFile file=files[i];
      if (file.isFile()) {
        if (filenameFilter.accept(null,file.getName())) {
          if (connector.validateFile(file)) {
            return file;
          }
        }
      }
    }
  }
  if (!FTPReply.isPositiveCompletion(client.getReplyCode())) {
    throw new IOException("Ftp error: " + client.getReplyCode());
  }
  return null;
}
