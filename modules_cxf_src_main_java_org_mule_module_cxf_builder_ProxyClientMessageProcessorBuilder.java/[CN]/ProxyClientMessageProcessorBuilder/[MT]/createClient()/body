{
  ClientFactoryBean cpf=new ClientFactoryBean();
  cpf.setServiceClass(ProxyService.class);
  cpf.setDataBinding(new StaxDataBinding());
  cpf.getFeatures().add(new StaxDataBindingFeature());
  cpf.setAddress(getAddress());
  cpf.setBus(getBus());
  cpf.setProperties(properties);
  if (soapVersion != null) {
    cpf.setBindingId(CxfUtils.getBindingIdForSoapVersion(soapVersion));
  }
  if (wsdlLocation != null) {
    cpf.setWsdlURL(wsdlLocation);
  }
  Client client=cpf.create();
  Binding binding=client.getEndpoint().getBinding();
  CxfUtils.removeInterceptor(binding.getOutInterceptors(),WrappedOutInterceptor.class.getName());
  CxfUtils.removeInterceptor(binding.getInInterceptors(),Soap11FaultInInterceptor.class.getName());
  CxfUtils.removeInterceptor(binding.getInInterceptors(),Soap12FaultInInterceptor.class.getName());
  CxfUtils.removeInterceptor(binding.getInInterceptors(),CheckFaultInterceptor.class.getName());
  if (isProxyEnvelope()) {
    CxfUtils.removeInterceptor(binding.getOutInterceptors(),SoapOutInterceptor.class.getName());
    client.getInInterceptors().add(new ReversibleStaxInInterceptor());
    client.getInInterceptors().add(new ResetStaxInterceptor());
  }
  return client;
}
