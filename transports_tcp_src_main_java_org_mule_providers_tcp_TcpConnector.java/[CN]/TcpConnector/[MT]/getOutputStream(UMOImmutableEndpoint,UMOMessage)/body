{
  Socket socket;
  try {
    socket=getSocket(endpoint);
  }
 catch (  Exception e) {
    throw new MessagingException(new Message(Messages.FAILED_TO_GET_OUTPUT_STREAM),message,e);
  }
  if (socket == null) {
    throw new IllegalStateException("could not get socket for endpoint: " + endpoint.getEndpointURI().getAddress());
  }
  try {
    return new DataOutputStream(new BufferedOutputStream(socket.getOutputStream()));
  }
 catch (  IOException e) {
    throw new MessagingException(new Message(Messages.FAILED_TO_GET_OUTPUT_STREAM),message,e);
  }
}
