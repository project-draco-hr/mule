{
  HttpsConnector cnn;
  ServerSocketFactory ssf;
  cnn=(HttpsConnector)connector;
  SSLContext sslc=SSLContext.getInstance(cnn.getSslType(),cnn.getProvider());
  sslc.init(cnn.getKeyManagerFactory().getKeyManagers(),cnn.getTrustManagerFactory().getTrustManagers(),new SecureRandom());
  ssf=sslc.getServerSocketFactory();
  String host=StringUtils.defaultIfEmpty(uri.getHost(),"localhost");
  int backlog=cnn.getReceiveBacklog();
  SSLServerSocket serverSocket;
  InetAddress inetAddress=InetAddress.getByName(host);
  if (inetAddress.equals(InetAddress.getLocalHost()) || inetAddress.isLoopbackAddress() || host.trim().equals("localhost")) {
    serverSocket=(SSLServerSocket)ssf.createServerSocket(uri.getPort(),backlog);
  }
 else {
    serverSocket=(SSLServerSocket)ssf.createServerSocket(uri.getPort(),backlog,inetAddress);
  }
  serverSocket.setNeedClientAuth(cnn.isRequireClientAuthentication());
  return serverSocket;
}
