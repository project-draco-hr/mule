{
  Object data=event.getMessage().getPayload();
  byte[] buf;
  InputStream inputStream;
  if (data instanceof byte[]) {
    buf=(byte[])data;
    inputStream=new ByteArrayInputStream(buf);
  }
 else   if (data instanceof InputStream) {
    inputStream=(InputStream)data;
  }
 else   if (data instanceof String) {
    inputStream=new ByteArrayInputStream(((String)data).getBytes());
  }
 else {
    throw new IllegalArgumentException("Unexpected message type: java.io.InputStream, byte[], or String expected. Got " + data.getClass().getName());
  }
  return inputStream;
}
