{
  MuleMessage muleMessage=event.getMessage();
  String outPattern=(String)endpoint.getProperty(SftpConnector.PROPERTY_OUTPUT_PATTERN);
  if (outPattern == null) {
    outPattern=(String)muleMessage.getProperty(SftpConnector.PROPERTY_OUTPUT_PATTERN,connector.getOutputPattern());
  }
  String filename=connector.getFilenameParser().getFilename(muleMessage,outPattern);
  if (filename == null) {
    filename=(String)event.getMessage().findPropertyInAnyScope(SftpConnector.PROPERTY_FILENAME,null);
  }
  return filename;
}
