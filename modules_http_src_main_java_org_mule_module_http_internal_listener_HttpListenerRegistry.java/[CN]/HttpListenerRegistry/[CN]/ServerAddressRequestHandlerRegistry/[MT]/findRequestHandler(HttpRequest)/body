{
  final String path=normalizePathWithSpacesOrEncodedSpaces(request.getPath());
  Preconditions.checkArgument(path.startsWith(SLASH),"path parameter must start with /");
  Stack<PathMap> foundPaths=findPossibleRequestHandlersFromCache(path);
  RequestHandlerMatcherPair requestHandlerMatcherPair=null;
  while (!foundPaths.empty()) {
    final PathMap pathMap=foundPaths.pop();
    requestHandlerMatcherPair=findRequestHandlerMatcherPair(pathMap.getRequestHandlerMatcherPairs(),request);
    if (requestHandlerMatcherPair != null) {
      break;
    }
  }
  if (requestHandlerMatcherPair == null) {
    if (logger.isWarnEnabled()) {
      logger.warn("No listener found for request: " + request.getPath());
      logger.warn("Available listeners are: [{}]",Joiner.on(", ").join(this.paths));
    }
    return NoListenerRequestHandler.getInstance();
  }
  if (!requestHandlerMatcherPair.isRunning()) {
    return ServiceTemporarilyUnavailableListenerRequestHandler.getInstance();
  }
  return requestHandlerMatcherPair.getRequestHandler();
}
