{
  final String contentType="text/xml";
  final String wrongContentType="text/json";
  Map<String,Serializable> outboundProperties=new HashMap<>();
  outboundProperties.put(HEADER_CONTENT_TYPE,wrongContentType);
  muleContext=spy(muleContext);
  MuleMessage msg=MuleMessage.builder().payload(NullPayload.getInstance()).outboundProperties(outboundProperties).addOutboundProperty(HEADER_CONTENT_TYPE,wrongContentType).addInboundProperty(HEADER_CONTENT_TYPE,wrongContentType).addOutboundProperty(HEADER_CONTENT_TYPE,contentType).build();
  MuleMessageToHttpResponse transformer=getMuleMessageToHttpResponse();
  HttpResponse response=transformer.createResponse(null,UTF_8,msg);
  Header[] headers=response.getHeaders();
  boolean hasContentTypeHeader=false;
  for (  Header header : headers) {
    if (HEADER_CONTENT_TYPE.equals(header.getName())) {
      hasContentTypeHeader=true;
      assertThat(header.getValue(),is(equalTo(contentType)));
    }
  }
  assertThat("Missing" + HEADER_CONTENT_TYPE + " header",hasContentTypeHeader,is(true));
}
