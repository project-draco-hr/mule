{
  MuleMessage msg=createMockMessage();
  MuleMessageToHttpResponse transformer=getMuleMessageToHttpResponse();
  Cookie[] cookiesOutbound=new Cookie[2];
  cookiesOutbound[0]=new Cookie("domain","name-out-1","value-out-1");
  cookiesOutbound[1]=new Cookie("domain","name-out-2","value-out-2");
  when(msg.getOutboundProperty("Set-Cookie")).thenReturn(cookiesOutbound);
  Set props=new HashSet();
  props.add("Set-Cookie");
  when(msg.getOutboundPropertyNames()).thenReturn(props);
  HttpResponse response=transformer.createResponse(null,UTF_8,msg);
  Header[] headers=response.getHeaders();
  int cookiesSet=0;
  for (  Header header : headers) {
    if ("Set-Cookie".equals(header.getName())) {
      cookiesSet++;
    }
  }
  assertThat(cookiesSet,equalTo(cookiesOutbound.length));
}
