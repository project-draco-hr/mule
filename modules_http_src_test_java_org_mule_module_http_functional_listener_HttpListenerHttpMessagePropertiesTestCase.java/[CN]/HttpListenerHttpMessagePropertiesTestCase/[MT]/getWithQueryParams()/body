{
  final ImmutableMap<String,Object> queryParams=ImmutableMap.<String,Object>builder().put(QUERY_PARAM_NAME,QUERY_PARAM_VALUE).put(SECOND_QUERY_PARAM_NAME,SECOND_QUERY_PARAM_VALUE).build();
  final String uri="/?" + buildQueryString(queryParams);
  final String url=String.format("http://localhost:%s" + uri,listenPort.getNumber());
  Request.Get(url).connectTimeout(RECEIVE_TIMEOUT).execute();
  final MuleMessage message=muleContext.getClient().request("vm://out",RECEIVE_TIMEOUT);
  assertThat(message.<String>getInboundProperty(HttpConstants.RequestProperties.HTTP_REQUEST_URI),is(uri));
  assertThat(message.<String>getInboundProperty(HttpConstants.RequestProperties.HTTP_REQUEST_PATH_PROPERTY),is(BASE_PATH));
  Map<String,String> retrivedQueryParams=message.getInboundProperty(HttpConstants.RequestProperties.HTTP_QUERY_PARAMS);
  assertThat(retrivedQueryParams,IsNull.notNullValue());
  assertThat(retrivedQueryParams.size(),is(2));
  assertThat(retrivedQueryParams.get(QUERY_PARAM_NAME),is(QUERY_PARAM_VALUE));
  assertThat(retrivedQueryParams.get(SECOND_QUERY_PARAM_NAME),is(SECOND_QUERY_PARAM_VALUE));
}
