{
  Mock mockPTM=new Mock(PlatformTransactionManager.class);
  Mock mockTS=new Mock(TransactionStatus.class);
  mockPTM.expectAndReturn("getTransaction",C.same(null),mockTS.proxy());
  mockPTM.expect("commit",C.same(mockTS.proxy()));
  SpringTransactionFactory factory=new SpringTransactionFactory();
  factory.setManager((PlatformTransactionManager)mockPTM.proxy());
  Transaction tx=factory.beginTransaction(muleContext);
  tx.commit();
}
