{
  String payload=getRequestResource(DOWNLOAD_ATTACHMENT);
  Message message=flowRunner(DOWNLOAD_ATTACHMENT).withPayload(payload).run().getMessage();
  MultiPartPayload multipart=(MultiPartPayload)message.getPayload().getValue();
  List<Message> parts=multipart.getParts();
  assertThat(parts,hasSize(2));
  Message bodyPart=parts.get(0);
  Message attachmentPart=parts.get(1);
  assertDownloadedAttachment(attachmentPart);
  assertDownloadedAttachmentBody(bodyPart,attachmentPart);
}
