{
  configureMockEvent(event);
  when(operationModel.getReturnType()).thenReturn(toMetadataType(String.class));
  when(operationModel.getExecutor()).thenReturn(operationExecutorFactory);
  when(operationModel.getExceptionEnricherFactory()).thenReturn(Optional.of(exceptionEnricherFactory));
  when(exceptionEnricherFactory.createEnricher()).thenReturn(new NullExceptionEnricher());
  when(operationExecutorFactory.createExecutor()).thenReturn(operationExecutor);
  when(resolverSet.resolve(event)).thenReturn(parameters);
  when(configurationInstance.getName()).thenReturn(CONFIG_NAME);
  when(configurationInstance.getModel()).thenReturn(configurationModel);
  when(configurationInstance.getValue()).thenReturn(configuration);
  connectionManager=new DefaultConnectionManager(muleContext);
  connectionManager.initialise();
  when(connectionProviderWrapper.getRetryPolicyTemplate()).thenReturn(connectionManager.getDefaultRetryPolicyTemplate());
  when(configurationInstance.getConnectionProvider()).thenReturn(Optional.of(connectionProviderWrapper));
  when(extensionManager.getConfiguration(CONFIG_NAME,event)).thenReturn(configurationInstance);
  when(extensionManager.getConfiguration(extensionModel,event)).thenReturn(configurationInstance);
  messageProcessor=createOperationMessageProcessor();
}
