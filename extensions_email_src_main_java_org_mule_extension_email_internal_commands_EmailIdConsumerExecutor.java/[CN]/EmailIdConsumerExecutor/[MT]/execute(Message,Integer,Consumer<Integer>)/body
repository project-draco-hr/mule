{
  if (emailId == null) {
    Object payload=muleMessage.getPayload().getValue();
    if (payload instanceof List) {
      for (      Object o : (List)payload) {
        if (o instanceof OperationResult) {
          emailId=getIdOrFail(((OperationResult)o));
          consumer.accept(emailId);
        }
 else {
          throw new EmailException(NO_ID_ERROR);
        }
      }
      return;
    }
    Object result=muleMessage.getPayload().getValue();
    if (result instanceof OperationResult) {
      emailId=getIdOrFail((OperationResult)result);
    }
 else {
      throw new EmailException(NO_ID_ERROR);
    }
  }
  consumer.accept(emailId);
}
