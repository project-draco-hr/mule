{
  Object result;
  if (transformer instanceof MessageTransformer) {
    result=((MessageTransformer)transformer).transform(message,event);
  }
 else {
    result=transformer.transform(message);
  }
  if (result instanceof MuleMessage) {
    return (MuleMessage)result;
  }
 else {
    return MuleMessage.builder(message).payload(result != null ? result : NullPayload.getInstance()).mediaType(mergeMediaType(message,transformer.getReturnDataType())).build();
  }
}
