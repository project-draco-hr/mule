{
  List<Thread> threads=new ArrayList<Thread>(THREAD_COUNT * 2);
  for (int i=0; i < THREAD_COUNT; i++) {
    IncrementKeyValueThread incrementKeyValueThread=new IncrementKeyValueThread(sharedKeyA,useTryLock);
    threads.add(incrementKeyValueThread);
    incrementKeyValueThread.start();
    incrementKeyValueThread=new IncrementKeyValueThread(sharedKeyB,useTryLock);
    threads.add(incrementKeyValueThread);
    incrementKeyValueThread.start();
  }
  threadStartLatch.release();
  for (  Thread thread : threads) {
    thread.join();
  }
  assertThat(objectStore.retrieve(sharedKeyA),is(THREAD_COUNT * ITERATIONS_PER_THREAD));
  assertThat(objectStore.retrieve(sharedKeyB),is(THREAD_COUNT * ITERATIONS_PER_THREAD));
}
