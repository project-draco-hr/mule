{
  MuleRegistry muleRegistry=mock(MuleRegistry.class);
  when(muleContext.getRegistry()).thenReturn(muleRegistry);
  Transformer aToBConverter=new MockConverterBuilder().from(dataTypeA).to(dataTypeB).build();
  ArrayList<Transformer> transformers=new ArrayList<Transformer>();
  transformers.add(aToBConverter);
  when(muleRegistry.lookupTransformers(dataTypeA,dataTypeB)).thenReturn(transformers);
  TypeBasedTransformerResolver resolver=new TypeBasedTransformerResolver();
  resolver.setMuleContext(muleContext);
  Transformer resolvedTransformer=resolver.resolve(dataTypeA,dataTypeB);
  assertEquals(aToBConverter,resolvedTransformer);
}
