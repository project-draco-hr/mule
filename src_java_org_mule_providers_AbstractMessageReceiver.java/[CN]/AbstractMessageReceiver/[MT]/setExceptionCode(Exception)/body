{
  String propName=ExceptionHelper.getErrorCodePropertyName(connector.getProtocol());
  if (propName != null) {
    UMOEvent event=RequestContext.getEvent();
    if (event != null) {
      UMOMessage message=event.getMessage();
      String code=ExceptionHelper.getErrorMapping(connector.getProtocol(),exception.getClass());
      if (logger.isDebugEnabled()) {
        logger.debug("Setting error code for: " + connector.getProtocol() + ", "+ propName+ "="+ code);
      }
      message.setProperty(propName,code);
      RequestContext.rewriteEvent(message);
    }
  }
}
