{
  MuleClient client=muleContext.getClient();
  String endpointUri="clientEndpoint." + encoding.name();
  MuleMessage reply=client.send(endpointUri,MuleMessage.builder().payload(payload).mediaType(MediaType.parse("text/plain; charset=" + encoding.name())).outboundProperties(createMessageProperties(httpMethod)).build());
  assertNotNull(reply);
  assertEquals("200",reply.getInboundProperty(HttpConnector.HTTP_STATUS_PROPERTY));
  Object contentTypeHeader=reply.getDataType().getMediaType().toRfcString();
  assertEquals("text/plain; charset=" + encoding.name(),contentTypeHeader);
  assertThat(reply.getDataType().getMediaType().getCharset().get(),is(encoding));
  return reply;
}
