{
  when(inboundEndpoint.getTransactionConfig().isConfigured()).thenReturn(false);
  when(inboundEndpoint.getExchangePattern().hasResponse()).thenReturn(false);
  flow.setExceptionListener(rollbackMessagingExceptionStrategy);
  when(rollbackMessagingExceptionStrategy.hasMaxRedeliveryAttempts()).thenReturn(true);
  when(rollbackMessagingExceptionStrategy.acceptsAll()).thenReturn(true);
  when(inboundEndpoint.getRedeliveryPolicy()).thenReturn(mockRedeliveryPolicy);
  flow.setMessageSource(inboundEndpoint);
}
