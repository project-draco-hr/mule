{
  FlowConstruct flowConstruct=session.getFlowConstruct();
  if (flowConstruct == null) {
    throw new IllegalStateException(CoreMessages.objectIsNull("flowConstruct").getMessage());
  }
 else   if (!(flowConstruct instanceof Service)) {
    throw new UnsupportedOperationException("EventContext.dispatchEvent is only supported when flow constuct is a Service");
  }
 else {
    OutboundRouterCollection router=((Service)flowConstruct).getOutboundRouter();
    if (router == null) {
      throw new EndpointNotFoundException(CoreMessages.noOutboundRouterSetOn(flowConstruct.getName()));
    }
    router.process(new DefaultMuleEvent(message,RequestContext.getEvent()));
  }
}
