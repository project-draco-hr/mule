{
  ContinuationCometdServlet servlet=new ContinuationCometdServlet();
  Context context=new Context(this.getHttpServer(),"/",Context.NO_SECURITY | Context.NO_SESSIONS);
  context.setConnectorNames(new String[]{connector.getName()});
  ServletHolder holder=new ServletHolder();
  holder.setServlet(servlet);
  context.setResourceBase(endpoint.getEndpointURI().getPath());
  context.addServlet(holder,"/cometd/*");
  context.addServlet("org.mortbay.jetty.servlet.DefaultServlet","/");
  try {
    connector.start();
    context.start();
  }
 catch (  Exception e) {
    throw new InitialisationException(CometdMessages.failedToStartCometdServlet(),e,this);
  }
  if (getInterval() != INT_VALUE_NOT_SET)   holder.setInitParameter("interval",Integer.toString(getInterval()));
  holder.setInitParameter("JSONCommented",Boolean.toString(isJsonCommented()));
  if (getLogLevel() != INT_VALUE_NOT_SET)   holder.setInitParameter("logLevel",Integer.toString(getLogLevel()));
  if (getMaxInterval() != INT_VALUE_NOT_SET)   holder.setInitParameter("maxInterval",Integer.toString(getMaxInterval()));
  if (getMultiFrameInterval() != INT_VALUE_NOT_SET)   holder.setInitParameter("multiFrameInterval",(Integer.toString(getMultiFrameInterval())));
  if (getTimeout() != INT_VALUE_NOT_SET)   holder.setInitParameter("timeout",Integer.toString(getTimeout()));
  if (getRefsThreshold() != INT_VALUE_NOT_SET)   holder.setInitParameter("refsThreshold",Integer.toString(getRefsThreshold()));
  holder.setInitParameter("requestAvailable",Boolean.toString(isRequestAvailable()));
  holder.setInitParameter("directDeliver",Boolean.toString(isDirectDeliver()));
  return servlet;
}
