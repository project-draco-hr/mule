{
  FileConnector fc=new FileConnector(muleContext);
  fc.setPollingFrequency(3000000);
  if (messageFactoryClass != null) {
    Map<String,String> overrides=new HashMap<String,String>();
    overrides.put("message.factory",messageFactoryClass.getName());
    fc.setServiceOverrides(overrides);
  }
  fc.setName("moveDeleteConnector");
  File moveToDir=new File(inFile.getParent() + "/moveto/");
  moveToDir.mkdir();
  File workDir=new File(inFile.getParent() + "/work/");
  workDir.mkdir();
  MuleRegistryTransportHelper.registerConnector(muleContext.getRegistry(),fc);
  if (move) {
    fc.setMoveToDirectory(moveToDir.getPath());
  }
  if (useWorkDir) {
    fc.setWorkDirectory(workDir.getPath());
  }
  fc.setAutoDelete(delete);
  fc.setStreaming(stream);
  return moveToDir;
}
