{
  StreamSource source=XsltTransformer.this.getStreamSource();
  String factoryClassName=XsltTransformer.this.getXslTransformerFactory();
  TransformerFactory factory;
  if (StringUtils.isNotEmpty(factoryClassName)) {
    factory=(TransformerFactory)ClassUtils.instanciateClass(factoryClassName,ClassUtils.NO_ARGS,this.getClass());
  }
 else {
    try {
      factory=TransformerFactory.newInstance();
    }
 catch (    TransformerFactoryConfigurationError e) {
      System.setProperty("javax.xml.transform.TransformerFactory",XMLUtils.TRANSFORMER_FACTORY_JDK5);
      factory=TransformerFactory.newInstance();
    }
  }
  factory.setURIResolver(getUriResolver());
  return factory.newTransformer(source);
}
