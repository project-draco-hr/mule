{
  ExceptionListener exceptionListener=new ExceptionListener(muleContext);
  expectedException.expectCause(instanceOf(ComponentException.class));
  InternalMessage result=flowRunner("the-service").withPayload(getTestMuleMessage()).run().getMessage();
  exceptionListener.waitUntilAllNotificationsAreReceived();
  assertNull(result);
}
