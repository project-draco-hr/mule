{
  HttpRequestDispatcherWork httpRequestDispatcherWork=new HttpRequestDispatcherWork(mockHttpConnector,mockSocket);
  setUpSocketMessage();
  when(mockSocket.getLocalSocketAddress()).thenReturn(new InetSocketAddress(0));
  when(mockHttpConnector.lookupReceiver(any(Socket.class),any(RequestLine.class))).thenThrow(mockNoReceiverForEndpointException);
  ByteArrayOutputStream socketOutput=new ByteArrayOutputStream();
  when(mockSocket.getOutputStream()).thenReturn(socketOutput);
  httpRequestDispatcherWork.run();
  String response=new String(socketOutput.toByteArray());
  assertThat(response.startsWith("HTTP/1.0 404 Not Found"),Is.is(true));
}
