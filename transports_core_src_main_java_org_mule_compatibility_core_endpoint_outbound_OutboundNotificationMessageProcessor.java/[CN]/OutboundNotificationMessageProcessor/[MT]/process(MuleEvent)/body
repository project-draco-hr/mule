{
  AbstractConnector connector=(AbstractConnector)endpoint.getConnector();
  if (connector.isEnableMessageEvents(endpoint.getMuleContext())) {
    int notificationAction;
    if (endpoint.getExchangePattern().hasResponse()) {
      notificationAction=EndpointMessageNotification.MESSAGE_SEND_END;
    }
 else {
      notificationAction=EndpointMessageNotification.MESSAGE_DISPATCH_END;
    }
    dispatchNotification(new EndpointMessageNotification(event.getMessage(),endpoint,event.getFlowConstruct(),notificationAction));
  }
  return event;
}
