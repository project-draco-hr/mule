{
  try {
    ServerSocket serverSocket=new ServerSocket(listenPort);
    startupLatch.countDown();
    Socket socket=serverSocket.accept();
    InputStream in=socket.getInputStream();
    BufferedReader reader=new BufferedReader(new InputStreamReader(in));
    readHttpRequest(reader);
    OutputStream out=socket.getOutputStream();
    out.write("HTTP/1.1 200 OK\n\n".getBytes());
    in.close();
    out.close();
    socket.close();
    serverSocket.close();
  }
 catch (  Exception ex) {
    throw new RuntimeException(ex);
  }
 finally {
    testCompleteLatch.countDown();
  }
}
