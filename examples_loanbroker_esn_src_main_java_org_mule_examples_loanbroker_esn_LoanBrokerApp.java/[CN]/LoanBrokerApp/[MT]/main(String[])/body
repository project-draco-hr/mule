{
  LoanBrokerApp loanBrokerApp=null;
  Map options=SystemUtils.getCommandLineOptions(args,CLI_OPTIONS);
  String config=(String)options.get("config");
  if (StringUtils.isNotBlank(config)) {
    loanBrokerApp=new LoanBrokerApp(config);
    int i=100;
    String requests=(String)options.get("req");
    if (requests != null) {
      i=Integer.parseInt(requests);
    }
    String sync=(String)options.get("sync");
    if (sync != null) {
      synchronous=Boolean.valueOf(sync).booleanValue();
    }
    if (synchronous) {
      long start=System.currentTimeMillis();
      List results=loanBrokerApp.requestSend(i,"vm://customer.requests");
      System.out.println(LocaleMessage.getString(LocaleMessage.RESPONSE_NUM_QUOTES,String.valueOf(results.size())));
      List output=new ArrayList(results.size());
      int x=1;
      for (Iterator iterator=results.iterator(); iterator.hasNext(); x++) {
        LoanQuote quote=(LoanQuote)iterator.next();
        output.add(x + ". " + quote.toString());
      }
      System.out.println(StringMessageUtils.getBoilerPlate(output,'*',80));
      long cur=System.currentTimeMillis();
      System.out.println(DateUtils.getFormattedDuration(cur - start));
      System.out.println(LocaleMessage.getString(LocaleMessage.RESPONSE_AVG_REQUEST,String.valueOf(((cur - start) / x))));
    }
 else {
      loanBrokerApp.requestDispatch(i,"vm://customer.requests");
    }
  }
 else {
    loanBrokerApp=new LoanBrokerApp(getInteractiveConfig());
    loanBrokerApp.run(synchronous);
  }
}
