{
  Object payloadFactory=getPayloadFactory();
  if (payloadFactory == null) {
    return super.createConsumer(session,destination,messageSelector,noLocal,durableName);
  }
 else {
    if (destination == null) {
      throw new IllegalArgumentException("Destination (queue or topic) is missing.");
    }
 else     if ((destination instanceof Queue) && (session instanceof QueueSession)) {
      if (messageSelector != null) {
        return ((AQjmsSession)session).createReceiver((Queue)destination,messageSelector,payloadFactory);
      }
 else {
        return ((AQjmsSession)session).createReceiver((Queue)destination,payloadFactory);
      }
    }
 else     if ((destination instanceof Topic) && (session instanceof TopicSession)) {
      if (durableName == null) {
        return ((AQjmsSession)session).createSubscriber((Topic)destination,messageSelector,noLocal);
      }
 else {
        return ((AQjmsSession)session).createDurableSubscriber((Topic)destination,messageSelector,durableName,noLocal,payloadFactory);
      }
    }
 else     throw new IllegalArgumentException("Session and domain type do not match");
  }
}
