{
  Object connectionLock=getTrackedConnectionLock(connection);
synchronized (connectionLock) {
    checkValidConnectionLock(connection,connectionLock);
    Set<ResultSet> resultSets=getConnectionResultSets(connection,resultSet);
    try {
      super.close(connection,resultSet);
    }
  finally {
      if (isEmpty(resultSets)) {
        releaseResources(connection,connectionLock);
      }
    }
  }
}
