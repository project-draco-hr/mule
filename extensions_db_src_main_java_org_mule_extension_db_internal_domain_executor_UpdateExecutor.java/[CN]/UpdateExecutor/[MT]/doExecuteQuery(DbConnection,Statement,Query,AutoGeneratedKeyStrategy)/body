{
  try {
    int updateCount=autoGeneratedKeyStrategy.executeUpdate(statement,query.getQueryTemplate());
    StatementResult result;
    if (autoGeneratedKeyStrategy.returnsAutoGeneratedKeys()) {
      ResultSet generatedKeys=statement.getGeneratedKeys();
      ListResultSetHandler listResultSetHandler=new ListResultSetHandler(new InsensitiveMapRowHandler());
      List generatedKeyList=listResultSetHandler.processResultSet(dbConnection,generatedKeys);
      Map<String,BigInteger> keyMap=generatedKeyList.isEmpty() ? null : (Map<String,BigInteger>)generatedKeyList.get(0);
      result=new StatementResult(updateCount,keyMap);
    }
 else {
      result=new StatementResult(updateCount,null);
    }
    return result;
  }
  finally {
    statement.close();
  }
}
