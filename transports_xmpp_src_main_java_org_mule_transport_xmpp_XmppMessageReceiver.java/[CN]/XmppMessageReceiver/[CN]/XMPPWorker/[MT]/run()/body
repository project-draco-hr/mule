{
  try {
    if (logger.isDebugEnabled()) {
      logger.debug("Processing XMPP packet from: " + packet.getFrom());
    }
    MuleMessage message=createMuleMessage(packet,endpoint.getEncoding());
    MuleEvent event=routeMessage(message);
    MuleMessage returnMessage=event == null ? null : event.getMessage();
    if (returnMessage != null && packet instanceof Message) {
      returnMessage.applyTransformers(event,connector.getDefaultResponseTransformers(endpoint));
      Packet result=(Packet)returnMessage.getPayload();
    }
  }
 catch (  Exception e) {
    getConnector().getMuleContext().getExceptionListener().handleException(e);
  }
}
