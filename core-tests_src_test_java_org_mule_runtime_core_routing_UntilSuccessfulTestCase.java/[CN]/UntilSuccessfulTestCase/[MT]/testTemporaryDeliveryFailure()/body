{
  targetMessageProcessor.setNumberOfFailuresToSimulate(untilSuccessful.getMaxRetries());
  untilSuccessful.initialise();
  untilSuccessful.start();
  final Event testEvent=eventBuilder().message(InternalMessage.of("ERROR")).build();
  assertSame(VoidMuleEvent.getInstance(),untilSuccessful.process(testEvent));
  ponderUntilEventProcessed(testEvent);
  assertEquals(targetMessageProcessor.getEventCount(),untilSuccessful.getMaxRetries() + 1);
}
