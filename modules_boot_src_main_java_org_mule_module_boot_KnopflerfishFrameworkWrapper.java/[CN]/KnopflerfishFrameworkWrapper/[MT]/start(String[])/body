{
  String muleHome=System.getProperty("mule.home");
  Properties osgiSysProps=new Properties();
  osgiSysProps.put("org.osgi.framework.dir",muleHome + "/conf/knopflerfish");
  osgiSysProps.put("org.knopflerfish.gosg.jars","file:" + muleHome + "/lib/");
  for (Iterator iter=osgiSysProps.entrySet().iterator(); iter.hasNext(); ) {
    Map.Entry entry=(Map.Entry)iter.next();
    System.setProperty((String)entry.getKey(),(String)entry.getValue());
  }
  try {
    if (startGui) {
      Main.main(new String[]{"-xargs",muleHome + "/conf/osgi.properties","-xargs",muleHome + "/conf/init.xargs","-start",DESKTOP_BUNDLE});
    }
 else {
      Main.main(new String[]{"-xargs",muleHome + "/conf/osgi.properties","-xargs",muleHome + "/conf/init.xargs"});
    }
    return null;
  }
 catch (  Exception e) {
    e.printStackTrace();
    return new Integer(1);
  }
}
