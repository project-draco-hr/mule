{
  String message="testing";
  MuleClient client=new MuleClient();
  UMOMessage result=client.receive("client-endpoint3",5000);
  while (result != null) {
    result=client.receive("client-endpoint3",5000);
  }
  result=client.send("client-endpoint1",message,null);
  result=client.receive("client-endpoint3",5000);
  assertNotNull(result);
  assertFalse(result.getPayload() instanceof NullPayload);
  assertEquals(result.getPayloadAsString(),message);
  result=client.send("client-endpoint2",message,null);
  result=client.receive("client-endpoint3",5000);
  assertNotNull(result);
  assertFalse(result.getPayload() instanceof NullPayload);
  assertEquals(result.getPayloadAsString(),message);
  result=client.send("client-endpoint1",message,null);
  result=client.receive("client-endpoint3",5000);
  assertNotNull(result);
  assertFalse(result.getPayload() instanceof NullPayload);
  assertEquals(result.getPayloadAsString(),message);
}
