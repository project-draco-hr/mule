{
  try {
    final String payload=RandomStringUtils.randomAlphanumeric(20);
    Flow flow=(Flow)getFlowConstruct("synchronous-with-retry");
    flow.process(getTestEvent(payload));
    fail("Exception should be thrown");
  }
 catch (  Exception e) {
    assertThat(getNumberOfInvocationsFor("untilSuccessful"),is(4));
    assertThat(getNumberOfInvocationsFor("exceptionStrategy"),is(1));
  }
}
