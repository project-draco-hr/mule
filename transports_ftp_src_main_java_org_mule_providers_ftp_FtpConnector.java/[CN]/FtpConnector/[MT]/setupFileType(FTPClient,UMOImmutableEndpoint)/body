{
  int type;
  final String binaryTransferString=(String)endpoint.getProperty(FtpConnector.PROPERTY_BINARY_TRANSFER);
  if (binaryTransferString == null) {
    if (isBinary()) {
      if (logger.isTraceEnabled()) {
        logger.trace("Using FTP BINARY type");
      }
      type=org.apache.commons.net.ftp.FTP.BINARY_FILE_TYPE;
    }
 else {
      if (logger.isTraceEnabled()) {
        logger.trace("Using FTP ASCII type");
      }
      type=org.apache.commons.net.ftp.FTP.ASCII_FILE_TYPE;
    }
  }
 else {
    final boolean binaryTransfer=Boolean.valueOf(binaryTransferString).booleanValue();
    if (binaryTransfer) {
      if (logger.isTraceEnabled()) {
        logger.trace("Using FTP BINARY type (endpoint override)");
      }
      type=org.apache.commons.net.ftp.FTP.BINARY_FILE_TYPE;
    }
 else {
      if (logger.isTraceEnabled()) {
        logger.trace("Using FTP ASCII type (endpoint override)");
      }
      type=org.apache.commons.net.ftp.FTP.ASCII_FILE_TYPE;
    }
  }
  client.setFileType(type);
}
