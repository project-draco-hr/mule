{
  if (keystoreLocation == null) {
    return getKeystore();
  }
  if (keystoreProvider == null)   keystoreProvider="JKS";
  KeyStore keystore=KeyStore.getInstance(keystoreProvider);
  FileInputStream in=new FileInputStream(keystoreLocation);
  try {
    keystore.load(in,password == null ? null : password.toCharArray());
  }
  finally {
    in.close();
  }
  return keystore;
}
