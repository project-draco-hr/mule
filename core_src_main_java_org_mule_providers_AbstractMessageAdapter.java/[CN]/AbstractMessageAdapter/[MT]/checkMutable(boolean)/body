{
  Thread currentThread=Thread.currentThread();
  if (currentThread.equals(ownerThread.get())) {
    if (write && !mutable.get()) {
      if (isDisabled()) {
        logger.warn("Writing to immutable message (exception disabled)");
      }
 else {
        throw newException("Cannot write to immutable message");
      }
    }
  }
 else {
    if (write) {
      if (isDisabled()) {
        logger.warn("Non-owner writing to message (exception disabled)");
      }
 else {
        throw newException("Only owner thread can write to message: " + ownerThread.get() + "/"+ Thread.currentThread());
      }
    }
 else {
      mutable.set(false);
    }
  }
}
