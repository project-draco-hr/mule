{
  File pluginDir=getAppPluginsFolder(APP_NAME);
  pluginDir.mkdirs();
  copyFile(createApplicationPluginFile(),new File(pluginDir,"plugin1.zip"));
  final ArtifactPluginRepository applicationPluginRepository=mock(ArtifactPluginRepository.class);
  final ArtifactPluginDescriptor plugin2Descriptor=new ArtifactPluginDescriptor("plugin2");
  final Set<String> exportedPackages=new HashSet<>();
  exportedPackages.add("org.foo");
  exportedPackages.add("org.bar");
  plugin2Descriptor.setClassLoaderModel(new ClassLoaderModelBuilder().exportingPackages(exportedPackages).build());
  when(applicationPluginRepository.getContainerArtifactPluginDescriptors()).thenReturn(Collections.singletonList(plugin2Descriptor));
  doPackageValidationTest(applicationPluginRepository);
}
