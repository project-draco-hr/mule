{
  final URL url=getClass().getResource("/dummy-app.zip");
  assertNotNull("Test app file not found " + url,url);
  addAppArchive(url);
  deploymentService.start();
  assertTrue("Deployer never invoked",deployLatch.await(LATCH_TIMEOUT,TimeUnit.MILLISECONDS));
  assertAppsDir(NONE,new String[]{"dummy-app"},true);
  assertEquals("Application has not been properly registered with Mule",1,deploymentService.getApplications().size());
  deployLatch=new Latch();
  addAppArchive(url);
  assertTrue("Undeploy never invoked",undeployLatch.await(LATCH_TIMEOUT,TimeUnit.MILLISECONDS));
  assertTrue("Deployer never invoked",deployLatch.await(LATCH_TIMEOUT,TimeUnit.MILLISECONDS));
  assertEquals("Application has not been properly registered with Mule",1,deploymentService.getApplications().size());
  assertAppsDir(NONE,new String[]{"dummy-app"},true);
}
