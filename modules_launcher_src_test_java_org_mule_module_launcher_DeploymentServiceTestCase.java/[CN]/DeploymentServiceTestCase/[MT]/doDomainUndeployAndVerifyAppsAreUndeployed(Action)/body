{
  deploymentService.start();
  addPackedDomainFromResource(dummyDomainDescriptor.zipPath);
  assertDeploymentSuccess(domainDeploymentListener,dummyDomainDescriptor.id);
  addPackedAppFromResource(dummyDomainApp1Descriptor.zipPath);
  assertDeploymentSuccess(applicationDeploymentListener,dummyDomainApp1Descriptor.id);
  addPackedAppFromResource(dummyDomainApp2Descriptor.zipPath);
  assertDeploymentSuccess(applicationDeploymentListener,dummyDomainApp2Descriptor.id);
  undeployAction.perform();
  assertDeploymentSuccess(applicationDeploymentListener,dummyDomainApp1Descriptor.id);
  assertDeploymentSuccess(applicationDeploymentListener,dummyDomainApp2Descriptor.id);
  assertUndeploymentSuccess(domainDeploymentListener,dummyDomainDescriptor.id);
}
