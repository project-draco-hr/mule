{
  addExplodedAppFromBuilder(incompleteAppFileBuilder);
  deploymentService.start();
  assertDeploymentFailure(applicationDeploymentListener,incompleteAppFileBuilder.getId());
  reset(applicationDeploymentListener);
  File originalConfigFile=new File(appsDir + "/" + incompleteAppFileBuilder.getDeployedPath(),MULE_CONFIG_XML_FILE);
  assertThat(originalConfigFile.exists(),is(true));
  URL url=getClass().getResource(EMPTY_DOMAIN_CONFIG_XML);
  File newConfigFile=new File(url.toURI());
  FileUtils.copyFile(newConfigFile,originalConfigFile);
  assertApplicationDeploymentSuccess(applicationDeploymentListener,incompleteAppFileBuilder.getId());
  addPackedAppFromBuilder(emptyAppFileBuilder);
  assertApplicationDeploymentSuccess(applicationDeploymentListener,emptyAppFileBuilder.getId());
  assertAppFolderIsMaintained(incompleteAppFileBuilder.getId());
}
