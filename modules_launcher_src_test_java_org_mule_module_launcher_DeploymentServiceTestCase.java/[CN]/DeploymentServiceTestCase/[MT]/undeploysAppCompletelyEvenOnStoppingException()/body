{
  addPackedAppFromResource(emptyAppDescriptor.zipPath);
  TestApplicationFactory appFactory=new TestApplicationFactory(new MuleApplicationClassLoaderFactory(new MuleDomainClassLoaderRepository(),new DefaultNativeLibraryFinderFactory()));
  appFactory.setFailOnStopApplication(true);
  deploymentService.setAppFactory(appFactory);
  deploymentService.start();
  assertApplicationDeploymentSuccess(applicationDeploymentListener,emptyAppDescriptor.id);
  Application app=findApp(emptyAppDescriptor.id,1);
  assertTrue("Unable to remove anchor file",removeAppAnchorFile(emptyAppDescriptor.id));
  assertUndeploymentSuccess(applicationDeploymentListener,emptyAppDescriptor.id);
  assertAppFolderIsDeleted(emptyAppDescriptor.id);
  assertStatus(app,ApplicationStatus.DESTROYED);
}
