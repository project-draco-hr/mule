{
  addPackedDomainFromResource(DeploymentServiceTestCase.dummyDomainDescriptor.zipPath);
  File dummyDomainFile=new File(DeploymentServiceTestCase.dummyDomainDescriptor.zipPath);
  long firstFileTimestamp=dummyDomainFile.lastModified();
  deploymentService.start();
  assertDeploymentSuccess(domainDeploymentListener,dummyDomainDescriptor.id);
  assertDomainDir(NONE,new String[]{dummyDomainDescriptor.id},true);
  assertEquals("Domain has not been properly registered with Mule",1,deploymentService.getDomains().size());
  reset(domainDeploymentListener);
  addPackedDomainFromResource(DeploymentServiceTestCase.dummyDomainDescriptor.zipPath);
  alterTimestampIfNeeded(dummyDomainFile,firstFileTimestamp);
  assertUndeploymentSuccess(domainDeploymentListener,dummyDomainDescriptor.id);
  assertDeploymentSuccess(domainDeploymentListener,dummyDomainDescriptor.id);
  assertEquals("Domain has not been properly registered with Mule",1,deploymentService.getDomains().size());
  assertDomainDir(NONE,new String[]{dummyDomainDescriptor.id},true);
}
