{
  byte[] buffer;
  try {
    byte[] input=null;
    if (src instanceof InputStream) {
      InputStream inputStream=(InputStream)src;
      try {
        input=IOUtils.toByteArray(inputStream);
      }
  finally {
        inputStream.close();
      }
    }
 else {
      input=(byte[])src;
    }
    buffer=getStrategy().uncompressByteArray(input);
  }
 catch (  IOException e) {
    throw new TransformerException(MessageFactory.createStaticMessage("Failed to uncompress message."),this,e);
  }
  if (!DataTypeFactory.BYTE_ARRAY.equals(getReturnDataType())) {
    return SerializationUtils.deserialize(buffer);
  }
  return buffer;
}
