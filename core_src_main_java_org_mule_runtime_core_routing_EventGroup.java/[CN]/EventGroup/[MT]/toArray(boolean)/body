{
synchronized (this) {
    if (eventsObjectStore.allKeys(eventsPartitionKey).isEmpty()) {
      return EMPTY_EVENTS_ARRAY;
    }
    List<Serializable> keys=eventsObjectStore.allKeys(eventsPartitionKey);
    MuleEvent[] eventArray=new MuleEvent[keys.size()];
    for (int i=0; i < keys.size(); i++) {
      eventArray[i]=eventsObjectStore.retrieve(keys.get(i),eventsPartitionKey);
    }
    if (sortByArrival) {
      Arrays.sort(eventArray,new ArrivalOrderEventComparator());
    }
    return eventArray;
  }
}
