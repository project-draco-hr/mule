{
  OutboundEndpoint endpoint;
  try {
    endpoint=muleContext.getRegistry().lookupEndpointFactory().getOutboundEndpoint(applicationEvent.getEndpoint());
  }
 catch (  MuleException e) {
    throw new ApplicationEventException("Failed to get endpoint for endpointUri: " + applicationEvent.getEndpoint(),e);
  }
  if (endpoint != null) {
    try {
      DefaultMuleMessage message=new DefaultMuleMessage(applicationEvent.getSource(),applicationEvent.getProperties(),muleContext);
      if (applicationEvent.getMuleEventContext() != null) {
        applicationEvent.getMuleEventContext().setStopFurtherProcessing(true);
        applicationEvent.getMuleEventContext().dispatchEvent(message,endpoint);
      }
 else {
        MuleSession session=new DefaultMuleSession(message,((AbstractConnector)endpoint.getConnector()).getSessionHandler(),service,muleContext);
        RequestContext.setEvent(new DefaultMuleEvent(message,endpoint,session,false));
        if (endpoint.getTransformers() != null) {
          message=new DefaultMuleMessage(applicationEvent.getSource(),applicationEvent.getProperties(),muleContext);
          message.applyTransformers(endpoint.getTransformers());
        }
        endpoint.dispatch(new DefaultMuleEvent(message,endpoint,session,false));
      }
    }
 catch (    Exception e1) {
      throw new ApplicationEventException("Failed to dispatch event: " + e1.getMessage(),e1);
    }
  }
 else {
    throw new ApplicationEventException("Failed endpoint using name: " + applicationEvent.getEndpoint());
  }
}
