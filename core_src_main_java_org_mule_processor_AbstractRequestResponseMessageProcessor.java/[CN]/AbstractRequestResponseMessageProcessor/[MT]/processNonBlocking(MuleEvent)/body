{
  final ReplyToHandler originalReplyToHandler=event.getReplyToHandler();
  event=new DefaultMuleEvent(event,new ReplyToHandler(){
    @Override public void processReplyTo(    MuleEvent event,    MuleMessage returnMessage,    Object replyTo) throws MuleException {
      MuleEvent response=processResponse(new DefaultMuleEvent(event,originalReplyToHandler));
      if (!NonBlockingVoidMuleEvent.getInstance().equals(response)) {
        originalReplyToHandler.processReplyTo(response,null,null);
      }
      processFinally(event,null);
    }
    @Override public void processExceptionReplyTo(    MessagingException exception,    Object replyTo){
      originalReplyToHandler.processExceptionReplyTo(exception,replyTo);
      processFinally(exception.getEvent(),exception);
    }
  }
);
  try {
    MuleEvent result=processNext(processRequest(event));
    if (!(result instanceof NonBlockingVoidMuleEvent)) {
      return processResponse(result);
    }
 else {
      return result;
    }
  }
 catch (  MessagingException exception) {
    processFinally(event,exception);
    throw exception;
  }
}
