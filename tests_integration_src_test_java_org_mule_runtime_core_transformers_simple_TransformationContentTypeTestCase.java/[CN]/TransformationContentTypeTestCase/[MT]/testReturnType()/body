{
  Transformer trans=muleContext.getRegistry().lookupTransformer("testTransformer");
  assertNotNull(trans);
  String inputMessage="ABCDEF";
  byte[] array=(byte[])trans.transform(inputMessage);
  MuleMessage message=new DefaultMuleMessage(inputMessage,muleContext);
  List<Transformer> transformers=Arrays.asList(new Transformer[]{trans});
  message=muleContext.getTransformationService().applyTransformers(message,null,transformers);
  assertThat(message.getDataType().getMediaType().getPrimaryType(),is("text"));
  assertThat(message.getDataType().getMediaType().getSubType(),is("plain"));
  assertThat(message.getDataType().getMediaType().getCharset().get(),is(ISO_8859_1));
}
