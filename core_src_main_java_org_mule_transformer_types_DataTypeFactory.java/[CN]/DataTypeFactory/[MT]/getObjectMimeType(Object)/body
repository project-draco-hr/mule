{
  String mime=null;
  if (value instanceof MuleMessage) {
    MuleMessage mm=(MuleMessage)value;
    mime=mm.getInboundProperty(MuleProperties.CONTENT_TYPE_PROPERTY);
    if (mime == null) {
      mime=mm.getInboundProperty("ContentType");
    }
  }
 else   if (value instanceof DataHandler) {
    mime=((DataHandler)value).getContentType();
  }
 else   if (value instanceof DataSource) {
    mime=((DataSource)value).getContentType();
  }
  if (mime != null) {
    int i=mime.indexOf(";");
    mime=(i > -1 ? mime.substring(0,i) : mime);
  }
 else {
    mime=MimeTypes.ANY;
  }
  return mime;
}
