{
  MuleClient client=muleContext.getClient();
  NonSerializableMessageObject message=new NonSerializableMessageObject(1,"Hello",true);
  for (int i=0; i < messages; i++) {
    client.dispatch("vm://in",new DefaultMuleMessage(message));
  }
  for (int i=0; i < messages; i++) {
    MuleMessage msg=client.request("vm://out",30000);
    assertTrue(msg.getPayload() instanceof NonSerializableMessageObject);
    NonSerializableMessageObject received=(NonSerializableMessageObject)msg.getPayload();
    assertEquals("Hello",received.s);
    assertEquals(1,received.i);
    assertEquals(true,received.b);
  }
}
