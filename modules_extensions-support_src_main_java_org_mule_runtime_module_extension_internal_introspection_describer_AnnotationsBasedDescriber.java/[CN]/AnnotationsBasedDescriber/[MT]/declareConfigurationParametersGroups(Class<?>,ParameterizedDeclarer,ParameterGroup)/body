{
  List<ParameterGroup> groups=new LinkedList<>();
  for (  Field field : getParameterContainers(annotatedType,typeLoader)) {
    if (field.isAnnotationPresent(org.mule.runtime.extension.api.annotation.param.Optional.class)) {
      throw new IllegalParameterModelDefinitionException(format("@%s can not be applied along with @%s. Affected field [%s] in [%s].",org.mule.runtime.extension.api.annotation.param.Optional.class.getSimpleName(),org.mule.runtime.extension.api.annotation.ParameterGroup.class.getSimpleName(),field.getName(),annotatedType));
    }
    Set<ParameterDeclarer> parameters=declareSingleParameters(getExposedFields(field.getType()),parameterDeclarer);
    if (!parameters.isEmpty()) {
      ParameterGroup group=new ParameterGroup(field.getType(),field);
      groups.add(group);
      for (      ParameterDeclarer descriptor : parameters) {
        ParameterDeclaration parameter=inheritGroupParentDisplayProperties(parent,field,group,descriptor);
        group.addParameter(getField(field.getType(),getMemberName(parameter,parameter.getName())));
      }
      List<ParameterGroup> childGroups=declareConfigurationParametersGroups(field.getType(),parameterDeclarer,group);
      if (!CollectionUtils.isEmpty(childGroups)) {
        group.addModelProperty(new ParameterGroupModelProperty(childGroups));
      }
    }
  }
  return groups;
}
