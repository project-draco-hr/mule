{
  Object nonSerializable=new Object();
  FlowRunner runner=flowRunner("FlowRefWithSessionProperties").withPayload("data").withSessionProperty("keyNonSerializable",nonSerializable).withSessionProperty("key","value");
  MuleEvent event=runner.buildEvent();
  MuleEvent result=runner.run();
  assertSame(event.getSession(),result.getSession());
  assertNotNull(result);
  assertThat(result.getMessage().getProperty("key",PropertyScope.SESSION),is("value"));
  assertThat(result.getMessage().getProperty("key1",PropertyScope.SESSION),is("value1"));
  assertThat(result.getMessage().getProperty("key2",PropertyScope.SESSION),is("value2"));
  assertThat(result.getMessage().getProperty("keyNonSerializable",PropertyScope.SESSION),is(nonSerializable));
}
