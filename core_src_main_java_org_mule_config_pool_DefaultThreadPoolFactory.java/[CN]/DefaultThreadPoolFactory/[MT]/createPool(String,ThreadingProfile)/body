{
  ThreadingProfile threadingProfileCopy=tp instanceof DirectThreadingProfile ? tp : new ImmutableThreadingProfile(tp);
  BlockingQueue buffer;
  if (threadingProfileCopy.getMaxBufferSize() > 0 && threadingProfileCopy.getMaxThreadsActive() > 1) {
    buffer=new LinkedBlockingDeque(threadingProfileCopy.getMaxBufferSize());
  }
 else {
    buffer=new SynchronousQueue();
  }
  ThreadPoolExecutor pool=internalCreatePool(name,threadingProfileCopy,buffer);
  configureThreadPoolExecutor(name,threadingProfileCopy,pool);
  return pool;
}
