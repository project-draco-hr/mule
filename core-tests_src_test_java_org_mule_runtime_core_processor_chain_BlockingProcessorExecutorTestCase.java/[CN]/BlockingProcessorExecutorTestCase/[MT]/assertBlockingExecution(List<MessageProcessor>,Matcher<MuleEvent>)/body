{
  ProcessorExecutor executor=createProcessorExecutor(processors);
  if (event.getExchangePattern() == MessageExchangePattern.REQUEST_RESPONSE) {
    assertThat(executor.execute().getMessageAsString(muleContext),equalTo(RESULT));
    assertThat(getCurrentEvent(),requestResponseMatcher);
  }
 else {
    assertThat(executor.execute().getId(),equalTo(event.getId()));
    assertThat(executor.execute().getMessage(),equalTo(event.getMessage()));
    assertThat(getCurrentEvent(),not(sameInstance(event)));
  }
  assertThat(processor1.event,is(notNullValue()));
  assertThat(processor1.thread,equalTo(Thread.currentThread()));
  assertThat(processor2.event,is(notNullValue()));
  assertThat(processor2.thread,equalTo(Thread.currentThread()));
  assertThat(processor3.event,is(notNullValue()));
  assertThat(processor3.thread,equalTo(Thread.currentThread()));
}
