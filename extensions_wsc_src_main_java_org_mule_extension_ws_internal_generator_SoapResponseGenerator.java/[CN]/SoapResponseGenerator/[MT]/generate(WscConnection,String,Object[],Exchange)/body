{
  Document document=unwrapResponse(response);
  WsdlIntrospecter introspecter=connection.getWsdlIntrospecter();
  TypeLoader loader=connection.getTypeLoader();
  String result=connection.getResponseEnricher().enrich(document,introspecter,loader,operation,exchange);
  WscAttributes attributes=processAttributes(exchange);
  List<Message> receivedAttachments=(List<Message>)exchange.get(MULE_ATTACHMENTS_KEY);
  Object output;
  if (!receivedAttachments.isEmpty()) {
    ImmutableList<Message> parts=ImmutableList.<Message>builder().add(Message.builder().payload(result).attributes(BODY_ATTRIBUTES).build()).addAll(receivedAttachments).build();
    output=new WscMultipartPayload(parts);
  }
 else {
    output=result;
  }
  return Result.<Object,WscAttributes>builder().output(output).attributes(attributes).build();
}
