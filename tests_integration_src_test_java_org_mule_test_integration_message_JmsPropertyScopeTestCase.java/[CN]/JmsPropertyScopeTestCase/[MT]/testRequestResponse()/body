{
  LocalMuleClient client=muleContext.getClient();
  MuleMessage message=new DefaultMuleMessage("test",muleContext);
  message.setOutboundProperty("foo","fooValue");
  message.setReplyTo("jms://reply");
  client.dispatch("inbound",message);
  MuleMessage result=client.request("jms://reply",10000);
  assertNotNull(result);
  assertEquals("test bar",result.getPayload());
  assertEquals("fooValue",result.<Object>getInboundProperty("foo"));
}
