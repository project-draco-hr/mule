{
  Flow flow=(Flow)muleContext.getRegistry().lookupFlowConstruct("TestPersistentQueueService");
  populateSedaQueue(flow,NUM_MESSAGES);
  stopService(flow);
  assertNoLostMessages(NUM_MESSAGES,flow);
  startService(flow);
  Thread.sleep(WAIT_TIME_MILLIS * 2);
  stopService(flow);
  assertNoLostMessages(NUM_MESSAGES,flow);
  startService(flow);
  Thread.sleep(WAIT_TIME_MILLIS * 10);
  stopService(flow);
  assertNoLostMessages(NUM_MESSAGES,flow);
  assertSedaQueueEmpty(flow);
}
