{
  if (muleContext != null && muleContext.isStarted()) {
    return muleContext.getQueueManager().getQueueSession().getQueue(name).size();
  }
 else {
    MuleContext localMuleContext=new DefaultMuleContextBuilder().buildMuleContext();
    QueuePersistenceObjectStore<Serializable> store=new QueuePersistenceObjectStore<Serializable>(localMuleContext);
    QueueManager queueManager=new TransactionalQueueManager();
    queueManager.setPersistentObjectStore(store);
    queueManager.start();
    int size=queueManager.getQueueSession().getQueue(name).size();
    queueManager.stop();
    localMuleContext=null;
    return size;
  }
}
