{
  if (muleContext != null && muleContext.isStarted()) {
    return muleContext.getQueueManager().getQueueSession().getQueue(name).size();
  }
 else {
    MuleContext localMuleContext=new DefaultMuleContextBuilder().buildMuleContext();
    String workingDirectory=localMuleContext.getConfiguration().getWorkingDirectory();
    String path=workingDirectory + File.separator + QueuePersistenceObjectStore.DEFAULT_QUEUE_STORE+ File.separator+ name;
    File[] filesInQueue=new File(path).listFiles();
    return filesInQueue.length;
  }
}
