{
  int len=0;
  byte[] buf=new byte[1 << 16];
  boolean wroteSomething=false;
  while (bytesRequested.get() + offset > bytesWrote && (len=this.toBeEncrypted.read(buf)) > 0) {
    pgpOutputStream.write(buf,0,len);
    bytesWrote=bytesWrote + len;
    wroteSomething=true;
  }
  if (wroteSomething && len <= 0) {
    pgpOutputStream.close();
    compressedEncryptedOutputStream.close();
    encryptedOutputStream.close();
    armoredOut.close();
    return true;
  }
  return false;
}
