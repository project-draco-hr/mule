{
  try {
    if (getSize() > 0) {
      queueFileProvider.getRandomAccessFile().seek(fileTotalSpace);
    }
    long filePointer=queueFileProvider.getRandomAccessFile().getFilePointer();
    int totalBytesRequired=CONTROL_DATA_SIZE + data.length;
    ByteBuffer byteBuffer=ByteBuffer.allocate(totalBytesRequired);
    byteBuffer.put(NOT_REMOVED);
    byteBuffer.putInt(data.length);
    byteBuffer.put(data);
    queueFileProvider.getRandomAccessFile().write(byteBuffer.array());
    fileTotalSpace+=totalBytesRequired;
    return filePointer;
  }
 catch (  IOException e) {
    throw new MuleRuntimeException(e);
  }
}
