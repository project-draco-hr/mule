{
  MuleMessage msg=new DefaultMuleMessage("message",muleContext);
  MessagePropertiesTransformer add=new MessagePropertiesTransformer();
  Map<String,Object> addProps=new HashMap<String,Object>();
  addProps.put("foo","bar");
  addProps.put("foo2","baz");
  add.setAddProperties(addProps);
  add.setMuleContext(muleContext);
  add.initialise();
  msg=(DefaultMuleMessage)add.transform(msg,(String)null);
  assertEquals("bar",msg.getOutboundProperty("foo"));
  assertEquals("bar",msg.getProperty("foo",OUTBOUND));
  MessagePropertiesTransformer delete=new MessagePropertiesTransformer();
  delete.setDeleteProperties(Collections.singletonList("foo"));
  delete.setMuleContext(muleContext);
  delete.initialise();
  msg=(DefaultMuleMessage)delete.transform(msg,(String)null);
  assertNull(msg.getOutboundProperty("foo"));
  assertEquals("baz",msg.getOutboundProperty("foo2"));
}
