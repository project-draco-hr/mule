{
  if (consumableFilter.accept(request.getMessage())) {
    Serializable key;
    try {
      key=keyGenerator.generateKey(request);
    }
 catch (    Exception e) {
      logger.warn("Message will be processed without cache: key generation error",e);
      return messageProcessor.process(request);
    }
    return processMessageWithCache(key,request,messageProcessor);
  }
 else {
    return messageProcessor.process(request);
  }
}
