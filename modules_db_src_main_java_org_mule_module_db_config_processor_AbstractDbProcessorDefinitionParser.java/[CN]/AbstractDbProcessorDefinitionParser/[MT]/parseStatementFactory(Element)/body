{
  Object result;
  if (element.hasAttribute(STATEMENT_FACTORY_REF_ATTRIBUTE)) {
    result=new RuntimeBeanReference(element.getAttribute(STATEMENT_FACTORY_REF_ATTRIBUTE));
  }
 else {
    QueryStatementFactory defaultStatementFactory=new QueryStatementFactory();
    if (element.hasAttribute(MAX_ROWS_ATTRIBUTE)) {
      defaultStatementFactory.setMaxRows(Integer.parseInt(element.getAttribute(MAX_ROWS_ATTRIBUTE)));
    }
    if (element.hasAttribute(FETCH_SIZE)) {
      defaultStatementFactory.setFetchSize(Integer.parseInt(element.getAttribute(FETCH_SIZE)));
    }
 else     if (streaming) {
      logger.warn("Streaming mode needs to configure fetchSize property. Using default value: " + DEFAULT_FETCH_SIZE);
      defaultStatementFactory.setFetchSize(DEFAULT_FETCH_SIZE);
    }
    result=defaultStatementFactory;
  }
  return result;
}
