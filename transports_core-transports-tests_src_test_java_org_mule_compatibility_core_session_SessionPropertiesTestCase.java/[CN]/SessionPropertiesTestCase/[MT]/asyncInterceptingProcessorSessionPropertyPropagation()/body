{
  AsyncInterceptingMessageProcessor async=new AsyncInterceptingMessageProcessor();
  async.setScheduler(scheduler);
  SensingNullMessageProcessor asyncListener=new SensingNullMessageProcessor();
  async.setMuleContext(muleContext);
  async.setFlowConstruct(flow);
  async.setListener(asyncListener);
  InternalMessage message=InternalMessage.builder().payload("data").build();
  Event event=Event.builder(context).message(message).exchangePattern(ONE_WAY).flow(flow).build();
  event.getSession().setProperty("key","value");
  async.process(event);
  asyncListener.latch.await(RECEIVE_TIMEOUT,TimeUnit.MILLISECONDS);
  Event asyncEvent=asyncListener.event;
  assertNotSame(asyncEvent,event);
  assertNotSame(asyncEvent,event);
  assertNotSame(asyncEvent.getSession(),event.getSession());
  assertEquals(1,asyncEvent.getSession().getPropertyNamesAsSet().size());
  assertEquals("value",asyncEvent.getSession().getProperty("key"));
  asyncEvent.getSession().setProperty("newKey","newValue");
  assertEquals(2,asyncEvent.getSession().getPropertyNamesAsSet().size());
  assertEquals("newValue",asyncEvent.getSession().getProperty("newKey"));
  assertEquals(1,event.getSession().getPropertyNamesAsSet().size());
  assertNull(event.getSession().getProperty("newKey"));
}
