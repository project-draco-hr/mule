{
  Object msg;
  HttpMethod httpMethod=(HttpMethod)src;
  Header contentType=httpMethod.getResponseHeader(HttpConstants.HEADER_CONTENT_TYPE);
  try {
    if (contentType != null && !contentType.getValue().startsWith("text/")) {
      msg=IOUtils.toByteArray(httpMethod.getResponseBodyAsStream());
    }
 else {
      msg=httpMethod.getResponseBodyAsString();
    }
  }
 catch (  IOException e) {
    throw new TransformerException(this,e);
  }
  Map headerProps=new HashMap();
  Header[] headers=httpMethod.getRequestHeaders();
  String name;
  for (int i=0; i < headers.length; i++) {
    name=headers[i].getName();
    if (name.startsWith(HttpConstants.X_PROPERTY_PREFIX)) {
      name=name.substring(2);
    }
    headerProps.put(name,headers[i].getValue());
  }
  return new MuleMessage(msg,headerProps);
}
