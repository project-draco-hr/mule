{
  muleContext.start();
  OutboundEndpoint out=getTestOutboundEndpoint("out","test://out?exchangePattern=request-response",null,null,null,connector);
  try {
    out.process(testEvent);
    fail("cannot send on a connector that is not started");
  }
 catch (  MessagingException e) {
  }
  assertEquals(0,connector.dispatchers.getNumIdle());
  assertDispatcherStartedConnected(out,false,false);
  connector.start();
  assertDispatcherStartedConnected(out,true,true);
  OutboundEndpoint out2=getTestOutboundEndpoint("out2","test://out2?exchangePattern=request-response",null,null,null,connector);
  out2.process(testEvent);
  assertEquals(2,connector.dispatchers.getNumIdle());
  assertDispatcherStartedConnected(out,true,true);
  assertDispatcherStartedConnected(out2,true,true);
  connector.stop();
  assertEquals(0,connector.dispatchers.getNumActive() + connector.dispatchers.getNumIdle());
  assertDispatcherStartedConnected(out,false,false);
  assertDispatcherStartedConnected(out2,false,false);
  connector.start();
  assertEquals(2,connector.dispatchers.getNumActive() + connector.dispatchers.getNumIdle());
  assertDispatcherStartedConnected(out,true,true);
  assertDispatcherStartedConnected(out2,true,true);
  out.process(testEvent);
  assertEquals(2,connector.dispatchers.getNumIdle());
  assertDispatcherStartedConnected(out,true,true);
  connector.dispose();
  assertEquals(0,connector.dispatchers.getNumActive() + connector.dispatchers.getNumIdle());
}
