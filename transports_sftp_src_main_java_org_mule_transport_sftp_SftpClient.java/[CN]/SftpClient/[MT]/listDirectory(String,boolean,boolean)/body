{
  try {
    Vector<LsEntry> entries=channelSftp.ls(path);
    if (entries != null) {
      List<String> ret=new ArrayList<String>();
      for (      LsEntry entry : entries) {
        if (includeFiles && !entry.getAttrs().isDir()) {
          ret.add(entry.getFilename());
        }
        if (includeDirectories && entry.getAttrs().isDir()) {
          if (!entry.getFilename().equals(".") && !entry.getFilename().equals("..")) {
            ret.add(entry.getFilename());
          }
        }
      }
      return ret.toArray(new String[ret.size()]);
    }
  }
 catch (  SftpException e) {
    throw new IOException(e.getMessage(),e);
  }
  return null;
}
