{
  try {
    Properties hash=new Properties();
    hash.put(STRICT_HOST_KEY_CHECKING,"no");
    if (!StringUtils.isEmpty(preferredAuthenticationMethods)) {
      hash.put(PREFERRED_AUTHENTICATION_METHODS,preferredAuthenticationMethods);
    }
    session=jsch.getSession(user,host);
    session.setConfig(hash);
    session.setPort(port);
    session.setPassword(password);
    session.setTimeout(connectionTimeoutMillis);
    session.connect();
    Channel channel=session.openChannel(CHANNEL_SFTP);
    channel.connect();
    channelSftp=(ChannelSftp)channel;
    setHome(channelSftp.pwd());
  }
 catch (  JSchException e) {
    logAndThrowLoginError(user,e);
  }
catch (  SftpException e) {
    logAndThrowLoginError(user,e);
  }
}
