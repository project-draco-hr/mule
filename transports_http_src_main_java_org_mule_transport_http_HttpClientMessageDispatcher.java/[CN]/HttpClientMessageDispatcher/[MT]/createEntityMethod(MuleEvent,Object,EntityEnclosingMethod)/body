{
  HttpMethod httpMethod;
  if (body instanceof String) {
    httpMethod=(HttpMethod)sendTransformer.transform(body.toString());
  }
 else   if (body instanceof byte[]) {
    byte[] buffer=event.transformMessage(DataType.BYTE_ARRAY_DATA_TYPE);
    postMethod.setRequestEntity(new ByteArrayRequestEntity(buffer,event.getEncoding()));
    httpMethod=postMethod;
  }
 else {
    if (!(body instanceof OutputHandler)) {
      body=event.transformMessage(DataTypeFactory.create(OutputHandler.class));
    }
    OutputHandler outputHandler=(OutputHandler)body;
    postMethod.setRequestEntity(new StreamPayloadRequestEntity(outputHandler,event));
    postMethod.setContentChunked(true);
    httpMethod=postMethod;
  }
  return httpMethod;
}
