{
  if (client == null) {
    String wsdlUrl=event.getEndpoint().getEndpointURI().getAddress();
    String serviceName=wsdlUrl.substring(0,wsdlUrl.lastIndexOf("?"));
    XFire xfire=connector.getXfire();
    Service service=xfire.getServiceRegistry().getService(new QName(serviceName));
    if (service != null) {
      client=new Client(new MuleUniversalTransport(),service,wsdlUrl);
    }
 else {
      client=new Client(new URL(wsdlUrl));
      client.getService().setName(new QName(serviceName));
      xfire.getServiceRegistry().register(client.getService());
    }
    client.setXFire(xfire);
  }
  if (client.getTimeout() != event.getTimeout()) {
    client.setTimeout(event.getTimeout());
  }
  client.setEndpointUri(event.getEndpoint().getEndpointURI().toString());
  return client;
}
