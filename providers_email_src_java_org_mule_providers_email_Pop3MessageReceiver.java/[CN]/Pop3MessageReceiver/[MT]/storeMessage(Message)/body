{
  if (backupFolder != null) {
    String filename=msg.getFileName();
    if (filename == null) {
      filename=msg.getFrom()[0].toString() + "[" + UUID.getUUID()+ "]";
    }
    filename=Utility.prepareWinFilename(filename);
    filename=backupFolder + filename + ".msg";
    logger.debug("Writing message to: " + filename);
    File f=Utility.createFile(filename);
    FileWriter fw=new FileWriter(f);
    ByteArrayOutputStream baos=new ByteArrayOutputStream();
    msg.writeTo(baos);
    fw.write(new String(baos.toByteArray()));
    baos.close();
    fw.close();
  }
}
