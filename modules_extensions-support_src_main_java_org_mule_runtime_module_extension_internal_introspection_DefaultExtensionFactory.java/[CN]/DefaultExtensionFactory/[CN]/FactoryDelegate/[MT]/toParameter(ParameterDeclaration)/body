{
  Object defaultValue=parameter.getDefaultValue();
  if (defaultValue instanceof String) {
    if (parameter.getExpressionSupport() == NOT_SUPPORTED && isExpression((String)defaultValue)) {
      throw new IllegalParameterModelDefinitionException(format("Parameter '%s' is marked as not supporting expressions yet it" + " contains one as a default value. Please fix this",parameter.getName()));
    }
 else     if (parameter.getExpressionSupport() == REQUIRED && !isExpression((String)defaultValue)) {
      throw new IllegalParameterModelDefinitionException(format("Parameter '%s' requires expressions yet it " + "contains a constant as a default value. Please fix this",parameter.getName()));
    }
  }
  return new ImmutableParameterModel(parameter.getName(),parameter.getDescription(),parameter.getType(),parameter.hasDynamicType(),parameter.isRequired(),parameter.getExpressionSupport(),parameter.getDefaultValue(),parameter.getDslModel(),parameter.getDisplayModel(),parameter.getLayoutModel(),parameter.getModelProperties());
}
