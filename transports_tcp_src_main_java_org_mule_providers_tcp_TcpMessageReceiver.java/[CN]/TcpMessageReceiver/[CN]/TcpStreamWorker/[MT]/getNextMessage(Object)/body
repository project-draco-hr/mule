{
  if (endpoint.isSynchronous()) {
    latch=new CountDownLatch(2);
    dataOut=new CloseCountDownOutputStream(dataOut,latch);
  }
 else {
    latch=new CountDownLatch(2);
  }
  dataIn=new CloseCountDownInputStream(dataIn,latch);
  UMOMessageAdapter adapter=connector.getStreamMessageAdapter(dataIn,dataOut);
  return adapter;
}
