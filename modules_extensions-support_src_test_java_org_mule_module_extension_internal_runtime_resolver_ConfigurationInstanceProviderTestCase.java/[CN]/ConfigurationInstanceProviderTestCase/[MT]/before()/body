{
  when(muleContext.getExtensionManager()).thenReturn(extensionManager);
  ExtensionsTestUtils.stubRegistryKeys(muleContext,CONFIG_NAME);
  when(configuration.getInstantiator().getObjectType()).thenReturn(MODULE_CLASS);
  when(configuration.getInstantiator().newInstance()).thenAnswer(new Answer<Object>(){
    @Override public Object answer(    InvocationOnMock invocation) throws Throwable {
      return MODULE_CLASS.newInstance();
    }
  }
);
  when(configuration.getCapabilities(any(Class.class))).thenReturn(null);
  when(operationContext.getEvent()).thenReturn(event);
  Map<Parameter,ValueResolver> parameters=new HashMap<>();
  parameters.put(getParameter("myName",String.class),new StaticValueResolver(MY_NAME));
  parameters.put(getParameter("age",Integer.class),new StaticValueResolver(AGE));
  when(resolverSet.getResolvers()).thenReturn(parameters);
  when(resolverSet.isDynamic()).thenReturn(false);
  instanceProvider=MuleExtensionUtils.createConfigurationInstanceProvider(CONFIG_NAME,extension,configuration,resolverSet,muleContext,extensionManager);
}
