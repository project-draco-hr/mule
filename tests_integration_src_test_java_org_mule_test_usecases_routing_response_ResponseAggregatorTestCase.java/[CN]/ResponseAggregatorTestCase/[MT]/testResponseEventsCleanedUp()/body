{
  RelaxedAsyncReplyMP mp=new RelaxedAsyncReplyMP();
  try {
    MuleEvent event=getTestEvent("message1");
    final MuleMessage message=MuleMessage.builder(event.getMessage()).build();
    ((DefaultMuleEvent)event).setLegacyCorrelationId(event.getCorrelationId());
    event=MuleEvent.builder(event).message(message).correlation(new Correlation(1,null)).build();
    SensingNullMessageProcessor listener=getSensingNullMessageProcessor();
    mp.setListener(listener);
    mp.setReplySource(listener.getMessageSource());
    mp.process(event);
    Map<String,MuleEvent> responseEvents=mp.getResponseEvents();
    assertTrue("Response events should be cleaned up.",responseEvents.isEmpty());
  }
  finally {
    mp.stop();
  }
}
