{
  RelaxedAsyncReplyMP mp=new RelaxedAsyncReplyMP();
  try {
    Event event=getTestEvent("message1");
    final InternalMessage message=InternalMessage.builder(event.getMessage()).build();
    event=Event.builder(event).message(message).correlationId(event.getCorrelationId()).groupCorrelation(new GroupCorrelation(1,null)).build();
    SensingNullMessageProcessor listener=getSensingNullMessageProcessor();
    mp.setListener(listener);
    mp.setReplySource(listener.getMessageSource());
    mp.process(event);
    Map<String,Event> responseEvents=mp.getResponseEvents();
    assertTrue("Response events should be cleaned up.",responseEvents.isEmpty());
  }
  finally {
    mp.stop();
  }
}
