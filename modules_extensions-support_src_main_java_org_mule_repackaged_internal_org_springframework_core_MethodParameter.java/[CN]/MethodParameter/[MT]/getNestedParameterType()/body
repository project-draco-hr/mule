{
  if (this.nestingLevel > 1) {
    Type type=getGenericParameterType();
    if (type instanceof ParameterizedType) {
      Integer index=getTypeIndexForCurrentLevel();
      Type[] args=((ParameterizedType)type).getActualTypeArguments();
      Type arg=args[index != null ? index : args.length - 1];
      if (arg instanceof Class) {
        return (Class<?>)arg;
      }
 else       if (arg instanceof ParameterizedType) {
        arg=((ParameterizedType)arg).getRawType();
        if (arg instanceof Class) {
          return (Class<?>)arg;
        }
      }
    }
    return Object.class;
  }
 else {
    return getParameterType();
  }
}
