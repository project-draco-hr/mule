{
  final CountDownLatch latch=new CountDownLatch(1);
  final AtomicInteger notificationCount=new AtomicInteger(0);
  muleContext.registerListener(new ExceptionNotificationListener<ExceptionNotification>(){
    public void onNotification(    ExceptionNotification notification){
      if (notification.getAction() == ExceptionNotification.EXCEPTION_ACTION) {
        assertEquals("exception",notification.getActionName());
        assertEquals("Wrong info type",ServerNotification.TYPE_ERROR,notification.getType());
        notificationCount.incrementAndGet();
        latch.countDown();
      }
    }
  }
);
  InstrumentedExceptionStrategy strategy=new InstrumentedExceptionStrategy();
  strategy.setMuleContext(muleContext);
  strategy.exceptionThrown(new IllegalArgumentException("boom"));
  latch.await(2000,TimeUnit.MILLISECONDS);
  assertEquals(1,notificationCount.get());
}
