{
  configureXaTransactionAndSingleResourceTransaction();
  MuleEvent resultEvent=handleMessagingExceptionStrategy.handleException(mockException,mockMuleEvent,null);
  assertThat(resultEvent,is(resultEvent));
  verify(mockMuleMessage).setExceptionPayload(Matchers.<ExceptionPayload>any(ExceptionPayload.class));
  verify(mockMuleMessage).setExceptionPayload(null);
  verify(mockTransaction).commit();
  verify(mockXaTransaction).resume();
  verify(mockStreamCloserService).closeStream(Matchers.<Object>any(Object.class));
}
