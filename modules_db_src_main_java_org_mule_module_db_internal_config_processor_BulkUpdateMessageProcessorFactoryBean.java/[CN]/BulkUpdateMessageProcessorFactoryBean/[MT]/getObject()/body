{
  AbstractBulkUpdateMessageProcessor bulkUpdateMessageProcessor;
  if (query.isDynamic()) {
    bulkUpdateMessageProcessor=new DynamicBulkUpdateMessageProcessor(dbConfigResolver,queryResolver,bulkUpdateExecutorFactory,transactionalAction,validQueryTypes);
  }
 else {
    bulkUpdateMessageProcessor=new PreparedBulkUpdateMessageProcessor(dbConfigResolver,queryResolver,bulkUpdateExecutorFactory,transactionalAction,validQueryTypes);
  }
  bulkUpdateMessageProcessor.setSource(source);
  bulkUpdateMessageProcessor.setTarget(target);
  bulkUpdateMessageProcessor.setQueryMetadataProvider(queryMetadataProvider);
  bulkUpdateMessageProcessor.setAutoGeneratedKeyStrategy(autoGeneratedKeyStrategy);
  return bulkUpdateMessageProcessor;
}
