{
  configureXaTransactionAndSingleResourceTransaction();
  MuleEvent resultEvent=catchMessagingExceptionStrategy.handleException(mockException,mockMuleEvent);
  assertThat(resultEvent,is(resultEvent));
  verify(mockMuleMessage,VerificationModeFactory.times(2)).setExceptionPayload(Matchers.<ExceptionPayload>any(ExceptionPayload.class));
  verify(mockTransaction,VerificationModeFactory.times(0)).setRollbackOnly();
  verify(mockTransaction,VerificationModeFactory.times(0)).commit();
  verify(mockTransaction,VerificationModeFactory.times(0)).rollback();
  verify(mockStreamCloserService).closeStream(Matchers.<Object>any(Object.class));
}
