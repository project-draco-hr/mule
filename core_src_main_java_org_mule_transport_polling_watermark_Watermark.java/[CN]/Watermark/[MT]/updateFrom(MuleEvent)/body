{
  try {
    String variableName=resolveVariable(event);
    Object watermarkValue=this.getUpdatedValue(event,variableName);
    if (watermarkValue == null) {
      logger.warn(CoreMessages.nullWatermark().getMessage());
    }
 else     if (watermarkValue instanceof Serializable) {
synchronized (objectStore) {
        if (objectStore.contains(variableName)) {
          objectStore.remove(variableName);
        }
        if (watermarkValue != null) {
          objectStore.store(variableName,(Serializable)watermarkValue);
        }
      }
    }
 else {
      throw new IllegalArgumentException(CoreMessages.notSerializableWatermark(variableName).getMessage());
    }
  }
 catch (  Exception e) {
    logger.error("Exception found updating watermark",e);
  }
}
