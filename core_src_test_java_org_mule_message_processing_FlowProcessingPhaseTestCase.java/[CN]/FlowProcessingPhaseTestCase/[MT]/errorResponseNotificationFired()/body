{
  MuleEvent event=mock(MuleEvent.class);
  when(event.getMuleContext()).thenReturn(mock(MuleContext.class));
  RequestContext.setEvent(event);
  when(mockContext.supportsAsynchronousProcessing()).thenReturn(false);
  when(mockRequestResponseTemplate.afterRouteEvent(any(MuleEvent.class))).thenThrow(mockMessagingException);
  when(mockMessagingException.handled()).thenReturn(false);
  phase.runPhase(mockRequestResponseTemplate,mockContext,mockNotifier);
  verify(notificationHelper,never()).fireNotification(any(MuleEvent.class),isNull(String.class),any(FlowConstruct.class),eq(MESSAGE_RESPONSE));
  verify(notificationHelper).fireNotification(eq(event),isNull(String.class),any(FlowConstruct.class),eq(MESSAGE_ERROR_RESPONSE));
}
