{
  when(mockContext.supportsAsynchronousProcessing()).thenReturn(false);
  doThrow(mockMessagingException).when(mockRequestResponseTemplate).sendResponseToClient(any(MuleEvent.class));
  when(mockMessagingException.handled()).thenReturn(false);
  phase.runPhase(mockRequestResponseTemplate,mockContext,mockNotifier);
  verify(mockRequestResponseTemplate,times(1)).sendResponseToClient(any(MuleEvent.class));
  verify(mockRequestResponseTemplate,times(1)).afterFailureProcessingFlow(mockMessagingException);
}
