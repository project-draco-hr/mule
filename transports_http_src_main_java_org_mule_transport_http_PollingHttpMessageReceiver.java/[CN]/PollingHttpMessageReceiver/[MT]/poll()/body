{
  MuleMessage req=new DefaultMuleMessage(new DefaultMessageAdapter(""));
  if (etag != null && checkEtag) {
    Map customHeaders=Collections.singletonMap(HttpConstants.HEADER_IF_NONE_MATCH,etag);
    req.setProperty(HttpConnector.HTTP_CUSTOM_HEADERS_MAP_PROPERTY,customHeaders);
  }
  req.setProperty(HttpConnector.HTTP_METHOD_PROPERTY,"GET");
  MuleSession session=new DefaultMuleSession(service,connector.getMuleContext());
  if (outboundEndpoint == null) {
    MuleContext muleContext=endpoint.getMuleContext();
    EndpointBuilder endpointBuilder=new EndpointURIEndpointBuilder(endpoint,muleContext);
    endpointBuilder.setTransformers(Collections.EMPTY_LIST);
    outboundEndpoint=muleContext.getRegistry().lookupEndpointFactory().getOutboundEndpoint(endpointBuilder);
  }
  MuleEvent event=new DefaultMuleEvent(req,outboundEndpoint,session,true);
  MuleMessage message=connector.send(outboundEndpoint,event);
  if (message.getIntProperty(HttpConstants.HEADER_CONTENT_LENGTH,-1) == 0 && discardEmptyContent) {
    if (logger.isDebugEnabled()) {
      logger.debug("Received empty message and ignoring from: " + endpoint.getEndpointURI());
    }
    return;
  }
  int status=message.getIntProperty(HttpConnector.HTTP_STATUS_PROPERTY,0);
  etag=message.getStringProperty(HttpConstants.HEADER_ETAG,null);
  if ((status != 304 || !checkEtag)) {
    routeMessage(message,endpoint.isSynchronous());
  }
}
