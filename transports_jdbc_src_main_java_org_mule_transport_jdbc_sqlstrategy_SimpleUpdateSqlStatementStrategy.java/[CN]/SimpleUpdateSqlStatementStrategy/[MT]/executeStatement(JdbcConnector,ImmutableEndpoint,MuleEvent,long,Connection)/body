{
  String statement=connector.getStatement(endpoint);
  List<?> paramNames=new ArrayList<Object>();
  String sql=connector.parseStatement(statement,paramNames);
  sql=escapeStatement(sql);
  MuleMessage message=event.getMessage();
  Object[] paramValues=connector.getParams(endpoint,paramNames,new DefaultMuleMessage(event.getMessage().getPayload(),message,event.getMuleContext()),endpoint.getEndpointURI().getAddress());
  Transaction tx=TransactionCoordination.getInstance().getTransaction();
  if (logger.isDebugEnabled()) {
    logger.debug("SQL UPDATE: " + sql + ", params = "+ ArrayUtils.toString(paramValues));
  }
  int nbRows=connector.getQueryRunnerFor(endpoint).update(connection,sql,paramValues);
  if (logger.isInfoEnabled()) {
    logger.info("Executing SQL statement: " + nbRows + " row(s) updated");
  }
  logger.debug("MuleEvent dispatched succesfuly");
  return event.getMessage();
}
