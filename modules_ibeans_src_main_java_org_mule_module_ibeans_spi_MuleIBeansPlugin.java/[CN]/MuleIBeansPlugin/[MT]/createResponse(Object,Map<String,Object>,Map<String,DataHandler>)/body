{
  DefaultMuleMessage message=new DefaultMuleMessage(payload,muleContext);
  if (headers != null) {
    for (    Map.Entry<String,Object> entry : headers.entrySet()) {
      try {
        message.setInboundProperty(entry.getKey(),entry.getValue());
      }
 catch (      Exception e) {
        throw new IBeansException(e);
      }
    }
  }
  if (attachments != null) {
    for (    Map.Entry<String,DataHandler> entry : attachments.entrySet()) {
      try {
        message.addAttachment(entry.getKey(),entry.getValue());
      }
 catch (      Exception e) {
        throw new IBeansException(e);
      }
    }
  }
  try {
    return new MuleResponseMessage(message);
  }
 catch (  MimeTypeParseException e) {
    throw new IBeansException(e);
  }
}
