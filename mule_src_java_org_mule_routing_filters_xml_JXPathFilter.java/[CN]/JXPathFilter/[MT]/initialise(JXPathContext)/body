{
  Map.Entry entry=null;
  if (namespaces != null) {
    for (Iterator iterator=namespaces.entrySet().iterator(); iterator.hasNext(); ) {
      entry=(Map.Entry)iterator.next();
      context.registerNamespace(entry.getKey().toString(),entry.getValue().toString());
    }
  }
  if (contextProperties != null) {
    for (Iterator iterator=namespaces.entrySet().iterator(); iterator.hasNext(); ) {
      entry=(Map.Entry)iterator.next();
      context.setValue(entry.getKey().toString(),entry.getValue());
    }
  }
  if (factory != null) {
    context.setFactory(factory);
  }
  context.setLenient(lenient);
  if ((expression.endsWith("= null") || expression.endsWith("=null")) && value == null) {
    value="null";
    expression=expression.substring(0,expression.lastIndexOf("="));
  }
  if (value == null) {
    if (logger.isDebugEnabled()) {
      logger.debug("Value for JXPathFilter is not set : true by default");
    }
    value=Boolean.TRUE.toString();
  }
}
