{
  super(previous);
  if (previous != null) {
    if (message == null) {
      this.message=NullPayload.getInstance();
    }
 else {
      this.message=message;
    }
    for (Iterator iterator=previous.getAttachmentNames().iterator(); iterator.hasNext(); ) {
      String name=(String)iterator.next();
      try {
        DataHandler dh=previous.getAttachment(name);
        if (null == dh) {
          logger.warn("Detected concurrent access to attachment " + name + " for "+ previous);
        }
 else {
          addAttachment(name,dh);
        }
      }
 catch (      Exception e) {
        throw new MuleRuntimeException(CoreMessages.failedToReadPayload(),e);
      }
    }
    if (previous instanceof AbstractMessageAdapter) {
      properties=((AbstractMessageAdapter)previous).getPropertiesContext();
    }
 else {
      properties=((AbstractMessageAdapter)((DefaultMuleMessage)previous).getAdapter()).getPropertiesContext();
    }
  }
 else {
    throw new IllegalArgumentException("previousAdapter may not be null");
  }
}
