{
  HttpRequesterConfig requestConfig=null;
  try {
    requestConfig=new HttpRequesterConfigBuilder(muleContext).setProtocol(HTTPS).setTlsContext(muleContext.getRegistry().get("tlsContext")).build();
    final HttpRequestOptions options=newOptions().disableStatusCodeValidation().requestConfig(requestConfig).build();
    final InternalMessage response=muleContext.getClient().send(format("https://localhost:%s/",httpsPort.getNumber()),InternalMessage.builder().nullPayload().build(),options).getRight();
    assertThat(response.getInboundProperty(HttpConstants.ResponseProperties.HTTP_STATUS_PROPERTY),is(200));
    assertThat(getPayloadAsString(response),is(TEST_RESPONSE));
  }
  finally {
    if (requestConfig != null) {
      requestConfig.stop();
    }
  }
}
