{
  MuleMessage response;
  Map<String,Serializable> messageProperties=new HashMap<>();
  MuleClient client=muleContext.getClient();
  messageProperties.put("content-type","text/plain");
  EchoComponent.setExpectedMimeType("text/xml");
  response=client.send("vm://in1?connector=vm-in1","OK",messageProperties);
  assertNotNull(response);
  assertEquals("OK",response.getPayload());
  messageProperties.remove("content-type");
  response=client.send("vm://in1?connector=vm-in1","OK",messageProperties);
  assertNotNull(response);
  assertEquals("OK",response.getPayload());
  messageProperties.put("content-type","text/xml");
  EchoComponent.setExpectedMimeType("text/plain");
  response=client.send("vm://in2?connector=vm-in2","OK",messageProperties);
  assertNotNull(response);
  assertEquals("OK",response.getPayload());
  messageProperties.remove("content-type");
  response=client.send("vm://in2?connector=vm-in2","OK",messageProperties);
  assertNotNull(response);
  assertEquals("OK",response.getPayload());
}
