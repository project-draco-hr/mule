{
  FunctionalTestComponent testComponent=getFunctionalTestComponent("testService");
  assertNotNull(testComponent);
  EventCallback callback=new EventCallback(){
    @Override public void eventReceived(    final MuleEventContext context,    final Object component) throws Exception {
      MuleMessage msg=context.getMessage();
      assertEquals("BAR",msg.getInboundProperty("FOO"));
    }
  }
;
  testComponent.setEventCallback(callback);
  MuleMessage result=flowRunner("clientFlow").withPayload("Dan").withOutboundProperty("operation","greetMe").withOutboundProperty("FOO","BAR").run().getMessage();
  assertEquals("Hello Dan Received",result.getPayload());
  GreeterImpl impl=getGreeter();
  assertEquals(1,impl.getInvocationCount());
}
