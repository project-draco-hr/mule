{
  NormalizedMessage message=me.getMessage(IN);
  UMOEvent event=JbiUtils.createEvent(message,this);
  try {
    UMOMessage m=router.route(event);
    if (m != null) {
      InOnly exchange=context.getDeliveryChannel().createExchangeFactory().createInOnlyExchange();
      NormalizedMessage nmessage=exchange.createMessage();
      ServiceEndpoint endpoint=null;
      ServiceEndpoint[] eps=context.getEndpointsForService(targetService);
      if (eps.length == 0) {
      }
 else {
        endpoint=eps[0];
      }
      if (endpoint != null) {
        exchange.setEndpoint(endpoint);
      }
      exchange.setInMessage(nmessage);
      JbiUtils.populateNormalizedMessage(m,nmessage);
      boolean synchronous=m.getBooleanProperty("synchronous",true);
      if (synchronous) {
        getContext().getDeliveryChannel().sendSync(me);
      }
 else {
        getContext().getDeliveryChannel().send(me);
      }
    }
    done(me);
  }
 catch (  org.mule.umo.MessagingException e) {
    error(me,e);
  }
}
