{
  ServiceRegistry serviceRegistry=mock(ServiceRegistry.class);
  when(serviceRegistry.lookupProviders(same(ModelEnricher.class),any(ClassLoader.class))).thenReturn(asList(new PasswordModelEnricher()));
  extensionFactory=new DefaultExtensionFactory(new SpiServiceRegistry(),getClass().getClassLoader());
  Descriptor descriptor=new AnnotationsBasedDescriber(SecureConnector.class).describe(new DefaultDescribingContext()).getRootDeclaration();
  extensionModel=extensionFactory.createFrom(descriptor);
}
