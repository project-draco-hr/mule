{
  final String domainOriginal="TEST_DOMAIN_1";
  UMOManager manager=getManager(true);
  final MuleDescriptor descriptor=new MuleDescriptor("TEST_SERVICE");
  descriptor.setImplementation(new Object());
  MuleManager.getRegistry().registerComponent(descriptor,MuleTestUtils.DEFAULT_MODEL_NAME);
  manager.start();
  final ComponentService service=new ComponentService("TEST_SERVICE");
  final ObjectName name=ObjectName.getInstance(domainOriginal + ":type=TEST_SERVICE");
  mBeanServer.registerMBean(service,name);
  Set mbeans=mBeanServer.queryMBeans(ObjectName.getInstance(domainOriginal + ":*"),null);
  assertEquals("Unexpected number of components registered in the domain.",4,mbeans.size());
  mBeanServer.unregisterMBean(name);
  mbeans=mBeanServer.queryMBeans(ObjectName.getInstance(domainOriginal + ":*"),null);
  assertEquals("There should be no MBeans left in the domain",0,mbeans.size());
}
