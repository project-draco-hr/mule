{
  final String domainOriginal="TEST_DOMAIN_1";
  final SedaComponent component=new SedaComponent();
  component.setName("TEST_SERVICE");
  component.setServiceFactory(new SingletonObjectFactory(new Object()));
  component.setThreadingProfile(new ThreadingProfile());
  SedaModel model=new SedaModel();
  component.setModel(model);
  managementContext.getRegistry().registerModel(model,managementContext);
  managementContext.getRegistry().registerComponent(component,managementContext);
  managementContext.getRegistry().initialise();
  component.initialise();
  managementContext.start();
  final ComponentService service=new ComponentService("TEST_SERVICE");
  final ObjectName name=ObjectName.getInstance(domainOriginal + ":type=TEST_SERVICE");
  mBeanServer.registerMBean(service,name);
  Set mbeans=mBeanServer.queryMBeans(ObjectName.getInstance(domainOriginal + ":*"),null);
  assertEquals("Unexpected number of components registered in the domain.",4,mbeans.size());
  mBeanServer.unregisterMBean(name);
  mbeans=mBeanServer.queryMBeans(ObjectName.getInstance(domainOriginal + ":*"),null);
  assertEquals("There should be no MBeans left in the domain",0,mbeans.size());
}
