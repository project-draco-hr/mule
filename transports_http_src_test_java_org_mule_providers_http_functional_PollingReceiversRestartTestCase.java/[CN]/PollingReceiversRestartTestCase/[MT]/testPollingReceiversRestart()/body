{
  MuleServer mule=new MuleServer("polling-receivers-restart-test.xml");
  mule.start(true,false);
  Thread.sleep(WAIT_TIME);
  UMOModel model=(UMOModel)managementContext.getRegistry().getModels().get("main");
  UMOComponent c=model.getComponent("Test");
  assertTrue("Component should be a TestSedaComponent",c instanceof TestSedaComponent);
  MuleProxy proxy=((TestSedaComponent)c).getProxy();
  Object ftc=((TestMuleProxy)proxy).getComponent();
  assertNotNull("Functional Test Component not found in the model.",ftc);
  assertTrue("Service should be a FunctionalTestComponent",ftc instanceof FunctionalTestComponent);
  AtomicInteger pollCounter=new AtomicInteger(0);
  ((FunctionalTestComponent)ftc).setEventCallback(new CounterCallback(pollCounter));
  managementContext.start();
  Thread.sleep(WAIT_TIME);
  managementContext.stop();
  assertTrue("No polls performed",pollCounter.get() > 0);
  managementContext.start();
  pollCounter.set(0);
  ((FunctionalTestComponent)ftc).setEventCallback(new CounterCallback(pollCounter));
  Thread.sleep(WAIT_TIME);
  managementContext.dispose();
  assertTrue("No polls performed",pollCounter.get() > 0);
}
