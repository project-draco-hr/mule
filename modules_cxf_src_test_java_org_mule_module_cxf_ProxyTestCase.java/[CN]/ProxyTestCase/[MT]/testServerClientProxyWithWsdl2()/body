{
  final Latch latch=new Latch();
  ((FunctionalTestComponent)getComponent("serverClientProxyWithWsdl2")).setEventCallback(new EventCallback(){
    public void eventReceived(    MuleEventContext context,    Object component) throws Exception {
      latch.countDown();
    }
  }
);
  String msg="<soap:Envelope xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\">" + "<soap:Body> <test xmlns=\"http://foo\"></test>" + "</soap:Body>"+ "</soap:Envelope>";
  MuleClient client=new MuleClient(muleContext);
  MuleMessage result=client.send("http://localhost:" + getPorts().get(0) + "/services/proxyWithWsdl2",msg,null);
  String resString=result.getPayloadAsString();
  assertTrue(latch.await(1000,TimeUnit.MILLISECONDS));
  assertTrue(resString.indexOf("<test xmlns=\"http://foo\"") != -1);
}
