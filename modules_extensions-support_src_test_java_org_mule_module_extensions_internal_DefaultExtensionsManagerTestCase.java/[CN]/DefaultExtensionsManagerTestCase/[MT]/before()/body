{
  extensionsManager=new DefaultExtensionsManager();
  extensionsManager.setExtensionsDiscoverer(discoverer);
  when(extension1.getName()).thenReturn(EXTENSION1_NAME);
  when(extension2.getName()).thenReturn(EXTENSION2_NAME);
  when(extension1.getVersion()).thenReturn(EXTENSION1_VERSION);
  when(extension2.getVersion()).thenReturn(EXTENSION2_VERSION);
  classLoader=getClass().getClassLoader();
  when(discoverer.discover(same(classLoader))).thenAnswer(new Answer<List<Extension>>(){
    @Override public List<Extension> answer(    InvocationOnMock invocation) throws Throwable {
      return getTestExtensions();
    }
  }
);
}
