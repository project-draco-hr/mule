{
  JobDataMap map=jobExecutionContext.getJobDetail().getJobDataMap();
  String receiverKey=(String)map.get(QuartzMessageReceiver.QUARTZ_RECEIVER_PROPERTY);
  if (receiverKey == null)   throw new JobExecutionException(new Message("quartz",5).getMessage());
  String connectorName=(String)map.get(QuartzMessageReceiver.QUARTZ_CONNECTOR_PROPERTY);
  if (connectorName == null)   throw new JobExecutionException(new Message("quartz",6).getMessage());
  AbstractConnector connector=(AbstractConnector)RegistryContext.getRegistry().lookupConnector(connectorName);
  if (connector == null)   throw new JobExecutionException(new Message("quartz",7,connectorName).getMessage());
  AbstractMessageReceiver receiver=(AbstractMessageReceiver)connector.lookupReceiver(receiverKey);
  if (receiver == null)   throw new JobExecutionException(new Message("quartz",8,connectorName,receiverKey).getMessage());
  Object payload=jobExecutionContext.getJobDetail().getJobDataMap().get(QuartzConnector.PROPERTY_PAYLOAD);
  try {
    if (payload == null) {
      String ref=jobExecutionContext.getJobDetail().getJobDataMap().getString(QuartzConnector.PROPERTY_PAYLOAD_REFERENCE);
      if (ref == null) {
        ref=jobExecutionContext.getJobDetail().getJobDataMap().getString(QuartzConnector.PROPERTY_PAYLOAD_CLASS_NAME);
      }
      try {
        if (ref == null) {
          payload=NullPayload.getInstance();
        }
 else {
          payload=RegistryContext.getRegistry().getContainerContext().getComponent(ref);
        }
      }
 catch (      ObjectNotFoundException e) {
        logger.warn("There is no payload attached to this quartz job. Sending Null payload");
        payload=NullPayload.getInstance();
      }
    }
    receiver.routeMessage(new MuleMessage(receiver.getConnector().getMessageAdapter(payload)));
  }
 catch (  Exception e) {
    receiver.handleException(e);
  }
}
