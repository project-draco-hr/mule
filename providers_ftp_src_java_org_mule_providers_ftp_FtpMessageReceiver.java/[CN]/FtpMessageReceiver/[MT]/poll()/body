{
  FTPFile[] files=listFiles();
  for (int i=0; i < files.length; i++) {
    final FTPFile file=files[i];
    if (!currentFiles.contains(file.getName())) {
      getWorkManager().scheduleWork(new Work(){
        public void run(){
          try {
            currentFiles.add(file.getName());
            processFile(file);
          }
 catch (          Exception e) {
            connector.handleException(e);
          }
 finally {
            currentFiles.remove(file.getName());
          }
        }
        public void release(){
        }
      }
);
    }
  }
}
