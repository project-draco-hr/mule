{
  QueuePersistenceObjectStore queueStore=new QueuePersistenceObjectStore(muleContext);
  queueStore.open();
  muleContext.getRegistry().registerObject(MuleProperties.OBJECT_STORE_DEFAULT_PERSISTENT_NAME,queueStore);
  ObjectStoreManager manager=muleContext.getRegistry().lookupObject(MuleProperties.OBJECT_STORE_MANAGER);
  ListableObjectStore store=manager.getObjectStore("persistencePart1",true);
  assertTrue(store instanceof PartitionedObjectStoreWrapper);
  ObjectStore baseStore=((PartitionedObjectStoreWrapper)store).getBaseStore();
  assertTrue(baseStore instanceof QueuePersistenceObjectStore);
  assertSame(baseStore,muleContext.getRegistry().lookupObject(MuleProperties.OBJECT_STORE_DEFAULT_PERSISTENT_NAME));
  testObjectStore(store,false);
  testObjectStoreExpiry(manager.getObjectStore("persistenceExpPart1",true,-1,500,200));
  testObjectStoreMaxEntries((ListableObjectStore)manager.getObjectStore("persistenceMaxPart1",true,10,10000,200));
}
