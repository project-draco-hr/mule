{
  ServerSocket server=null;
  ArrayList<Integer> ports=new ArrayList<Integer>();
  for (int port=MIN_PORT; ports.size() != numPorts && port < MAX_PORT; ++port) {
    try {
      server=new ServerSocket(port);
      ports.add(port);
    }
 catch (    IOException ex) {
      continue;
    }
 finally {
      if (server != null) {
        try {
          server.close();
        }
 catch (        IOException e) {
          e.printStackTrace();
        }
      }
    }
  }
  if (ports.size() != numPorts) {
    logger.info("requested " + numPorts + " open ports, but returning "+ ports.size());
  }
  return ports;
}
