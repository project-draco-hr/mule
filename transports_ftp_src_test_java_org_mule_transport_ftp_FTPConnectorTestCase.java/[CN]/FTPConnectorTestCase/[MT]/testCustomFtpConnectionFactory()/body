{
  final String testObject="custom object";
  final ImmutableEndpoint endpoint=muleContext.getRegistry().lookupEndpointFactory().getOutboundEndpoint("ftp://test:test@example.com");
  final EndpointURI endpointURI=endpoint.getEndpointURI();
  FtpConnectionFactory testFactory=new TestFtpConnectionFactory(endpointURI);
  FtpConnector connector=(FtpConnector)getConnector();
  connector.setConnectionFactoryClass(testFactory.getClass().getName());
  connector.setValidateConnections(false);
  ObjectPool pool=connector.getFtpPool(endpointURI);
  Object obj=pool.borrowObject();
  assertEquals("Custom FTP connection factory has been ignored.",testObject,obj);
}
