{
  try {
    if (event.getEventType() == MessageExchangeEvent.IN_RCVD_EVENT) {
      com.fs.pxe.sfwk.spi.MessageExchange me=event.getMessageExchange();
      Message input=me.lastInput();
      System.err.println(input);
      System.err.println(DOMUtils.domToString(input.getMessage()));
      ServiceContext service=event.getTargetService();
      Definition def=service.getSystemWSDL();
      QName serviceName=new QName(def.getTargetNamespace(),service.getServiceName());
      String portName=event.getPort().getPortName();
      String operation=me.getName();
      System.err.println("Sending message to " + serviceName + " at "+ portName);
      ServiceEndpoint se=this.context.getEndpoint(serviceName,portName);
      MessageExchangeFactory mef=this.context.getDeliveryChannel().createExchangeFactory(se);
      InOnly in=mef.createInOnlyExchange();
      in.setOperation(new QName(def.getTargetNamespace(),operation));
      NormalizedMessage m=in.createMessage();
      m.setContent(new DOMSource(input.getMessage()));
      in.setInMessage(m);
      this.context.getDeliveryChannel().send(in);
    }
 else {
      throw new UnsupportedOperationException();
    }
  }
 catch (  Exception e) {
    e.printStackTrace();
  }
}
