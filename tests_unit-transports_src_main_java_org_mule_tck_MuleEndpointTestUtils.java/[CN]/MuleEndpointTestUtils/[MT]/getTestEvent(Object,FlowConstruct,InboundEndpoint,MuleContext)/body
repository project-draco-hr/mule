{
  final MuleSession session=getTestSession(flowConstruct,context);
  final MuleMessageFactory factory=endpoint.getConnector().createMuleMessageFactory();
  final MuleMessage message=factory.create(data,endpoint.getEncoding());
  final DefaultMuleEvent event=new DefaultMuleEvent(DefaultMessageContext.create(flowConstruct,TEST_CONNECTOR),message,flowConstruct,session);
  DefaultMuleEventEndpointUtils.populateFieldsFromInboundEndpoint(event,endpoint);
  return event;
}
