{
  final String passiveString=(String)endpoint.getProperty(FtpConnector.PROPERTY_PASSIVE_MODE);
  if (passiveString == null) {
    if (isPassive()) {
      if (logger.isTraceEnabled()) {
        logger.trace("Entering FTP passive mode");
      }
      client.enterLocalPassiveMode();
    }
 else {
      if (logger.isTraceEnabled()) {
        logger.trace("Entering FTP active mode");
      }
      client.enterLocalActiveMode();
    }
  }
 else {
    final boolean passiveMode=Boolean.valueOf(passiveString).booleanValue();
    if (passiveMode) {
      if (logger.isTraceEnabled()) {
        logger.trace("Entering FTP passive mode (endpoint override)");
      }
      client.enterLocalPassiveMode();
    }
 else {
      if (logger.isTraceEnabled()) {
        logger.trace("Entering FTP active mode (endpoint override)");
      }
      client.enterLocalActiveMode();
    }
  }
}
