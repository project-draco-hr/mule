{
  final String passiveString=(String)endpointProperties.get(FtpConnector.PROPERTY_PASSIVE_MODE);
  if (passiveString == null) {
    if (isPassive()) {
      logger.debug("Entering FTP passive mode");
      client.enterLocalPassiveMode();
    }
 else {
      logger.debug("Entering FTP active mode");
      client.enterLocalActiveMode();
    }
  }
 else {
    final boolean passiveMode=Boolean.valueOf(passiveString).booleanValue();
    if (passiveMode) {
      logger.debug("Entering FTP passive mode (endpoint override)");
      client.enterLocalPassiveMode();
    }
 else {
      logger.debug("Entering FTP active mode (endpoint override)");
      client.enterLocalActiveMode();
    }
  }
}
