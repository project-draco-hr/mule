{
  Path path=resolveExistingPath(directoryPath);
  if (!Files.isDirectory(path)) {
    throw cannotListFileException(path);
  }
  TreeNode.Builder treeNodeBuilder=TreeNode.Builder.forDirectory(new LocalFileAttributes(path));
  doList(path.toFile(),treeNodeBuilder,recursive,message,matcher);
  return treeNodeBuilder.build();
}
