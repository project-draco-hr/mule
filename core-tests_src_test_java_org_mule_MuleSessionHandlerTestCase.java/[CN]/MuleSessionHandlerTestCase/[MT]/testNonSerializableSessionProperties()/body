{
  MuleEvent event=MuleTestUtils.getTestEvent("Test Message",muleContext);
  SessionHandler handler=new SerializeAndEncodeSessionHandler();
  NotSerializableClass clazz=new NotSerializableClass();
  event.getSession().setProperty("foo",clazz);
  handler.storeSessionInfoToMessage(event.getSession(),event.getMessage());
  Object s=removeProperty(event);
  event.getMessage().setProperty(MuleProperties.MULE_SESSION_PROPERTY,s,PropertyScope.INBOUND);
  MuleSession session=handler.retrieveSessionInfoFromMessage(event.getMessage());
  assertNull(session.getProperty("foo"));
}
