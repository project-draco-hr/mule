{
  try {
    currentFiles.add(name);
    processFile(file);
  }
 catch (  Exception e) {
    if (e instanceof MessagingException) {
      MuleEvent event=((MessagingException)e).getEvent();
      event.getFlowConstruct().getExceptionListener().handleException(e,event);
    }
 else {
      getConnector().getMuleContext().getExceptionListener().handleException(e);
    }
  }
 finally {
    currentFiles.remove(name);
    scheduledFiles.remove(name);
  }
}
