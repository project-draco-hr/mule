{
  FTPFile[] files=listFiles();
  if (logger.isDebugEnabled()) {
    logger.debug("Poll encountered " + files.length + " new file(s)");
  }
synchronized (scheduledFiles) {
    for (    final FTPFile file : files) {
      if (getLifecycleState().isStopping()) {
        break;
      }
      final String fileName=file.getName();
      if (!scheduledFiles.contains(fileName) && !currentFiles.contains(fileName)) {
        if (!scheduledFiles.contains(fileName) && !currentFiles.contains(fileName)) {
          scheduledFiles.add(fileName);
          getWorkManager().scheduleWork(new FtpWork(fileName,file));
        }
      }
    }
  }
}
