{
  httpServer=new Server();
  SocketListener socketListener=new SocketListener(new InetAddrPort(endpoint.getEndpointURI().getPort()));
  ThreadingProfile tp=connector.getReceiverThreadingProfile();
  socketListener.setMaxIdleTimeMs((int)tp.getThreadTTL());
  socketListener.setMaxThreads(tp.getMaxThreadsActive());
  socketListener.setThreadsPriority(tp.getThreadPriority());
  httpServer.addListener(socketListener);
  String path=endpoint.getEndpointURI().getPath();
  if (StringUtils.isEmpty(path)) {
    path="/";
  }
  if (!path.endsWith("/")) {
    path+="/";
  }
  HttpContext context=httpServer.getContext("/");
  context.setRequestLog(null);
  ServletHandler handler=new ServletHandler();
  if ("rest".equals(endpoint.getEndpointURI().getScheme())) {
    handler.addServlet("MuleRESTReceiverServlet",path + "*",MuleRESTReceiverServlet.class.getName());
  }
 else {
    handler.addServlet("JettyReceiverServlet",path + "*",JettyReceiverServlet.class.getName());
  }
  context.addHandler(handler);
  context.setAttribute("messageReceiver",this);
}
