{
  super.doSetUp();
  builder=new QuickConfigurationBuilder();
  UMOEndpointBuilder endpointBuilder=new EndpointURIEndpointBuilder("vm://Single",managementContext);
  endpointBuilder.setName("SingleEndpoint");
  UMOImmutableEndpoint vmSingle=managementContext.getRegistry().lookupEndpointFactory().getOutboundEndpoint(endpointBuilder,managementContext);
  UMOEndpointBuilder endpointBuilder2=new EndpointURIEndpointBuilder("vm://Single",managementContext);
  endpointBuilder2.setName("ChainedEndpoint");
  UMOImmutableEndpoint vmChained=managementContext.getRegistry().lookupEndpointFactory().getOutboundEndpoint(endpointBuilder2,managementContext);
  FunctionalTestComponent single=new FunctionalTestComponent();
  single.setEventCallback(this);
  FunctionalTestComponent chained=new FunctionalTestComponent();
  chained.setEventCallback(this);
  builder.registerComponentInstance(single,"SINGLE",vmSingle.getEndpointURI());
  builder.registerComponentInstance(chained,"CHAINED",vmChained.getEndpointURI(),vmSingle.getEndpointURI());
}
