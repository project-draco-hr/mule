{
  Mock session=MuleTestUtils.getMockSession();
  session.matchAndReturn("getService",getTestService());
  XmlMessageSplitter splitter=new XmlMessageSplitter();
  splitter.setMuleContext(muleContext);
  MuleMessage message=new DefaultMuleMessage("This is not XML.",muleContext);
  try {
    splitter.route(message,(MuleSession)session.proxy());
    fail("No exception thrown.");
  }
 catch (  IllegalArgumentException iaex) {
    assertTrue("Wrong exception message.",iaex.getMessage().startsWith("Failed to initialise the payload: "));
  }
}
