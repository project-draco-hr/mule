{
  super.doSetUp();
  session=mock(MuleSession.class);
  dest1=getTestOutboundEndpoint("dest1");
  dest2=getTestOutboundEndpoint("dest2");
  dest3=getTestOutboundEndpoint("dest3");
  mockendpoint1=RouterTestUtils.getMockEndpoint(dest1);
  mockendpoint2=RouterTestUtils.getMockEndpoint(dest2);
  mockendpoint3=RouterTestUtils.getMockEndpoint(dest3);
  List<MessageProcessor> endpoints=new ArrayList<MessageProcessor>();
  endpoints.add((OutboundEndpoint)mockendpoint1.proxy());
  endpoints.add((OutboundEndpoint)mockendpoint2.proxy());
  endpoints.add((OutboundEndpoint)mockendpoint3.proxy());
  router=new EndpointSelector();
  router.setRoutes(endpoints);
  router.setMuleContext(muleContext);
  router.initialise();
}
