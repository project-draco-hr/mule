{
  super.doSetUp();
  session=MuleTestUtils.getMockSession();
  session.matchAndReturn("getFlowConstruct",getTestService());
  dest1=getTestOutboundEndpoint("dest1");
  dest2=getTestOutboundEndpoint("dest2");
  dest3=getTestOutboundEndpoint("dest3");
  List<OutboundEndpoint> endpoints=new ArrayList<OutboundEndpoint>();
  endpoints.add(dest1);
  endpoints.add(dest2);
  endpoints.add(dest3);
  router=new EndpointSelector();
  router.setEndpoints(endpoints);
  router.setMuleContext(muleContext);
  router.initialise();
}
