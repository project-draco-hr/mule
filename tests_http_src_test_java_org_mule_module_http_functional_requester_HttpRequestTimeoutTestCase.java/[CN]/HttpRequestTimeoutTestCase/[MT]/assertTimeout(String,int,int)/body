{
  final Latch requestTimeoutLatch=new Latch();
  Thread thread=new Thread(){
    @Override public void run(){
      try {
        FlowRunner runner=flowRunner(flowName).withPayload(TEST_MESSAGE).withFlowVariable("timeout",responseTimeoutRequester);
        runner.buildEvent().setTimeout(responseTimeoutEvent);
        MessagingException e=runner.runExpectingException();
        assertThat(e.getCauseException(),instanceOf(TimeoutException.class));
        requestTimeoutLatch.release();
      }
 catch (      Exception e) {
        throw new RuntimeException(e);
      }
    }
  }
;
  thread.start();
  assertTrue(requestTimeoutLatch.await(TEST_TIMEOUT,TimeUnit.MILLISECONDS));
  thread.join();
  serverLatch.release();
}
