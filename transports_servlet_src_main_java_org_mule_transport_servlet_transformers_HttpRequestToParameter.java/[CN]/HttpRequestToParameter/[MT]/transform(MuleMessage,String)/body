{
  HttpRequestMessageAdapter messageAdapter=(HttpRequestMessageAdapter)message.getAdapter();
  String payloadParam=messageAdapter.getStringProperty(AbstractReceiverServlet.PAYLOAD_PARAMETER_NAME,AbstractReceiverServlet.DEFAULT_PAYLOAD_PARAMETER_NAME);
  String payload=messageAdapter.getStringProperty(payloadParam,null);
  if (null == payload) {
    if (isText(messageAdapter.getContentType())) {
      try {
        InputStream is=(InputStream)message.getPayload();
        BufferedReader reader=new BufferedReader(new InputStreamReader(is,messageAdapter.getCharacterEncoding()));
        StringBuffer buffer=new StringBuffer(8192);
        String line=reader.readLine();
        while (line != null) {
          buffer.append(line);
          line=reader.readLine();
          if (line != null)           buffer.append(SystemUtils.LINE_SEPARATOR);
        }
        payload=buffer.toString();
      }
 catch (      IOException e) {
        throw new TransformerException(this,e);
      }
    }
  }
  return payload;
}
