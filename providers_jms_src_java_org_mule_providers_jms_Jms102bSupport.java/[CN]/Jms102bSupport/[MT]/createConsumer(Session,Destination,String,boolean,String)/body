{
  if (destination instanceof Queue) {
    if (session instanceof XAQueueSession || session instanceof QueueSession) {
      if (messageSelector != null) {
        return ((QueueSession)session).createReceiver((Queue)destination,messageSelector);
      }
 else {
        return ((QueueSession)session).createReceiver((Queue)destination);
      }
    }
  }
 else {
    if (session instanceof XATopicSession || session instanceof TopicSession) {
      if (durableName == null) {
        return ((TopicSession)session).createSubscriber((Topic)destination,messageSelector,noLocal);
      }
 else {
        return ((TopicSession)session).createDurableSubscriber((Topic)destination,messageSelector,durableName,noLocal);
      }
    }
  }
  throw new IllegalArgumentException("Session and domain type do not match");
}
