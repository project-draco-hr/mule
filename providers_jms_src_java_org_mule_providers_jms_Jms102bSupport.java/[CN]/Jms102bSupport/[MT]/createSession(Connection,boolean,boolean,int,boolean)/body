{
  if (topic && connection instanceof TopicConnection) {
    return ((TopicConnection)connection).createTopicSession(noLocal,ackMode);
  }
 else   if (connection instanceof QueueConnection) {
    return ((QueueConnection)connection).createQueueSession(transacted,ackMode);
  }
 else {
    throw new IllegalArgumentException("Unknown Jms connection: " + connection.getClass().getName());
  }
}
