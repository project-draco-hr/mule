{
  if (fileAge > 0) {
    long lastModifiedTime=client.getLastModifiedTime(fileName);
    long now=System.currentTimeMillis();
    long diff=now - lastModifiedTime;
    if (diff < fileAge) {
      if (logger.isDebugEnabled()) {
        logger.debug("The file has not aged enough yet, will return nothing for: " + fileName + ". The file must be "+ (fileAge - diff)+ "ms older, was "+ diff);
      }
      return true;
    }
    if (logger.isDebugEnabled()) {
      logger.debug("The file " + fileName + " has aged enough. Was "+ diff);
    }
  }
  if (sizeCheckDelayMs > 0) {
    logger.info("Perform size check with a delay of: " + sizeCheckDelayMs + " ms.");
    long fileSize1=client.getSize(fileName);
    Thread.sleep(sizeCheckDelayMs);
    long fileSize2=client.getSize(fileName);
    if (fileSize1 == fileSize2) {
      logger.info("File is stable (not growing), ready for retrieval: " + fileName);
    }
 else {
      logger.info("File is growing, deferring retrieval: " + fileName);
      return true;
    }
  }
  return false;
}
