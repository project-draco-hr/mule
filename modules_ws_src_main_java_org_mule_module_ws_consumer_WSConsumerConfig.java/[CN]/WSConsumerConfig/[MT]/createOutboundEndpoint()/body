{
  Preconditions.checkState(StringUtils.isNotEmpty(serviceAddress),"No serviceAddress provided in WS consumer config");
  EndpointBuilder builder=muleContext.getEndpointFactory().getEndpointBuilder(serviceAddress);
  if (connector != null) {
    String protocol=new MuleEndpointURI(serviceAddress,muleContext).getScheme();
    if (!connector.supportsProtocol(protocol)) {
      throw new IllegalStateException(String.format("Connector %s does not support protocol: %s",connector.getName(),protocol));
    }
    builder.setConnector(connector);
  }
  return muleContext.getEndpointFactory().getOutboundEndpoint(builder);
}
