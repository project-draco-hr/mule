{
  String protocolTransactionFactoryClassName="org.mule.transport." + StringUtils.lowerCase(protocol) + "."+ StringUtils.capitalize(protocol)+ "TransactionFactory";
  if (!ClassUtils.isClassOnPath(protocolTransactionFactoryClassName,getClass())) {
    throw new TransactionException(MessageFactory.createStaticMessage("Failed to locate a transaction factory for protocol: " + protocol));
  }
  try {
    return (TransactionFactory)ClassUtils.instanciateClass(protocolTransactionFactoryClassName);
  }
 catch (  Exception e) {
    throw new TransactionException(MessageFactory.createStaticMessage("Failed to instantiate a transaction factory for protocol: " + protocol),e);
  }
}
