{
  MessageAdapter messageAdapter=createAdapter(TEST_MESSAGE);
  DefaultMuleMessage muleMessage=new DefaultMuleMessage(messageAdapter);
  byte[] serializedMessage=SerializationUtils.serialize(muleMessage);
  DefaultMuleMessage readMessage=(DefaultMuleMessage)SerializationUtils.deserialize(serializedMessage);
  assertNotNull(readMessage.getAdapter());
  MessageAdapter readMessageAdapter=readMessage.getAdapter();
  assertTrue(readMessageAdapter instanceof EjbMessageAdapter);
  assertEquals(TEST_MESSAGE,readMessageAdapter.getPayload());
}
