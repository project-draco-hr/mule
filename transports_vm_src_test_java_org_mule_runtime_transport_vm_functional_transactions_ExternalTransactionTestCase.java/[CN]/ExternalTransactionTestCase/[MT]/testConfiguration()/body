{
  tm=muleContext.getTransactionManager();
  tm.begin();
  MuleClient client=muleContext.getClient();
  client.send("vm://entry?connector=vm-normal","OK",null);
  tm.commit();
  MuleMessage response=client.request("queue2",WAIT);
  assertNull("Response is not null",response);
  try {
    client.send("vm://entry?connector=vm-normal","OK",null);
    fail("Exception expected");
  }
 catch (  Exception e) {
    assertTrue(ExceptionUtils.getRootCause(e) instanceof IllegalTransactionStateException);
  }
}
