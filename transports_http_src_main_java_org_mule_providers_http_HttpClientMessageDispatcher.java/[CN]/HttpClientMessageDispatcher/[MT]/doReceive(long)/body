{
  HttpMethod httpMethod=new GetMethod(endpoint.getEndpointURI().getAddress());
  httpMethod.setDoAuthentication(true);
  if (endpoint.getEndpointURI().getUserInfo() != null && endpoint.getProperty(HttpConstants.HEADER_AUTHORIZATION) == null) {
    StringBuffer header=new StringBuffer(128);
    header.append("Basic ");
    header.append(new String(Base64.encodeBase64(endpoint.getEndpointURI().getUserInfo().getBytes(endpoint.getEncoding()))));
    httpMethod.addRequestHeader(HttpConstants.HEADER_AUTHORIZATION,header.toString());
  }
  boolean releaseConn=false;
  try {
    HttpClient client=new HttpClient();
    client.executeMethod(httpMethod);
    if (httpMethod.getStatusCode() == HttpStatus.SC_OK) {
      UMOMessage res=(UMOMessage)receiveTransformer.transform(httpMethod);
      if (StringUtils.EMPTY.equals(res.getPayload())) {
        releaseConn=true;
      }
      return res;
    }
 else {
      releaseConn=true;
      throw new ReceiveException(HttpMessages.requestFailedWithStatus(httpMethod.getStatusLine().toString()),endpoint,timeout);
    }
  }
 catch (  ReceiveException e) {
    releaseConn=true;
    throw e;
  }
catch (  Exception e) {
    releaseConn=true;
    throw new ReceiveException(endpoint,timeout,e);
  }
 finally {
    if (releaseConn) {
      httpMethod.releaseConnection();
    }
  }
}
