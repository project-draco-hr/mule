{
  HttpMethod httpMethod;
  if (body instanceof String) {
    ObjectToHttpClientMethodRequest trans=new ObjectToHttpClientMethodRequest();
    httpMethod=(HttpMethod)trans.transform(body.toString());
  }
 else   if (body instanceof byte[]) {
    byte[] buffer=event.getTransformedMessageAsBytes();
    postMethod.setRequestEntity(new ByteArrayRequestEntity(buffer,event.getEncoding()));
    httpMethod=postMethod;
  }
 else {
    if (!(body instanceof OutputHandler)) {
      body=event.getTransformedMessage(OutputHandler.class);
    }
    OutputHandler outputHandler=(OutputHandler)body;
    postMethod.setRequestEntity(new StreamPayloadRequestEntity(outputHandler,event));
    postMethod.setContentChunked(true);
    httpMethod=postMethod;
  }
  return httpMethod;
}
