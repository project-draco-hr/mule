{
  try {
    Object payload=event.getTransformedMessage();
    if (!connector.isKeepSendSocketOpen()) {
      connectedSocket=initSocket(event.getEndpoint().getEndpointURI().getAddress());
    }
 else {
      reconnect(event,connector.getMaxRetryCount());
    }
    try {
      write(connectedSocket,payload);
    }
 catch (    IOException e) {
      if (connector.isKeepSendSocketOpen()) {
        logger.warn("Write raised exception: '" + e.getMessage() + "' attempting to reconnect.");
        doDispose();
        if (reconnect(event,connector.getMaxRetryCount()))         write(connectedSocket,payload);
      }
 else {
        throw e;
      }
    }
    if (useRemoteSync(event)) {
      try {
        byte[] result=receive(connectedSocket,event.getEndpoint().getRemoteSyncTimeout());
        if (result == null) {
          return null;
        }
        return new MuleMessage(connector.getMessageAdapter(result));
      }
 catch (      SocketTimeoutException e) {
        logger.info("Socket timed out normally while doing a synchronous receive on endpointUri: " + event.getEndpoint().getEndpointURI());
        return null;
      }
    }
 else {
      return event.getMessage();
    }
  }
  finally {
    if (!connector.isKeepSendSocketOpen()) {
      doDispose();
    }
  }
}
