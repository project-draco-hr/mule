{
  Class beanClass=null;
  if (isAllowClassAttribute()) {
    beanClass=getBeanClassFromAttribute(element);
  }
  if (beanClass == null) {
    beanClass=getBeanClass(element);
  }
  if (null != beanClass && null != classConstraint && !classConstraint.isAssignableFrom(beanClass)) {
    logger.error(beanClass + " not a subclass of " + classConstraint);
    beanClass=null;
  }
  if (null == beanClass) {
    throw new IllegalStateException("No class for element " + element.getNodeName());
  }
  return beanClass;
}
