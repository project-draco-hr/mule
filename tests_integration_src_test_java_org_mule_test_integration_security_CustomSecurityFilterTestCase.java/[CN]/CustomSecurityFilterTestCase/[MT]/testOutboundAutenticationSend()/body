{
  Map<String,Object> props=new HashMap<String,Object>();
  props.put("username","ross");
  props.put("pass","ross");
  MuleMessage result=flowRunner("test").withPayload("hi").withInboundProperties(props).run().getMessage();
  assertNull(result.getExceptionPayload());
  props.put("pass","badpass");
  MessagingException e=flowRunner("test").withPayload("hi").withInboundProperties(props).runExpectingException();
  assertThat(ExceptionHelper.getRootException(e),instanceOf(BadCredentialsException.class));
}
