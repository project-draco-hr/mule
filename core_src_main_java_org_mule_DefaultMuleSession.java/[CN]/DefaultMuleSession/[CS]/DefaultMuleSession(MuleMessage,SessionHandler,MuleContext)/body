{
  this.muleContext=muleContext;
  if (requestSessionHandler == null) {
    throw new IllegalArgumentException(CoreMessages.propertiesNotSet("requestSessionHandler").toString());
  }
  if (message == null) {
    throw new IllegalArgumentException(CoreMessages.propertiesNotSet("message").toString());
  }
  properties=new HashMap();
  requestSessionHandler.retrieveSessionInfoFromMessage(message,this);
  id=(String)getProperty(requestSessionHandler.getSessionIDKey());
  if (id == null) {
    id=UUID.getUUID();
    if (logger.isDebugEnabled()) {
      logger.debug("There is no session id on the request using key: " + requestSessionHandler.getSessionIDKey() + ". Generating new session id: "+ id);
    }
  }
 else   if (logger.isDebugEnabled()) {
    logger.debug("Got session with id: " + id);
  }
}
