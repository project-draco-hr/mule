{
  int timeout=event.getMessage().getIntProperty(MuleProperties.MULE_EVENT_TIMEOUT_PROPERTY,-1);
  if (timeout >= 0) {
    event.setTimeout(timeout);
  }
  if (event.getEndpoint() instanceof OutboundEndpoint) {
    MuleEvent resultEvent=((OutboundEndpoint)event.getEndpoint()).process(event);
    if (resultEvent != null) {
      return resultEvent.getMessage();
    }
 else {
      return null;
    }
  }
 else   if (flowConstruct == null) {
    throw new DispatchException(CoreMessages.noComponentForEndpoint(),event.getMessage(),event.getEndpoint());
  }
 else   if (!(flowConstruct instanceof Service)) {
    throw new UnsupportedOperationException("MuleSession.sendEvent is only supported when flow constuct is a Service");
  }
 else {
    if (logger.isDebugEnabled()) {
      logger.debug("sending event to service: " + flowConstruct.getName() + " event is: "+ event);
    }
    return ((Service)flowConstruct).sendEvent(event);
  }
}
