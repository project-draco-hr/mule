{
  URI uri=getURI(msg);
  PostMethod postMethod=new PostMethod(uri.toString());
  String bodyParameterName=getBodyParameterName(msg);
  Object src=msg.getPayload();
  if (src instanceof Map) {
    for (    Map.Entry<?,?> entry : ((Map<?,?>)src).entrySet()) {
      postMethod.addParameter(entry.getKey().toString(),entry.getValue().toString());
    }
  }
 else   if (bodyParameterName != null) {
    postMethod.addParameter(bodyParameterName,src.toString());
  }
 else {
    setupEntityMethod(src,outputEncoding,msg,postMethod);
  }
  String outgoingContentType=msg.getInvocationProperty(HttpConstants.HEADER_CONTENT_TYPE);
  if (outgoingContentType != null) {
    postMethod.setRequestHeader(HttpConstants.HEADER_CONTENT_TYPE,outgoingContentType);
  }
  return postMethod;
}
