{
  if (message instanceof Object[]) {
    this.message=((Object[])message)[0];
    if (((Object[])message).length > 1) {
      Map props=(Map)((Object[])message)[1];
      for (Iterator iterator=props.keySet().iterator(); iterator.hasNext(); ) {
        Object o=iterator.next();
        setProperty(o,props.get(o));
      }
    }
  }
 else   if (message instanceof byte[]) {
    this.message=message;
  }
 else {
    throw new MessageTypeNotSupportedException(message,getClass());
  }
  String temp=(String)properties.get(HttpConnector.HTTP_VERSION_PROPERTY);
  if (HttpConstants.HTTP10.equalsIgnoreCase(temp)) {
    http11=false;
  }
  String charset=null;
  Header contenttype=getHeader(HttpConstants.HEADER_CONTENT_TYPE);
  if (contenttype != null) {
    HeaderElement values[]=contenttype.getElements();
    if (values.length == 1) {
      NameValuePair param=values[0].getParameterByName("charset");
      if (param != null) {
        charset=param.getValue();
      }
    }
  }
  if (charset != null) {
    encoding=charset;
  }
 else {
    encoding=MuleManager.getConfiguration().getEncoding();
  }
}
