{
  DefaultMessageProcessorChainBuilder requestChainBuilder=new EndpointMessageProcessorChainBuilder(endpoint);
  requestChainBuilder.setName("OutboundEndpoint '" + endpoint.getEndpointURI().getUri() + "' request chain");
  requestChainBuilder.chain(createOutboundMessageProcessors(endpoint));
  requestChainBuilder.chain(endpoint.getMessageProcessors());
  if (target == null) {
    throw new ConfigurationException(MessageFactory.createStaticMessage("No listener (target) has been set for this endpoint"));
  }
  requestChainBuilder.chain(target);
  if (!endpoint.getExchangePattern().hasResponse()) {
    return requestChainBuilder.build();
  }
 else {
    DefaultMessageProcessorChainBuilder responseChainBuilder=new EndpointMessageProcessorChainBuilder(endpoint);
    responseChainBuilder.setName("OutboundEndpoint '" + endpoint.getEndpointURI().getUri() + "' response chain");
    responseChainBuilder.chain(createOutboundResponseMessageProcessors(endpoint));
    responseChainBuilder.chain(endpoint.getResponseMessageProcessors());
    DefaultMessageProcessorChainBuilder compositeChainBuilder=new EndpointMessageProcessorChainBuilder(endpoint);
    compositeChainBuilder.setName("OutboundEndpoint '" + endpoint.getEndpointURI().getUri() + "' composite request/response chain");
    compositeChainBuilder.chain(requestChainBuilder.build(),responseChainBuilder.build());
    return compositeChainBuilder.build();
  }
}
