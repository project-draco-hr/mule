{
  Enumeration<?> e=ClassUtils.getResources(SERVICE_PATH + REGISTRY_PROPERTIES,getClass());
  List<Map<String,String>> bootstraps=new LinkedList<Map<String,String>>();
  while (e.hasMoreElements()) {
    try {
      bootstraps.add(this.readBootstrap((URL)e.nextElement()));
    }
 catch (    Exception e1) {
      throw new InitialisationException(e1,this);
    }
  }
  int objectCounter=1;
  int transformerCounter=1;
  Map<String,String> transformers=new LinkedHashMap<String,String>();
  Map<String,String> namedObjects=new LinkedHashMap<String,String>();
  Map<String,String> unnamedObjects=new LinkedHashMap<String,String>();
  Map<String,String> singleTransactionFactories=new LinkedHashMap<String,String>();
  for (  Map<String,String> bootstrap : bootstraps) {
    for (    Map.Entry<String,String> entry : bootstrap.entrySet()) {
      final String key=entry.getKey();
      if (key.contains(OBJECT_KEY)) {
        String newKey=key.substring(0,key.lastIndexOf(".")) + objectCounter++;
        unnamedObjects.put(newKey,entry.getValue());
      }
 else       if (key.contains(TRANSFORMER_KEY)) {
        String newKey=key.substring(0,key.lastIndexOf(".")) + transformerCounter++;
        transformers.put(newKey,entry.getValue());
      }
 else       if (key.contains(SINGLE_TX)) {
        if (!key.contains(".transaction.resource")) {
          String transactionResourceKey=key.replace(".transaction.factory",".transaction.resource");
          String transactionResource=bootstrap.get(transactionResourceKey);
          if (transactionResource == null) {
            throw new InitialisationException(CoreMessages.createStaticMessage(String.format("Theres no transaction resource specified for transaction factory %s",key)),this);
          }
          singleTransactionFactories.put(entry.getValue(),transactionResource);
        }
      }
 else {
{
          namedObjects.put(key,entry.getValue());
        }
      }
    }
  }
  try {
    registerUnnamedObjects(unnamedObjects,context.getRegistry());
    registerTransformers((MuleRegistryHelper)context.getRegistry());
    registerTransformers(transformers,context.getRegistry());
    registerObjects(namedObjects,context.getRegistry());
    registerTransactionFactories(singleTransactionFactories,context);
  }
 catch (  Exception e1) {
    throw new InitialisationException(e1,this);
  }
}
