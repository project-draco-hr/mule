{
  for (  Entry<String,String> entry : singleTransactionFactories.entrySet()) {
    String transactionResourceClassNameProperties=entry.getValue();
    String transactionFactoryClassName=entry.getKey();
    String name=null;
    boolean optional=false;
    int x=transactionResourceClassNameProperties.indexOf(",");
    if (x > -1) {
      Properties p=PropertiesUtils.getPropertiesFromString(transactionResourceClassNameProperties.substring(x + 1),',');
      name=p.getProperty("name",null);
      optional=p.containsKey("optional");
    }
    final String transactionResourceClassName=(x == -1 ? transactionResourceClassNameProperties : transactionResourceClassNameProperties.substring(0,x));
    try {
      context.getTransactionFactoryManager().registerTransactionFactory(Class.forName(transactionResourceClassName),(TransactionFactory)Class.forName(transactionFactoryClassName).newInstance());
    }
 catch (    NoClassDefFoundError ncdfe) {
      if (optional) {
        if (logger.isDebugEnabled()) {
          logger.debug("Ignoring optional transaction factory: " + transactionResourceClassName);
        }
      }
 else {
        throw ncdfe;
      }
    }
catch (    ClassNotFoundException cnfe) {
      if (optional) {
        if (logger.isDebugEnabled()) {
          logger.debug("Ignoring optional transaction factory: " + transactionResourceClassName);
        }
      }
 else {
        throw cnfe;
      }
    }
  }
}
