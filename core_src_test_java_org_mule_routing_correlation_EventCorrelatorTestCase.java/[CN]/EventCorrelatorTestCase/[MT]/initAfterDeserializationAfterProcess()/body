{
  when(mockMessagingInfoMapping.getCorrelationId(isA(MuleMessage.class))).thenReturn(TEST_GROUP_ID);
  when(mockProcessedGroups.contains(TEST_GROUP_ID)).thenReturn(false);
  when(mockEventCorrelatorCallback.shouldAggregateEvents(mockEventGroup)).thenReturn(false);
  doThrow(new ObjectAlreadyExistsException()).when(mockObjectStore).store(TEST_GROUP_ID,mockEventGroup);
  EventCorrelator eventCorrelator=createEventCorrelator();
  eventCorrelator.process(mockMuleEvent);
  verify(mockEventGroup,times(1)).initAfterDeserialisation(mockMuleContext);
}
