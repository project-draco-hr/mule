{
  final XFire xfire=getXfire();
  final String serviceName=XFireMessageDispatcher.getServiceName(endpoint);
  final Service service=xfire.getServiceRegistry().getService(serviceName);
  if (service == null) {
    throw new FatalConnectException(XFireMessages.serviceIsNull(serviceName),this);
  }
  List inList=getServerInHandlers();
  if (inList != null) {
    for (int i=0; i < inList.size(); i++) {
      Handler handler=(Handler)ClassUtils.instanciateClass(inList.get(i).toString(),ClassUtils.NO_ARGS,getClass());
      service.addInHandler(handler);
    }
  }
  List outList=getServerOutHandlers();
  if (outList != null) {
    for (int i=0; i < outList.size(); i++) {
      Handler handler=(Handler)ClassUtils.instanciateClass(outList.get(i).toString(),ClassUtils.NO_ARGS,getClass());
      service.addOutHandler(handler);
    }
  }
  try {
    return createXFireClient(endpoint,service,xfire);
  }
 catch (  Exception ex) {
    connectable.disconnect();
    throw ex;
  }
}
