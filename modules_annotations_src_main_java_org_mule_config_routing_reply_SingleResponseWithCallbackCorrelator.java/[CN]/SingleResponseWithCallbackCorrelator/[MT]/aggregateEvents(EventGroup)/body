{
  MuleEvent event=events.iterator().next();
  if (!(event.getFlowConstruct() instanceof Service)) {
    throw new UnsupportedOperationException("CollectionResponseWithCallbackCorrelator is only supported with Service");
  }
  if (callback != null) {
    event.getMessage().setInvocationProperty(MuleProperties.MULE_METHOD_PROPERTY,callback);
    try {
      return ((Service)event.getFlowConstruct()).getComponent().process(event);
    }
 catch (    MuleException e) {
      throw new RoutingException(AnnotationsMessages.failedToInvokeReplyMethod(callback),event.getMessage(),event.getEndpoint());
    }
  }
 else {
    return event;
  }
}
