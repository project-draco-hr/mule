{
  MuleMessage retMessage;
  final VMMessageReceiver receiver=connector.getReceiver(endpoint.getEndpointURI());
  if (receiver == null) {
    throw new NoReceiverForEndpointException(VMMessages.noReceiverForEndpoint(connector.getName(),endpoint.getEndpointURI()));
  }
  MuleEvent eventToSend=DefaultMuleEvent.copy(event);
  final MuleMessage message=eventToSend.getMessage().createInboundMessage();
  ProcessingTemplate<MuleMessage> processingTemplate=TransactionalProcessingTemplate.createTransactionalProcessingTemplate(event.getMuleContext(),receiver.getEndpoint().getTransactionConfig());
  ProcessingCallback<MuleMessage> processingCallback=new ProcessingCallback<MuleMessage>(){
    public MuleMessage process() throws Exception {
      return receiver.onCall(message);
    }
  }
;
  retMessage=processingTemplate.execute(processingCallback);
  if (logger.isDebugEnabled()) {
    logger.debug("sent event on endpointUri: " + endpoint.getEndpointURI());
  }
  if (retMessage != null) {
    retMessage=retMessage.createInboundMessage();
  }
  return retMessage;
}
