{
  MimeMessage mimeMessage=null;
  if (mailMessage instanceof MimeMessage) {
    mimeMessage=(MimeMessage)mailMessage;
  }
  try {
    Address[] recipients=mailMessage.getRecipients(recipientType);
    muleMessage.setProperty(property,MailUtils.mailAddressesToString(recipients),PropertyScope.INBOUND);
  }
 catch (  MessagingException e) {
    if (mimeMessage != null) {
      String[] header=mimeMessage.getHeader(recipientType.toString());
      String recipients=StringUtils.join(header,", ");
      muleMessage.setProperty(property,recipients,PropertyScope.INBOUND);
    }
  }
}
