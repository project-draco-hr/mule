{
  super.addProperties(muleMessage,transportMessage);
  Message mailMessage=(Message)transportMessage;
  addRecipientProperty(muleMessage,mailMessage,RecipientType.TO,MailProperties.INBOUND_TO_ADDRESSES_PROPERTY);
  addRecipientProperty(muleMessage,mailMessage,RecipientType.CC,MailProperties.INBOUND_CC_ADDRESSES_PROPERTY);
  addRecipientProperty(muleMessage,mailMessage,RecipientType.BCC,MailProperties.INBOUND_BCC_ADDRESSES_PROPERTY);
  try {
    muleMessage.setOutboundProperty(MailProperties.INBOUND_REPLY_TO_ADDRESSES_PROPERTY,MailUtils.mailAddressesToString(mailMessage.getReplyTo()));
  }
 catch (  MessagingException me) {
    log.warn("Invalid address found in ReplyTo header:",me);
  }
  try {
    muleMessage.setOutboundProperty(MailProperties.INBOUND_FROM_ADDRESS_PROPERTY,MailUtils.mailAddressesToString(mailMessage.getFrom()));
  }
 catch (  javax.mail.MessagingException me) {
    log.warn("Invalid address found in From header:",me);
  }
  muleMessage.setOutboundProperty(MailProperties.INBOUND_SUBJECT_PROPERTY,StringUtils.defaultIfEmpty(mailMessage.getSubject(),"(no subject)"));
  muleMessage.setOutboundProperty(MailProperties.INBOUND_CONTENT_TYPE_PROPERTY,StringUtils.defaultIfEmpty(mailMessage.getContentType(),"text/plain"));
  Date sentDate=mailMessage.getSentDate();
  if (sentDate == null) {
    sentDate=new Date();
  }
  muleMessage.setOutboundProperty(MailProperties.SENT_DATE_PROPERTY,sentDate);
  for (Enumeration<?> e=mailMessage.getAllHeaders(); e.hasMoreElements(); ) {
    Header header=(Header)e.nextElement();
    String name=header.getName();
    String listName=MailUtils.toListHeader(name);
    String value=header.getValue();
    if (null == muleMessage.getOutboundProperty(name)) {
      muleMessage.setOutboundProperty(name,value);
    }
    Object listPropertyValue=muleMessage.getOutboundProperty(listName);
    if (null == listPropertyValue) {
      listPropertyValue=new LinkedList<Object>();
      muleMessage.setOutboundProperty(listName,listPropertyValue);
    }
    if (listPropertyValue instanceof List<?>) {
      ((List)listPropertyValue).add(header.getValue());
    }
  }
}
