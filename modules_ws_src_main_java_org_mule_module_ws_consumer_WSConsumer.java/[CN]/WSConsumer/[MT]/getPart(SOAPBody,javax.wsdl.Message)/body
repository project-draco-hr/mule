{
  if (soapBody.getParts() == null || soapBody.getParts().isEmpty()) {
    Map parts=inputMessage.getParts();
    if (parts.isEmpty()) {
      return null;
    }
    if (parts.size() > 1) {
      logger.warn("Input messages with multiple parts are not supported");
    }
    return (Part)parts.values().iterator().next();
  }
 else {
    if (soapBody.getParts().size() > 1) {
      logger.warn("Input messages with multiple parts in the SOAP body are not supported");
    }
    String partName=(String)soapBody.getParts().get(0);
    return inputMessage.getPart(partName);
  }
}
