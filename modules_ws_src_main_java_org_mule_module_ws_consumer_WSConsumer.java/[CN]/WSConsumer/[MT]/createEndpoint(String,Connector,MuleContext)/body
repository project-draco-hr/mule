{
  if (connector != null) {
    String protocol=new MuleEndpointURI(address,muleContext).getScheme();
    if (!connector.supportsProtocol(protocol)) {
      throw new RuntimeException("Connector " + connector + " does not support protocol: "+ protocol);
    }
  }
  EndpointBuilder builder=muleContext.getEndpointFactory().getEndpointBuilder(address);
  builder.setConnector(connector);
  return muleContext.getEndpointFactory().getOutboundEndpoint(builder);
}
