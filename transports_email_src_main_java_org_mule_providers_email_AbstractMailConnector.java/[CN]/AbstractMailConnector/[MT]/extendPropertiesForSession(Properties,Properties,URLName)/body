{
  int port=url.getPort();
  if (port == -1) {
    port=this.getDefaultPort();
  }
  local.setProperty("mail." + getBaseProtocol() + ".socketFactory.port",Integer.toString(port));
  if (StringUtils.isNotBlank(url.getPassword())) {
    local.setProperty("mail." + getBaseProtocol() + ".auth","true");
    if (getAuthenticator() == null) {
      setAuthenticator(new DefaultAuthenticator(url.getUsername(),url.getPassword()));
      if (logger.isDebugEnabled()) {
        logger.debug("No Authenticator set on connector: " + getName() + "; using default.");
      }
    }
  }
 else {
    local.setProperty("mail." + getBaseProtocol() + ".auth","false");
  }
  local.setProperty("mail." + getBaseProtocol() + ".host",url.getHost());
  local.setProperty("mail." + getBaseProtocol() + ".rsetbeforequit","true");
}
