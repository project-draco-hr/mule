{
  if (streamingMethod == null) {
    initialise(component);
  }
  StreamMessageAdapter adapter=(StreamMessageAdapter)context.getMessage().getAdapter();
  OutputStream out=new DeferredOutputStream(context);
  try {
    Object result;
    if (component instanceof StreamingService) {
      return invokeMethod(component,streamingMethod,new Object[]{adapter.getInputStream(),out,context});
    }
 else     if (inAndOut) {
      return invokeMethod(component,streamingMethod,new Object[]{adapter.getInputStream(),out});
    }
 else {
      return invokeMethod(component,streamingMethod,new Object[]{adapter.getInputStream()});
    }
  }
 catch (  Exception e) {
    logger.warn("Failed to route streaming event via " + component + ": "+ e.getMessage(),e);
    throw e;
  }
 finally {
    try {
      out.flush();
    }
 catch (    IOException e) {
    }
  }
}
