{
  FlowConstruct flowConstruct=mock(FlowConstruct.class);
  MuleEvent event=mock(MuleEvent.class);
  when(event.getFlowConstruct()).thenReturn(flowConstruct);
  FlowConstructAware targetSubFlowConstructAware=mock(FlowConstructAware.class,INITIALIZABLE_MESSAGE_PROCESSOR);
  when(((MessageProcessor)targetSubFlowConstructAware).process(event)).thenReturn(result);
  FlowRefFactoryBean flowRefFactoryBean=createDynamicFlowRefFactoryBean((MessageProcessor)targetSubFlowConstructAware);
  assertSame(result,flowRefFactoryBean.getObject().process(event));
  verify(targetSubFlowConstructAware).setFlowConstruct(flowConstruct);
}
