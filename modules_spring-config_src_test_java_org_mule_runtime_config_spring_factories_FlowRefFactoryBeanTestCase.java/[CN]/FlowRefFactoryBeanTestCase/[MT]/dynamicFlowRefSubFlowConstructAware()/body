{
  FlowConstruct flowConstruct=mock(FlowConstruct.class);
  MuleEvent event=mock(MuleEvent.class);
  FlowConstructAware targetSubFlowConstructAware=mock(FlowConstructAware.class,INITIALIZABLE_MESSAGE_PROCESSOR);
  when(((MessageProcessor)targetSubFlowConstructAware).process(event)).thenReturn(result);
  FlowRefFactoryBean flowRefFactoryBean=createDynamicFlowRefFactoryBean((MessageProcessor)targetSubFlowConstructAware);
  final MessageProcessor flowRefProcessor=flowRefFactoryBean.getObject();
  ((FlowConstructAware)flowRefProcessor).setFlowConstruct(flowConstruct);
  assertSame(result,flowRefProcessor.process(event));
  verify(targetSubFlowConstructAware).setFlowConstruct(flowConstruct);
}
