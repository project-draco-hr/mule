{
  FlowConstruct flowConstruct=mock(FlowConstruct.class);
  Event event=testEvent();
  FlowConstructAware targetSubFlowConstructAware=mock(FlowConstructAware.class,INITIALIZABLE_MESSAGE_PROCESSOR);
  when(((Processor)targetSubFlowConstructAware).process(event)).thenReturn(result);
  FlowRefFactoryBean flowRefFactoryBean=createDynamicFlowRefFactoryBean((Processor)targetSubFlowConstructAware);
  final Processor flowRefProcessor=getFlowRefProcessor(flowRefFactoryBean);
  ((FlowConstructAware)flowRefProcessor).setFlowConstruct(flowConstruct);
  assertSame(result,flowRefProcessor.process(event));
  verify(targetSubFlowConstructAware).setFlowConstruct(flowConstruct);
}
