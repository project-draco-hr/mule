{
  try {
    flow.process(getTestEvent(TEST_MESSAGE));
    fail("Request should go through the proxy.");
  }
 catch (  MessagingException e) {
    assertThat(e.getCauseException(),is(instanceOf(IOException.class)));
    assertThat(e.getCauseException().getMessage(),is("Remotely closed"));
  }
  latch.await(1,TimeUnit.SECONDS);
}
