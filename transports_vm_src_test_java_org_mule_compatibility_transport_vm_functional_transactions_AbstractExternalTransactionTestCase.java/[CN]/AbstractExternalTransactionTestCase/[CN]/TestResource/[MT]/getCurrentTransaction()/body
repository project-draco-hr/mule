{
  Transaction tx=null;
  Exception ex=null;
  try {
    tx=tm.getTransaction();
  }
 catch (  SystemException e) {
    tx=null;
    ex=e;
  }
  if (tx == null) {
    throw new IllegalStateException("Unable to access resource value outside transaction",ex);
  }
  return tx;
}
