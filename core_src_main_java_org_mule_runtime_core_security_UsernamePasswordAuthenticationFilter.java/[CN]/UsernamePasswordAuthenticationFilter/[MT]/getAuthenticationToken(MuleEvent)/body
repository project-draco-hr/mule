{
  ExpressionLanguage expressionLanguage=muleContext.getExpressionLanguage();
  Object usernameEval=expressionLanguage.evaluate(username,event,null);
  Object passwordEval=expressionLanguage.evaluate(password,event,null);
  if (usernameEval == null) {
    throw new UnauthorisedException(CoreMessages.authNoCredentials());
  }
  if (passwordEval == null) {
    throw new UnauthorisedException(CoreMessages.authNoCredentials());
  }
  return new DefaultMuleAuthentication(new MuleCredentials(usernameEval.toString(),passwordEval.toString().toCharArray()));
}
