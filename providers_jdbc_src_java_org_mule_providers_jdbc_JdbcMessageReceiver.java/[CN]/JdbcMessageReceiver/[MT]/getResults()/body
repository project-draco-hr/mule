{
  Connection con=null;
  try {
    Object session=this.connector.getSession(endpoint);
    if (session instanceof Connection) {
      con=(Connection)session;
    }
 else {
      con=((XAConnection)session).getConnection();
    }
    Object[] readParams=JdbcConnector.getParams(getEndpointURI(),this.readParams,null);
    Object results=new QueryRunner().query(con,this.readStmt,readParams,new MapListHandler());
    return (List)results;
  }
  finally {
    DbUtils.close(con);
  }
}
