{
  DefaultMuleMessage message=new DefaultMuleMessage("payload",muleContext);
  message.setInboundProperty("X-MyHeader","value");
  message.setInboundProperty("Content-Type","text/plain");
  message.setInboundProperty(HttpConnector.HTTP_METHOD_PROPERTY,"GET");
  message.setInboundProperty(HttpConnector.HTTP_CONTEXT_PATH_PROPERTY,"/foo");
  message.setInboundProperty(HttpConnector.HTTP_REQUEST_PATH_PROPERTY,"/foo/bar");
  if (queryParam != null) {
    queryParam="?" + queryParam;
  }
  message.setInboundProperty(HttpConnector.HTTP_REQUEST_PROPERTY,"/foo/bar" + queryParam);
  message.setInboundProperty(HttpConstants.HEADER_HOST,"127.0.0.1");
  message.setEncoding("UTF-8");
  InboundEndpoint ep=mock(InboundEndpoint.class);
  when(ep.getAddress()).thenReturn("http://localhost:8080/foo");
  when(ep.getName()).thenReturn("test");
  when(ep.getEndpointURI()).thenReturn(new MuleEndpointURI("http://localhost:8080/foo",muleContext));
  TransactionConfig txConfig=mock(TransactionConfig.class);
  when(ep.getTransactionConfig()).thenReturn(txConfig);
  when(ep.getExchangePattern()).thenReturn(MessageExchangePattern.REQUEST_RESPONSE);
  DefaultMuleEvent event=new DefaultMuleEvent(message,(FlowConstruct)null);
  DefaultMuleEventEndpointUtils.populateFieldsFromInboundEndpoint(event,ep);
  return event;
}
