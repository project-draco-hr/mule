{
  Mockito.when(mockMuleContext.getRegistry().get(MuleProperties.OBJECT_STORE_MANAGER)).thenReturn(mockObjectStoreManager);
  Mockito.when(mockObjectStoreManager.getObjectStore(anyString(),anyBoolean(),anyInt(),anyInt(),anyInt())).thenReturn(new InMemoryObjectStore());
  IdempotentRedeliveryPolicy irp=new IdempotentRedeliveryPolicy();
  irp.setUseSecureHash(true);
  irp.setMaxRedeliveryCount(1);
  irp.setFlowConstruct(mock(FlowConstruct.class));
  irp.setMuleContext(mockMuleContext);
  irp.initialise();
  when(message.getPayload()).thenReturn(new Object());
  when(event.getMessage()).thenReturn(message);
  MuleEvent process=irp.process(event);
  Assert.assertNull(process);
}
