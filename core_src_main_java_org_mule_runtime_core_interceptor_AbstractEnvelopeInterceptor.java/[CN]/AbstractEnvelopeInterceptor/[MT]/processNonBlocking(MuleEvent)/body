{
  final long startTime=System.currentTimeMillis();
  final ProcessingTime time=((CoreMessageContext)event.getContext()).getProcessingTime();
  MuleEvent responseEvent=event;
  final ReplyToHandler originalReplyToHandler=event.getReplyToHandler();
  responseEvent=MuleEvent.builder(event).replyToHandler(new ResponseReplyToHandler(originalReplyToHandler,time,startTime)).build();
  setCurrentEvent(responseEvent);
  try {
    responseEvent=processNext(processRequest(responseEvent));
    if (!(responseEvent instanceof NonBlockingVoidMuleEvent)) {
      responseEvent=processResponse(responseEvent,event);
    }
  }
 catch (  Exception exception) {
    last(responseEvent,time,startTime,true);
    throw exception;
  }
  return responseEvent;
}
