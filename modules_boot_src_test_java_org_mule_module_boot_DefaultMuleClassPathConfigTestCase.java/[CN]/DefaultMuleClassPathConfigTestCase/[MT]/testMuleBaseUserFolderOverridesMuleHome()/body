{
  final File tempDir=SystemUtils.getJavaIoTmpDir();
  final long now=System.currentTimeMillis();
  final File currentTestFolder=new File(tempDir,"mule_test_delete_me_" + now);
  File testMuleHome=new File(currentTestFolder,"mule_home");
  File testMuleBase=new File(currentTestFolder,"mule_base");
  try {
    assertTrue("Couldn't create test Mule home folder.",testMuleHome.mkdirs());
    assertTrue("Couldn't create test Mule base folder.",testMuleBase.mkdirs());
    DefaultMuleClassPathConfig cp=new DefaultMuleClassPathConfig(testMuleHome,testMuleBase);
    List urls=cp.getURLs();
    assertNotNull("Urls shouldn't be null.",urls);
    assertFalse("Urls shouldn't be empty.",urls.isEmpty());
    URL muleBaseUserFolder=new File(testMuleBase,DefaultMuleClassPathConfig.USER_DIR).getAbsoluteFile().toURI().toURL();
    String expectedMuleBaseUserFolder=muleBaseUserFolder.toExternalForm();
    String firstUrl=((URL)urls.get(0)).toExternalForm();
    assertEquals("$MULE_BASE/lib/user must come first.",expectedMuleBaseUserFolder,firstUrl);
  }
  finally {
    FileUtils.deleteTree(currentTestFolder);
  }
}
