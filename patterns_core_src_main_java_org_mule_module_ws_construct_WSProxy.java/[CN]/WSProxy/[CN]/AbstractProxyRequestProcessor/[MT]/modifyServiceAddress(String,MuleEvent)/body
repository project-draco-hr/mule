{
  String inboundAddress=event.getMessageSourceURI().toASCIIString();
  try {
    String substitutedAddress=outboundAddress;
    ExpressionManager expressionManager=event.getMuleContext().getExpressionManager();
    if (expressionManager.isValidExpression(outboundAddress)) {
      substitutedAddress=expressionManager.parse(outboundAddress,event,true);
    }
    wsdlContents=wsdlContents.replaceAll(substitutedAddress,inboundAddress);
  }
 catch (  ExpressionRuntimeException ex) {
    logger.warn("Unable to construct outbound address for WSDL request to proxied dynamic endpoint " + outboundAddress);
  }
  if (wsdlContents.indexOf(LOCALHOST) > -1) {
    wsdlContents=wsdlContents.replaceAll(LOCALHOST,InetAddress.getLocalHost().getHostName());
  }
  if (logger.isDebugEnabled()) {
    logger.debug("WSDL modified successfully");
  }
  return wsdlContents;
}
