{
  UMOEndpointURI endpointUri=event.getEndpoint().getEndpointURI();
  String method=(String)endpointUri.getParams().remove("method");
  if (method == null) {
    method=(String)event.getEndpoint().getProperties().get("method");
    if (method == null) {
      throw new DispatchException(new org.mule.config.i18n.Message("soap",4),event.getMessage(),event.getEndpoint());
    }
  }
  Call call=(Call)getService(event).createCall();
  String style=(String)event.getProperties().get("style");
  String use=(String)event.getProperties().get("use");
  if (style != null) {
    Style s=Style.getStyle(style);
    if (s == null) {
      throw new IllegalArgumentException(new org.mule.config.i18n.Message(Messages.X_IS_INVALID,"style=" + style).toString());
    }
 else {
      call.setOperationStyle(s);
    }
  }
  if (use != null) {
    Use u=Use.getUse(use);
    if (u == null) {
      throw new IllegalArgumentException(new org.mule.config.i18n.Message(Messages.X_IS_INVALID,"use=" + use).toString());
    }
 else {
      call.setOperationUse(u);
    }
  }
  BeanUtils.populateWithoutFail(call,event.getEndpoint().getProperties(),false);
  call.setTargetEndpointAddress(endpointUri.toString());
  String soapAction=(String)event.getProperty("soapAction");
  if (soapAction != null) {
    soapAction=parseSoapAction(soapAction,method,event);
    call.setSOAPActionURI(soapAction);
    call.setUseSOAPAction(Boolean.TRUE.booleanValue());
  }
  String methodNamespace=(String)event.getProperty(AxisConnector.METHOD_NAMESPACE_PROPERTY);
  if (methodNamespace != null) {
    call.setOperationName(new QName(methodNamespace,method));
  }
 else {
    call.setOperationName(new QName(method));
  }
  call.setProperty(MuleProperties.MULE_EVENT_PROPERTY,event);
  int timeout=event.getIntProperty(MuleProperties.MULE_EVENT_TIMEOUT_PROPERTY,-1);
  if (timeout >= 0) {
    call.setTimeout(new Integer(timeout));
  }
  if (endpointUri.getUserInfo() != null) {
    call.setUsername(endpointUri.getUsername());
    call.setPassword(endpointUri.getPassword());
  }
  setCallParams(call,event,call.getOperationName());
  return call;
}
