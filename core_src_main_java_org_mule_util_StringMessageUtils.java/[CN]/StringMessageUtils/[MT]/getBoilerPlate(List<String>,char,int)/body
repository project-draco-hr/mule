{
  int size;
  StringBuilder buf=new StringBuilder(messages.size() * maxlength);
  int trimLength=maxlength - (c == ' ' ? 2 : 4);
  for (int i=0; i < messages.size(); i++) {
    size=messages.get(i).toString().length();
    if (size > trimLength) {
      String temp=messages.get(i).toString();
      int k=i;
      int x;
      int len;
      messages.remove(i);
      while (temp.length() > 0) {
        len=(trimLength <= temp.length() ? trimLength : temp.length());
        String msg=temp.substring(0,len);
        x=msg.indexOf(SystemUtils.LINE_SEPARATOR);
        if (x > -1) {
          msg=msg.substring(0,x);
          len=x + 1;
        }
 else {
          x=msg.lastIndexOf(' ');
          if (x > -1 && len == trimLength) {
            msg=msg.substring(0,x);
            len=x + 1;
          }
        }
        if (msg.startsWith(" ")) {
          msg=msg.substring(1);
        }
        temp=temp.substring(len);
        messages.add(k,msg);
        k++;
      }
    }
  }
  buf.append(SystemUtils.LINE_SEPARATOR);
  if (c != ' ') {
    buf.append(StringUtils.repeat(c,maxlength));
  }
  for (int i=0; i < messages.size(); i++) {
    buf.append(SystemUtils.LINE_SEPARATOR);
    if (c != ' ') {
      buf.append(c);
    }
    buf.append(" ");
    buf.append(messages.get(i));
    String osEncoding=CharSetUtils.defaultCharsetName();
    int padding;
    try {
      padding=trimLength - messages.get(i).toString().getBytes(osEncoding).length;
    }
 catch (    UnsupportedEncodingException ueex) {
      throw new MuleRuntimeException(CoreMessages.failedToConvertStringUsingEncoding(osEncoding),ueex);
    }
    if (padding > 0) {
      buf.append(StringUtils.repeat(' ',padding));
    }
    buf.append(' ');
    if (c != ' ') {
      buf.append(c);
    }
  }
  buf.append(SystemUtils.LINE_SEPARATOR);
  if (c != ' ') {
    buf.append(StringUtils.repeat(c,maxlength));
  }
  return buf.toString();
}
