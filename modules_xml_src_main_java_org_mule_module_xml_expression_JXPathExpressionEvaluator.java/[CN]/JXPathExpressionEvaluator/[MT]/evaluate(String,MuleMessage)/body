{
  deprecationWarning.warn();
  Document document;
  try {
    document=XMLUtils.toW3cDocument(message.getPayload());
  }
 catch (  Exception e) {
    logger.error("Could not parse document",e);
    return null;
  }
  JXPathContext context;
  if (document != null) {
    context=createContextForXml(document);
  }
 else {
    context=createContextForBean(message.getPayload());
  }
  return getExpressionValue(context,expression);
}
