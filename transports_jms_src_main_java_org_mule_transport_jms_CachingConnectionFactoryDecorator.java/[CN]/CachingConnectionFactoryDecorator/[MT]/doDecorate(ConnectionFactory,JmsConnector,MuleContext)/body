{
  if (resolveReuseSessionsEnabled(jmsConnector)) {
    cachingConnectionFactory=new CustomCachingConnectionFactory(connectionFactory,jmsConnector.getUsername(),jmsConnector.getPassword());
    cachingConnectionFactory.setCacheConsumers(false);
    cachingConnectionFactory.setCacheProducers(true);
    cachingConnectionFactory.setSessionCacheSize(Integer.MAX_VALUE);
    cachingConnectionFactory.setClientId(jmsConnector.getClientId());
    cachingConnectionFactory.setExceptionListener(jmsConnector);
    cachingConnectionFactory.setReconnectOnException(false);
    return cachingConnectionFactory;
  }
 else {
    return connectionFactory;
  }
}
