{
  Map<String,String> credentials=getValidCredentials();
  authenticator.setCredentials(credentials);
  Subject subject=authenticator.authenticate(VALID_AUTH_TOKEN);
  assertNotNull(subject);
  assertTrue(subject.isReadOnly());
  Set<Object> publicCredentials=subject.getPublicCredentials();
  assertNotNull(publicCredentials);
  assertEquals(0,publicCredentials.size());
  Set<Object> privateCredentials=subject.getPrivateCredentials();
  assertNotNull(privateCredentials);
  assertEquals(0,privateCredentials.size());
  Set<Principal> principals=subject.getPrincipals();
  assertNotNull(principals);
  assertEquals(1,principals.size());
  Object ref=principals.iterator().next();
  assertTrue(ref instanceof JMXPrincipal);
  JMXPrincipal jmxPrincipal=(JMXPrincipal)ref;
  String name=jmxPrincipal.getName();
  assertNotNull(name);
  assertEquals(VALID_AUTH_TOKEN[0],name);
}
