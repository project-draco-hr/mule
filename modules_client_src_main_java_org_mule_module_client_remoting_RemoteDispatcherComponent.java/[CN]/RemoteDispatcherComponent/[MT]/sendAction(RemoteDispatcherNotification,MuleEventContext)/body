{
  MuleMessage result=null;
  OutboundEndpoint endpoint=null;
  MuleContext managementContext=context.getMuleContext();
  try {
    if (RemoteDispatcherNotification.ACTION_DISPATCH == action.getAction()) {
      endpoint=managementContext.getRegistry().lookupEndpointFactory().getOutboundEndpoint(action.getResourceIdentifier());
      context.dispatchEvent(action.getMessage(),endpoint);
      return null;
    }
 else {
      EndpointFactory endpointFactory=managementContext.getRegistry().lookupEndpointFactory();
      EndpointBuilder endpointBuilder=endpointFactory.getEndpointBuilder(action.getResourceIdentifier());
      endpointBuilder.setRemoteSync(true);
      endpoint=managementContext.getRegistry().lookupEndpointFactory().getOutboundEndpoint(endpointBuilder);
      result=context.sendEvent(action.getMessage(),endpoint);
      if (result == null) {
        return null;
      }
 else {
        ByteArrayOutputStream out=new ByteArrayOutputStream();
        wireFormat.write(out,result,getEncoding());
        return out.toByteArray();
      }
    }
  }
 catch (  Exception e) {
    return handleException(result,e);
  }
}
