{
  if (messageExchange.getRole() == MessageExchange.Role.PROVIDER) {
    return;
  }
  NormalizedMessage in=messageExchange.getMessage("in");
  try {
    NormalizedMessage out=messageExchange.createMessage();
    transform(messageExchange,in,out);
    if (isInOut(messageExchange)) {
      messageExchange.setMessage(out,OUT);
    }
 else {
      InOnly outExchange=getExchangeFactory().createInOnlyExchange();
      outExchange.setInMessage(out);
      context.getDeliveryChannel().sendSync(outExchange);
    }
    done(messageExchange);
  }
 catch (  Exception e) {
    error(messageExchange,e);
  }
}
