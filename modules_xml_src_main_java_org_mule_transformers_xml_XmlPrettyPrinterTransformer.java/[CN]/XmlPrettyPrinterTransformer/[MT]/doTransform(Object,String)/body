{
  try {
    ByteArrayOutputStream resultStream=new ByteArrayOutputStream();
    Document document=null;
    if (src instanceof java.lang.String) {
      String text=(String)src;
      document=DocumentHelper.parseText(text);
    }
 else     if (src instanceof org.dom4j.Document) {
      document=(Document)src;
    }
    XMLWriter writer=new XMLWriter(resultStream,format);
    writer.write(document);
    writer.close();
    return resultStream.toString(encoding);
  }
 catch (  Exception e) {
    throw new TransformerException(this,e);
  }
}
