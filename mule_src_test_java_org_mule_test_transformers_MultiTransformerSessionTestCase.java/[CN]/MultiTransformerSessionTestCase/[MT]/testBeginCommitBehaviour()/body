{
  MultiTransformerSession mts=new MultiTransformerSession();
  assertTrue(!mts.isInSession());
  mts.begin();
  assertTrue(mts.isInSession());
  Object result=mts.transform(trans,TEST_DATA);
  assertTrue(mts.isInSession());
  assertEquals(TEST_DATA,new String(roundtripTrans.transform(result).toString()));
  result=mts.transform(roundtripTrans,result);
  assertEquals(TEST_DATA,result.toString());
  assertEquals(3,mts.getStackSize());
  assertEquals(TEST_DATA,mts.getFromStack(0));
  assertEquals(mts.getFromStack(1),new String(trans.transform(result).toString()));
  assertEquals(TEST_DATA,mts.getFromStack(2));
  result=mts.transform(trans,TEST_DATA);
  assertEquals(4,mts.getStackSize());
  assertEquals(result,mts.getData());
  mts.commit();
  assertEquals(0,mts.getStackSize());
  assertEquals(result,mts.getData());
  assertTrue(!mts.isInSession());
}
