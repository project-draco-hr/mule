{
  MuleClient client=muleContext.getClient();
  MuleMessage result=client.send("inboundEndpoint",MuleMessage.builder().payload("some data").addOutboundProperty(MULE_REPLY_TO_PROPERTY,"jms://client-reply").build()).getRight();
  assertNotNull(result);
  assertEquals("got it!",getPayloadAsString(result));
  final Object foo=result.getInboundProperty("foo");
  assertNotNull(foo);
  assertEquals("bar",foo);
}
