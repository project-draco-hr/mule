{
  DefaultMuleMessage muleMessage=new DefaultMuleMessage(TEST,buildDefaultEncodingDataType());
  muleMessage.setDataType(DataType.builder().mediaType(APPLICATION_XML).build());
  Transformer transformer=mock(Transformer.class);
  when(transformer.isSourceDataTypeSupported(org.mockito.Matchers.<DataType<?>>any())).thenReturn(true);
  DataType outputDataType=DataType.builder().type(Integer.class).mediaType(ANY).charset(DEFAULT_ENCODING).build();
  when(transformer.getReturnDataType()).thenReturn(outputDataType);
  when(transformer.transform(anyObject())).thenReturn(1);
  MuleEvent muleEvent=mock(MuleEvent.class);
  MuleMessage result=transformationService.applyTransformers(muleMessage,muleEvent,singletonList(transformer));
  assertDataType(result,Integer.class,APPLICATION_XML,DEFAULT_ENCODING);
}
