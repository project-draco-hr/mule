{
  DefaultMuleMessage muleMessage=new DefaultMuleMessage(TEST,muleContext);
  muleMessage.setOutboundProperty(MULE_ENCODING_PROPERTY,getDefaultEncoding(muleContext));
  DataType<?> originalDataType=muleMessage.getDataType();
  Transformer transformer=mock(Transformer.class);
  when(transformer.isSourceDataTypeSupported(org.mockito.Matchers.<DataType<?>>any())).thenReturn(true);
  DataType outputDataType=DataType.builder().type(Object.class).mimeType(ANY).build();
  when(transformer.getReturnDataType()).thenReturn(outputDataType);
  when(transformer.transform(muleMessage)).thenReturn(TEST);
  MuleEvent muleEvent=mock(MuleEvent.class);
  MuleMessage result=transformationService.applyTransformers(muleMessage,muleEvent,Collections.singletonList(transformer));
  assertDataType(result,originalDataType);
}
