{
  Evaluator evaluator=annotation.annotationType().getAnnotation(Evaluator.class);
  if (evaluator != null) {
    String expr=((InboundAttachments)annotation).value();
    boolean optional=false;
    String eval=MessageAttachmentExpressionEvaluator.NAME;
    if (parameterType.isAssignableFrom(Map.class)) {
      eval=MessageAttachmentsExpressionEvaluator.NAME;
    }
 else     if (parameterType.isAssignableFrom(List.class)) {
      eval=MessageAttachmentsListExpressionEvaluator.NAME;
    }
 else     if (expr.endsWith(OPTIONAL_ARGUMENT)) {
      optional=true;
    }
    return new ExpressionArgument(null,new ExpressionConfig(expr,eval,null),optional,parameterType);
  }
 else {
    throw new IllegalArgumentException("The @Evaluator annotation must be set on an Expression Annotation");
  }
}
