{
  MuleClient client=new MuleClient();
  Properties props=new Properties();
  props.setProperty(WSHandlerConstants.ACTION,WSHandlerConstants.ENCRYPT);
  props.setProperty(WSHandlerConstants.USER,"mulealias");
  props.setProperty(WSHandlerConstants.PW_CALLBACK_CLASS,"org.mule.extras.wssecurity.callbackhandlers.MuleWsSecurityCallbackHandler");
  props.setProperty(WSHandlerConstants.ENC_PROP_FILE,"out-encrypted-security.properties");
  UMOMessage m=client.send("vm://testin","Test",props);
  assertNotNull(m);
  assertTrue(m.getPayload() instanceof String);
  assertTrue(((String)m.getPayload()).equals("Test"));
}
