{
  TransactionalQueueManager mgr=createQueueManager();
  mgr.start();
  QueueSession s=mgr.getQueueSession();
  Queue q=s.getQueue("warmRecoverQueue");
  int toPopulate=500;
  Random rnd=new Random();
  for (int j=0; j < toPopulate; j++) {
    byte[] o=new byte[2048];
    rnd.nextBytes(o);
    q.put(o);
  }
  assertEquals(toPopulate,q.size());
  mgr.stop();
  mgr=createQueueManager();
  mgr.start();
  s=mgr.getQueueSession();
  q=s.getQueue("warmRecoverQueue");
  if (isPersistent()) {
    assertEquals(toPopulate,q.size());
  }
 else {
    assertEquals(0,q.size());
  }
}
