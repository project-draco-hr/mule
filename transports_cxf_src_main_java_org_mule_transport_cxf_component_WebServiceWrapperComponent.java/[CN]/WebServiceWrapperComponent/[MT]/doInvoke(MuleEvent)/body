{
  MuleContext muleContext=event.getMuleContext();
  String tempUrl;
  if (addressFromMessage) {
    tempUrl=event.getMessage().getStringProperty(WS_SERVICE_URL,null);
    if (tempUrl == null) {
      throw new IllegalArgumentException(CoreMessages.propertyIsNotSetOnEvent(WS_SERVICE_URL).toString());
    }
  }
 else {
    tempUrl=address;
  }
  MuleMessage message=new DefaultMuleMessage(event.transformMessage(),muleContext);
  EndpointBuilder endpointBuilder=new EndpointURIEndpointBuilder("cxf:" + tempUrl,muleContext);
  if (wsdlPort != null) {
    endpointBuilder.setProperty("wsdlPort",wsdlPort);
  }
  if (operation != null) {
    endpointBuilder.setProperty("operation",operation);
  }
  OutboundEndpoint endpoint=muleContext.getRegistry().lookupEndpointFactory().getOutboundEndpoint(endpointBuilder);
  MuleMessage result=event.getSession().sendEvent(message,endpoint);
  return result;
}
