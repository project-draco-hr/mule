{
  if (obj == null) {
    return false;
  }
  if (expression == null) {
    logger.warn("Expression for JXPathFilter is not set");
    return false;
  }
  boolean res=false;
  try {
    Object o=null;
    if (obj instanceof String) {
      Document doc=DocumentHelper.parseText((String)obj);
      o=doc.valueOf(expression);
    }
 else     if (obj instanceof org.dom4j.Document) {
      Document doc=(Document)obj;
      o=doc.valueOf(expression);
    }
 else {
      if (logger.isDebugEnabled()) {
        logger.debug("Passing object of type " + obj.getClass().toString() + " to JXPathContext");
      }
      JXPathContext context=JXPathContext.newContext(obj);
      initialise(context);
      o=context.getValue(expression);
    }
    if (logger.isDebugEnabled()) {
      logger.debug("JXPathFilter Expression result='" + o + "' -  Expected value='"+ value+ "'");
    }
    if (o != null) {
      res=value.equals(o.toString());
    }
 else     if ("null".equals(value)) {
      res=true;
    }
 else {
      res=false;
      logger.warn("JXPathFilter Expression result is null (" + expression + ")");
    }
  }
 catch (  Exception e) {
    logger.warn("JXPathFilter cannot evaluate expression (" + expression + ") :"+ e.getMessage(),e);
  }
  if (logger.isDebugEnabled()) {
    logger.debug("JXPathFilter accept object  : " + res);
  }
  return res;
}
