{
  JmxAgent jmxAgent=getMuleContextForDomain().getRegistry().lookupObject(JmxAgent.class);
  MBeanServer mBeanServer=jmxAgent.getMBeanServer();
  Set<ObjectName> objectNames=mBeanServer.queryNames(null,null);
  List<String> endpointsForApp1=getNames(objectNames,"endpoint.jms.queueApp1");
  Assert.assertEquals(1,endpointsForApp1.size());
  Assert.assertTrue(endpointsForApp1.get(0).contains("flowApp1"));
  Assert.assertFalse(endpointsForApp1.get(0).contains("flowApp2"));
  List<String> endpointsForApp2=getNames(objectNames,"endpoint.jms.queueApp2");
  Assert.assertEquals(1,endpointsForApp2.size());
  Assert.assertTrue(endpointsForApp2.get(0).contains("flowApp2"));
  Assert.assertFalse(endpointsForApp2.get(0).contains("flowApp1"));
  Assert.assertEquals(1,getNames(objectNames,"flowApp1"));
  Assert.assertEquals(1,getNames(objectNames,"flowApp2"));
}
