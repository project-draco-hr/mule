{
  Transformer trans1=new TestEventTransformer();
  trans1.setName("OptimusPrime");
  Transformer trans2=new TestEventTransformer();
  trans2.setName("Bumblebee");
  List transformers=new ArrayList();
  transformers.add(trans1);
  transformers.add(trans2);
  ImmutableEndpoint endpoint=getTestOutboundEndpoint("Test",null,transformers,new PayloadTypeFilter(Object.class),null);
  MuleEvent event=RequestContext.setEvent(getTestEvent("payload",endpoint));
  Serializable serialized=(Serializable)new SerializableToByteArray().transform(event);
  assertNotNull(serialized);
  MuleEvent deserialized=(MuleEvent)new ByteArrayToObject().transform(serialized);
  assertNotNull(deserialized);
  assertNotNull(deserialized.getMuleContext());
  assertNotNull(deserialized.getSession());
  assertEquals(event.getSession().getId(),deserialized.getSession().getId());
  assertNotNull(deserialized.getSession().getService());
  assertEquals(event.getSession().getService(),deserialized.getSession().getService());
  assertSame(event.getSession().getService(),deserialized.getSession().getService());
  assertNotNull(deserialized.getEndpoint());
  assertEquals(endpoint,deserialized.getEndpoint());
  List deserializedTransformers=deserialized.getEndpoint().getTransformers();
  assertEquals(2,deserializedTransformers.size());
  assertEquals(trans1.getName(),((Transformer)deserializedTransformers.get(0)).getName());
  assertEquals(trans2.getName(),((Transformer)deserializedTransformers.get(1)).getName());
  assertEquals(PayloadTypeFilter.class,deserialized.getEndpoint().getFilter().getClass());
}
