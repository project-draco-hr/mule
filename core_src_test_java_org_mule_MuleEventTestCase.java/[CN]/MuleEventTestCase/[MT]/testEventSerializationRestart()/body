{
  MuleEvent event=createEventToSerialize();
  muleContext.start();
  Serializable serialized=(Serializable)new SerializableToByteArray().transform(event);
  assertNotNull(serialized);
  muleContext.dispose();
  muleContext=createMuleContext();
  muleContext.start();
  ByteArrayToObject trans=new ByteArrayToObject();
  trans.setMuleContext(muleContext);
  createAndRegisterTransformersEndpointBuilderService();
  MuleEvent deserialized=(MuleEvent)trans.transform(serialized);
  assertNotNull(deserialized);
  assertNotNull(deserialized.getMuleContext());
  assertNotNull(deserialized.getSession());
  assertEquals(event.getSession().getId(),deserialized.getSession().getId());
  assertNotNull(deserialized.getFlowConstruct());
  Flow service=(Flow)event.getFlowConstruct();
  Flow deserializedService=(Flow)deserialized.getFlowConstruct();
  assertEquals(service.getName(),deserializedService.getName());
  assertEquals(service.getInitialState(),deserializedService.getInitialState());
  assertEquals(service.getExceptionListener().getClass(),deserializedService.getExceptionListener().getClass());
  assertEquals(service.getMessageProcessors(),deserializedService.getMessageProcessors());
}
