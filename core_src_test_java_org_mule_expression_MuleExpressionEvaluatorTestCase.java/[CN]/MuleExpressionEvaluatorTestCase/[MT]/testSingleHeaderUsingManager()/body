{
  MuleMessage message=new DefaultMuleMessage("test",props,muleContext);
  Object result=muleContext.getExpressionManager().evaluate("#[mule:message.header(foo)]",message);
  assertNotNull(result);
  assertEquals("moo",result);
  result=muleContext.getExpressionManager().evaluate("#[mule:message.header(foo?)]",message);
  assertNotNull(result);
  assertEquals("moo",result);
  result=muleContext.getExpressionManager().evaluate("#[mule:message.header(fool?)]",message);
  assertNull(result);
  try {
    muleContext.getExpressionManager().evaluate("#[mule:message.header(fool)]",createMessageWithAttachments());
    fail("Header 'fool' is not on the message and not defined as optional");
  }
 catch (  Exception e) {
  }
}
