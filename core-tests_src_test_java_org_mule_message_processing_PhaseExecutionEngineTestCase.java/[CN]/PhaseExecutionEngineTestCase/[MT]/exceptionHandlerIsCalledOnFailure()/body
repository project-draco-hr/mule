{
  addSupportedPhase(mockFailingPhase);
  addSupportedPhase(mockProcessPhase1);
  when(mockEndPhase.supportsTemplate(mockTemplate)).thenReturn(true);
  PhaseExecutionEngine phaseExecutionEngine=new PhaseExecutionEngine(phaseList,mockExceptionHandler,mockEndPhase);
  phaseExecutionEngine.process(mockTemplate,mockContext);
  verify(mockEndPhase,times(1)).runPhase(any(EndPhaseTemplate.class),any(MessageProcessContext.class),any(PhaseResultNotifier.class));
}
