{
  String xml="<node1>";
  xml+="<subnode1>sub node 1 original value</subnode1>";
  xml+="<subnode2>sub node 2 original value</subnode2>";
  xml+="</node1>";
  String param="sub node 2 cool new value";
  String expectedTransformedxml="<node1>";
  expectedTransformedxml+="<subnode1>sub node 1 original value</subnode1>";
  expectedTransformedxml+="<subnode2>" + param + "</subnode2>";
  expectedTransformedxml+="</node1>";
  String xsl="<xsl:stylesheet xmlns:xsl=\"http://www.w3.org/1999/XSL/Transform\" version=\"1.0\"";
  xsl+=" xmlns:wsdlsoap=\"http://schemas.xmlsoap.org/wsdl/soap/\"";
  xsl+=" xmlns:wsdl=\"http://schemas.xmlsoap.org/wsdl/\">";
  xsl+="<xsl:param name=\"param1\"/>";
  xsl+="<xsl:template match=\"@*|node()\">";
  xsl+="<xsl:copy><xsl:apply-templates select=\"@*|node()\"/></xsl:copy>";
  xsl+="</xsl:template>";
  xsl+="<xsl:template match=\"@*|node()\">";
  xsl+="<xsl:copy><xsl:apply-templates select=\"@*|node()\"/></xsl:copy>";
  xsl+="</xsl:template>";
  xsl+="<xsl:template match=\"/node1/subnode2/text()\">";
  xsl+="<xsl:value-of select=\"$param1\"/>";
  xsl+="</xsl:template>";
  xsl+="</xsl:stylesheet>";
  XsltTransformer transformer=new XsltTransformer();
  transformer.setReturnClass(String.class);
  transformer.setXslt(xsl);
  Map params=new HashMap();
  params.put("param1",param);
  transformer.setTransformParameters(params);
  transformer.initialise();
  String transformerResult=(String)transformer.transform(xml);
  transformerResult=transformerResult.substring(transformerResult.indexOf("?>") + 2);
  assertTrue(transformerResult.indexOf(expectedTransformedxml) > -1);
}
