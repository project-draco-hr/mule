{
  filter.setEndpoint(endpoint);
  if (endpoint instanceof InboundEndpoint) {
    return new InboundSecurityFilterMessageProcessor((InboundEndpoint)endpoint,filter);
  }
 else   if (endpoint instanceof OutboundEndpoint) {
    return new OutboundSecurityFilterMessageProcessor((OutboundEndpoint)endpoint,filter);
  }
 else {
    return null;
  }
}
