{
  ByteArrayInputStream bis=new ByteArrayInputStream(SerializationUtils.serialize(TEST_DATA));
  MuleClient client=new MuleClient(muleContext);
  MuleMessage compressedResponse=client.send("vm://compressInput",bis,null);
  assertNotNull(compressedResponse);
  assertTrue(compressedResponse.getPayload() instanceof InputStream);
  MuleMessage uncompressedResponse=client.send("vm://decompressInput",compressedResponse.getPayload(),null);
  assertNotNull(uncompressedResponse);
  assertTrue(uncompressedResponse.getPayload() instanceof InputStream);
  byte[] uncompressedByteArray=IOUtils.toByteArray((InputStream)uncompressedResponse.getPayload());
  String uncompressedStr=(String)SerializationUtils.deserialize(uncompressedByteArray);
  assertEquals(TEST_DATA,uncompressedStr);
}
