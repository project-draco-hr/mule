{
  ByteArrayInputStream bis=new ByteArrayInputStream(TEST_DATA.getBytes());
  MuleClient client=muleContext.getClient();
  Event muleEvent=flowRunner("compressInput").withPayload(bis).run();
  InternalMessage compressedResponse=muleEvent.getMessage();
  assertNotNull(compressedResponse);
  assertTrue(compressedResponse.getPayload().getValue() instanceof InputStream);
  muleEvent=flowRunner("decompressInput").withPayload(compressedResponse.getPayload().getValue()).run();
  InternalMessage uncompressedResponse=muleEvent.getMessage();
  assertNotNull(uncompressedResponse);
  assertTrue(uncompressedResponse.getPayload().getValue() instanceof InputStream);
  byte[] uncompressedByteArray=IOUtils.toByteArray((InputStream)uncompressedResponse.getPayload().getValue());
  String uncompressedStr=new String(uncompressedByteArray);
  assertEquals(TEST_DATA,uncompressedStr);
}
