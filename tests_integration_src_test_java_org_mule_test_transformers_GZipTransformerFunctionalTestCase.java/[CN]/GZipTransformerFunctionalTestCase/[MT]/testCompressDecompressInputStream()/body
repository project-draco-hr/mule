{
  ByteArrayInputStream bis=new ByteArrayInputStream(TEST_DATA.getBytes());
  MuleClient client=muleContext.getClient();
  MuleEvent muleEvent=flowRunner("compressInput").withPayload(bis).run();
  MuleMessage compressedResponse=muleEvent.getMessage();
  assertNotNull(compressedResponse);
  assertTrue(compressedResponse.getPayload() instanceof InputStream);
  muleEvent=flowRunner("decompressInput").withPayload(compressedResponse.getPayload()).run();
  MuleMessage uncompressedResponse=muleEvent.getMessage();
  assertNotNull(uncompressedResponse);
  assertTrue(uncompressedResponse.getPayload() instanceof InputStream);
  byte[] uncompressedByteArray=IOUtils.toByteArray((InputStream)uncompressedResponse.getPayload());
  String uncompressedStr=new String(uncompressedByteArray);
  assertEquals(TEST_DATA,uncompressedStr);
}
