{
  ByteArrayInputStream bis=new ByteArrayInputStream(TEST_DATA.getBytes());
  MuleClient client=muleContext.getClient();
  MuleMessage compressedResponse=client.send("vm://compressInput",bis,null);
  assertNotNull(compressedResponse);
  assertTrue(compressedResponse.getPayload() instanceof InputStream);
  MuleMessage uncompressedResponse=client.send("vm://decompressInput",compressedResponse.getPayload(),null);
  assertNotNull(uncompressedResponse);
  assertTrue(uncompressedResponse.getPayload() instanceof InputStream);
  byte[] uncompressedByteArray=IOUtils.toByteArray((InputStream)uncompressedResponse.getPayload());
  String uncompressedStr=new String(uncompressedByteArray);
  assertEquals(TEST_DATA,uncompressedStr);
}
