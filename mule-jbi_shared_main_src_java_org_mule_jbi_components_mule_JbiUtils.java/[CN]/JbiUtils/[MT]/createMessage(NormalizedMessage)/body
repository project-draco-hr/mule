{
  Object source=message.getContent();
  Map properties=new HashMap();
  for (Iterator iterator=message.getPropertyNames().iterator(); iterator.hasNext(); ) {
    String s=(String)iterator.next();
    properties.put(s,message.getProperty(s));
  }
  if (message.getSecuritySubject() != null) {
    properties.put(MuleProperties.MULE_USER_PROPERTY,message.getSecuritySubject());
  }
  return new MuleMessage(source,properties);
}
