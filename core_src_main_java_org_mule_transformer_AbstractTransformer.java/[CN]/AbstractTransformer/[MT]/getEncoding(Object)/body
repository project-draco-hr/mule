{
  String enc=null;
  if (src instanceof MuleMessage) {
    enc=((MuleMessage)src).getEncoding();
  }
  if (enc == null && endpoint != null) {
    enc=endpoint.getEncoding();
  }
 else   if (enc == null) {
    enc=muleContext != null ? muleContext.getConfiguration().getDefaultEncoding() : System.getProperty(MuleProperties.MULE_ENCODING_SYSTEM_PROPERTY);
  }
  return enc;
}
