{
  if (processor instanceof EndpointAwareMessageProcessor) {
    ((EndpointAwareMessageProcessor)processor).injectEndpoint(endpoint);
  }
  if (processor instanceof FlowConstructAware) {
    ((FlowConstructAware)processor).setFlowConstruct(flowConstruct);
  }
  if (processor instanceof MessageProcessorBuilder) {
    return ((MessageProcessorBuilder)processor).build();
  }
 else {
    return (MessageProcessor)processor;
  }
}
