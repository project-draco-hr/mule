{
  long endTime=System.currentTimeMillis() + timeout;
  int iteration=1;
  while (System.currentTimeMillis() < endTime) {
    logger.debug("checking file list, iteration :" + iteration);
    if (getFileList(directory).length == count) {
      logger.debug("found expected file count : " + count);
      return true;
    }
    Thread.sleep(1000);
    ++iteration;
  }
  return false;
}
