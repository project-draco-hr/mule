{
  Foreach foreachMp=new Foreach();
  foreachMp.setMuleContext(muleContext);
  foreachMp.setFlowConstruct(mock(Flow.class));
  List<Processor> processors=getSimpleMessageProcessors();
  foreachMp.setMessageProcessors(processors);
  MessageProcessorPathElement parentElement=mock(MessageProcessorPathElement.class);
  MessageProcessorPathElement foreachElement=mock(MessageProcessorPathElement.class);
  when(parentElement.addChild(any(Processor.class))).thenReturn(foreachElement);
  foreachMp.addMessageProcessorPathElements(parentElement);
  assertAddedPathElements(processors,foreachElement);
}
