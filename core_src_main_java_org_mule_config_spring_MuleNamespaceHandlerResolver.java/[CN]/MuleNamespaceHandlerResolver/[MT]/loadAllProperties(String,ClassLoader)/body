{
  Assert.notNull(resourceName,"Resource name must not be null");
  ClassLoader clToUse=classLoader;
  if (clToUse == null) {
    clToUse=ClassUtils.getDefaultClassLoader();
  }
  Collection namesAndValues=new HashSet();
  Enumeration urls=clToUse.getResources(resourceName);
  while (urls.hasMoreElements()) {
    Properties properties=new Properties();
    URL url=(URL)urls.nextElement();
    InputStream is=null;
    try {
      URLConnection con=url.openConnection();
      con.setUseCaches(false);
      is=con.getInputStream();
      properties.load(is);
    }
  finally {
      if (is != null) {
        is.close();
      }
    }
    Enumeration names=properties.propertyNames();
    while (names.hasMoreElements()) {
      String name=(String)names.nextElement();
      String value=properties.getProperty(name);
      namesAndValues.add(new PropertyNameValuePair(name,value));
    }
  }
  return namesAndValues;
}
