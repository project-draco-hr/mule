{
  DefaultMessageProcessorChainBuilder requestChainBuilder=new EndpointMessageProcessorChainBuilder(endpoint,flowConstruct);
  requestChainBuilder.setName("InboundEndpoint '" + endpoint.getEndpointURI().getUri() + "' request chain");
  requestChainBuilder.chain(createInboundMessageProcessors(endpoint));
  AbstractRedeliveryPolicy redeliveryPolicy=endpoint.getRedeliveryPolicy();
  if (redeliveryPolicy != null) {
    requestChainBuilder.chain(redeliveryPolicy);
  }
  requestChainBuilder.chain(endpoint.getMessageProcessors());
  if (target == null) {
    throw new ConfigurationException(MessageFactory.createStaticMessage("No listener (target) has been set for this endpoint"));
  }
  requestChainBuilder.chain(target);
  if (!endpoint.getExchangePattern().hasResponse()) {
    return requestChainBuilder.build();
  }
 else {
    DefaultMessageProcessorChainBuilder responseChainBuilder=new EndpointMessageProcessorChainBuilder(endpoint,flowConstruct);
    responseChainBuilder.setName("InboundEndpoint '" + endpoint.getEndpointURI().getUri() + "' response chain");
    responseChainBuilder.chain(createInboundResponseMessageProcessors(endpoint));
    responseChainBuilder.chain(endpoint.getResponseMessageProcessors());
    DefaultMessageProcessorChainBuilder compositeChainBuilder=new EndpointMessageProcessorChainBuilder(endpoint,flowConstruct);
    compositeChainBuilder.setName("InboundEndpoint '" + endpoint.getEndpointURI().getUri() + "' composite request/response chain");
    compositeChainBuilder.chain(requestChainBuilder.build(),responseChainBuilder.build());
    return compositeChainBuilder.build();
  }
}
