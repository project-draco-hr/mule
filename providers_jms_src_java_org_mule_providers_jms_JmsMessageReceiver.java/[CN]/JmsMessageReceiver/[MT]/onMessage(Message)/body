{
  if (logger.isDebugEnabled()) {
    logger.debug("Message received it is of type: " + message.getClass().getName());
  }
  try {
    String correlationId=message.getJMSCorrelationID();
    logger.debug("Message CorrelationId is: " + correlationId);
    logger.info("Jms Message Id is: " + message.getJMSMessageID());
    if (message.getJMSRedelivered()) {
      logger.info("Message with correlationId: " + correlationId + " is redelivered. handing off to Exception Handler");
      handleMessageRedeliviered(message);
      return;
    }
    TransactionProxy trans=null;
    if (connector instanceof TransactionEnabledConnector) {
      if (session.getTransacted()) {
        trans=((TransactionEnabledConnector)connector).beginTransaction(endpoint,session);
      }
 else       if (connector instanceof JmsConnector && ((JmsConnector)connector).getAcknowledgementMode() == Session.CLIENT_ACKNOWLEDGE) {
        trans=((TransactionEnabledConnector)connector).beginTransaction(endpoint,message);
      }
    }
    UMOMessageAdapter adapter=connector.getMessageAdapter(message);
    routeMessage(new MuleMessage(adapter),trans,endpoint.isSynchronous());
  }
 catch (  Exception e1) {
    handleException(message,new MuleException("Failed to create incoming message to an event: " + e1.getMessage(),e1));
  }
}
