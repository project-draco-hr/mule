{
  final String invalidSchemaLocation="non-existent.xsd";
  Mock session=MuleTestUtils.getMockSession();
  UMOEndpoint endpoint1=getTestEndpoint("Test1Endpoint",UMOEndpoint.ENDPOINT_TYPE_SENDER);
  endpoint1.setEndpointURI(new MuleEndpointURI("test://endpointUri.1"));
  RoundRobinXmlSplitter splitter=new RoundRobinXmlSplitter();
  splitter.setValidateSchema(true);
  splitter.setExternalSchemaLocation(invalidSchemaLocation);
  String payload=Utility.loadResourceAsString("purchase-order.xml",getClass());
  UMOMessage message=new MuleMessage(payload);
  assertTrue(splitter.isMatch(message));
  try {
    splitter.route(message,(UMOSession)session.proxy(),false);
    fail("Should have thrown an exception, because XSD is not found.");
  }
 catch (  IllegalArgumentException iaex) {
    assertTrue("Wrong exception?",iaex.getMessage().indexOf("Couldn't find schema at " + invalidSchemaLocation) != -1);
  }
  session.verify();
}
