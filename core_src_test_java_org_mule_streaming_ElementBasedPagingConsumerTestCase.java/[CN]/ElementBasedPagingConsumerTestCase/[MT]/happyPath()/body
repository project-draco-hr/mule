{
  List<Integer> elements=new ArrayList<Integer>();
  while (!this.consumer.isConsumed()) {
    elements.add(this.consumer.consume());
  }
  Assert.assertEquals(elements.size(),totalCount);
  Assert.assertTrue(this.consumer.isConsumed());
  for (  List<Integer> page : pages) {
    Assert.assertTrue(elements.containsAll(page));
  }
  Mockito.verify(this.consumer).close();
  Mockito.verify(this.producer).close();
  this.consumer.consume();
}
