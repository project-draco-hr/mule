{
  try {
    ZipFile zip=new ZipFile(file);
    nextEntry:     for (Enumeration<? extends ZipEntry> e=zip.entries(); e.hasMoreElements(); ) {
      ZipEntry entry=e.nextElement();
      if (pattern != null) {
        Matcher m=pattern.matcher(entry.getName());
        if (!m.matches())         continue nextEntry;
      }
      if (!entry.isDirectory()) {
        long time=entry.getTime();
        if (time <= 0)         time=file.lastModified();
        jar.putResource(entry.getName(),new ZipResource(zip,entry,time),true);
      }
    }
    return zip;
  }
 catch (  FileNotFoundException e) {
    throw new IllegalArgumentException("Problem opening JAR: " + file.getAbsolutePath());
  }
}
