{
  endpoint=createTestInboundEndpoint(new TestFilter(true),null,null,null,REQUEST_RESPONSE,null);
  endpoint.setListener(inboundListener);
  endpoint.setFlowConstruct(getTestFlow(muleContext));
  requestEvent=createTestRequestEvent(endpoint);
  responseEvent=createTestResponseEvent(endpoint);
  Processor mpChain=((AbstractEndpoint)endpoint).getMessageProcessorChain(endpoint.getFlowConstruct());
  result=mpChain.process(requestEvent);
  assertMessageSentSame(true);
  assertEquals(responseEvent.getMessage(),result.getMessage());
}
