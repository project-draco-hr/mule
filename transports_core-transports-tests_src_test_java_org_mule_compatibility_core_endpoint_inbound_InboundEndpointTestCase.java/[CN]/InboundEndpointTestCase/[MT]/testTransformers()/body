{
  endpoint=createTestInboundEndpoint(null,null,new InboundAppendTransformer(),new ResponseAppendTransformer(),REQUEST_RESPONSE,null);
  endpoint.setListener(inboundListener);
  endpoint.setFlowConstruct(getTestFlow());
  requestEvent=createTestRequestEvent(endpoint);
  responseEvent=createTestResponseEvent(endpoint);
  Processor mpChain=((AbstractEndpoint)endpoint).getMessageProcessorChain(endpoint.getFlowConstruct());
  result=mpChain.process(requestEvent);
  assertMessageSent(true);
  assertEquals(TEST_MESSAGE + InboundAppendTransformer.APPEND_STRING,inboundListener.sensedEvent.getMessageAsString(muleContext));
  assertNotNull(result);
  assertEquals(RESPONSE_MESSAGE + ResponseAppendTransformer.APPEND_STRING,getPayloadAsString(result.getMessage()));
}
