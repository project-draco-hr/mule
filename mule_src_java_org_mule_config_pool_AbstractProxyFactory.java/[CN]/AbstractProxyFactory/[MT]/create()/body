{
  UMOManager manager=MuleManager.getInstance();
  Object impl=descriptor.getImplementation();
  Object component=null;
  if (impl instanceof String) {
    String reference=impl.toString();
    if (reference.startsWith(MuleDescriptor.IMPLEMENTATION_TYPE_LOCAL)) {
      String refName=reference.substring(MuleDescriptor.IMPLEMENTATION_TYPE_LOCAL.length());
      component=descriptor.getProperties().get(refName);
      if (component == null) {
        throw new InitialisationException("Component implementation type is 'local' but no property called " + refName + " is set on the descriptor called "+ descriptor.getName());
      }
    }
    if (component == null) {
      if (descriptor.isContainerManaged()) {
        component=manager.getContainerContext().getComponent(reference);
      }
 else {
        try {
          component=ClassHelper.instanciateClass(reference,new Object[]{});
        }
 catch (        Exception e) {
          throw new InitialisationException("Failed to instanciate non-container managed object reference: " + reference + ". "+ e.getMessage(),e);
        }
      }
    }
  }
 else {
    component=impl;
  }
  descriptor.fireInitialisationCallbacks(component);
  afterComponentCreate(component);
  MuleProxy proxy=new MuleProxy(component,descriptor,pool);
  return proxy;
}
