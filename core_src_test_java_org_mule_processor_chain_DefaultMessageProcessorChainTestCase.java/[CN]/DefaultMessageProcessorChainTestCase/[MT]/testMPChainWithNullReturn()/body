{
  DefaultMessageProcessorChainBuilder builder=new DefaultMessageProcessorChainBuilder();
  AppendingMP mp1=new AppendingMP("1");
  AppendingMP mp2=new AppendingMP("2");
  ReturnNullMP nullmp=new ReturnNullMP();
  AppendingMP mp3=new AppendingMP("3");
  builder.chain(mp1,mp2,nullmp,mp3);
  MuleEvent requestEvent=getTestEventUsingFlow("0");
  assertNull(builder.build().process(requestEvent));
  assertSame(requestEvent,mp1.event);
  assertNotSame(mp1.event,mp1.resultEvent);
  assertEquals("01",mp1.resultEvent.getMessage().getPayload());
  assertSame(mp1.resultEvent,mp2.event);
  assertNotSame(mp2.event,mp2.resultEvent);
  assertEquals("012",mp2.resultEvent.getMessage().getPayload());
  assertSame(mp2.resultEvent,nullmp.event);
  assertEquals("012",nullmp.event.getMessage().getPayload());
  assertNull(mp3.event);
}
