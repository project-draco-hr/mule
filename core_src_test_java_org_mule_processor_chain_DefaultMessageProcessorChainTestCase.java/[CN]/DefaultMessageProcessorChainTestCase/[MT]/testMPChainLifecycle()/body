{
  DefaultMessageProcessorChainBuilder builder=new DefaultMessageProcessorChainBuilder();
  AppendingMP mp1=new AppendingInterceptingMP("1");
  AppendingMP mp2=new AppendingInterceptingMP("2");
  MessageProcessor chain=builder.chain(mp1,mp2).build();
  ((MuleContextAware)chain).setMuleContext(Mockito.mock(MuleContext.class,Mockito.RETURNS_DEEP_STUBS));
  ((FlowConstructAware)chain).setFlowConstruct(Mockito.mock(FlowConstruct.class));
  ((Lifecycle)chain).initialise();
  ((Lifecycle)chain).start();
  ((Lifecycle)chain).stop();
  ((Lifecycle)chain).dispose();
  assertLifecycle(mp1);
  assertLifecycle(mp2);
}
