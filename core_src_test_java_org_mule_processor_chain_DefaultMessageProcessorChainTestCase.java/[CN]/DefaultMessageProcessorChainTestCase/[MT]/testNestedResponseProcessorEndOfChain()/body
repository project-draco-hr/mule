{
  DefaultMessageProcessorChainBuilder builder=new DefaultMessageProcessorChainBuilder();
  builder.chain(new ResponseMessageProcessorAdapter(DefaultMessageProcessorChain.from(getAppendingMP("1"))));
  process(builder.build(),getTestEventUsingFlow("0"));
  assertThat(process(builder.build(),getTestEventUsingFlow("0")).getMessage().getPayload(),equalTo("01"));
  assertEquals(isMultipleThreadsUsed() ? 3 : 1,threads);
}
