{
  try {
    Folder folder=connection.getFolder(folderName,READ_ONLY);
    List<MuleMessage<String,EmailAttributes>> list=new LinkedList<>();
    for (    Message m : folder.getMessages()) {
      String body="";
      EmailAttributes attributes=fromMessage(m,false);
      if (matcher.test(attributes)) {
        if (readContent) {
          body=EmailContentProcessor.process(m).getBody();
          attributes=fromMessage(m);
        }
        list.add((MuleMessage)new DefaultMuleMessage(body,null,attributes,context));
      }
    }
    return list;
  }
 catch (  MessagingException me) {
    throw new EmailRetrieverException(me);
  }
}
