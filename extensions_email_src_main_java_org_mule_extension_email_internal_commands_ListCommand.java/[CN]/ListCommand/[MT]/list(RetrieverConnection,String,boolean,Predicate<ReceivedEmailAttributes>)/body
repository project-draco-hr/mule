{
  try {
    Folder folder=connection.getFolder(folderName,READ_ONLY);
    List<Message> list=new LinkedList<>();
    for (    javax.mail.Message m : folder.getMessages()) {
      Object emailContent="";
      ReceivedEmailAttributes attributes=fromMessage(m);
      if (matcher.test(attributes)) {
        if (shouldReadContent) {
          emailContent=readContent(m);
        }
        attributes=fromMessage(m);
        list.add(Message.builder().payload(emailContent).attributes(attributes).build());
      }
    }
    return list;
  }
 catch (  MessagingException me) {
    throw new EmailRetrieveException(me);
  }
}
