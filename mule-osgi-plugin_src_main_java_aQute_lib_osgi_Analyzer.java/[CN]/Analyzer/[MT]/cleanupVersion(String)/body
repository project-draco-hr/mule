{
  if (Verifier.VERSIONRANGE.matcher(version).matches())   return version;
  Matcher m=fuzzyVersionRange.matcher(version);
  if (m.matches()) {
    String prefix=m.group(1);
    String first=m.group(2);
    String last=m.group(3);
    String suffix=m.group(4);
    return prefix + cleanupVersion(first) + ","+ cleanupVersion(last)+ suffix;
  }
 else {
    m=fuzzyVersion.matcher(version);
    if (m.matches()) {
      StringBuffer result=new StringBuffer();
      String major=m.group(1);
      String minor=m.group(3);
      String micro=m.group(5);
      String qualifier=m.group(7);
      if (major != null) {
        result.append(major);
        if (minor != null) {
          result.append(".");
          result.append(minor);
          if (micro != null) {
            result.append(".");
            result.append(micro);
            if (qualifier != null) {
              result.append(".");
              cleanupModifier(result,qualifier);
            }
          }
 else           if (qualifier != null) {
            result.append(".0.");
            cleanupModifier(result,qualifier);
          }
        }
 else         if (qualifier != null) {
          result.append(".0.0.");
          cleanupModifier(result,qualifier);
        }
        return result.toString();
      }
    }
  }
  return version;
}
