{
  if (payload instanceof InputStream) {
    m.put(Message.ENCODING,ctx.getEncoding());
    m.setContent(InputStream.class,payload);
  }
 else   if (payload instanceof Reader) {
    m.setContent(XMLStreamReader.class,StaxUtils.createXMLStreamReader((Reader)payload));
  }
 else   if (payload instanceof byte[]) {
    m.setContent(InputStream.class,new ByteArrayInputStream((byte[])payload));
  }
 else   if (payload instanceof StaxSource) {
    m.setContent(XMLStreamReader.class,((StaxSource)payload).getXMLStreamReader());
  }
 else   if (payload instanceof Source) {
    m.setContent(XMLStreamReader.class,StaxUtils.createXMLStreamReader((Source)payload));
  }
 else   if (payload instanceof XMLStreamReader) {
    m.setContent(XMLStreamReader.class,(XMLStreamReader)payload);
  }
 else   if (payload instanceof Document) {
    DOMSource source=new DOMSource((Node)payload);
    m.setContent(XMLStreamReader.class,StaxUtils.createXMLStreamReader(source));
  }
 else {
    InputStream is=(InputStream)ctx.transformMessage(InputStream.class);
    m.put(Message.ENCODING,ctx.getEncoding());
    m.setContent(InputStream.class,is);
  }
}
