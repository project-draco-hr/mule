{
  try {
    DatabaseMetaData metaData=connection.getJdbcConnection().getMetaData();
    ResultSet typeInfo=metaData.getTypeInfo();
    ResultSetIterator resultSetIterator=new ResultSetIterator(connection,typeInfo,new InsensitiveMapRowHandler(),new SingleResultResultSetCloser(false));
    while (resultSetIterator.hasNext()) {
      Map<String,Object> typeRecord=resultSetIterator.next();
      Number dataType=(Number)typeRecord.get(METADATA_TYPE_ID_COLUMN);
      String typeName=(String)typeRecord.get(METADATA_TYPE_NAME_COLUMN);
      DbType resolvedDbType=dataType.equals(Types.BLOB) ? new BlobDbType(dataType.intValue(),typeName) : new ResolvedDbType(dataType.intValue(),typeName);
      if (!isUserDefinedType(resolvedDbType)) {
        registerType(resolvedDbType);
        if (LOGGER.isDebugEnabled()) {
          LOGGER.debug("Type: " + typeRecord);
        }
      }
    }
  }
 catch (  SQLException e) {
    throw new IllegalStateException("Cannot process metadata information",e);
  }
}
