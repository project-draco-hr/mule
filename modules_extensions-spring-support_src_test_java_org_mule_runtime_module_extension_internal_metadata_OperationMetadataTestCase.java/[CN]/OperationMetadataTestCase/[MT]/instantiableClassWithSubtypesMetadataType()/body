{
  componentId=new ProcessorId(TYPE_WITH_DECLARED_SUBTYPES_METADATA,FIRST_PROCESSOR_INDEX);
  MetadataResult<ComponentMetadataDescriptor> metadata=metadataManager.getMetadata(componentId);
  assertThat(metadata.isSuccess(),is(true));
  ParameterMetadataDescriptor rectangleMetadata=metadata.get().getParametersMetadata().get(1).get();
  assertThat(rectangleMetadata.getName(),is("rectangleSubtype"));
  MetadataType shapeType=rectangleMetadata.getType();
  assertThat(shapeType,is(instanceOf(DefaultUnionType.class)));
  assertThat(((DefaultUnionType)shapeType).getTypes(),hasSize(2));
  assertThat(((DefaultUnionType)shapeType).getTypes(),hasItems(toMetadataType(Rectangle.class),toMetadataType(Square.class)));
}
