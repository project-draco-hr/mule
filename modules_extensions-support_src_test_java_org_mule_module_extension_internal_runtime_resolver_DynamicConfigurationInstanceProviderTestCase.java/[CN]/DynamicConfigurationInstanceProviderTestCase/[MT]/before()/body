{
  ExtensionsTestUtils.stubRegistryKeys(muleContext,CONFIG_NAME);
  when(configuration.getInstantiator().getObjectType()).thenReturn(MODULE_CLASS);
  when(configuration.getInstantiator().newInstance()).thenAnswer(new Answer<Object>(){
    @Override public Object answer(    InvocationOnMock invocation) throws Throwable {
      return MODULE_CLASS.newInstance();
    }
  }
);
  when(configuration.getCapabilities(any(Class.class))).thenReturn(null);
  when(resolverSet.resolve(event)).thenReturn(resolverSetResult);
  when(muleContext.getExtensionManager()).thenReturn(extensionManager);
  when(operationContext.getEvent()).thenReturn(event);
  configurationObjectBuilder=new ConfigurationObjectBuilder(CONFIG_NAME,extension,configuration,resolverSet,configurationInstanceRegistrationCallback);
  instanceProvider=new DynamicConfigurationInstanceProvider(configurationObjectBuilder,resolverSet);
}
