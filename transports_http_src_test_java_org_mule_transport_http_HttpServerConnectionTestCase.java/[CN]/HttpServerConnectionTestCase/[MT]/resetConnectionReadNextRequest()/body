{
  when(mockSocket.getInputStream()).thenReturn(new ByteArrayInputStream(String.format("GET %s HTTP/1.1\n\nGET %s HTTP/1.1\n","/service/order?param1=value1&param2=value2","/?param1=value1&param2=value2").getBytes()));
  HttpServerConnection httpServerConnection=new HttpServerConnection(mockSocket,muleContext.getConfiguration().getDefaultEncoding(),mockHttpConnector);
  assertThat(httpServerConnection.getUrlWithoutRequestParams(),is("/service/order"));
  httpServerConnection.reset();
  assertThat(httpServerConnection.getUrlWithoutRequestParams(),is("/"));
}
