{
  MuleContext domainContext=new DomainContextBuilder().setDomainConfig("domain/http-shared-connector.xml").build();
  MuleContext firstAppContext=new ApplicationContextBuilder().setApplicationResources(new String[]{"domain/http-hello-mule-app.xml"}).setDomainContext(domainContext).build();
  ApplicationContextBuilder secondApp=new ApplicationContextBuilder();
  try {
    secondApp.setApplicationResources(new String[]{"domain/http-hello-mule-app.xml"}).setDomainContext(domainContext).build();
    fail("Second app context start should fail");
  }
 catch (  Exception e) {
    assertThat(e.getCause(),IsInstanceOf.instanceOf(ConnectorException.class));
  }
  firstAppContext.dispose();
}
