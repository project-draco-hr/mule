{
  MuleContext domainContext=new DomainContextBuilder().setDomainConfig("domain/http/http-shared-listener-config.xml").build();
  MuleContext firstAppContext=new ApplicationContextBuilder().setApplicationResources(new String[]{"domain/http/http-hello-mule-app.xml"}).setDomainContext(domainContext).build();
  ApplicationContextBuilder secondApp=new ApplicationContextBuilder();
  try {
    secondApp.setApplicationResources(new String[]{"domain/http/http-hello-mule-app.xml"}).setDomainContext(domainContext).build();
    fail("Second app context start should fail");
  }
 catch (  Exception e) {
    assertThat(e.getCause(),IsInstanceOf.instanceOf(InitialisationException.class));
  }
  firstAppContext.dispose();
}
