{
  MuleMessage message=createMuleMessage();
  message.removeProperty("MuleMessage",PropertyScope.OUTBOUND);
  RequestContext.setEvent(new DefaultMuleEvent(message,getTestInboundEndpoint(FOO_PROPERTY),getTestService()));
  message.setOutboundProperty(FOO_PROPERTY,"fooOutbound");
  message.setInvocationProperty("bar","barInvocation");
  message.setInvocationProperty(FOO_PROPERTY,"fooInvocation");
  message.setProperty(FOO_PROPERTY,"fooInbound",PropertyScope.INBOUND);
  message.setSessionProperty(FOO_PROPERTY,"fooSession");
  assertEquals(2,message.getInvocationPropertyNames().size());
  assertEquals(1,message.getOutboundPropertyNames().size());
  assertEquals(1,message.getInboundPropertyNames().size());
  assertEquals(1,message.getSessionPropertyNames().size());
  String value=message.findPropertyInAnyScope(FOO_PROPERTY,null);
  assertEquals("fooOutbound",value);
  message.removeProperty(FOO_PROPERTY,PropertyScope.OUTBOUND);
  value=message.findPropertyInAnyScope(FOO_PROPERTY,null);
  assertEquals("fooInvocation",value);
  message.removeProperty(FOO_PROPERTY,PropertyScope.INVOCATION);
  value=message.findPropertyInAnyScope(FOO_PROPERTY,null);
  assertEquals("fooSession",value);
  message.removeProperty(FOO_PROPERTY,PropertyScope.SESSION);
  value=message.findPropertyInAnyScope(FOO_PROPERTY,null);
  assertEquals("fooInbound",value);
  value=message.findPropertyInAnyScope("bar",null);
  assertEquals("barInvocation",value);
}
