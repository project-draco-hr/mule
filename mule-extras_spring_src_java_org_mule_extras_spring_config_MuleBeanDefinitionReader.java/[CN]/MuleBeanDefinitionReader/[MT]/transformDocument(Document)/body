{
  if (getXslResource() != null) {
    Transformer transformer=createTransformer(createXslSource());
    DOMResult result=new DOMResult();
    transformer.transform(new DOMSource(document),result);
    ByteArrayOutputStream baos=new ByteArrayOutputStream();
    DOMWriterImpl writer=new DOMWriterImpl();
    writer.writeNode(baos,result.getNode());
    System.out.println(baos.toString());
    logger.debug("Transformed document is:\n" + baos.toString());
    baos.close();
    return (Document)result.getNode();
  }
 else {
    return document;
  }
}
