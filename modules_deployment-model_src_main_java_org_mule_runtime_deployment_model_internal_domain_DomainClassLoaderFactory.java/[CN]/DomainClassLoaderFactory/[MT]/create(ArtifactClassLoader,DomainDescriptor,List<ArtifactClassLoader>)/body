{
  String domain=descriptor.getName();
  Preconditions.checkArgument(domain != null,"Domain name cannot be null");
  ArtifactClassLoader domainClassLoader=domainArtifactClassLoaders.get(domain);
  if (domainClassLoader != null) {
    return domainClassLoader;
  }
 else {
synchronized (this) {
      domainClassLoader=domainArtifactClassLoaders.get(domain);
      if (domainClassLoader == null) {
        if (domain.equals(DEFAULT_DOMAIN_NAME)) {
          domainClassLoader=getDefaultDomainClassLoader(parent.getClassLoaderLookupPolicy());
        }
 else {
          domainClassLoader=getCustomDomainClassLoader(parent.getClassLoaderLookupPolicy(),descriptor);
        }
        domainArtifactClassLoaders.put(domain,domainClassLoader);
      }
    }
  }
  return domainClassLoader;
}
