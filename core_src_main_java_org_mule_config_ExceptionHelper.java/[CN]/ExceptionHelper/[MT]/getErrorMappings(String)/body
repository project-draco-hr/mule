{
  Object m=errorMappings.get(protocol);
  if (m != null) {
    if (m instanceof Properties) {
      return (Properties)m;
    }
 else {
      return null;
    }
  }
 else {
    String name=SpiUtils.SERVICE_ROOT + SpiUtils.EXCEPTION_SERVICE_PATH + protocol+ "-exception-mappings.properties";
    InputStream in=ExceptionHelper.class.getClassLoader().getResourceAsStream(name);
    if (in == null) {
      errorMappings.put(protocol,"not found");
      logger.warn("Failed to load error mappings from: " + name + " This may be because there are no error code mappings for protocol: "+ protocol);
      return null;
    }
    Properties p=new Properties();
    try {
      p.load(in);
      in.close();
    }
 catch (    IOException iox) {
      throw new IllegalArgumentException("Failed to load resource: " + name);
    }
    errorMappings.put(protocol,p);
    String applyTo=p.getProperty(APPLY_TO_PROPERTY,null);
    if (applyTo != null) {
      String[] protocols=StringUtils.splitAndTrim(applyTo,",");
      for (int i=0; i < protocols.length; i++) {
        errorMappings.put(protocols[i],p);
      }
    }
    return p;
  }
}
