{
  ResultSetMetaData statementMetaData;
  try {
    statementMetaData=statement.getMetaData();
  }
 catch (  SQLException e) {
    return new DefaultResult<MetaData>(null,Result.Status.FAILURE,e.getMessage(),FailureType.UNSPECIFIED,e);
  }
  if (statementMetaData == null) {
    return new DefaultResult<MetaData>(null,Result.Status.FAILURE,"Driver did not return metadata for the provided SQL");
  }
  Map<String,MetaDataModel> recordModels=new HashMap<String,MetaDataModel>();
  try {
    for (int i=1; i <= statementMetaData.getColumnCount(); i++) {
      int columnType=statementMetaData.getColumnType(i);
      recordModels.put(statementMetaData.getColumnName(i),getDataTypeMetadataModel(columnType));
    }
  }
 catch (  SQLException e) {
    return new DefaultResult<MetaData>(null,Result.Status.FAILURE,e.getMessage(),FailureType.UNSPECIFIED,e);
  }
  DefaultDefinedMapMetaDataModel recordModel=new DefaultDefinedMapMetaDataModel(recordModels);
  DefaultListMetaDataModel listModel=new DefaultListMetaDataModel(recordModel);
  if (streaming) {
    listModel.setImplementationClass(ResultSetIterator.class.getName());
  }
  DefaultMetaData defaultMetaData=new DefaultMetaData(listModel);
  return new DefaultResult<MetaData>(defaultMetaData);
}
