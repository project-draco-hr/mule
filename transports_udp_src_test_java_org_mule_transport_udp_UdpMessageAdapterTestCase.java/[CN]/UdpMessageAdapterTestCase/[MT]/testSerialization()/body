{
  MessageAdapter messageAdapter=createAdapter(getValidMessage());
  DefaultMuleMessage muleMessage=new DefaultMuleMessage(messageAdapter);
  byte[] serializedMessage=SerializationUtils.serialize(muleMessage);
  DefaultMuleMessage readMessage=(DefaultMuleMessage)SerializationUtils.deserialize(serializedMessage);
  assertNotNull(readMessage.getAdapter());
  MessageAdapter readMessageAdapter=readMessage.getAdapter();
  assertTrue(readMessageAdapter instanceof UdpMessageAdapter);
  assertTrue(Arrays.equals(TEST_MESSAGE.getBytes(),(byte[])readMessageAdapter.getPayload()));
}
