{
  List<ConfigResource> allResources=new ArrayList<>();
  if (useMinimalConfigResource) {
    allResources.add(new ConfigResource(MULE_DOMAIN_REGISTRY_BOOTSTRAP_SPRING_CONFIG));
    allResources.add(new ConfigResource(MULE_MINIMAL_SPRING_CONFIG));
    allResources.add(new ConfigResource(MULE_SPRING_CONFIG));
    allResources.addAll(Arrays.asList(configResources));
  }
 else   if (useDefaultConfigResource) {
    allResources.add(new ConfigResource(MULE_REGISTRY_BOOTSTRAP_SPRING_CONFIG));
    allResources.add(new ConfigResource(MULE_MINIMAL_SPRING_CONFIG));
    allResources.add(new ConfigResource(MULE_SPRING_CONFIG));
    allResources.add(new ConfigResource(MULE_DEFAULTS_CONFIG));
    allResources.addAll(Arrays.asList(configResources));
  }
 else {
    allResources.add(new ConfigResource(MULE_SPRING_CONFIG));
    allResources.addAll(Arrays.asList(configResources));
  }
  addResources(allResources);
  ConfigResource[] configResourcesArray=new ConfigResource[allResources.size()];
  applicationContext=createApplicationContext(muleContext,allResources.toArray(configResourcesArray));
  createSpringRegistry(muleContext,applicationContext);
}
