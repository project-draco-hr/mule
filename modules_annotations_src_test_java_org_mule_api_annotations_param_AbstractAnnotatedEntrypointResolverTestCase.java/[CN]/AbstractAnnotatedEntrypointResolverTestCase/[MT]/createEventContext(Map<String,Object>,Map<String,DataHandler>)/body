{
  if (headers == null) {
    headers=new HashMap<String,Object>();
    headers.put("foo","fooValue");
    headers.put("bar","barValue");
    headers.put("baz","bazValue");
  }
  if (attachments == null) {
    attachments=new HashMap<String,DataHandler>();
    attachments.put("foo",new DataHandler(new StringDataSource("fooValue")));
    attachments.put("bar",new DataHandler(new StringDataSource("barValue")));
    attachments.put("baz",new DataHandler(new StringDataSource("bazValue")));
  }
  DefaultMuleMessage message;
  if (inboundScope) {
    message=new DefaultMuleMessage("test",null,attachments,muleContext);
    for (    String s : headers.keySet()) {
      message.setInboundProperty(s,headers.get(s));
    }
  }
 else {
    message=new DefaultMuleMessage("test",headers,muleContext);
    for (    String s : attachments.keySet()) {
      message.addOutboundAttachment(s,attachments.get(s));
    }
  }
  return new DefaultMuleEventContext(new DefaultMuleEvent(message,getTestInboundEndpoint("null"),new DefaultMuleSession(muleContext)));
}
