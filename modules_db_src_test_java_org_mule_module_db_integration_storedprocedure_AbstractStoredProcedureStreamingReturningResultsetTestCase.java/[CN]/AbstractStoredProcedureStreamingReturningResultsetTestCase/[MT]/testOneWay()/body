{
  LocalMuleClient client=muleContext.getClient();
  client.dispatch("vm://testOneWay",TEST_MESSAGE,null);
  List<MuleMessage> responses=new LinkedList<MuleMessage>();
  MuleMessage response=client.request("vm://testOut",RECEIVE_TIMEOUT);
  responses.add(response);
  response=client.request("vm://testOut",RECEIVE_TIMEOUT);
  responses.add(response);
  response=client.request("vm://testOut",RECEIVE_TIMEOUT);
  responses.add(response);
  assertEquals(3,responses.size());
  assertThat(responses,AllOf.allOf(ContainsMessage.mapPayloadWith("NAME",MARS.getName()),ContainsMessage.mapPayloadWith("NAME",EARTH.getName()),ContainsMessage.mapPayloadWith("NAME",VENUS.getName())));
}
