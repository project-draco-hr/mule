{
  MuleEventContext context=RequestContext.getEventContext();
  String contents=data.toString();
  String msg=StringMessageUtils.getBoilerPlate("Message Received in component: " + context.getComponent().getName() + ". Content is: "+ StringMessageUtils.truncate(contents,100,true),'*',80);
  logger.info(msg);
  if (eventCallback != null) {
    eventCallback.eventReceived(context,this);
  }
  Object replyMessage;
  if (returnMessage != null) {
    replyMessage=returnMessage;
  }
 else {
    replyMessage=contents + " Received";
  }
  context.getMuleContext().fireNotification(new FunctionalTestNotification(context,replyMessage,FunctionalTestNotification.EVENT_RECEIVED));
  if (throwException) {
    if (returnMessage != null && returnMessage instanceof Exception) {
      throw (Exception)returnMessage;
    }
 else {
      throw new DefaultMuleException(MessageFactory.createStaticMessage("Functional Test Component Exception"));
    }
  }
  return replyMessage;
}
