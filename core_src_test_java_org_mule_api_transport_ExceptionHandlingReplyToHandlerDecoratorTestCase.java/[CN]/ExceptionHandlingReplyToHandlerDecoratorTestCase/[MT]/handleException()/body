{
  SensingNullReplyToHandler sensingReplyToHandler=new SensingNullReplyToHandler();
  ExceptionHandlingReplyToHandlerDecorator errorHandlingreplyToHandler=new ExceptionHandlingReplyToHandlerDecorator(sensingReplyToHandler,messagingExceptionHandler);
  MessagingException messagingException=new MessagingException(sourceEvent,new RuntimeException());
  when(messagingExceptionHandler.handleException(messagingException,sourceEvent)).thenAnswer(new Answer<MuleEvent>(){
    @Override public MuleEvent answer(    InvocationOnMock invocation) throws Throwable {
      return handledEvent;
    }
  }
);
  errorHandlingreplyToHandler.processExceptionReplyTo(sourceEvent,messagingException,null);
  verify(messagingExceptionHandler,Mockito.times(1)).handleException(messagingException,sourceEvent);
  assertThat(sensingReplyToHandler.exception,CoreMatchers.<Exception>equalTo(messagingException));
  assertThat(((MessagingException)sensingReplyToHandler.exception).getEvent(),equalTo(handledEvent));
  assertThat(sensingReplyToHandler.event,nullValue());
}
