{
  String myFirstDirName="FirstWrite";
  String mySecondDirName="SecondWrite";
  String myFileName1="export.txt";
  String myFileName2="export.txt.OK";
  File myDir=FileUtils.newFile(myFirstDirName);
  if (myDir.isDirectory()) {
    File[] files=myDir.listFiles();
    for (int i=0; i < files.length; i++) {
      assertTrue(files[i].delete());
    }
    assertTrue(myDir.delete());
  }
  File myDir2=FileUtils.newFile(mySecondDirName);
  if (myDir2.isDirectory()) {
    File[] files=myDir2.listFiles();
    for (int i=0; i < files.length; i++) {
      assertTrue(files[i].delete());
    }
    assertTrue(myDir2.delete());
  }
  try {
    assertFalse(FileUtils.newFile(myDir,myFileName1).exists());
    assertFalse(FileUtils.newFile(myDir2,myFileName2).exists());
    MuleClient client=new MuleClient();
    client.send("vm://filesend","Hello",null);
    assertTrue(FileUtils.newFile(myDir,myFileName1).exists());
    assertTrue(FileUtils.newFile(myDir2,myFileName2).exists());
  }
 catch (  AssertionFailedError e1) {
    e1.printStackTrace();
  }
 finally {
    assertTrue(FileUtils.newFile(myDir,myFileName1).delete());
    assertTrue(FileUtils.newFile(myDir2,myFileName2).delete());
    assertTrue(myDir.delete());
    assertTrue(myDir2.delete());
  }
}
