{
  when(mockMuleContext.getRegistry().lookupObject(MessageProcessingManager.class)).thenReturn(mockMessageProcessingManager);
  when(mockMuleContext.getRegistry().lookupObject(HttpListenerConnectionManager.class)).thenReturn(mockListenerConnectionManager);
  when(mockMuleContext.getRegistry().lookupObjects(HttpListenerConfig.class)).thenReturn(Collections.<HttpListenerConfig>emptyList());
  when(mockMuleContext.getRegistry().get(anyString())).thenReturn(null);
  new HttpListenerBuilder(mockMuleContext).setFlow(mockFlow).setHost(HOST).setPort(PORT).setPath(PATH).build();
  verify(mockListenerConnectionManager).createServer(eq(new ServerAddress(IP,PORT)),any(WorkManagerSource.class),eq(true),eq(DefaultHttpListenerConfig.DEFAULT_CONNECTION_IDLE_TIMEOUT));
}
