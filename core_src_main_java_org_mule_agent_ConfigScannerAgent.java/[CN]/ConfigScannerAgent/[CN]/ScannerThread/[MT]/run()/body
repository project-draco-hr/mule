{
  while (true) {
    if (doStop || errorCount >= errorThreshold) {
      break;
    }
    try {
      File[] configFiles=configDir.listFiles();
      for (int i=0; i < configFiles.length; i++) {
        File configFile=configFiles[i];
        String path=configFile.getCanonicalPath();
        if (processedFiles.contains(path)) {
          configFile.delete();
          if (configFile.exists()) {
            processedFiles.remove(processedFiles.indexOf(path));
          }
        }
 else {
          logger.info(path);
          processConfigFile(path);
          configFile.delete();
          processedFiles.add(path);
        }
      }
    }
 catch (    IOException ioe) {
      logger.error("Unable to check directory: " + ioe.toString());
      errorCount++;
    }
    try {
      sleep(sleepInterval);
    }
 catch (    InterruptedException e) {
    }
  }
}
