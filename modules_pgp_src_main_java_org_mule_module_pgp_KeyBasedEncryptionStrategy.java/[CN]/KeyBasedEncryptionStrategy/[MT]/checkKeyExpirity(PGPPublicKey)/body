{
  if (this.isCheckKeyExpirity() && publicKey.getValidDays() != 0) {
    Calendar calendar=Calendar.getInstance();
    calendar.setTime(publicKey.getCreationTime());
    calendar.add(Calendar.DATE,publicKey.getValidDays());
    if (!calendar.getTime().after(Calendar.getInstance().getTime())) {
      throw new InvalidPublicKeyException(PGPMessages.pgpPublicKeyExpired());
    }
  }
}
