{
  try {
    Continuation continuation=ContinuationSupport.getContinuation(request);
    if (continuation.isInitial()) {
      final JettyHttpMessageReceiver receiver=(JettyHttpMessageReceiver)getReceiverForURI(request);
      final JettyHttpMessageReceiver.ContinuationsResponseHandler continuationsResponseHandler=receiver.processMessageAsync(request,response,continuation);
      continuation.setAttribute(RESPONSE_HANDLER_KEY,continuationsResponseHandler);
      continuation.suspend();
    }
 else {
      if (continuation.isResumed()) {
        final JettyHttpMessageReceiver.ContinuationsResponseHandler responseHandler=(JettyHttpMessageReceiver.ContinuationsResponseHandler)continuation.getAttribute(RESPONSE_HANDLER_KEY);
        responseHandler.complete();
      }
    }
  }
 catch (  RuntimeException e) {
    throw new ServletException(e);
  }
catch (  Exception e) {
    String message=e.getMessage();
    handleException(e,message,response);
  }
}
