{
  TcpConnector c=(TcpConnector)muleContext.getRegistry().lookupObject("custom-class-loading-protocol-connector");
  assertNotNull(c);
  CustomClassLoadingLengthProtocol protocol=(CustomClassLoadingLengthProtocol)c.getTcpProtocol();
  assertEquals(protocol.getClass(),CustomClassLoadingLengthProtocol.class);
  assertEquals(protocol.getClassLoader(),muleContext.getRegistry().get("classLoader"));
  assertTrue(((AbstractByteProtocol)c.getTcpProtocol()).isRethrowExceptionOnRead());
}
