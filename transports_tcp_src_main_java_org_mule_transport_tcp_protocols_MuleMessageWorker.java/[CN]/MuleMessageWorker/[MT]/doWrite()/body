{
  DefaultMuleMessage msg=(DefaultMuleMessage)RequestContext.getEvent().getMessage();
  wireFormat.setMuleContext(RequestContext.getEvent().getMuleContext());
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  try {
    wireFormat.write(baos,msg,msg.getEncoding());
  }
 catch (  MuleException e) {
    throw new IOException(e.getDetailedMessage());
  }
  return baos.toByteArray();
}
