{
  if (entry == null) {
    if (expectedType == null) {
      return null;
    }
    Object entryType=ClassUtils.instanciateClass(expectedType,ClassUtils.NO_ARGS);
    if (!(entryType instanceof Entry)) {
      entry=new JiniMessage(null,entryType);
      if (fields.size() > 0) {
        BeanUtils.populate(entry,fields);
        BeanUtils.populate(((JiniMessage)entry).getPayload(),fields);
      }
    }
 else {
      entry=(Entry)entryType;
      if (fields.size() > 0) {
        BeanUtils.populate(entry,fields);
      }
    }
  }
  return entry;
}
