{
  try {
    DatabaseMetaData metaData=connection.getMetaData();
    ResultSet typeInfo=metaData.getTypeInfo();
    ResultSetIterator resultSetIterator=new ResultSetIterator(connection,typeInfo,new InsensitiveMapRowHandler(),new SingleResultResultSetCloser());
    while (resultSetIterator.hasNext()) {
      Map<String,Object> typeRecord=resultSetIterator.next();
      Number data_type=(Number)typeRecord.get(METADATA_TYPE_ID_COLUMN);
      String type_name=(String)typeRecord.get(METADATA_TYPE_NAME_COLUMN);
      ResolvedDbType resolvedDbType=new ResolvedDbType(data_type.intValue(),type_name);
      if (!isUserDefinedType(resolvedDbType)) {
        registerType(resolvedDbType);
        if (logger.isDebugEnabled()) {
          logger.debug("Type: " + typeRecord);
        }
      }
    }
  }
 catch (  SQLException e) {
    throw new IllegalStateException("Cannot process metadata information",e);
  }
}
