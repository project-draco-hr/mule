{
  DefaultListableBeanFactory beanFactory=new DefaultListableBeanFactory(getInternalParentBeanFactory());
  beanFactory.setAutowireCandidateResolver(new ContextAnnotationAutowireCandidateResolver());
  beanFactory.setInstantiationStrategy(new LaxInstantiationStrategyWrapper(new CglibSubclassingInstantiationStrategy(),optionalObjectsController));
  if (getParent() != null) {
    AbstractBeanFactory parentBeanFactory=(AbstractBeanFactory)getParent().getAutowireCapableBeanFactory();
    beanFactory.copyConfigurationFrom(parentBeanFactory);
  }
  return beanFactory;
}
