{
  int i=expression.indexOf(".");
  String name;
  String property=null;
  boolean propertyRequired=true;
  boolean objectRequired=true;
  if (i > 0) {
    name=expression.substring(0,i);
    property=expression.substring(i + 1);
    if (property.endsWith("*")) {
      propertyRequired=false;
      property=property.substring(property.length() - 1);
    }
  }
 else {
    name=expression;
  }
  if (name.endsWith("*")) {
    objectRequired=false;
    name=name.substring(name.length() - 1);
  }
  Object o=muleContext.getRegistry().lookupObject(name);
  if (o == null && objectRequired) {
    throw new ExpressionRuntimeException(CoreMessages.expressionEvaluatorReturnedNull(NAME,expression));
  }
 else   if (o == null || property == null) {
    return o;
  }
 else   if (muleContext.getExpressionManager().isEvaluatorRegistered("bean")) {
    if (o instanceof AbstractEndpointBuilder) {
      property="endpointBuilder.endpoint." + property;
    }
    Object p=muleContext.getExpressionManager().evaluate("#[bean:" + property + "]",new DefaultMuleMessage(o));
    if (p == null && propertyRequired) {
      throw new ExpressionRuntimeException(CoreMessages.expressionEvaluatorReturnedNull(NAME,name + "." + property));
    }
 else {
      return p;
    }
  }
 else {
    throw new ExpressionRuntimeException(CoreMessages.expressionEvaluatorNotRegistered("bean"));
  }
}
