{
  try {
    return mode == FileWriteMode.APPEND ? client.appendFileStream(path) : client.storeFileStream(path);
  }
 catch (  Exception e) {
    throw exception(String.format("Could not open stream to write to path '%s' using mode '%s'",path,mode),e);
  }
}
