{
  MuleClient client=muleContext.getClient();
  MuleMessage muleMessage=MuleMessage.builder().payload(TEST_MESSAGE).mediaType(MediaType.parse(MediaType.TEXT + "; charset=" + UTF_16.name())).build();
  client.dispatch("vm://testInput",muleMessage);
  MuleMessage response=client.request("vm://testOutput",120000);
  assertThat(response.getDataType().getMediaType().getPrimaryType(),equalTo(MediaType.TEXT.getPrimaryType()));
  assertThat(response.getDataType().getMediaType().getSubType(),equalTo(MediaType.TEXT.getSubType()));
  assertThat(response.getDataType().getMediaType().getCharset().get(),equalTo(UTF_16));
}
