{
  MuleClient client=muleContext.getClient();
  MuleMessage muleMessage=MuleMessage.builder().payload(TEST_MESSAGE).addOutboundProperty(CONTENT_TYPE_PROPERTY,MediaType.TEXT + "; charset=" + UTF_16.name()).build();
  client.dispatch("vm://testInput",muleMessage);
  MuleMessage response=client.request("vm://testOutput",120000);
  assertThat(response.getDataType().getMediaType().getPrimaryType(),equalTo(MediaType.TEXT.getPrimaryType()));
  assertThat(response.getDataType().getMediaType().getSubType(),equalTo(MediaType.TEXT.getSubType()));
  assertThat(response.getDataType().getMediaType().getCharset().get(),equalTo(UTF_16));
  assertThat(response.getOutboundProperty(MuleProperties.MULE_ENCODING_PROPERTY),is(nullValue()));
  assertThat(response.getOutboundProperty(MuleProperties.CONTENT_TYPE_PROPERTY),is(nullValue()));
}
