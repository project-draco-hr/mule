{
  String cId=event.getMessage().getCorrelationId();
  int groupSize=event.getMessage().getCorrelationGroupSize();
  if (cId == null) {
    throw new RoutingException(new Message(Messages.NO_CORRELATION_ID),event.getMessage(),event.getEndpoint());
  }
  EventGroup eg=(EventGroup)eventGroups.get(cId);
  if (eg == null) {
    eg=new EventGroup(cId,groupSize);
    eg.addEvent(event);
    eventGroups.put(eg.getGroupId(),eg);
  }
 else {
    eg.addEvent(event);
  }
  return eg;
}
