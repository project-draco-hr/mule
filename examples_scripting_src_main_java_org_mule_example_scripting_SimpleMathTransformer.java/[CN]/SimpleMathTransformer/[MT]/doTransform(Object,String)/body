{
  double data=NumberUtils.toDouble(src);
  if (data == NumberUtils.DOUBLE_ERROR) {
    throw new TransformerException(MessageFactory.createStaticMessage("Unable to convert message to double: " + src));
  }
  double result;
  if (operation.equalsIgnoreCase("add")) {
    result=data + factor;
  }
 else   if (operation.equalsIgnoreCase("subtract")) {
    result=data - factor;
  }
 else   if (operation.equalsIgnoreCase("multiply")) {
    result=data * factor;
  }
 else   if (operation.equalsIgnoreCase("divide")) {
    result=data / factor;
  }
 else {
    throw new TransformerException(MessageFactory.createStaticMessage("Operation " + operation + " not recognized"));
  }
  return new Double(result);
}
