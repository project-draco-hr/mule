{
  MuleContext muleContext=event.getMuleContext();
  String tempUrl;
  if (addressFromMessage) {
    tempUrl=event.getMessage().getStringProperty(WS_SERVICE_URL,null);
    if (tempUrl == null) {
      throw new IllegalArgumentException(CoreMessages.propertyIsNotSetOnEvent(WS_SERVICE_URL).toString());
    }
  }
 else {
    tempUrl=address;
  }
  MuleMessage message=new DefaultMuleMessage(event.transformMessage(),muleContext);
  if (properties != null && properties.get(AxisConnector.SOAP_METHODS) != null) {
    message.addProperties((Map)properties.get(AxisConnector.SOAP_METHODS));
  }
  EndpointBuilder endpointBuilder=new EndpointURIEndpointBuilder("axis:" + tempUrl,muleContext);
  if (use != null) {
    endpointBuilder.setProperty(AxisConnector.USE,use);
  }
  if (style != null) {
    endpointBuilder.setProperty(AxisConnector.STYLE,style);
  }
  OutboundEndpoint endpoint=muleContext.getRegistry().lookupEndpointFactory().getOutboundEndpoint(endpointBuilder);
  MuleMessage result=event.getSession().sendEvent(message,endpoint);
  return result;
}
