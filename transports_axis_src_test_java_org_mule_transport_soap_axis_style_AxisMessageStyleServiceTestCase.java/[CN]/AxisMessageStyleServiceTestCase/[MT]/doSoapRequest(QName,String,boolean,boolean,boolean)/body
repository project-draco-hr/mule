{
  if (useAxisApi) {
    Service service=new Service();
    Call call=(Call)service.createCall();
    call.setTargetEndpointAddress(new java.net.URL(endpoint));
    call.setOperationName(method);
    String ret=(String)call.invoke(new Object[]{expectedResult});
    assertNotNull(ret);
    assertEquals(ret,expectedResult);
  }
 else {
    MuleClient client=muleContext.getClient();
    Map<String,Object> props=new HashMap<String,Object>();
    if (useSoapMethod) {
      SoapMethod soapMethod=new SoapMethod(method);
      soapMethod.addNamedParameter(new QName(method.getNamespaceURI(),method.getLocalPart()),NamedParameter.XSD_STRING,ParameterMode.IN);
      props.put(MuleProperties.MULE_METHOD_PROPERTY,soapMethod);
    }
 else     if (useQNameMethod) {
      props.put(MuleProperties.MULE_METHOD_PROPERTY,method);
    }
 else {
      endpoint+="?method=" + method.getLocalPart();
      if (StringUtils.isNotBlank(method.getNamespaceURI())) {
        props.put("methodNamespace",method.getNamespaceURI());
      }
    }
    MuleMessage result=client.send(endpoint,expectedResult,props);
    assertNotNull(result);
    assertEquals(expectedResult,result.getPayloadAsString());
  }
}
