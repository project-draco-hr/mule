{
  if (event == null || VoidMuleEvent.getInstance().equals(event)) {
    return event;
  }
  MuleMessage message=event.getMessage();
  if (transformer != null) {
    try {
      Object payload=transformer.transform(message.getPayload());
      message=new DefaultMuleMessage(payload,message,muleContext);
      propagateMagicProperties(message,message);
    }
 catch (    TransformerException e) {
      throw new RoutingException(CoreMessages.transformFailedBeforeFilter(),event,routes.get(0),e);
    }
  }
  return message == null ? null : new DefaultMuleEvent(message,event);
}
