{
  Mock mockMessage=new Mock(TextMessage.class);
  mockMessage.expectAndReturn("getJMSCorrelationID",null);
  mockMessage.expectAndReturn("getJMSMessageID","1234567890");
  mockMessage.expectAndReturn("getJMSDeliveryMode",new Integer(1));
  mockMessage.expectAndReturn("getJMSDestination",null);
  mockMessage.expectAndReturn("getJMSPriority",new Integer(4));
  mockMessage.expectAndReturn("getJMSRedelivered",Boolean.FALSE);
  mockMessage.expectAndReturn("getJMSReplyTo",null);
  mockMessage.expectAndReturn("getJMSExpiration",new Long(0));
  mockMessage.expectAndReturn("getJMSTimestamp",new Long(0));
  mockMessage.expectAndReturn("getJMSType",null);
  mockMessage.expect("toString");
  mockMessage.expect("toString");
  mockMessage.expect("clearProperties");
  mockMessage.expectAndReturn("getPropertyNames",IteratorUtils.asEnumeration(IteratorUtils.emptyIterator()));
  mockMessage.expectAndReturn("getObjectProperty","JMS_CUSTOM_PROPERTY","customValue");
  ConstraintMatcher setPropertyMatcher=new FullConstraintMatcher(new Constraint[]{new IsEqual("JMS_CUSTOM_PROPERTY"),new IsEqual("customValue")});
  mockMessage.expect("setObjectProperty",setPropertyMatcher);
  Message mockTextMessage=(Message)mockMessage.proxy();
  UMOMessage msg=new MuleMessage(new JmsMessageAdapter(mockTextMessage));
  msg.setProperty("JMS_CUSTOM_PROPERTY","customValue");
  RequestContext.setEvent(new MuleEvent(msg,MuleTestUtils.getTestEvent("previous")));
  ObjectToJMSMessage transformer=new ObjectToJMSMessage();
  Message transformed=(Message)transformer.transform(msg.getPayload());
  assertEquals("customValue",transformed.getObjectProperty("JMS_CUSTOM_PROPERTY"));
}
