{
  MessageAdapter messageAdapter=createAdapter(messageFile);
  DefaultMuleMessage muleMessage=new DefaultMuleMessage(messageAdapter);
  byte[] serializedMessage=SerializationUtils.serialize(muleMessage);
  DefaultMuleMessage readMessage=(DefaultMuleMessage)SerializationUtils.deserialize(serializedMessage);
  assertNotNull(readMessage.getAdapter());
  MessageAdapter readMessageAdapter=readMessage.getAdapter();
  assertTrue(readMessageAdapter instanceof FileContentsMessageAdapter);
  assertTrue(Arrays.equals((byte[])getValidMessage(),(byte[])readMessageAdapter.getPayload()));
}
