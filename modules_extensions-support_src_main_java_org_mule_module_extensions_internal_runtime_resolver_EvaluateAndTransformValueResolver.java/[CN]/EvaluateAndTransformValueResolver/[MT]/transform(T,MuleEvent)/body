{
  if (expectedType.getRawType().isInstance(object)) {
    return object;
  }
  Type expectedClass=expectedType.getRawType();
  if (expectedClass instanceof ParameterizedType) {
    expectedClass=((ParameterizedType)expectedClass).getRawType();
  }
  org.mule.api.transformer.DataType sourceDataType=DataTypeFactory.create(object.getClass());
  org.mule.api.transformer.DataType targetDataType=DataTypeFactory.create((Class)expectedClass);
  Transformer transformer;
  try {
    transformer=muleContext.getRegistry().lookupTransformer(sourceDataType,targetDataType);
  }
 catch (  TransformerException e) {
    return object;
  }
  if (transformer != null) {
    if (transformer instanceof MessageTransformer) {
      return (T)((MessageTransformer)transformer).transform(object,event);
    }
 else {
      return (T)transformer.transform(object);
    }
  }
  return object;
}
