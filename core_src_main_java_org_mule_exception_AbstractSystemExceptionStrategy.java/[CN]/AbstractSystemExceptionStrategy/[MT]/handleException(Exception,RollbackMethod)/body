{
  fireNotification(ex);
  logException(ex);
  if (isRollback(ex)) {
    rollback(rollbackMethod);
  }
 else {
    commit();
  }
  ExceptionPayload exceptionPayload=new DefaultExceptionPayload(ex);
  if (RequestContext.getEvent() != null) {
    RequestContext.setExceptionPayload(exceptionPayload);
  }
  if (ex instanceof ConnectException) {
    handleReconnection((ConnectException)ex);
  }
}
