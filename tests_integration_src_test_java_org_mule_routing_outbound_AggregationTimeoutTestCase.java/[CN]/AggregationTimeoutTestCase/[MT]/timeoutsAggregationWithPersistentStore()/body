{
  List<String> inputData=new ArrayList<>();
  inputData.add(PROCESS_EVENT);
  inputData.add(BLOCK_EVENT);
  try {
    LocalMuleClient client=muleContext.getClient();
    client.dispatch("vm://testIn",inputData,null);
    MuleMessage response=client.request("vm://testOut",RECEIVE_TIMEOUT);
    assertThat(response.getPayload(),instanceOf(List.class));
    List<String> payload=(List)response.getPayload();
    assertThat(payload.size(),equalTo(1));
    assertThat(payload,hasItem(PROCESSED_EVENT));
  }
  finally {
    blockExecution.countDown();
  }
}
