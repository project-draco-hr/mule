{
  AsyncInterceptingMessageProcessor async=new AsyncInterceptingMessageProcessor(muleContext.getDefaultThreadingProfile(),"async",0);
  SensingNullMessageProcessor asyncListener=new SensingNullMessageProcessor();
  async.setListener(asyncListener);
  async.start();
  MuleMessage message=new DefaultMuleMessage("data",muleContext);
  MuleEvent event=new DefaultMuleEvent(message,MessageExchangePattern.ONE_WAY,getTestService());
  message.setInvocationProperty("key","value");
  async.process(event);
  asyncListener.latch.await(RECEIVE_TIMEOUT,TimeUnit.MILLISECONDS);
  MuleEvent asyncEvent=asyncListener.event;
  assertNotSame(asyncEvent,event);
  assertFalse(asyncEvent.equals(event));
  assertNotSame(asyncEvent.getSession(),event.getSession());
  assertEquals("value",message.getInvocationProperty("key"));
  message.setProperty("newKey","newValue",PropertyScope.INVOCATION);
  assertEquals("newValue",message.getInvocationProperty("newKey"));
  assertNull(event.getSession().getProperty("newKey"));
  async.stop();
}
