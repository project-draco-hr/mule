{
  URL url=Thread.currentThread().getContextClassLoader().getResource("./encrypted-signed.asc");
  int length=(int)FileUtils.newFile(url.getFile()).length();
  byte[] msg=new byte[length];
  FileInputStream in=new FileInputStream(url.getFile());
  in.read(msg);
  in.close();
  Map props=new HashMap();
  props.put("TARGET_FILE",TARGET);
  MuleClient client=new MuleClient();
  MuleMessage reply=client.send("vm://echo",new String(msg),props);
  assertNull(reply.getExceptionPayload());
  try {
    FileReader outputFile=new FileReader(DIRECTORY + TARGET);
    outputFile.close();
    File f=FileUtils.newFile(DIRECTORY + TARGET);
    f.delete();
  }
 catch (  FileNotFoundException fileNotFound) {
    fail("File not successfully created");
  }
}
