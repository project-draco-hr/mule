{
  try {
    dispatchToSocket(event);
    if (returnResponse(event)) {
      try {
        Object result=receiveFromSocket(socket,getTimeout(),endpoint);
        if (result == null) {
          return InternalMessage.builder().nullPayload().build();
        }
        if (result instanceof InternalMessage) {
          return (InternalMessage)result;
        }
        return InternalMessage.builder().payload(result).build();
      }
 catch (      Exception ex) {
        if (logger.isInfoEnabled()) {
          logger.info("Error occurred while Reading; Message: " + ex.getMessage(),ex);
        }
        closeSocket();
        throw ex;
      }
    }
 else {
      return event.getMessage();
    }
  }
  finally {
    if (!this.getConnector().isKeepSendSocketOpen()) {
      closeSocket();
    }
  }
}
