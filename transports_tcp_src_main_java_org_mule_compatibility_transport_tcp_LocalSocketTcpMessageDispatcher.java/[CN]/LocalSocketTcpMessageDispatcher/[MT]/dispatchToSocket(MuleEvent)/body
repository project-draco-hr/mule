{
  if (socket == null || socket.isClosed()) {
    if (logger.isDebugEnabled()) {
      logger.debug("Socket is null; Creating... ");
    }
    TcpSocketKey socketKey=new TcpSocketKey(endpoint);
    socket=(Socket)socketFactory.makeObject(socketKey);
  }
  if (logger.isDebugEnabled()) {
    logger.debug("Is socket closed? " + (socket != null && socket.isClosed()));
  }
  try {
    Object payload=event.getMessage().getPayload();
    event.setMessage(new DefaultMuleMessage(payload,event.getMessage(),event.getMuleContext()));
    write(payload);
    return;
  }
 catch (  IOException ioEx) {
    closeSocket();
    if (logger.isInfoEnabled()) {
      logger.info("Error occurred while Writing; Message: " + ioEx.getMessage(),ioEx);
    }
    if (ioEx instanceof SocketTimeoutException) {
      throw ioEx;
    }
  }
catch (  Exception ex) {
    logger.info("Unknown Error occurred while Writing; Message: " + ex.getMessage(),ex);
  }
}
