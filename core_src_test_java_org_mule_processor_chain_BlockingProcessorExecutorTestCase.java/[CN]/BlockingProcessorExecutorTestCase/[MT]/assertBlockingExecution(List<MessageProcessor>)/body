{
  ProcessorExecutor executor=createProcessorExecutor(processors);
  assertThat(RequestContext.getEvent(),is(nullValue()));
  if (event.getExchangePattern() == MessageExchangePattern.REQUEST_RESPONSE) {
    assertThat(executor.execute().getMessageAsString(),equalTo(RESULT));
    assertThat(RequestContext.getEvent(),is(nullValue()));
  }
 else {
    assertThat(executor.execute(),equalTo(event));
    assertThat(RequestContext.getEvent(),not(nullValue()));
  }
  assertThat(processor1.event,is(notNullValue()));
  assertThat(processor1.thread,equalTo(Thread.currentThread()));
  assertThat(processor2.event,is(notNullValue()));
  assertThat(processor2.thread,equalTo(Thread.currentThread()));
  assertThat(processor3.event,is(notNullValue()));
  assertThat(processor3.thread,equalTo(Thread.currentThread()));
}
