{
  super(parserContext,muleContext);
  if (message != null) {
    addFinalVariable("message",message);
    addResolver("payload",new PayloadVariableResolver(message));
    if (message.getExceptionPayload() != null) {
      addFinalVariable("exception",message.getExceptionPayload().getException());
    }
    addFinalVariable("inbound",new MessagePropertyMapContext(message,PropertyScope.INBOUND));
    addFinalVariable("outbound",new MessagePropertyMapContext(message,PropertyScope.OUTBOUND));
    addFinalVariable("flowVariables",new MessagePropertyMapContext(message,PropertyScope.INVOCATION));
    addFinalVariable("sessionVariables",new MessagePropertyMapContext(message,PropertyScope.SESSION));
    addFinalVariable("inboundAttachments",new InboundAttachmentMapContext(message));
    addFinalVariable("outboundAttachments",new OutboundAttachmentMapContext(message));
  }
}
