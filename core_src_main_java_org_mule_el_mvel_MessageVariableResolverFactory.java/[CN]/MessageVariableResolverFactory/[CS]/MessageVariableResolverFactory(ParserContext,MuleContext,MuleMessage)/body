{
  super(parserContext,muleContext);
  if (message != null) {
    addVariable("message",new MessageContext(message));
    addVariable("payload",message.getPayload(),new VariableAssignmentCallback(){
      @Override public void assignValue(      String name,      Object value,      Object newValue){
        message.setPayload(newValue);
      }
    }
);
    if (message.getExceptionPayload() != null) {
      addVariable("exception",message.getExceptionPayload().getException());
    }
 else {
      addVariable("exception",null);
    }
    addVariable("flowVars",new MessagePropertyMapContext(message,PropertyScope.INVOCATION));
    addVariable("sessionVars",new MessagePropertyMapContext(message,PropertyScope.SESSION));
  }
}
