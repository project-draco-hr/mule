{
  super(parserContext,muleContext);
  if (message != null) {
    addFinalVariable("message",message);
    addResolver("payload",new PayloadVariableResolver(message));
    if (message.getExceptionPayload() != null) {
      addFinalVariable("exception",message.getExceptionPayload().getException());
    }
    addFinalVariable("inbound",new MessagePropertyWrapperMap(message,PropertyScope.INBOUND));
    addFinalVariable("outbound",new MessagePropertyWrapperMap(message,PropertyScope.OUTBOUND));
    addFinalVariable("flowVariables",new MessagePropertyWrapperMap(message,PropertyScope.INVOCATION));
    addFinalVariable("sessionVariables",new MessagePropertyWrapperMap(message,PropertyScope.SESSION));
    addFinalVariable("inboundAttachments",new InboundAttachmentWrapperMap(message));
    addFinalVariable("outboundAttachments",new OutboundAttachmentWrapperMap(message));
  }
}
