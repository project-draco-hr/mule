{
  StringBuilder urlBuilder=new StringBuilder();
  urlBuilder.append(authorizationUrl);
  urlBuilder.append("?").append("response_type=code&").append(OAuthConstants.CLIENT_ID_PARAMETER + "=").append(clientId);
  try {
    if (isNotBlank(scope)) {
      urlBuilder.append(String.format(ADDED_PARAMETER_TEMPLATE,OAuthConstants.SCOPE_PARAMETER)).append(URLEncoder.encode(scope,"UTF-8"));
    }
    if (isNotBlank(state)) {
      urlBuilder.append(String.format(ADDED_PARAMETER_TEMPLATE,OAuthConstants.STATE_PARAMETER)).append(URLEncoder.encode(state,"UTF-8"));
    }
    for (    Map.Entry<String,String> entry : customParameters.entrySet()) {
      urlBuilder.append("&").append(entry.getKey()).append("=").append(URLEncoder.encode(entry.getValue(),"UTF-8"));
    }
    urlBuilder.append(String.format(ADDED_PARAMETER_TEMPLATE,OAuthConstants.REDIRECT_URI_PARAMETER)).append(URLEncoder.encode(redirectUrl,"UTF-8"));
  }
 catch (  UnsupportedEncodingException e) {
    throw new RuntimeException(e);
  }
  if (logger.isDebugEnabled()) {
    logger.debug(("Authorization URL has been generated as follows: " + urlBuilder));
  }
  return urlBuilder.toString();
}
