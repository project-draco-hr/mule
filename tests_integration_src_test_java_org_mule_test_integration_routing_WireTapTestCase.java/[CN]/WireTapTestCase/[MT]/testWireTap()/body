{
  final Latch receiverLatch=new Latch();
  final Latch tappedReceiverLatch=new Latch();
  muleContext.registerListener(new FunctionalTestNotificationListener(){
    public void onNotification(    ServerNotification notification){
      if (notification.getResourceIdentifier().equals("Receiver")) {
        receiverLatch.countDown();
      }
 else       if (notification.getResourceIdentifier().equals("TappedReceiver")) {
        tappedReceiverLatch.countDown();
      }
    }
  }
);
  MuleClient client=new MuleClient();
  client.send("vm://inbound.channel","test",null);
  assertTrue(receiverLatch.await(3L,TimeUnit.SECONDS));
  assertTrue(tappedReceiverLatch.await(1L,TimeUnit.SECONDS));
}
