{
  MuleClient client=new MuleClient();
  List results=new ArrayList();
  for (int i=0; i < getNumberOfMessages(); i++) {
    client.dispatch("component1.endpoint","test",null);
  }
  for (int i=0; i < getNumberOfMessages(); i++) {
    UMOMessage result=client.request("results.endpoint",1000);
    assertNotNull(result);
    results.add(result);
  }
  assertEquals(results.size(),getNumberOfMessages());
  for (Iterator iterator=results.iterator(); iterator.hasNext(); ) {
    UMOMessage umoMessage=(UMOMessage)iterator.next();
    assertEquals("request received by component 3",umoMessage.getPayloadAsString());
  }
}
