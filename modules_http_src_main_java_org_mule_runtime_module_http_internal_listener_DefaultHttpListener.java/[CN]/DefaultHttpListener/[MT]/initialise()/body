{
  if (allowedMethods != null) {
    parsedAllowedMethods=extractAllowedMethods();
    methodRequestMatcher=new MethodRequestMatcher(parsedAllowedMethods);
  }
  if (responseBuilder == null) {
    responseBuilder=HttpResponseBuilder.emptyInstance(muleContext);
  }
  LifecycleUtils.initialiseIfNeeded(responseBuilder);
  if (errorResponseBuilder == null) {
    errorResponseBuilder=HttpResponseBuilder.emptyInstance(muleContext);
  }
  LifecycleUtils.initialiseIfNeeded(errorResponseBuilder);
  path=HttpParser.sanitizePathWithStartSlash(path);
  listenerPath=config.getFullListenerPath(path);
  path=listenerPath.getResolvedPath();
  responseBuilder.setResponseStreaming(responseStreamingMode);
  validatePath();
  parseRequest=config.resolveParseRequest(parseRequest);
  try {
    messageProcessingManager=DefaultHttpListener.this.muleContext.getRegistry().lookupObject(MessageProcessingManager.class);
    requestHandlerManager=this.config.addRequestHandler(new ListenerRequestMatcher(methodRequestMatcher,path),getRequestHandler());
  }
 catch (  Exception e) {
    throw new InitialisationException(e,this);
  }
}
