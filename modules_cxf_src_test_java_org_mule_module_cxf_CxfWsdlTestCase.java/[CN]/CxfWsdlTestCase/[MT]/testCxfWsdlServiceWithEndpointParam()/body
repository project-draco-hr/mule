{
  EndpointBuilder endpointBuilder=new EndpointURIEndpointBuilder(TEST_URL_NOWSDL,muleContext);
  endpointBuilder.setProperty("wsdlUrl",TEST_URL_WSDL);
  OutboundEndpoint endpoint=muleContext.getEndpointFactory().getOutboundEndpoint(endpointBuilder);
  MuleMessage message=new DefaultMuleMessage("test1",muleContext);
  MuleSession session=new DefaultMuleSession(message,((AbstractConnector)endpoint.getConnector()).getSessionHandler(),muleContext);
  MuleEvent event=new DefaultMuleEvent(message,endpoint.getExchangePattern(),session);
  MuleMessage reply=endpoint.process(event).getMessage();
  assertNotNull(reply);
  Document response=(Document)reply.getPayload();
  assertNotNull(response);
  XMLAssert.assertXpathEvaluatesTo("test1","//*[namespace-uri()='http://applications.external.tck.mule.org' and local-name()='key']",response);
}
