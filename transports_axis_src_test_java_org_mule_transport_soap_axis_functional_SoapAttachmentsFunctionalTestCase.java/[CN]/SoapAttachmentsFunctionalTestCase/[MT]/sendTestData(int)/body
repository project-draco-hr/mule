{
  OutboundEndpoint ep=muleContext.getRegistry().lookupEndpointBuilder("client").buildOutboundEndpoint();
  AxisMessageDispatcher client=new AxisMessageDispatcher(ep);
  client.initialise();
  for (int i=0; i < iterations; i++) {
    MuleMessage msg=new DefaultMuleMessage("testPayload",muleContext);
    File tempFile=File.createTempFile("test",".att");
    tempFile.deleteOnExit();
    msg.addAttachment("testAttachment",new DataHandler(new FileDataSource(tempFile)));
    DefaultMuleSession session=new DefaultMuleSession(msg,((AbstractConnector)ep.getConnector()).getSessionHandler(),muleContext);
    DefaultMuleEvent event=new DefaultMuleEvent(msg,ep,session);
    MuleMessage result=client.process(event).getMessage();
    assertNotNull(result);
    assertNotNull(result.getPayload());
    assertEquals(result.getPayloadAsString(),"Done");
    callbackCount++;
  }
}
