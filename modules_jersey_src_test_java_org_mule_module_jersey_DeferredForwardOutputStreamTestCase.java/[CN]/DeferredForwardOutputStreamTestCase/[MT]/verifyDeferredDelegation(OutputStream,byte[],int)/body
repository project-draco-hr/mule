{
  ArgumentCaptor<byte[]> captor=ArgumentCaptor.forClass(byte[].class);
  verify(delegate).write(captor.capture());
  byte[] captured=captor.getValue();
  assertThat(captured.length,is(len));
  assertThat(ArrayUtils.isEquals(buffer,captured),is(true));
}
