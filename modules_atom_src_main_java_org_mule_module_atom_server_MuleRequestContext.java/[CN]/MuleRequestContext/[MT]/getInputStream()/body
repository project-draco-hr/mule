{
  Object payload=request.getPayload();
  if (payload instanceof InputStream) {
    return (InputStream)payload;
  }
 else   if (payload instanceof byte[]) {
    return new ByteArrayInputStream((byte[])payload);
  }
 else {
    try {
      return new ByteArrayInputStream(request.getPayloadAsString().getBytes());
    }
 catch (    Exception e) {
      IOException e2=new IOException("Could not convert message to String.");
      e2.initCause(e);
      throw e2;
    }
  }
}
