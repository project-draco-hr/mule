{
  if (endpoints.size() > 0 && routers.size() == 0) {
    addRouter(new InboundPassThroughRouter());
  }
  String componentName=event.getSession().getComponent().getDescriptor().getName();
  UMOEvent[] eventsToRoute=null;
  boolean noRoute=true;
  boolean match=false;
  UMOInboundRouter umoInboundRouter=null;
  for (Iterator iterator=getRouters().iterator(); iterator.hasNext(); ) {
    umoInboundRouter=(UMOInboundRouter)iterator.next();
    if (umoInboundRouter.isMatch(event)) {
      match=true;
      eventsToRoute=umoInboundRouter.process(event);
      noRoute=(eventsToRoute == null);
      if (!matchAll) {
        break;
      }
    }
  }
  if (!event.isStopFurtherProcessing()) {
    if (noRoute) {
      if (getStatistics().isEnabled()) {
        getStatistics().incrementNoRoutedMessage();
      }
      if (!match) {
        if (getCatchAllStrategy() != null) {
          if (logger.isDebugEnabled()) {
            logger.debug("Message did not match any routers on: " + componentName + " - invoking catch all strategy");
          }
          getStatistics().incrementCaughtMessage();
          return getCatchAllStrategy().catchMessage(event.getMessage(),event.getSession(),event.isSynchronous());
        }
 else {
          logger.warn("Message did not match any routers on: " + componentName + " and there is no catch all strategy configured on this router.  Disposing message.");
          if (logger.isDebugEnabled()) {
            try {
              logger.warn("Message fragment is: " + StringMessageHelper.truncate(event.getMessageAsString(),100,true));
            }
 catch (            UMOException e) {
            }
          }
        }
      }
    }
 else {
      try {
        UMOMessage messageResult=null;
        if (eventsToRoute != null) {
          for (int i=0; i < eventsToRoute.length; i++) {
            if (event.isSynchronous()) {
              messageResult=send(eventsToRoute[i]);
            }
 else {
              dispatch(eventsToRoute[i]);
            }
            if (getStatistics().isEnabled()) {
              getStatistics().incrementRoutedMessage(eventsToRoute[i].getEndpoint());
            }
          }
        }
        return messageResult;
      }
 catch (      UMOException e) {
        throw new RoutingException(event.getMessage(),event.getEndpoint(),e);
      }
    }
  }
  return (eventsToRoute != null && eventsToRoute.length > 0 ? eventsToRoute[eventsToRoute.length - 1].getMessage() : null);
}
