{
  Object payload="hello world!";
  Serializable newAttributes=mock(Serializable.class);
  delegate.asReturnValue(MuleMessage.builder().payload(payload).attributes(newAttributes).build(),operationContext);
  MuleMessage message=getOutputMessage();
  assertThat(message.getPayload(),is(sameInstance(payload)));
  assertThat(message.getAttributes(),is(sameInstance(newAttributes)));
  assertThat(message.getDataType().getType().equals(String.class),is(true));
}
