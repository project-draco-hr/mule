{
  this.muleContext=context;
  try {
    AbstractJmxAgent agent=muleContext.getRegistry().lookupObject(AbstractJmxAgent.class);
    if (getMBeanServer() != null) {
      agent.setMBeanServer(getMBeanServer());
    }
    if (getConnectorServerUrl() != null) {
      agent.setConnectorServerUrl(getConnectorServerUrl());
    }
    if (getConnectorServerProperties() != null && !getConnectorServerProperties().isEmpty()) {
      agent.setConnectorServerProperties(getConnectorServerProperties());
    }
    agent.setCreateServer(isCreateServer());
    agent.setLocateServer(isLocateServer());
    agent.setEnableStatistics(isEnableStatistics());
    agent.setCreateRmiRegistry(isCreateRmiRegistry());
    agent.setCredentials(credentials);
  }
 catch (  RegistrationException e) {
    throw new RuntimeException(e);
  }
}
