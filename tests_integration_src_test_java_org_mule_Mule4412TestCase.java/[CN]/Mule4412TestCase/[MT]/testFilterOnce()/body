{
  DefaultMuleMessage msg=new DefaultMuleMessage(TEST_MESSAGE,muleContext);
  msg.setOutboundProperty("pass","true");
  MuleClient client=muleContext.getClient();
  client.send("vm://async",msg);
  MuleMessage reply=client.request("vm://asyncResponse",RECEIVE_TIMEOUT_MS);
  int times=FilterCounter.counter.get();
  assertTrue("did not filter one time as expected, times filtered " + times,times == 1);
  assertNotNull(reply);
  assertEquals("wrong message received : " + reply.getPayloadAsString(),TEST_MESSAGE,reply.getPayloadAsString());
  assertEquals("'pass' property value not correct","true",reply.getInboundProperty("pass"));
  assertNull(client.request("vm://asyncResponse",RECEIVE_TIMEOUT_MS));
}
