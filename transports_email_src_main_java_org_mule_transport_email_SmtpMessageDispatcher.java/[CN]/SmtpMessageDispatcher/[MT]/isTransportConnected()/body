{
  boolean isConnected=false;
  isConnected=transport.isConnected();
  if (isConnected) {
    SMTPTransport smtpTransport=(SMTPTransport)transport;
    String lastServerResponse=smtpTransport.getLastServerResponse();
    if (lastServerResponse.startsWith("250") == false) {
      isConnected=false;
      try {
        smtpTransport.close();
      }
 catch (      MessagingException me) {
        if (logger.isInfoEnabled()) {
          logger.info("Unable to close SMTP Transport",me);
        }
      }
    }
  }
  return isConnected;
}
