{
  assertQueueIsEmpty("vm://error.queue");
  client.send("vm://component.in","test",null);
  assertQueueIsEmpty("vm://component.out");
  MuleMessage message=client.request("vm://error.queue",2000);
  assertNotNull(message);
  Object payload=message.getPayload();
  assertTrue(payload instanceof ExceptionMessage);
  assertNotificationsArrived();
  assertNotificationsHaveMatchingResourceIds();
}
