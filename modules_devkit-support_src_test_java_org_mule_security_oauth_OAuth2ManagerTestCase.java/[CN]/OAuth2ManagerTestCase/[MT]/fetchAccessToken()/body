{
  final String accessTokenUrl="accessTokenUrl";
  Mockito.when(adapter.getAccessTokenUrl()).thenReturn(accessTokenUrl);
  final String oauthVerifier="oauthVerifier";
  final String consumerKey="consumerKey";
  final String consumerSecret="consumerSecret";
  final String redirectUri="redirectUri";
  final String response="response";
  final String requestBody="code=oauthVerifier&client_id=consumerKey&client_secret=consumerSecret&grant_type=authorization_code&redirect_uri=redirectUri";
  final Pattern accessTokenPattern=Pattern.compile(".");
  final Pattern expirationPattern=Pattern.compile(".");
  final Pattern refreshTokenPattern=Pattern.compile(".");
  final String accessToken="accessToken";
  final String refreshToken="refreshToken";
  final Date expiration=new Date();
  Mockito.when(adapter.getOauthVerifier()).thenReturn(oauthVerifier);
  Mockito.when(adapter.getConsumerKey()).thenReturn(consumerKey);
  Mockito.when(adapter.getConsumerSecret()).thenReturn(consumerSecret);
  Mockito.when(adapter.getAccessCodePattern()).thenReturn(accessTokenPattern);
  Mockito.when(adapter.getRefreshTokenPattern()).thenReturn(refreshTokenPattern);
  Mockito.when(adapter.getExpirationTimePattern()).thenReturn(expirationPattern);
  Mockito.when(this.httpUtil.post(this.manager.getDefaultUnauthorizedConnector().getAccessTokenUrl(),requestBody)).thenReturn(response);
  Mockito.when(this.oauthResponseParser.extractAccessCode(accessTokenPattern,response)).thenReturn(accessToken);
  Mockito.when(this.oauthResponseParser.extractExpirationTime(expirationPattern,response)).thenReturn(expiration);
  Mockito.when(this.oauthResponseParser.extractRefreshToken(refreshTokenPattern,response)).thenReturn(refreshToken);
  this.manager.fetchAccessToken(adapter,redirectUri);
  Mockito.verify(this.httpUtil).post(this.manager.getDefaultUnauthorizedConnector().getAccessTokenUrl(),requestBody);
  Mockito.verify(this.oauthResponseParser).extractAccessCode(accessTokenPattern,response);
  Mockito.verify(this.adapter).setAccessToken(accessToken);
  Mockito.verify(this.adapter).setExpiration(expiration);
  Mockito.verify(this.adapter).setRefreshToken(refreshToken);
  Mockito.verify(adapter).postAuth();
  Mockito.verify(this.manager).fetchCallbackParameters(this.adapter,response);
}
