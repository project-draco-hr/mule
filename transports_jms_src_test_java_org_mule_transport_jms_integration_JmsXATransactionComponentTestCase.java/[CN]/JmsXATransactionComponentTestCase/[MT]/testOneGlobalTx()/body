{
  MuleClient client=muleContext.getClient();
  client.dispatch("vm://in",DEFAULT_INPUT_MESSAGE,null);
  MuleMessage result=client.request("vm://out",getTimeout());
  assertNotNull(result);
  result=client.request("vm://out",getSmallTimeout());
  assertNull(result);
  muleContext.getRegistry().lookupConnector(CONNECTOR1_NAME).stop();
  assertEquals(muleContext.getRegistry().lookupConnector(CONNECTOR1_NAME).isStarted(),false);
  log.info(CONNECTOR1_NAME + " is stopped");
  client.dispatch("vm://in",DEFAULT_INPUT_MESSAGE,null);
  Thread.sleep(1000);
  muleContext.getRegistry().lookupConnector(CONNECTOR1_NAME).start();
  Thread.sleep(1000);
  log.info(CONNECTOR1_NAME + " is started");
  result=client.request("vm://out",getTimeout());
  assertNotNull(result);
  result=client.request("vm://out",getSmallTimeout());
  assertNull(result);
}
