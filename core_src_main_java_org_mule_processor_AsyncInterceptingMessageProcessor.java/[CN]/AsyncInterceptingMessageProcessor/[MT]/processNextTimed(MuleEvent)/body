{
  if (next == null) {
    return event;
  }
 else {
    if (logger.isTraceEnabled()) {
      logger.trace("Invoking next MessageProcessor: '" + next.getClass().getName() + "' ");
    }
    if (next instanceof OutboundEndpoint) {
      event=new DefaultMuleEvent(event.getMessage(),(OutboundEndpoint)next,event.getSession());
    }
    MuleEvent response;
    if (event.getFlowConstruct() != null) {
      response=new ProcessingTimeInterceptor(next,event.getFlowConstruct()).process(event);
    }
 else {
      response=next.process(event);
    }
    return response;
  }
}
