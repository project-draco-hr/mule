{
  try {
    if (connection != null) {
      if (!embeddedMode) {
        connection.setExceptionListener(null);
      }
      connection.close();
    }
  }
  finally {
    connection=null;
  }
}
