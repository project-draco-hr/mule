{
  String auth=request.getHeader(AUTHORIZATION);
  if (auth == null) {
    response.setStatus(SC_UNAUTHORIZED);
    response.addHeader(WWW_AUTHENTICATE,"NTLM");
  }
  if (TYPE_1_MESSAGE.equals(auth)) {
    response.setStatus(SC_UNAUTHORIZED);
    response.setHeader(WWW_AUTHENTICATE,TYPE_2_MESSAGE);
  }
 else   if (type3Message.equals(auth)) {
    response.setStatus(SC_OK);
    response.getWriter().print(AUTHORIZED);
  }
 else {
    response.setStatus(SC_UNAUTHORIZED);
  }
}
