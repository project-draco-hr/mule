{
  if (transportResponse == null) {
    return null;
  }
  Object payload;
  if (response == null || response.length == 0) {
    payload=null;
  }
 else   if (response.length == 1) {
    payload=response[0];
  }
 else {
    payload=response;
  }
  MuleMessage message=transportResponse.getMessage();
  String statusCode=message.getInboundProperty(HttpConnector.HTTP_STATUS_PROPERTY);
  if (statusCode != null && Integer.parseInt(statusCode) != HttpConstants.SC_OK) {
    String exPayload;
    try {
      exPayload=message.getPayloadAsString();
    }
 catch (    Exception e) {
      exPayload="Invalid status code: " + statusCode;
    }
    message.setExceptionPayload(new DefaultExceptionPayload(new HttpException(exPayload)));
  }
 else {
    message.setPayload(payload);
  }
  return transportResponse;
}
