{
  MuleMessage message=new DefaultMuleMessage("",muleContext);
  MuleEvent event=new DefaultMuleEvent(message,MessageExchangePattern.ONE_WAY,Mockito.mock(FlowConstruct.class));
  event.setFlowVariable("foo","bar_old");
  muleContext.getExpressionManager().evaluate("#[groovy:flowVars['foo']='bar']",message);
  assertEquals("bar",event.getFlowVariable("foo"));
}
