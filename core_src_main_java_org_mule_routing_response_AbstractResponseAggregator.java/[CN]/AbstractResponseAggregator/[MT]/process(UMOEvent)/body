{
  EventGroup eg=addEvent(event);
  if (shouldAggregate(eg)) {
    UMOMessage returnMessage=aggregateEvents(eg);
    Object id=eg.getGroupId();
    removeGroup(id);
    responseEvents.put(id,returnMessage);
synchronized (locks) {
      Latch l=(Latch)locks.get(id);
      if (l == null) {
        if (logger.isDebugEnabled()) {
          logger.debug("Creating latch for " + id + " in "+ this);
        }
        l=new Latch();
        locks.put(id,l);
      }
      l.countDown();
    }
  }
}
