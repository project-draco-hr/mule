{
  when(serviceRegistry.lookupProviders(Describer.class,getClass().getClassLoader())).thenReturn(Arrays.asList(describer));
  when(describer.describe(any(DescribingContext.class))).thenReturn(extensionDeclarer);
  when(extensionFactory.createFrom(extensionDeclarer)).thenReturn(extensionModel);
  List<RuntimeExtensionModel> extensionModels=discoverer.discover(getClass().getClassLoader());
  assertThat(extensionModels,hasSize(1));
  assertThat(extensionModels.get(0),is(sameInstance(extensionModel)));
  verify(serviceRegistry).lookupProviders(Describer.class,getClass().getClassLoader());
  verify(describer).describe(any(DescribingContext.class));
  verify(extensionFactory).createFrom(extensionDeclarer);
}
