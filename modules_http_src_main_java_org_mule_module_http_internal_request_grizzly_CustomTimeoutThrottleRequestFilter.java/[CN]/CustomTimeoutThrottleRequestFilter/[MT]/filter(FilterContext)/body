{
  try {
    if (logger.isDebugEnabled()) {
      logger.debug("Current Throttling Status {}",available.availablePermits());
    }
    if (!available.tryAcquire(ctx.getRequest().getPerRequestConfig().getRequestTimeoutInMs(),MILLISECONDS)) {
      throw new FilterException(String.format("No slot available for processing Request %s with AsyncHandler %s",ctx.getRequest(),ctx.getAsyncHandler()));
    }
  }
 catch (  InterruptedException e) {
    throw new FilterException(String.format("Interrupted Request %s with AsyncHandler %s",ctx.getRequest(),ctx.getAsyncHandler()));
  }
  return new FilterContext.FilterContextBuilder(ctx).asyncHandler(new AsyncHandlerWrapper(ctx.getAsyncHandler())).build();
}
