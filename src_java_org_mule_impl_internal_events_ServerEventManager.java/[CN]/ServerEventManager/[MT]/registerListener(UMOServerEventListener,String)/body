{
  if (subscription == null) {
    subscription=NULL_SUBSCRIPTION;
  }
  TreeMap listeners=getListeners(listener.getClass());
synchronized (listeners) {
    listeners.put(listener,subscription);
  }
}
