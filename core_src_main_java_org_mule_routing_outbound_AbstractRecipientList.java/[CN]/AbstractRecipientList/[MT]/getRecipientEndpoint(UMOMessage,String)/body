{
  UMOEndpoint endpoint=(UMOEndpoint)recipientCache.get(recipient);
  if (endpoint != null) {
    return endpoint;
  }
  try {
    if (null != getManagementContext() && null != getManagementContext().getRegistry()) {
      endpoint=getManagementContext().getRegistry().getEndpointFromUri(recipient);
    }
    if (null == endpoint) {
      UMOEndpointURI uri=new MuleEndpointURI(recipient);
      if (null != getManagementContext() && null != getManagementContext().getRegistry()) {
        endpoint=getManagementContext().getRegistry().getOrCreateEndpointForUri(uri,UMOEndpoint.ENDPOINT_TYPE_SENDER);
      }
    }
    if (null == endpoint) {
      throw new RegistrationException("Failed to create endpoint for: " + recipient);
    }
    endpoint.initialise();
  }
 catch (  UMOException e) {
    throw new RoutingException(message,endpoint,e);
  }
  UMOEndpoint existingEndpoint=(UMOEndpoint)recipientCache.putIfAbsent(recipient,endpoint);
  if (existingEndpoint != null) {
    endpoint=existingEndpoint;
  }
  return endpoint;
}
