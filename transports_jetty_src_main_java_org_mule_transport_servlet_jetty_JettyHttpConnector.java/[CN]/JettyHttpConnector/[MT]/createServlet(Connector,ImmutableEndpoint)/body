{
  HttpServlet servlet;
  if (getReceiverServlet() == null) {
    if (isUseContinuations()) {
      servlet=new JettyContinuationsReceiverServlet();
    }
 else {
      servlet=new JettyReceiverServlet();
    }
  }
 else {
    servlet=getReceiverServlet();
  }
  String path=endpoint.getEndpointURI().getPath();
  if (StringUtils.isBlank(path)) {
    path=ROOT;
  }
  ContextHandlerCollection handlerCollection=new ContextHandlerCollection();
  Context context=new Context(handlerCollection,ROOT,Context.NO_SECURITY);
  context.setConnectorNames(new String[]{connector.getName()});
  context.addEventListener(new MuleServletContextListener(muleContext,getName()));
  if (resourceBase != null) {
    Context resourceContext=new Context(handlerCollection,path,Context.NO_SECURITY);
    resourceContext.setResourceBase(resourceBase);
  }
  context.addServlet(JarResourceServlet.class,JarResourceServlet.DEFAULT_PATH_SPEC);
  ServletHolder holder=new ServletHolder();
  holder.setServlet(servlet);
  context.addServlet(holder,"/*");
  getHttpServer().addHandler(handlerCollection);
  return servlet;
}
